[Inductive {name = "tree"; relv = R;
   body =
   (Binder ([],
      (PBind ((Type U),
         (Binder ("A",
            (PBase
               ((TBase (Type U)),
                [(DConstr ("Leaf",
                    (TBind (R, (Id ("A", I)),
                       (Binder ("x",
                          (TBase (App [(Id ("tree", I)); (Id ("A", I))]))))
                       )),
                    [E]));
                  (DConstr ("Node",
                     (TBind (R, (App [(Id ("tree", I)); (Id ("A", I))]),
                        (Binder ("l",
                           (TBind (R,
                              (App [(Id ("tree", I)); (Id ("A", I))]),
                              (Binder ("r",
                                 (TBase
                                    (App [(Id ("tree", I)); (Id ("A", I))]))
                                 ))
                              ))
                           ))
                        )),
                     [E; E]))
                  ]))
            ))
         ))
      ));
   view = [E]};
  Inductive {name = "opr"; relv = R;
    body =
    (Binder ([],
       (PBind ((Type U),
          (Binder ("A",
             (PBase
                ((TBase (Type L)),
                 [(DConstr ("Free",
                     (TBase (App [(Id ("opr", I)); (Id ("A", I))])), 
                     []));
                   (DConstr ("Map",
                      (TBind (N, (Type U),
                         (Binder ("B",
                            (TBind (R,
                               (Pi (R, U, (Id ("A", I)),
                                  (Binder ("_", (Id ("B", I)))))),
                               (Binder ("f",
                                  (TBase
                                     (App [(Id ("opr", I)); (Id ("A", I))]))
                                  ))
                               ))
                            ))
                         )),
                      [I; E]));
                   (DConstr ("Reduce",
                      (TBind (N, (Type U),
                         (Binder ("B",
                            (TBind (R,
                               (Pi (R, U, (Id ("A", I)),
                                  (Binder ("_", (Id ("B", I)))))),
                               (Binder ("f",
                                  (TBind (R,
                                     (Pi (R, U, (Id ("B", I)),
                                        (Binder ("_",
                                           (Pi (R, U, (Id ("B", I)),
                                              (Binder ("_", (Id ("B", I))))))
                                           ))
                                        )),
                                     (Binder ("g",
                                        (TBase
                                           (App
                                              [(Id ("opr", I)); (Id ("A", I))
                                                ]))
                                        ))
                                     ))
                                  ))
                               ))
                            ))
                         )),
                      [I; E; E]))
                   ]))
             ))
          ))
       ));
    view = [E]};
  Definition {name = "map"; relv = R;
    body =
    (Binder ([],
       ((Fun (
           (Pi (N, U, (Type U),
              (Binder ("A",
                 (Pi (N, U, (Type U),
                    (Binder ("B",
                       (Pi (R, U,
                          (Pi (R, U, (Id ("A", I)),
                             (Binder ("_", (Id ("B", I)))))),
                          (Binder ("f",
                             (Pi (R, U,
                                (App [(Id ("tree", I)); (Id ("A", I))]),
                                (Binder ("_",
                                   (App [(Id ("tree", I)); (Id ("B", I))])))
                                ))
                             ))
                          ))
                       ))
                    ))
                 ))
              )),
           (Binder ((Some "map"),
              [([(PId "A"); (PId "B"); (PId "f");
                  (PConstr ("Leaf", [(PId "x")]))],
                (Some (App
                         [(Id ("Leaf", I));
                           (App [(Id ("f", I)); (Id ("x", I))])])));
                ([(PId "A"); (PId "B"); (PId "f");
                   (PConstr ("Node", [(PId "l"); (PId "r")]))],
                 (Some (App
                          [(Id ("Node", I));
                            (App
                               [(Id ("map", I)); (Id ("f", I)); (Id ("l", I))
                                 ]);
                            (App
                               [(Id ("map", I)); (Id ("f", I)); (Id ("r", I))
                                 ])
                            ])))
                ]
              )),
           [I; I; E])),
        (Pi (N, U, (Type U),
           (Binder ("A",
              (Pi (N, U, (Type U),
                 (Binder ("B",
                    (Pi (R, U,
                       (Pi (R, U, (Id ("A", I)),
                          (Binder ("_", (Id ("B", I)))))),
                       (Binder ("f",
                          (Pi (R, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                             (Binder ("_",
                                (App [(Id ("tree", I)); (Id ("B", I))])))
                             ))
                          ))
                       ))
                    ))
                 ))
              ))
           )))
       ));
    view = [I; I; E]};
  Definition {name = "reduce"; relv = R;
    body =
    (Binder ([],
       ((Fun (
           (Pi (N, U, (Type U),
              (Binder ("A",
                 (Pi (N, U, (Type U),
                    (Binder ("B",
                       (Pi (R, U,
                          (Pi (R, U, (Id ("A", I)),
                             (Binder ("_", (Id ("B", I)))))),
                          (Binder ("f",
                             (Pi (R, U,
                                (Pi (R, U, (Id ("B", I)),
                                   (Binder ("_",
                                      (Pi (R, U, (Id ("B", I)),
                                         (Binder ("_", (Id ("B", I))))))
                                      ))
                                   )),
                                (Binder ("g",
                                   (Pi (R, U,
                                      (App [(Id ("tree", I)); (Id ("A", I))]),
                                      (Binder ("_", (Id ("B", I))))))
                                   ))
                                ))
                             ))
                          ))
                       ))
                    ))
                 ))
              )),
           (Binder ((Some "reduce"),
              [([(PId "A"); (PId "B"); (PId "f"); (PId "g");
                  (PConstr ("Leaf", [(PId "x")]))],
                (Some (App [(Id ("f", I)); (Id ("x", I))])));
                ([(PId "A"); (PId "B"); (PId "f"); (PId "g");
                   (PConstr ("Node", [(PId "l"); (PId "r")]))],
                 (Some (App
                          [(Id ("g", I));
                            (App
                               [(Id ("reduce", I)); (Id ("f", I));
                                 (Id ("g", I)); (Id ("l", I))]);
                            (App
                               [(Id ("reduce", I)); (Id ("f", I));
                                 (Id ("g", I)); (Id ("r", I))])
                            ])))
                ]
              )),
           [I; I; E; E])),
        (Pi (N, U, (Type U),
           (Binder ("A",
              (Pi (N, U, (Type U),
                 (Binder ("B",
                    (Pi (R, U,
                       (Pi (R, U, (Id ("A", I)),
                          (Binder ("_", (Id ("B", I)))))),
                       (Binder ("f",
                          (Pi (R, U,
                             (Pi (R, U, (Id ("B", I)),
                                (Binder ("_",
                                   (Pi (R, U, (Id ("B", I)),
                                      (Binder ("_", (Id ("B", I))))))
                                   ))
                                )),
                             (Binder ("g",
                                (Pi (R, U,
                                   (App [(Id ("tree", I)); (Id ("A", I))]),
                                   (Binder ("_", (Id ("B", I))))))
                                ))
                             ))
                          ))
                       ))
                    ))
                 ))
              ))
           )))
       ));
    view = [I; I; E; E]};
  Definition {name = "tree_p"; relv = N;
    body =
    (Binder ([],
       ((Fun (
           (Pi (N, U, (Type U),
              (Binder ("A",
                 (Pi (R, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                    (Binder ("t", Proto))))
                 ))
              )),
           (Binder ((Some "tree_p"),
              [([(PId "A"); (PId "t")],
                (Some (Act (R, false, (App [(Id ("opr", I)); (Id ("A", I))]),
                         (Binder ("o",
                            (Match ([(R, (Id ("o", I)), None)], None,
                               [([(PId "Free")], (Some End));
                                 ([(PConstr ("Map", [(PId "_"); (PId "f")]))],
                                  (Some (App
                                           [(Id ("tree_p", I));
                                             (App
                                                [(Id ("map", I));
                                                  (Id ("f", I));
                                                  (Id ("t", I))])
                                             ])));
                                 ([(PConstr ("Reduce",
                                      [(PId "_"); (PId "f"); (PId "g")]))
                                    ],
                                  (Some (Act (R, true,
                                           (UOpr ("`",
                                              (App
                                                 [(Id ("reduce", I));
                                                   (Id ("f", I));
                                                   (Id ("g", I));
                                                   (Id ("t", I))])
                                              )),
                                           (Binder ("_",
                                              (App
                                                 [(Id ("tree_p", I));
                                                   (Id ("t", I))])
                                              ))
                                           ))))
                                 ]
                               ))
                            ))
                         ))))
                ]
              )),
           [I; E])),
        (Pi (N, U, (Type U),
           (Binder ("A",
              (Pi (R, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                 (Binder ("t", Proto))))
              ))
           )))
       ));
    view = [I; E]};
  Definition {name = "ctree_ch"; relv = N;
    body =
    (Binder ([],
       ((Fun (
           (Pi (N, U, (Type U),
              (Binder ("A",
                 (Pi (R, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                    (Binder ("t", (Type L)))))
                 ))
              )),
           (Binder ((Some "ctree_ch"),
              [([(PId "A"); (PId "t")],
                (Some (Ch (true, (App [(Id ("tree_p", I)); (Id ("t", I))])))))
                ]
              )),
           [I; E])),
        (Pi (N, U, (Type U),
           (Binder ("A",
              (Pi (R, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                 (Binder ("t", (Type L)))))
              ))
           )))
       ));
    view = [I; E]};
  Definition {name = "ctree_hc"; relv = N;
    body =
    (Binder ([],
       ((Fun (
           (Pi (N, U, (Type U),
              (Binder ("A",
                 (Pi (R, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                    (Binder ("t", (Type L)))))
                 ))
              )),
           (Binder ((Some "ctree_hc"),
              [([(PId "A"); (PId "t")],
                (Some (Ch (false, (App [(Id ("tree_p", I)); (Id ("t", I))])))))
                ]
              )),
           [I; E])),
        (Pi (N, U, (Type U),
           (Binder ("A",
              (Pi (R, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                 (Binder ("t", (Type L)))))
              ))
           )))
       ));
    view = [I; E]};
  Definition {name = "ctree"; relv = N;
    body =
    (Binder ([],
       ((Fun (
           (Pi (N, U, (Type U),
              (Binder ("A",
                 (Pi (R, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                    (Binder ("t", (Type L)))))
                 ))
              )),
           (Binder ((Some "ctree"),
              [([(PId "A"); (PId "t")],
                (Some (IO (App [(Id ("ctree_hc", I)); (Id ("t", I))]))))]
              )),
           [I; E])),
        (Pi (N, U, (Type U),
           (Binder ("A",
              (Pi (R, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                 (Binder ("t", (Type L)))))
              ))
           )))
       ));
    view = [I; E]};
  Definition {name = "leaf_worker"; relv = R;
    body =
    (Binder ([],
       ((Fun (
           (Pi (N, U, (Type U),
              (Binder ("A",
                 (Pi (R, U, (Id ("A", I)),
                    (Binder ("x",
                       (Pi (R, U,
                          (App
                             [(Id ("ctree_ch", E)); (Id ("A", I));
                               (App [(Id ("Leaf", I)); (Id ("x", I))])]),
                          (Binder ("c", (IO (Id ("unit", I)))))))
                       ))
                    ))
                 ))
              )),
           (Binder ((Some "leaf_worker"),
              [([(PId "A"); (PId "x"); (PId "c")],
                (Some (MLet ((Recv (Id ("c", I))),
                         (Binder (
                            (PBOpr ("\226\159\168,\226\159\169", (PId "o"),
                               (PId "c"))),
                            (Match (
                               [(R, (Id ("o", I)), (Some ("o0", IMeta)));
                                 (R, (Id ("c", I)),
                                  (Some ("_",
                                         (Ch (true,
                                            (Match (
                                               [(R, (Id ("o0", I)), None)],
                                               None,
                                               [([(PId "Free")], (Some End));
                                                 ([(PConstr ("Map",
                                                      [(PId "B"); (PId "f")]
                                                      ))
                                                    ],
                                                  (Some (App
                                                           [(Id ("tree_p", E
                                                               ));
                                                             (Id ("B", I));
                                                             (App
                                                                [(Id ("Leaf",
                                                                    E));
                                                                  (Id ("B", I
                                                                    ));
                                                                  (App
                                                                    [(Id (
                                                                    "f", I));
                                                                    (Id ("x",
                                                                    I))])
                                                                  ])
                                                             ])));
                                                 ([(PConstr ("Reduce",
                                                      [(PId "B"); (PId "f");
                                                        (PId "_")]
                                                      ))
                                                    ],
                                                  (Some (Act (R, true,
                                                           (App
                                                              [(Id ("sing", E
                                                                  ));
                                                                (Id ("B", I));
                                                                (App
                                                                   [(Id ("f",
                                                                    I));
                                                                    (Id ("x",
                                                                    I))])
                                                                ]),
                                                           (Binder ("_",
                                                              (App
                                                                 [(Id (
                                                                    "tree_p",
                                                                    I));
                                                                   (App
                                                                    [(Id (
                                                                    "Leaf", I
                                                                    ));
                                                                    (Id ("x",
                                                                    I))])
                                                                   ])
                                                              ))
                                                           ))))
                                                 ]
                                               ))
                                            )))))
                                 ],
                               None,
                               [([(PId "Free"); (PId "c")],
                                 (Some (Close (Id ("c", I)))));
                                 ([(PConstr ("Map", [(PId "B"); (PId "f")]));
                                    (PId "c")],
                                  (Some (App
                                           [(Id ("leaf_worker", E));
                                             (Id ("B", I));
                                             (App
                                                [(Id ("f", I)); (Id ("x", I))
                                                  ]);
                                             (Id ("c", I))])));
                                 ([(PConstr ("Reduce",
                                      [(PId "_"); (PId "f"); (PId "_")]));
                                    (PId "c")],
                                  (Some (MLet (
                                           (App
                                              [(Send (Id ("c", I)));
                                                (App
                                                   [(Id ("just", I));
                                                     (App
                                                        [(Id ("f", I));
                                                          (Id ("x", I))])
                                                     ])
                                                ]),
                                           (Binder ((PId "c"),
                                              (App
                                                 [(Id ("leaf_worker", I));
                                                   (Id ("x", I));
                                                   (Id ("c", I))])
                                              ))
                                           ))))
                                 ]
                               ))
                            ))
                         ))))
                ]
              )),
           [I; E; E])),
        (Pi (N, U, (Type U),
           (Binder ("A",
              (Pi (R, U, (Id ("A", I)),
                 (Binder ("x",
                    (Pi (R, U,
                       (App
                          [(Id ("ctree_ch", E)); (Id ("A", I));
                            (App [(Id ("Leaf", I)); (Id ("x", I))])]),
                       (Binder ("c", (IO (Id ("unit", I)))))))
                    ))
                 ))
              ))
           )))
       ));
    view = [I; E; E]};
  Definition {name = "node_worker"; relv = R;
    body =
    (Binder ([],
       ((Fun (
           (Pi (N, U, (Type U),
              (Binder ("A",
                 (Pi (N, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                    (Binder ("l",
                       (Pi (N, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                          (Binder ("r",
                             (Pi (R, L,
                                (App [(Id ("ctree_hc", I)); (Id ("l", I))]),
                                (Binder ("_",
                                   (Pi (R, L,
                                      (App
                                         [(Id ("ctree_hc", I)); (Id ("r", I))
                                           ]),
                                      (Binder ("_",
                                         (Pi (R, L,
                                            (App
                                               [(Id ("ctree_ch", I));
                                                 (App
                                                    [(Id ("Node", I));
                                                      (Id ("l", I));
                                                      (Id ("r", I))])
                                                 ]),
                                            (Binder ("_",
                                               (IO (Id ("unit", I)))))
                                            ))
                                         ))
                                      ))
                                   ))
                                ))
                             ))
                          ))
                       ))
                    ))
                 ))
              )),
           (Binder ((Some "node_worker"),
              [([(PId "A"); (PId "l"); (PId "r"); (PId "l_ch"); (PId "r_ch");
                  (PId "c")],
                (Some (MLet ((Recv (Id ("c", I))),
                         (Binder (
                            (PBOpr ("\226\159\168,\226\159\169", (PId "o"),
                               (PId "c"))),
                            (Match (
                               [(R, (Id ("o", I)), (Some ("o0", IMeta)));
                                 (R, (Id ("c", I)),
                                  (Some ("_",
                                         (Ch (true,
                                            (Match (
                                               [(R, (Id ("o0", I)), None)],
                                               None,
                                               [([(PId "Free")], (Some End));
                                                 ([(PConstr ("Map",
                                                      [(PId "B"); (PId "f")]
                                                      ))
                                                    ],
                                                  (Some (App
                                                           [(Id ("tree_p", E
                                                               ));
                                                             (Id ("B", I));
                                                             (App
                                                                [(Id ("map",
                                                                    E));
                                                                  IMeta;
                                                                  (Id ("B", I
                                                                    ));
                                                                  (Id ("f", I
                                                                    ));
                                                                  (App
                                                                    [(Id (
                                                                    "Node", I
                                                                    ));
                                                                    (Id ("l",
                                                                    I));
                                                                    (Id ("r",
                                                                    I))])
                                                                  ])
                                                             ])));
                                                 ([(PConstr ("Reduce",
                                                      [(PId "B"); (PId "f");
                                                        (PId "g")]
                                                      ))
                                                    ],
                                                  (Some (Act (R, true,
                                                           (App
                                                              [(Id ("sing", E
                                                                  ));
                                                                (Id ("B", I));
                                                                (App
                                                                   [(Id (
                                                                    "reduce",
                                                                    E));
                                                                    IMeta;
                                                                    (Id ("B",
                                                                    I));
                                                                    (Id ("f",
                                                                    I));
                                                                    (Id ("g",
                                                                    I));
                                                                    (App
                                                                    [(Id (
                                                                    "Node", I
                                                                    ));
                                                                    (Id ("l",
                                                                    I));
                                                                    (Id ("r",
                                                                    I))])])
                                                                ]),
                                                           (Binder ("_",
                                                              (App
                                                                 [(Id (
                                                                    "tree_p",
                                                                    I));
                                                                   (App
                                                                    [(Id (
                                                                    "Node", I
                                                                    ));
                                                                    (Id ("l",
                                                                    I));
                                                                    (Id ("r",
                                                                    I))])
                                                                   ])
                                                              ))
                                                           ))))
                                                 ]
                                               ))
                                            )))))
                                 ],
                               None,
                               [([(PId "Free"); (PId "c")],
                                 (Some (MLet (
                                          (App
                                             [(Send (Id ("l_ch", I)));
                                               (Id ("Free", I))]),
                                          (Binder ((PId "l_ch"),
                                             (MLet (
                                                (App
                                                   [(Send (Id ("r_ch", I)));
                                                     (Id ("Free", I))]),
                                                (Binder ((PId "r_ch"),
                                                   (BOpr (";",
                                                      (Close (Id ("l_ch", I))),
                                                      (BOpr (";",
                                                         (Close
                                                            (Id ("r_ch", I))),
                                                         (Close (Id ("c", I)))
                                                         ))
                                                      ))
                                                   ))
                                                ))
                                             ))
                                          ))));
                                 ([(PConstr ("Map", [(PId "_"); (PId "f")]));
                                    (PId "c")],
                                  (Some (MLet (
                                           (App
                                              [(Send (Id ("l_ch", I)));
                                                (App
                                                   [(Id ("Map", I));
                                                     (Id ("f", I))])
                                                ]),
                                           (Binder ((PId "l_ch"),
                                              (MLet (
                                                 (App
                                                    [(Send (Id ("r_ch", I)));
                                                      (App
                                                         [(Id ("Map", I));
                                                           (Id ("f", I))])
                                                      ]),
                                                 (Binder ((PId "r_ch"),
                                                    (App
                                                       [(Id ("node_worker", I
                                                           ));
                                                         (Id ("l_ch", I));
                                                         (Id ("r_ch", I));
                                                         (Id ("c", I))])
                                                    ))
                                                 ))
                                              ))
                                           ))));
                                 ([(PConstr ("Reduce",
                                      [(PId "_"); (PId "f"); (PId "g")]));
                                    (PId "c")],
                                  (Some (MLet (
                                           (App
                                              [(Send (Id ("l_ch", I)));
                                                (App
                                                   [(Id ("Reduce", I));
                                                     (Id ("f", I));
                                                     (Id ("g", I))])
                                                ]),
                                           (Binder ((PId "l_ch"),
                                              (MLet (
                                                 (App
                                                    [(Send (Id ("r_ch", I)));
                                                      (App
                                                         [(Id ("Reduce", I));
                                                           (Id ("f", I));
                                                           (Id ("g", I))])
                                                      ]),
                                                 (Binder ((PId "r_ch"),
                                                    (MLet (
                                                       (Recv (Id ("l_ch", I))),
                                                       (Binder (
                                                          (PBOpr (
                                                             "\226\159\168,\226\159\169",
                                                             (PConstr (
                                                                "just",
                                                                [(PId "vl")]
                                                                )),
                                                             (PId "l_ch"))),
                                                          (MLet (
                                                             (Recv
                                                                (Id ("r_ch",
                                                                   I))),
                                                             (Binder (
                                                                (PBOpr (
                                                                   "\226\159\168,\226\159\169",
                                                                   (PConstr (
                                                                    "just",
                                                                    [(PId
                                                                    "vr")])),
                                                                   (PId
                                                                    "r_ch")
                                                                   )),
                                                                (MLet (
                                                                   (App
                                                                    [(Send
                                                                    (Id ("c",
                                                                    I)));
                                                                    (App
                                                                    [(Id (
                                                                    "just", I
                                                                    ));
                                                                    (App
                                                                    [(Id (
                                                                    "g", I));
                                                                    (Id (
                                                                    "vl", I));
                                                                    (Id (
                                                                    "vr", I))
                                                                    ])])]),
                                                                   (Binder (
                                                                    (PId "c"),
                                                                    (App
                                                                    [(Id (
                                                                    "node_worker",
                                                                    I));
                                                                    (Id (
                                                                    "l_ch", I
                                                                    ));
                                                                    (Id (
                                                                    "r_ch", I
                                                                    ));
                                                                    (Id ("c",
                                                                    I))])))
                                                                   ))
                                                                ))
                                                             ))
                                                          ))
                                                       ))
                                                    ))
                                                 ))
                                              ))
                                           ))))
                                 ]
                               ))
                            ))
                         ))))
                ]
              )),
           [I; I; I])),
        (Pi (N, U, (Type U),
           (Binder ("A",
              (Pi (N, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                 (Binder ("l",
                    (Pi (N, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                       (Binder ("r",
                          (Pi (R, L,
                             (App [(Id ("ctree_hc", I)); (Id ("l", I))]),
                             (Binder ("_",
                                (Pi (R, L,
                                   (App [(Id ("ctree_hc", I)); (Id ("r", I))]),
                                   (Binder ("_",
                                      (Pi (R, L,
                                         (App
                                            [(Id ("ctree_ch", I));
                                              (App
                                                 [(Id ("Node", I));
                                                   (Id ("l", I));
                                                   (Id ("r", I))])
                                              ]),
                                         (Binder ("_", (IO (Id ("unit", I)))
                                            ))
                                         ))
                                      ))
                                   ))
                                ))
                             ))
                          ))
                       ))
                    ))
                 ))
              ))
           )))
       ));
    view = [I; I; I]};
  Definition {name = "cleaf"; relv = R;
    body =
    (Binder ([],
       ((Fun (
           (Pi (N, U, (Type U),
              (Binder ("A",
                 (Pi (R, U, (Id ("A", I)),
                    (Binder ("x",
                       (App
                          [(Id ("ctree", I));
                            (App [(Id ("Leaf", I)); (Id ("x", I))])])
                       ))
                    ))
                 ))
              )),
           (Binder ((Some "cleaf"),
              [([(PId "A"); (PId "x")],
                (Some (Fork
                         (Fun (
                            (Pi (R, L,
                               (App
                                  [(Id ("ctree_ch", I));
                                    (App [(Id ("Leaf", I)); (Id ("x", I))])]),
                               (Binder ("", (IO (Id ("unit", I))))))),
                            (Binder (None,
                               [([(PId "c")],
                                 (Some (App
                                          [(Id ("leaf_worker", I));
                                            (Id ("x", I)); (Id ("c", I))])))
                                 ]
                               )),
                            [])))))
                ]
              )),
           [I; E])),
        (Pi (N, U, (Type U),
           (Binder ("A",
              (Pi (R, U, (Id ("A", I)),
                 (Binder ("x",
                    (App
                       [(Id ("ctree", I));
                         (App [(Id ("Leaf", I)); (Id ("x", I))])])
                    ))
                 ))
              ))
           )))
       ));
    view = [I; E]};
  Definition {name = "cnode"; relv = R;
    body =
    (Binder ([],
       ((Fun (
           (Pi (N, U, (Type U),
              (Binder ("A",
                 (Pi (N, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                    (Binder ("l",
                       (Pi (N, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                          (Binder ("r",
                             (Pi (R, L,
                                (App [(Id ("ctree", I)); (Id ("l", I))]),
                                (Binder ("_",
                                   (Pi (R, L,
                                      (App [(Id ("ctree", I)); (Id ("r", I))]),
                                      (Binder ("_",
                                         (App
                                            [(Id ("ctree", I));
                                              (App
                                                 [(Id ("Node", I));
                                                   (Id ("l", I));
                                                   (Id ("r", I))])
                                              ])
                                         ))
                                      ))
                                   ))
                                ))
                             ))
                          ))
                       ))
                    ))
                 ))
              )),
           (Binder ((Some "cnode"),
              [([(PId "A"); (PId "l"); (PId "r"); (PId "l0"); (PId "r0")],
                (Some (MLet ((Id ("l0", I)),
                         (Binder ((PId "l_ch"),
                            (MLet ((Id ("r0", I)),
                               (Binder ((PId "r_ch"),
                                  (Fork
                                     (Fun (
                                        (Pi (R, L,
                                           (App
                                              [(Id ("ctree_ch", I));
                                                (App
                                                   [(Id ("Node", I));
                                                     (Id ("l", I));
                                                     (Id ("r", I))])
                                                ]),
                                           (Binder ("", (IO (Id ("unit", I)))
                                              ))
                                           )),
                                        (Binder (None,
                                           [([(PId "c")],
                                             (Some (App
                                                      [(Id ("node_worker", I
                                                          ));
                                                        (Id ("l_ch", I));
                                                        (Id ("r_ch", I));
                                                        (Id ("c", I))])))
                                             ]
                                           )),
                                        [])))
                                  ))
                               ))
                            ))
                         ))))
                ]
              )),
           [I; I; I])),
        (Pi (N, U, (Type U),
           (Binder ("A",
              (Pi (N, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                 (Binder ("l",
                    (Pi (N, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                       (Binder ("r",
                          (Pi (R, L,
                             (App [(Id ("ctree", I)); (Id ("l", I))]),
                             (Binder ("_",
                                (Pi (R, L,
                                   (App [(Id ("ctree", I)); (Id ("r", I))]),
                                   (Binder ("_",
                                      (App
                                         [(Id ("ctree", I));
                                           (App
                                              [(Id ("Node", I));
                                                (Id ("l", I)); (Id ("r", I))])
                                           ])
                                      ))
                                   ))
                                ))
                             ))
                          ))
                       ))
                    ))
                 ))
              ))
           )))
       ));
    view = [I; I; I]};
  Definition {name = "ctree_of_tree"; relv = R;
    body =
    (Binder ([],
       ((Fun (
           (Pi (N, U, (Type U),
              (Binder ("A",
                 (Pi (R, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                    (Binder ("t", (App [(Id ("ctree", I)); (Id ("t", I))])))
                    ))
                 ))
              )),
           (Binder ((Some "ctree_of_tree"),
              [([(PId "A"); (PConstr ("Leaf", [(PId "x")]))],
                (Some (App [(Id ("cleaf", I)); (Id ("x", I))])));
                ([(PId "A"); (PConstr ("Node", [(PId "l"); (PId "r")]))],
                 (Some (App
                          [(Id ("cnode", I));
                            (App [(Id ("ctree_of_tree", I)); (Id ("l", I))]);
                            (App [(Id ("ctree_of_tree", I)); (Id ("r", I))])])))
                ]
              )),
           [I])),
        (Pi (N, U, (Type U),
           (Binder ("A",
              (Pi (R, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                 (Binder ("t", (App [(Id ("ctree", I)); (Id ("t", I))])))))
              ))
           )))
       ));
    view = [I]};
  Definition {name = "cfree"; relv = R;
    body =
    (Binder ([],
       ((Fun (
           (Pi (N, U, (Type U),
              (Binder ("A",
                 (Pi (N, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                    (Binder ("t",
                       (Pi (R, U, (App [(Id ("ctree", I)); (Id ("t", I))]),
                          (Binder ("ct", (IO (Id ("unit", I)))))))
                       ))
                    ))
                 ))
              )),
           (Binder ((Some "cfree"),
              [([(PId "A"); (PId "t"); (PId "ct")],
                (Some (MLet ((Id ("ct", I)),
                         (Binder ((PId "c"),
                            (MLet (
                               (App [(Send (Id ("c", I))); (Id ("Free", I))]),
                               (Binder ((PId "c"), (Close (Id ("c", I)))))))
                            ))
                         ))))
                ]
              )),
           [I; I; E])),
        (Pi (N, U, (Type U),
           (Binder ("A",
              (Pi (N, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                 (Binder ("t",
                    (Pi (R, U, (App [(Id ("ctree", I)); (Id ("t", I))]),
                       (Binder ("ct", (IO (Id ("unit", I)))))))
                    ))
                 ))
              ))
           )))
       ));
    view = [I; I; E]};
  Definition {name = "cmap"; relv = R;
    body =
    (Binder ([],
       ((Fun (
           (Pi (N, U, (Type U),
              (Binder ("A",
                 (Pi (N, U, (Type U),
                    (Binder ("B",
                       (Pi (N, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                          (Binder ("t",
                             (Pi (R, U,
                                (Pi (R, U, (Id ("A", I)),
                                   (Binder ("_", (Id ("B", I)))))),
                                (Binder ("f",
                                   (Pi (R, U,
                                      (App [(Id ("ctree", I)); (Id ("t", I))]),
                                      (Binder ("ct",
                                         (App
                                            [(Id ("ctree", I));
                                              (App
                                                 [(Id ("map", I));
                                                   (Id ("f", I));
                                                   (Id ("t", I))])
                                              ])
                                         ))
                                      ))
                                   ))
                                ))
                             ))
                          ))
                       ))
                    ))
                 ))
              )),
           (Binder ((Some "cmap"),
              [([(PId "A"); (PId "B"); (PId "t"); (PId "f"); (PId "ct")],
                (Some (MLet ((Id ("ct", I)),
                         (Binder ((PId "c"),
                            (MLet (
                               (App
                                  [(Send (Id ("c", I)));
                                    (App [(Id ("Map", I)); (Id ("f", I))])]),
                               (Binder ((PId "c"), (Return (Id ("c", I)))))))
                            ))
                         ))))
                ]
              )),
           [I; I; I; E; E])),
        (Pi (N, U, (Type U),
           (Binder ("A",
              (Pi (N, U, (Type U),
                 (Binder ("B",
                    (Pi (N, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                       (Binder ("t",
                          (Pi (R, U,
                             (Pi (R, U, (Id ("A", I)),
                                (Binder ("_", (Id ("B", I)))))),
                             (Binder ("f",
                                (Pi (R, U,
                                   (App [(Id ("ctree", I)); (Id ("t", I))]),
                                   (Binder ("ct",
                                      (App
                                         [(Id ("ctree", I));
                                           (App
                                              [(Id ("map", I));
                                                (Id ("f", I)); (Id ("t", I))])
                                           ])
                                      ))
                                   ))
                                ))
                             ))
                          ))
                       ))
                    ))
                 ))
              ))
           )))
       ));
    view = [I; I; I; E; E]};
  Definition {name = "creduce"; relv = R;
    body =
    (Binder ([],
       ((Fun (
           (Pi (N, U, (Type U),
              (Binder ("A",
                 (Pi (N, U, (Type U),
                    (Binder ("B",
                       (Pi (N, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                          (Binder ("t",
                             (Pi (R, U,
                                (Pi (R, U, (Id ("A", I)),
                                   (Binder ("_", (Id ("B", I)))))),
                                (Binder ("f",
                                   (Pi (R, U,
                                      (Pi (R, U, (Id ("B", I)),
                                         (Binder ("_",
                                            (Pi (R, U, (Id ("B", I)),
                                               (Binder ("_", (Id ("B", I))))
                                               ))
                                            ))
                                         )),
                                      (Binder ("g",
                                         (Pi (R, U,
                                            (App
                                               [(Id ("ctree", I));
                                                 (Id ("t", I))]),
                                            (Binder ("ct",
                                               (IO
                                                  (BOpr ("\226\138\151",
                                                     (UOpr ("`",
                                                        (App
                                                           [(Id ("reduce", I
                                                               ));
                                                             (Id ("f", I));
                                                             (Id ("g", I));
                                                             (Id ("t", I))])
                                                        )),
                                                     (App
                                                        [(Id ("ctree", I));
                                                          (Id ("t", I))])
                                                     )))
                                               ))
                                            ))
                                         ))
                                      ))
                                   ))
                                ))
                             ))
                          ))
                       ))
                    ))
                 ))
              )),
           (Binder ((Some "creduce"),
              [([(PId "A"); (PId "B"); (PId "t"); (PId "f"); (PId "g");
                  (PId "ct")],
                (Some (MLet ((Id ("ct", I)),
                         (Binder ((PId "c"),
                            (MLet (
                               (App
                                  [(Send (Id ("c", I)));
                                    (App
                                       [(Id ("Reduce", I)); (Id ("f", I));
                                         (Id ("g", I))])
                                    ]),
                               (Binder ((PId "c"),
                                  (MLet ((Recv (Id ("c", I))),
                                     (Binder (
                                        (PBOpr ("\226\159\168,\226\159\169",
                                           (PId "x"), (PId "ct"))),
                                        (Return
                                           (BOpr (
                                              "\226\159\168,\226\159\169",
                                              (Id ("x", I)),
                                              (Return (Id ("ct", I))))))
                                        ))
                                     ))
                                  ))
                               ))
                            ))
                         ))))
                ]
              )),
           [I; I; I; E; E; E])),
        (Pi (N, U, (Type U),
           (Binder ("A",
              (Pi (N, U, (Type U),
                 (Binder ("B",
                    (Pi (N, U, (App [(Id ("tree", I)); (Id ("A", I))]),
                       (Binder ("t",
                          (Pi (R, U,
                             (Pi (R, U, (Id ("A", I)),
                                (Binder ("_", (Id ("B", I)))))),
                             (Binder ("f",
                                (Pi (R, U,
                                   (Pi (R, U, (Id ("B", I)),
                                      (Binder ("_",
                                         (Pi (R, U, (Id ("B", I)),
                                            (Binder ("_", (Id ("B", I))))))
                                         ))
                                      )),
                                   (Binder ("g",
                                      (Pi (R, U,
                                         (App
                                            [(Id ("ctree", I)); (Id ("t", I))
                                              ]),
                                         (Binder ("ct",
                                            (IO
                                               (BOpr ("\226\138\151",
                                                  (UOpr ("`",
                                                     (App
                                                        [(Id ("reduce", I));
                                                          (Id ("f", I));
                                                          (Id ("g", I));
                                                          (Id ("t", I))])
                                                     )),
                                                  (App
                                                     [(Id ("ctree", I));
                                                       (Id ("t", I))])
                                                  )))
                                            ))
                                         ))
                                      ))
                                   ))
                                ))
                             ))
                          ))
                       ))
                    ))
                 ))
              ))
           )))
       ));
    view = [I; I; I; E; E; E]};
  Definition {name = "split"; relv = R;
    body =
    (Binder (["t"],
       ((Fun (
           (Pi (R, U,
              (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t]),
              (Binder ("_",
                 (BOpr ("\226\138\151",
                    (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t]),
                    (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t])
                    ))
                 ))
              )),
           (Binder ((Some "split"),
              [([(PId "nil")],
                (Some (BOpr ("\226\159\168,\226\159\169", (Id ("nil", I)),
                         (Id ("nil", I))))));
                ([(PBOpr ("::", (PId "x"), (PId "nil")))],
                 (Some (BOpr ("\226\159\168,\226\159\169",
                          (BOpr ("::", (Id ("x", I)), (Id ("nil", I)))),
                          (Id ("nil", I))))));
                ([(PBOpr ("::", (PId "x"),
                     (PBOpr ("::", (PId "y"), (PId "zs")))))
                   ],
                 (Some (Let (R, (App [(Id ("split", I)); (Id ("zs", I))]),
                          (Binder (
                             (PBOpr ("\226\159\168,\226\159\169", (PId "xs"),
                                (PId "ys"))),
                             (BOpr ("\226\159\168,\226\159\169",
                                (BOpr ("::", (Id ("x", I)), (Id ("xs", I)))),
                                (BOpr ("::", (Id ("y", I)), (Id ("ys", I))))
                                ))
                             ))
                          ))))
                ]
              )),
           [])),
        (Pi (R, U, (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t]),
           (Binder ("_",
              (BOpr ("\226\138\151",
                 (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t]),
                 (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t])))
              ))
           )))
       ));
    view = []};
  Definition {name = "merge"; relv = R;
    body =
    (Binder (["t"],
       ((Fun (
           (Pi (R, U,
              (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t]),
              (Binder ("_",
                 (Pi (R, L,
                    (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t]),
                    (Binder ("_",
                       (App
                          [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t])
                       ))
                    ))
                 ))
              )),
           (Binder ((Some "merge"),
              [([(PId "nil"); (PId "ys")], (Some (Id ("ys", I))));
                ([(PId "xs"); (PId "nil")], (Some (Id ("xs", I))));
                ([(PBOpr ("::", (PId "x"), (PId "xs")));
                   (PBOpr ("::", (PId "y"), (PId "ys")))],
                 (Some (Match (
                          [(R, (BOpr ("<=", (Id ("x", I)), (Id ("y", I)))),
                            None)],
                          None,
                          [([(PId "true")],
                            (Some (BOpr ("::", (Id ("x", I)),
                                     (App
                                        [(Id ("merge", I)); (Id ("xs", I));
                                          (BOpr ("::", (Id ("y", I)),
                                             (Id ("ys", I))))
                                          ])
                                     ))));
                            ([(PId "false")],
                             (Some (BOpr ("::", (Id ("y", I)),
                                      (App
                                         [(Id ("merge", I));
                                           (BOpr ("::", (Id ("x", I)),
                                              (Id ("xs", I))));
                                           (Id ("ys", I))])
                                      ))))
                            ]
                          ))))
                ]
              )),
           [])),
        (Pi (R, U, (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t]),
           (Binder ("_",
              (Pi (R, L,
                 (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t]),
                 (Binder ("_",
                    (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t])
                    ))
                 ))
              ))
           )))
       ));
    view = []};
  Definition {name = "msort"; relv = R;
    body =
    (Binder (["t"],
       ((Fun (
           (Pi (R, U,
              (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t]),
              (Binder ("_",
                 (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t])))
              )),
           (Binder ((Some "msort"),
              [([(PId "nil")], (Some (Id ("nil", I))));
                ([(PBOpr ("::", (PId "z"), (PId "nil")))],
                 (Some (BOpr ("::", (Id ("z", I)), (Id ("nil", I))))));
                ([(PId "zs")],
                 (Some (Let (R, (App [(Id ("split", I)); (Id ("zs", I))]),
                          (Binder (
                             (PBOpr ("\226\159\168,\226\159\169", (PId "xs"),
                                (PId "ys"))),
                             (App
                                [(Id ("merge", I));
                                  (App [(Id ("msort", I)); (Id ("xs", I))]);
                                  (App [(Id ("msort", I)); (Id ("ys", I))])])
                             ))
                          ))))
                ]
              )),
           [])),
        (Pi (R, U, (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t]),
           (Binder ("_",
              (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t])))
           )))
       ));
    view = []};
  Definition {name = "splitting_tree"; relv = R;
    body =
    (Binder ([],
       ((Fun (
           (Pi (R, U, (App [(Inst ("list", [(SId "_"); U], I)); Int_t]),
              (Binder ("_",
                 (App
                    [(Id ("tree", I));
                      (App [(Inst ("list", [(SId "_"); U], I)); Int_t])])
                 ))
              )),
           (Binder ((Some "splitting_tree"),
              [([(PId "nil")],
                (Some (App [(Id ("Leaf", I)); (Id ("nil", I))])));
                ([(PBOpr ("::", (PId "z"), (PId "nil")))],
                 (Some (App
                          [(Id ("Leaf", I));
                            (BOpr ("::", (Id ("z", I)), (Id ("nil", I))))])));
                ([(PId "zs")],
                 (Some (Let (R, (App [(Id ("split", I)); (Id ("zs", I))]),
                          (Binder (
                             (PBOpr ("\226\159\168,\226\159\169", (PId "xs"),
                                (PId "ys"))),
                             (Let (R,
                                (App
                                   [(Id ("splitting_tree", I));
                                     (Id ("xs", I))]),
                                (Binder ((PId "l"),
                                   (Let (R,
                                      (App
                                         [(Id ("splitting_tree", I));
                                           (Id ("ys", I))]),
                                      (Binder ((PId "r"),
                                         (App
                                            [(Id ("Node", I)); (Id ("l", I));
                                              (Id ("r", I))])
                                         ))
                                      ))
                                   ))
                                ))
                             ))
                          ))))
                ]
              )),
           [])),
        (Pi (R, U, (App [(Inst ("list", [(SId "_"); U], I)); Int_t]),
           (Binder ("_",
              (App
                 [(Id ("tree", I));
                   (App [(Inst ("list", [(SId "_"); U], I)); Int_t])])
              ))
           )))
       ));
    view = []};
  Definition {name = "reduce_splitting_tree"; relv = N;
    body =
    (Binder ([],
       ((Fun (
           (Pi (R, U, (App [(Inst ("list", [(SId "_"); U], I)); Int_t]),
              (Binder ("xs",
                 (BOpr ("=",
                    (App
                       [(Id ("reduce", I));
                         (Fun ((Pi (R, U, IMeta, (Binder ("x", IMeta)))),
                            (Binder (None,
                               [([(PId "x")], (Some (Id ("x", I))))])),
                            []));
                         (Fun (
                            (Pi (R, U, IMeta,
                               (Binder ("l",
                                  (Pi (R, U, IMeta, (Binder ("r", IMeta))))))
                               )),
                            (Binder (None,
                               [([(PId "l"); (PId "r")],
                                 (Some (App
                                          [(Id ("merge", I)); (Id ("l", I));
                                            (Id ("r", I))])))
                                 ]
                               )),
                            []));
                         (App [(Id ("splitting_tree", I)); (Id ("xs", I))])]),
                    (App [(Id ("msort", I)); (Id ("xs", I))])))
                 ))
              )),
           (Binder ((Some "reduce_splitting_tree"),
              [([(PId "nil")], (Some (Id ("refl", I))));
                ([(PBOpr ("::", (PId "z"), (PId "nil")))],
                 (Some (Id ("refl", I))));
                ([(PId "zs")],
                 (Some (Match (
                          [(R, (App [(Id ("split", I)); (Id ("zs", I))]),
                            (Some ("h1", IMeta)));
                            (N, (Id ("refl", I)),
                             (Some ("_",
                                    (BOpr ("=",
                                       (Let (R, (Id ("h1", I)),
                                          (Binder (
                                             (PBOpr (
                                                "\226\159\168,\226\159\169",
                                                (PId "xs"), (PId "ys"))),
                                             (App
                                                [(Id ("merge", I));
                                                  (App
                                                     [(Id ("msort", I));
                                                       (Id ("xs", I))]);
                                                  (App
                                                     [(Id ("msort", I));
                                                       (Id ("ys", I))])
                                                  ])
                                             ))
                                          )),
                                       (App
                                          [(Id ("msort", I)); (Id ("zs", I))])
                                       )))));
                            (N, (Id ("refl", I)),
                             (Some ("_",
                                    (BOpr ("=",
                                       (App
                                          [(Id ("reduce", I));
                                            (Fun (
                                               (Pi (R, U, IMeta,
                                                  (Binder ("x", IMeta)))),
                                               (Binder (None,
                                                  [([(PId "x")],
                                                    (Some (Id ("x", I))))]
                                                  )),
                                               []));
                                            (Fun (
                                               (Pi (R, U, IMeta,
                                                  (Binder ("l",
                                                     (Pi (R, U, IMeta,
                                                        (Binder ("r", IMeta))
                                                        ))
                                                     ))
                                                  )),
                                               (Binder (None,
                                                  [([(PId "l"); (PId "r")],
                                                    (Some (App
                                                             [(Id ("merge", I
                                                                 ));
                                                               (Id ("l", I));
                                                               (Id ("r", I))])))
                                                    ]
                                                  )),
                                               []));
                                            (Let (R, (Id ("h1", I)),
                                               (Binder (
                                                  (PBOpr (
                                                     "\226\159\168,\226\159\169",
                                                     (PId "xs"), (PId "ys"))),
                                                  (Let (R,
                                                     (App
                                                        [(Id (
                                                            "splitting_tree",
                                                            I));
                                                          (Id ("xs", I))]),
                                                     (Binder ((PId "l"),
                                                        (Let (R,
                                                           (App
                                                              [(Id (
                                                                  "splitting_tree",
                                                                  I));
                                                                (Id ("ys", I
                                                                   ))
                                                                ]),
                                                           (Binder (
                                                              (PId "r"),
                                                              (App
                                                                 [(Id (
                                                                    "Node", I
                                                                    ));
                                                                   (Id ("l",
                                                                    I));
                                                                   (Id ("r",
                                                                    I))
                                                                   ])
                                                              ))
                                                           ))
                                                        ))
                                                     ))
                                                  ))
                                               ))
                                            ]),
                                       (App
                                          [(Id ("reduce", I));
                                            (Fun (
                                               (Pi (R, U, IMeta,
                                                  (Binder ("x", IMeta)))),
                                               (Binder (None,
                                                  [([(PId "x")],
                                                    (Some (Id ("x", I))))]
                                                  )),
                                               []));
                                            (Fun (
                                               (Pi (R, U, IMeta,
                                                  (Binder ("l",
                                                     (Pi (R, U, IMeta,
                                                        (Binder ("r", IMeta))
                                                        ))
                                                     ))
                                                  )),
                                               (Binder (None,
                                                  [([(PId "l"); (PId "r")],
                                                    (Some (App
                                                             [(Id ("merge", I
                                                                 ));
                                                               (Id ("l", I));
                                                               (Id ("r", I))])))
                                                    ]
                                                  )),
                                               []));
                                            (App
                                               [(Id ("splitting_tree", I));
                                                 (Id ("zs", I))])
                                            ])
                                       )))))
                            ],
                          None,
                          [([(PBOpr ("\226\159\168,\226\159\169",
                                (PId "xs0"), (PId "ys0")));
                              (PId "pf0"); (PId "pf1")],
                            (Some (Let (R,
                                     (App
                                        [(Id ("reduce_splitting_tree", I));
                                          (Id ("xs0", I))]),
                                     (Binder ((PId "pf_xs0"),
                                        (Let (R,
                                           (App
                                              [(Id ("reduce_splitting_tree",
                                                  I));
                                                (Id ("ys0", I))]),
                                           (Binder ((PId "pf_ys0"),
                                              (Let (R,
                                                 (App
                                                    [(Id ("rwr", I));
                                                      (Fun (
                                                         (Pi (R, U, IMeta,
                                                            (Binder ("xs",
                                                               IMeta))
                                                            )),
                                                         (Binder (None,
                                                            [([(PId "xs")],
                                                              (Some (
                                                              BOpr ("=",
                                                                (App
                                                                   [(Id (
                                                                    "merge",
                                                                    I));
                                                                    (Id (
                                                                    "xs", I));
                                                                    IMeta]),
                                                                IMeta))))
                                                              ]
                                                            )),
                                                         []));
                                                      (Id ("pf_xs0", I));
                                                      (Id ("pf0", I))]),
                                                 (Binder ((PId "pf0"),
                                                    (Let (R,
                                                       (App
                                                          [(Id ("rwr", I));
                                                            (Fun (
                                                               (Pi (R, U,
                                                                  IMeta,
                                                                  (Binder (
                                                                    "ys",
                                                                    IMeta))
                                                                  )),
                                                               (Binder (None,
                                                                  [([(PId
                                                                    "ys")],
                                                                    (Some (
                                                                    BOpr (
                                                                    "=",
                                                                    (App
                                                                    [(Id (
                                                                    "merge",
                                                                    I));
                                                                    IMeta;
                                                                    (Id (
                                                                    "ys", I))
                                                                    ]), IMeta
                                                                    ))))]
                                                                  )),
                                                               []));
                                                            (Id ("pf_ys0", I
                                                               ));
                                                            (Id ("pf0", I))]),
                                                       (Binder ((PId "pf0"),
                                                          (Let (R,
                                                             (App
                                                                [(Id ("rwl",
                                                                    I));
                                                                  (Fun (
                                                                    (Pi (R,
                                                                    U, IMeta,
                                                                    (Binder (
                                                                    "x",
                                                                    IMeta)))),
                                                                    (Binder (
                                                                    None,
                                                                    [([(PId
                                                                    "x")],
                                                                    (Some (
                                                                    BOpr (
                                                                    "=",
                                                                    (Id ("x",
                                                                    I)),
                                                                    IMeta))))
                                                                    ])), 
                                                                    []));
                                                                  (Id ("pf1",
                                                                    I));
                                                                  (Id ("pf0",
                                                                    I))
                                                                  ]),
                                                             (Binder (
                                                                (PId "pf0"),
                                                                (Id ("pf0", I
                                                                   ))
                                                                ))
                                                             ))
                                                          ))
                                                       ))
                                                    ))
                                                 ))
                                              ))
                                           ))
                                        ))
                                     ))))
                            ]
                          ))))
                ]
              )),
           [])),
        (Pi (R, U, (App [(Inst ("list", [(SId "_"); U], I)); Int_t]),
           (Binder ("xs",
              (BOpr ("=",
                 (App
                    [(Id ("reduce", I));
                      (Fun ((Pi (R, U, IMeta, (Binder ("x", IMeta)))),
                         (Binder (None, [([(PId "x")], (Some (Id ("x", I))))]
                            )),
                         []));
                      (Fun (
                         (Pi (R, U, IMeta,
                            (Binder ("l",
                               (Pi (R, U, IMeta, (Binder ("r", IMeta))))))
                            )),
                         (Binder (None,
                            [([(PId "l"); (PId "r")],
                              (Some (App
                                       [(Id ("merge", I)); (Id ("l", I));
                                         (Id ("r", I))])))
                              ]
                            )),
                         []));
                      (App [(Id ("splitting_tree", I)); (Id ("xs", I))])]),
                 (App [(Id ("msort", I)); (Id ("xs", I))])))
              ))
           )))
       ));
    view = []};
  Definition {name = "splitting_ctree"; relv = R;
    body =
    (Binder ([],
       ((Fun (
           (Pi (R, U, (App [(Inst ("list", [(SId "_"); U], I)); Int_t]),
              (Binder ("xs",
                 (Pi (R, U,
                    (Ch (true,
                       (Act (R, true,
                          (App
                             [(Id ("ctree", I));
                               (App
                                  [(Id ("splitting_tree", I)); (Id ("xs", I))
                                    ])
                               ]),
                          (Binder ("_", End))))
                       )),
                    (Binder ("_", (IO (Id ("unit", I)))))))
                 ))
              )),
           (Binder ((Some "splitting_ctree"),
              [([(PId "nil"); (PId "c")],
                (Some (MLet (
                         (App
                            [(Send (Id ("c", I)));
                              (App [(Id ("cleaf", I)); (Id ("nil", I))])]),
                         (Binder ((PId "c"),
                            (BOpr (";", (Close (Id ("c", I))),
                               (Return (Id ("tt", I)))))
                            ))
                         ))));
                ([(PBOpr ("::", (PId "z"), (PId "nil"))); (PId "c")],
                 (Some (MLet (
                          (App
                             [(Send (Id ("c", I)));
                               (App
                                  [(Id ("cleaf", I));
                                    (BOpr ("::", (Id ("z", I)),
                                       (Id ("nil", I))))
                                    ])
                               ]),
                          (Binder ((PId "c"),
                             (BOpr (";", (Close (Id ("c", I))),
                                (Return (Id ("tt", I)))))
                             ))
                          ))));
                ([(PId "zs"); (PId "c")],
                 (Some (Match (
                          [(R, (App [(Id ("split", I)); (Id ("zs", I))]),
                            (Some ("h1", IMeta)));
                            (N, (Id ("refl", I)),
                             (Some ("_",
                                    (BOpr ("=",
                                       (Let (R, (Id ("h1", I)),
                                          (Binder (
                                             (PBOpr (
                                                "\226\159\168,\226\159\169",
                                                (PId "xs"), (PId "ys"))),
                                             (Let (R,
                                                (App
                                                   [(Id ("splitting_tree", I
                                                       ));
                                                     (Id ("xs", I))]),
                                                (Binder ((PId "l"),
                                                   (Let (R,
                                                      (App
                                                         [(Id (
                                                             "splitting_tree",
                                                             I));
                                                           (Id ("ys", I))]),
                                                      (Binder ((PId "r"),
                                                         (App
                                                            [(Id ("Node", I));
                                                              (Id ("l", I));
                                                              (Id ("r", I))])
                                                         ))
                                                      ))
                                                   ))
                                                ))
                                             ))
                                          )),
                                       (App
                                          [(Id ("splitting_tree", I));
                                            (Id ("zs", I))])
                                       )))))
                            ],
                          None,
                          [([(PBOpr ("\226\159\168,\226\159\169", (PId "xs"),
                                (PId "ys")));
                              (PId "pf")],
                            (Some (MLet (
                                     (Fork
                                        (Fun (
                                           (Pi (R, L, IMeta,
                                              (Binder ("",
                                                 (IO (Id ("unit", I)))))
                                              )),
                                           (Binder (None,
                                              [([(PId "c")],
                                                (Some (App
                                                         [(Id (
                                                             "splitting_ctree",
                                                             I));
                                                           (Id ("xs", I));
                                                           (Id ("c", I))])))
                                                ]
                                              )),
                                           []))),
                                     (Binder ((PId "cl"),
                                        (MLet (
                                           (Fork
                                              (Fun (
                                                 (Pi (R, L, IMeta,
                                                    (Binder ("",
                                                       (IO (Id ("unit", I)))
                                                       ))
                                                    )),
                                                 (Binder (None,
                                                    [([(PId "c")],
                                                      (Some (App
                                                               [(Id (
                                                                   "splitting_ctree",
                                                                   I));
                                                                 (Id ("ys", I
                                                                    ));
                                                                 (Id ("c", I
                                                                    ))
                                                                 ])))
                                                      ]
                                                    )),
                                                 []))),
                                           (Binder ((PId "cr"),
                                              (MLet ((Recv (Id ("cl", I))),
                                                 (Binder (
                                                    (PBOpr (
                                                       "\226\159\168,\226\159\169",
                                                       (PId "l"), (PId "cl")
                                                       )),
                                                    (BOpr (";",
                                                       (Close (Id ("cl", I))),
                                                       (MLet (
                                                          (Recv
                                                             (Id ("cr", I))),
                                                          (Binder (
                                                             (PBOpr (
                                                                "\226\159\168,\226\159\169",
                                                                (PId "r"),
                                                                (PId "cr"))),
                                                             (BOpr (";",
                                                                (Close
                                                                   (Id ("cr",
                                                                    I))),
                                                                (Let (R,
                                                                   (Ann (
                                                                    (App
                                                                    [(Id (
                                                                    "cnode",
                                                                    I));
                                                                    (Id ("l",
                                                                    I));
                                                                    (Id ("r",
                                                                    I))]),
                                                                    (App
                                                                    [(Id (
                                                                    "ctree",
                                                                    I));
                                                                    (App
                                                                    [(Id (
                                                                    "Node", I
                                                                    ));
                                                                    (App
                                                                    [(Id (
                                                                    "splitting_tree",
                                                                    I));
                                                                    (Id (
                                                                    "xs", I))
                                                                    ]);
                                                                    (App
                                                                    [(Id (
                                                                    "splitting_tree",
                                                                    I));
                                                                    (Id (
                                                                    "ys", I))
                                                                    ])])]))),
                                                                   (Binder (
                                                                    (PId "ct"),
                                                                    (Let (R,
                                                                    (App
                                                                    [(Id (
                                                                    "rwl", I
                                                                    ));
                                                                    (Fun (
                                                                    (Pi (R,
                                                                    U, IMeta,
                                                                    (Binder (
                                                                    "t",
                                                                    IMeta)))),
                                                                    (Binder (
                                                                    None,
                                                                    [([(PId
                                                                    "t")],
                                                                    (Some (
                                                                    App
                                                                    [(Id (
                                                                    "ctree",
                                                                    I));
                                                                    (Id ("t",
                                                                    I))])))]
                                                                    )), 
                                                                    []));
                                                                    (Id (
                                                                    "pf", I));
                                                                    (Id (
                                                                    "ct", I))
                                                                    ]),
                                                                    (Binder (
                                                                    (PId "ct"),
                                                                    (MLet (
                                                                    (App
                                                                    [(Send
                                                                    (Id ("c",
                                                                    I)));
                                                                    (Id (
                                                                    "ct", I))
                                                                    ]),
                                                                    (Binder (
                                                                    (PId "c"),
                                                                    (Close
                                                                    (Id ("c",
                                                                    I)))))))
                                                                    ))))))
                                                                   ))
                                                                ))
                                                             ))
                                                          ))
                                                       ))
                                                    ))
                                                 ))
                                              ))
                                           ))
                                        ))
                                     ))))
                            ]
                          ))))
                ]
              )),
           [])),
        (Pi (R, U, (App [(Inst ("list", [(SId "_"); U], I)); Int_t]),
           (Binder ("xs",
              (Pi (R, U,
                 (Ch (true,
                    (Act (R, true,
                       (App
                          [(Id ("ctree", I));
                            (App [(Id ("splitting_tree", I)); (Id ("xs", I))])
                            ]),
                       (Binder ("_", End))))
                    )),
                 (Binder ("_", (IO (Id ("unit", I)))))))
              ))
           )))
       ));
    view = []};
  Definition {name = "cmsort"; relv = R;
    body =
    (Binder ([],
       ((Fun (
           (Pi (R, U, (App [(Inst ("list", [(SId "_"); U], I)); Int_t]),
              (Binder ("xs",
                 (IO (UOpr ("`", (App [(Id ("msort", I)); (Id ("xs", I))]))))
                 ))
              )),
           (Binder ((Some "cmsort"),
              [([(PId "xs")],
                (Some (MLet (
                         (Fork
                            (Fun (
                               (Pi (R, L, IMeta,
                                  (Binder ("", (IO (Id ("unit", I))))))),
                               (Binder (None,
                                  [([(PId "c")],
                                    (Some (App
                                             [(Id ("splitting_ctree", I));
                                               (Id ("xs", I)); (Id ("c", I))])))
                                    ]
                                  )),
                               []))),
                         (Binder ((PId "c"),
                            (MLet ((Recv (Id ("c", I))),
                               (Binder (
                                  (PBOpr ("\226\159\168,\226\159\169",
                                     (PId "ct"), (PId "c"))),
                                  (BOpr (";", (Close (Id ("c", I))),
                                     (MLet (
                                        (App
                                           [(Id ("creduce", I));
                                             (Fun (
                                                (Pi (R, U, IMeta,
                                                   (Binder ("x", IMeta)))),
                                                (Binder (None,
                                                   [([(PId "x")],
                                                     (Some (Id ("x", I))))]
                                                   )),
                                                []));
                                             (Fun (
                                                (Pi (R, U, IMeta,
                                                   (Binder ("l",
                                                      (Pi (R, U, IMeta,
                                                         (Binder ("r", IMeta
                                                            ))
                                                         ))
                                                      ))
                                                   )),
                                                (Binder (None,
                                                   [([(PId "l"); (PId "r")],
                                                     (Some (App
                                                              [(Id ("merge",
                                                                  I));
                                                                (Id ("l", I));
                                                                (Id ("r", I))
                                                                ])))
                                                     ]
                                                   )),
                                                []));
                                             (Id ("ct", I))]),
                                        (Binder (
                                           (PBOpr (
                                              "\226\159\168,\226\159\169",
                                              (PId "result"), (PId "ct"))),
                                           (Let (R,
                                              (App
                                                 [(Id ("rwl", I));
                                                   (Fun (
                                                      (Pi (R, U, IMeta,
                                                         (Binder ("x", IMeta
                                                            ))
                                                         )),
                                                      (Binder (None,
                                                         [([(PId "x")],
                                                           (Some (UOpr ("`",
                                                                    (
                                                                    Id ("x",
                                                                    I))))))
                                                           ]
                                                         )),
                                                      []));
                                                   (App
                                                      [(Id (
                                                          "reduce_splitting_tree",
                                                          I));
                                                        (Id ("xs", I))]);
                                                   (Id ("result", I))]),
                                              (Binder ((PId "result"),
                                                 (BOpr (";",
                                                    (App
                                                       [(Id ("cfree", I));
                                                         (Id ("ct", I))]),
                                                    (Return
                                                       (Id ("result", I)))
                                                    ))
                                                 ))
                                              ))
                                           ))
                                        ))
                                     ))
                                  ))
                               ))
                            ))
                         ))))
                ]
              )),
           [E])),
        (Pi (R, U, (App [(Inst ("list", [(SId "_"); U], I)); Int_t]),
           (Binder ("xs",
              (IO (UOpr ("`", (App [(Id ("msort", I)); (Id ("xs", I))]))))))
           )))
       ));
    view = [E]};
  Definition {name = "mklist"; relv = R;
    body =
    (Binder (["t"],
       ((Fun (
           (Pi (R, U, Int_t,
              (Binder ("n",
                 (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t])))
              )),
           (Binder ((Some "mklist"),
              [([(PId "n")],
                (Some (Match (
                         [(R, (BOpr ("<=", (Id ("n", I)), (Int 0))), None)],
                         None,
                         [([(PId "true")], (Some (Id ("nil", I))));
                           ([(PId "false")],
                            (Some (BOpr ("::", (Id ("n", I)),
                                     (App
                                        [(Id ("mklist", I));
                                          (BOpr ("-", (Id ("n", I)), (
                                             Int 1)))
                                          ])
                                     ))))
                           ]
                         ))))
                ]
              )),
           [E])),
        (Pi (R, U, Int_t,
           (Binder ("n",
              (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t])))
           )))
       ));
    view = [E]};
  Definition {name = "list_len"; relv = R;
    body =
    (Binder (["t"],
       ((Fun (
           (Pi (R, U,
              (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t]),
              (Binder ("_", Int_t)))),
           (Binder ((Some "list_len"),
              [([(PId "nil")], (Some (Int 0)));
                ([(PBOpr ("::", (PId "_"), (PId "xs")))],
                 (Some (BOpr ("+", (Int 1),
                          (App [(Id ("list_len", I)); (Id ("xs", I))])))))
                ]
              )),
           [])),
        (Pi (R, U, (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t]),
           (Binder ("_", Int_t)))))
       ));
    view = []};
  Definition {name = "print_list"; relv = R;
    body =
    (Binder (["t"],
       ((Fun (
           (Pi (R, U,
              (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t]),
              (Binder ("_", (IO (Id ("unit", I))))))),
           (Binder ((Some "print_list"),
              [([(PId "nil")], (Some (Print (String "nil"))));
                ([(PBOpr ("::", (PId "x"), (PId "xs")))],
                 (Some (BOpr (";",
                          (Print
                             (App [(Id ("string_of_int", I)); (Id ("x", I))])),
                          (BOpr (";", (Print (String " :: ")),
                             (App [(Id ("print_list", I)); (Id ("xs", I))])))
                          ))))
                ]
              )),
           [])),
        (Pi (R, U, (App [(Inst ("list", [(SId "_"); (SId "t")], I)); Int_t]),
           (Binder ("_", (IO (Id ("unit", I))))))))
       ));
    view = []};
  Definition {name = "main"; relv = R;
    body =
    (Binder ([],
       ((Let (R, (App [(Inst ("mklist", [U], I)); (Int 100)]),
           (Binder ((PId "test"),
              (MLet ((App [(Id ("cmsort", I)); (Id ("test", I))]),
                 (Binder ((PConstr ("just", [(PId "sorted")])),
                    (App [(Id ("print_list", I)); (Id ("sorted", I))])))
                 ))
              ))
           )),
        (IO (Id ("unit", I))))
       ));
    view = []}
  ]

[parse success]

-----------------------------------------

#[program]
inductive tree_11 (A_973 : U): U where
| Leaf_15 (x_974 : A_973) : (tree_11 A_973)
| Node_16
    (l_975 : (tree_11 A_973)) (r_976 : (tree_11 A_973)) : (tree_11 A_973)

#[program]
inductive opr_12 (A_977 : U): L where
| Free_17 : (opr_12 A_977)
| Map_18 {B_978 : U} (f_979 : A_977 -> B_978) : (opr_12 A_977)
| Reduce_19
    {B_981 : U} (f_982 : A_977 -> B_981) (g_984 : B_981 -> B_981 -> B_981)
    : (opr_12 A_977)

#[program]
def map_34 :
   {A_987 : U} ->
     {B_988 : U} -> A_987 -> B_988 -> (tree_11 A_987) -> (tree_11 B_988)
:=
  (fun map_992 :
     {A_993 : U} ->
       {B_994 : U} -> A_993 -> B_994 -> (tree_11 A_993) -> (tree_11 B_994)
  | A_998, B_999, f_1000, (Leaf_15 x_1001) =>
    (Leaf_15 ?_65[0;0] ((f_1000) x_1001))
  | A_1002, B_1003, f_1004, (Node_16 l_1005 r_1006) =>
    (Node_16
      ?_70[0;0] ((map_992) ?_67[0;0] ?_66[0;0] f_1004 l_1005)
      ((map_992) ?_69[0;0] ?_68[0;0] f_1004 r_1006)))

#[program]
def reduce_35 :
   {A_1007 : U} ->
     {B_1008 : U} ->
      A_1007 -> B_1008 ->
        B_1008 -> B_1008 -> B_1008 -> (tree_11 A_1007) -> B_1008
:=
  (fun reduce_1015 :
     {A_1016 : U} ->
       {B_1017 : U} ->
        A_1016 -> B_1017 ->
          B_1017 -> B_1017 -> B_1017 -> (tree_11 A_1016) -> B_1017
  | A_1024, B_1025, f_1026, g_1027, (Leaf_15 x_1028) => ((f_1026) x_1028)
  | A_1029, B_1030, f_1031, g_1032, (Node_16 l_1033 r_1034) =>
    ((g_1032)
      ((reduce_1015) ?_72[0;0] ?_71[0;0] f_1031 g_1032 l_1033)
      ((reduce_1015) ?_74[0;0] ?_73[0;0] f_1031 g_1032 r_1034)))

#[logical]
def tree_p_36 :  {A_1035 : U} -> (tree_11 A_1035) -> proto :=
  (fun tree_p_1037 :  {A_1038 : U} -> (tree_11 A_1038) -> proto
  | A_1040, t_1041 =>
    (o_1042 : (opr_12 A_1040)) 
      (match o_1042 in ?_75[0;0] -o ?_76[0;0] with
      | Free_17 => 
      | (Map_18 _1044 f_1045) =>
        ((tree_p_1037)
          ?_79[0;0] ((map_34) ?_78[0;0] ?_77[0;0] f_1045 t_1041))
      | (Reduce_19 _1046 f_1047 g_1048) =>
        (__1049 :
          ((ssing_6??_62)
            ?_82[0;0] ((reduce_35) ?_81[0;0] ?_80[0;0] f_1047 g_1048 t_1041))) 
          ((tree_p_1037) ?_83[0;0] t_1041)))

#[logical]
def ctree_ch_37 :  {A_1050 : U} -> (tree_11 A_1050) -> L :=
  (fun ctree_ch_1052 :  {A_1053 : U} -> (tree_11 A_1053) -> L
  | A_1055, t_1056 => ch((tree_p_36) ?_84[0;0] t_1056))

#[logical]
def ctree_hc_38 :  {A_1057 : U} -> (tree_11 A_1057) -> L :=
  (fun ctree_hc_1059 :  {A_1060 : U} -> (tree_11 A_1060) -> L
  | A_1062, t_1063 => hc((tree_p_36) ?_85[0;0] t_1063))

#[logical]
def ctree_39 :  {A_1064 : U} -> (tree_11 A_1064) -> L :=
  (fun ctree_1066 :  {A_1067 : U} -> (tree_11 A_1067) -> L
  | A_1069, t_1070 => IO ((ctree_hc_38) ?_86[0;0] t_1070))

#[program]
def leaf_worker_40 :
   {A_1071 : U} ->
     (x_1072 : A_1071) ->
      ((ctree_ch_37) A_1071 (Leaf_15 ?_98[0;0] x_1072)) -> IO unit_9
:=
  (fun leaf_worker_1074 :
     {A_1075 : U} ->
       (x_1076 : A_1075) ->
        ((ctree_ch_37) A_1075 (Leaf_15 ?_87[0;0] x_1076)) -> IO unit_9
  | A_1078, x_1079, c_1080 =>
    let* _1081 := recv c_1080 in
    (match _1081 in ?_97[0;0] -o ?_96[0;0] with
    | (ex1_14 o_1083 c_1084) =>
      (match o_1083, c_1084 in
          (o0_1085 : ?_88[0;0]) -o
           ch(match o0_1085 in ?_89[0;0] -o ?_90[0;0] with
                | Free_17 => 
                | (Map_18 B_1088 f_1089) =>
                  ((tree_p_36)
                    B_1088 (Leaf_15 B_1088 ((f_1089) x_1079)))
                | (Reduce_19 B_1090 f_1091 _1092) =>
                  (__1093 :
                    (sing_2??_63,??_64 B_1090 ((f_1091) x_1079))) 
                    ((tree_p_36) ?_92[0;0] (Leaf_15 ?_91[0;0] x_1079))) -o
             ?_93[0;0]
       with
      | Free_17, c_1094 => close c_1094
      | (Map_18 B_1095 f_1096), c_1097 =>
        ((leaf_worker_1074) B_1095 ((f_1096) x_1079) c_1097)
      | (Reduce_19 _1098 f_1099 _1100), c_1101 =>
        let* c_1102 :=
          ((send c_1101)
            (just_2??_65,??_66 ?_94[0;0] ((f_1099) x_1079)))
        in ((leaf_worker_1074) ?_95[0;0] x_1079 c_1102))))

#[program]
def node_worker_41 :
   {A_1103 : U} ->
     {l_1104 : (tree_11 A_1103)} ->
       {r_1105 : (tree_11 A_1103)} ->
        ((ctree_hc_38) ?_136[0;0] l_1104) -o
          ((ctree_hc_38) ?_137[0;0] r_1105) -o
            ((ctree_ch_37)
              ?_139[0;0] (Node_16 ?_138[0;0] l_1104 r_1105)) -o
              IO unit_9
:=
  (fun node_worker_1109 :
     {A_1110 : U} ->
       {l_1111 : (tree_11 A_1110)} ->
         {r_1112 : (tree_11 A_1110)} ->
          ((ctree_hc_38) ?_99[0;0] l_1111) -o
            ((ctree_hc_38) ?_100[0;0] r_1112) -o
              ((ctree_ch_37)
                ?_102[0;0] (Node_16 ?_101[0;0] l_1111 r_1112)) -o
                IO unit_9
  | A_1116, l_1117, r_1118, l_ch_1119, r_ch_1120, c_1121 =>
    let* _1122 := recv c_1121 in
    (match _1122 in ?_135[0;0] -o ?_134[0;0] with
    | (ex1_14 o_1124 c_1125) =>
      (match o_1124, c_1125 in
          (o0_1126 : ?_103[0;0]) -o
           ch(match o0_1126 in ?_104[0;0] -o ?_105[0;0] with
                | Free_17 => 
                | (Map_18 B_1129 f_1130) =>
                  ((tree_p_36)
                    B_1129
                    ((map_34)
                      ?_106[0;0] B_1129 f_1130
                      (Node_16 ?_107[0;0] l_1117 r_1118)))
                | (Reduce_19 B_1131 f_1132 g_1133) =>
                  (__1134 :
                    (sing_2??_67,??_68
                      B_1131
                      ((reduce_35)
                        ?_108[0;0] B_1131 f_1132 g_1133
                        (Node_16 ?_109[0;0] l_1117 r_1118)))) 
                    ((tree_p_36)
                      ?_111[0;0] (Node_16 ?_110[0;0] l_1117 r_1118))) -o
             ?_112[0;0]
       with
      | Free_17, c_1135 =>
        let* l_ch_1136 := ((send l_ch_1119) (Free_17 ?_113[0;0])) in
        let* r_ch_1137 := ((send r_ch_1120) (Free_17 ?_114[0;0])) in
        let* __1138 := close l_ch_1136 in
        let* __1139 := close r_ch_1137 in close c_1135
      | (Map_18 _1140 f_1141), c_1142 =>
        let* l_ch_1143 :=
          ((send l_ch_1119) (Map_18 ?_116[0;0] ?_115[0;0] f_1141))
        in
        let* r_ch_1144 :=
          ((send r_ch_1120) (Map_18 ?_118[0;0] ?_117[0;0] f_1141))
        in
        ((node_worker_1109)
          ?_121[0;0] ?_120[0;0] ?_119[0;0] l_ch_1143 r_ch_1144 c_1142)
      | (Reduce_19 _1145 f_1146 g_1147), c_1148 =>
        let* l_ch_1149 :=
          ((send l_ch_1119)
            (Reduce_19 ?_123[0;0] ?_122[0;0] f_1146 g_1147))
        in
        let* r_ch_1150 :=
          ((send r_ch_1120)
            (Reduce_19 ?_125[0;0] ?_124[0;0] f_1146 g_1147))
        in
        let* _1151 := recv l_ch_1149 in
        (match _1151 in ?_133[0;0] -o ?_132[0;0] with
        | (ex1_14 (just_2 vl_1153) l_ch_1154) =>
          let* _1155 := recv r_ch_1150 in
          (match _1155 in ?_131[0;0] -o ?_130[0;0] with
          | (ex1_14 (just_2 vr_1157) r_ch_1158) =>
            let* c_1159 :=
              ((send c_1148)
                (just_2??_69,??_70
                  ?_126[0;0] ((g_1147) vl_1153 vr_1157)))
            in
            ((node_worker_1109)
              ?_129[0;0] ?_128[0;0] ?_127[0;0] l_ch_1154 r_ch_1158 c_1159))))))

#[program]
def cleaf_42 :
   {A_1160 : U} ->
     (x_1161 : A_1160) ->
      ((ctree_39) ?_146[0;0] (Leaf_15 ?_145[0;0] x_1161))
:=
  (fun cleaf_1162 :
     {A_1163 : U} ->
       (x_1164 : A_1163) ->
        ((ctree_39) ?_141[0;0] (Leaf_15 ?_140[0;0] x_1164))
  | A_1165, x_1166 =>
    fork
      (fun _1167 :
        ((ctree_ch_37) ?_143[0;0] (Leaf_15 ?_142[0;0] x_1166)) -o
          IO unit_9
      | c_1169 => ((leaf_worker_40) ?_144[0;0] x_1166 c_1169)))

#[program]
def cnode_43 :
   {A_1170 : U} ->
     {l_1171 : (tree_11 A_1170)} ->
       {r_1172 : (tree_11 A_1170)} ->
        ((ctree_39) ?_156[0;0] l_1171) -o
          ((ctree_39) ?_157[0;0] r_1172) -o
            ((ctree_39) ?_159[0;0] (Node_16 ?_158[0;0] l_1171 r_1172))
:=
  (fun cnode_1175 :
     {A_1176 : U} ->
       {l_1177 : (tree_11 A_1176)} ->
         {r_1178 : (tree_11 A_1176)} ->
          ((ctree_39) ?_147[0;0] l_1177) -o
            ((ctree_39) ?_148[0;0] r_1178) -o
              ((ctree_39)
                ?_150[0;0] (Node_16 ?_149[0;0] l_1177 r_1178))
  | A_1181, l_1182, r_1183, l0_1184, r0_1185 =>
    let* l_ch_1186 := l0_1184 in
    let* r_ch_1187 := r0_1185 in
    fork
      (fun _1188 :
        ((ctree_ch_37) ?_152[0;0] (Node_16 ?_151[0;0] l_1182 r_1183)) -o
          IO unit_9
      | c_1190 =>
        ((node_worker_41)
          ?_155[0;0] ?_154[0;0] ?_153[0;0] l_ch_1186 r_ch_1187 c_1190)))

#[program]
def ctree_of_tree_44 :
   {A_1191 : U} ->
     (t_1192 : (tree_11 A_1191)) -> ((ctree_39) ?_167[0;0] t_1192)
:=
  (fun ctree_of_tree_1193 :
     {A_1194 : U} ->
       (t_1195 : (tree_11 A_1194)) -> ((ctree_39) ?_160[0;0] t_1195)
  | A_1196, (Leaf_15 x_1197) => ((cleaf_42) ?_161[0;0] x_1197)
  | A_1198, (Node_16 l_1199 r_1200) =>
    ((cnode_43)
      ?_166[0;0] ?_165[0;0] ?_164[0;0]
      ((ctree_of_tree_1193) ?_162[0;0] l_1199)
      ((ctree_of_tree_1193) ?_163[0;0] r_1200)))

#[program]
def cfree_45 :
   {A_1201 : U} ->
     {t_1202 : (tree_11 A_1201)} ->
      ((ctree_39) ?_170[0;0] t_1202) -> IO unit_9
:=
  (fun cfree_1204 :
     {A_1205 : U} ->
       {t_1206 : (tree_11 A_1205)} ->
        ((ctree_39) ?_168[0;0] t_1206) -> IO unit_9
  | A_1208, t_1209, ct_1210 =>
    let* c_1211 := ct_1210 in
    let* c_1212 := ((send c_1211) (Free_17 ?_169[0;0])) in close c_1212)

#[program]
def cmap_46 :
   {A_1213 : U} ->
     {B_1214 : U} ->
       {t_1215 : (tree_11 A_1213)} ->
         (f_1216 : A_1213 -> B_1214) ->
          ((ctree_39) ?_177[0;0] t_1215) ->
            ((ctree_39)
              ?_180[0;0] ((map_34) ?_179[0;0] ?_178[0;0] f_1216 t_1215))
:=
  (fun cmap_1219 :
     {A_1220 : U} ->
       {B_1221 : U} ->
         {t_1222 : (tree_11 A_1220)} ->
           (f_1223 : A_1220 -> B_1221) ->
            ((ctree_39) ?_171[0;0] t_1222) ->
              ((ctree_39)
                ?_174[0;0] ((map_34) ?_173[0;0] ?_172[0;0] f_1223 t_1222))
  | A_1226, B_1227, t_1228, f_1229, ct_1230 =>
    let* c_1231 := ct_1230 in
    let* c_1232 :=
      ((send c_1231) (Map_18 ?_176[0;0] ?_175[0;0] f_1229))
    in return c_1232)

#[program]
def creduce_47 :
   {A_1233 : U} ->
     {B_1234 : U} ->
       {t_1235 : (tree_11 A_1233)} ->
         (f_1236 : A_1233 -> B_1234) ->
           (g_1238 : B_1234 -> B_1234 -> B_1234) ->
            ((ctree_39) ?_192[0;0] t_1235) ->
              IO ((tensor_26??_77,??_78)
                   ((ssing_6??_76)
                     ?_195[0;0]
                     ((reduce_35) ?_194[0;0] ?_193[0;0] f_1236 g_1238 t_1235))
                   ((ctree_39) ?_196[0;0] t_1235))
:=
  (fun creduce_1242 :
     {A_1243 : U} ->
       {B_1244 : U} ->
         {t_1245 : (tree_11 A_1243)} ->
           (f_1246 : A_1243 -> B_1244) ->
             (g_1248 : B_1244 -> B_1244 -> B_1244) ->
              ((ctree_39) ?_181[0;0] t_1245) ->
                IO ((tensor_26??_72,??_73)
                     ((ssing_6??_71)
                       ?_184[0;0]
                       ((reduce_35)
                         ?_183[0;0] ?_182[0;0] f_1246 g_1248 t_1245))
                     ((ctree_39) ?_185[0;0] t_1245))
  | A_1252, B_1253, t_1254, f_1255, g_1256, ct_1257 =>
    let* c_1258 := ct_1257 in
    let* c_1259 :=
      ((send c_1258) (Reduce_19 ?_187[0;0] ?_186[0;0] f_1255 g_1256))
    in
    let* _1260 := recv c_1259 in
    (match _1260 in ?_191[0;0] -o ?_190[0;0] with
    | (ex1_14 x_1262 ct_1263) =>
      return (ex1_14??_74,??_75
               ?_188[0;0] ?_189[0;0] x_1262 return ct_1263)))

#[program]
def split_48t_1264 :
  (list_7??_104,t_1264 int) ->
    ((tensor_26??_107,??_108)
      (list_7??_105,t_1264 int) (list_7??_106,t_1264 int))
:=
  (fun split_1266 :
    (list_7??_79,t_1264 int) ->
      ((tensor_26??_82,??_83)
        (list_7??_80,t_1264 int) (list_7??_81,t_1264 int))
  | nil_10 =>
    (ex1_14??_88,??_89
      ?_199[0;0] ?_200[0;0] (nil_10??_84,??_85 ?_197[0;0])
      (nil_10??_86,??_87 ?_198[0;0]))
  | (cons_11 x_1268 nil_10) =>
    (ex1_14??_96,??_97
      ?_204[0;0] ?_205[0;0]
      (cons_11??_92,??_93
        ?_202[0;0] x_1268 (nil_10??_90,??_91 ?_201[0;0]))
      (nil_10??_94,??_95 ?_203[0;0]))
  | (cons_11 x_1269 (cons_11 y_1270 zs_1271)) =>
    (match ((split_1266) zs_1271) in ?_211[0;0] -o ?_210[0;0] with
    | (ex1_14 xs_1273 ys_1274) =>
      (ex1_14??_102,??_103
        ?_208[0;0] ?_209[0;0]
        (cons_11??_98,??_99 ?_206[0;0] x_1269 xs_1273)
        (cons_11??_100,??_101 ?_207[0;0] y_1270 ys_1274))))

#[program]
def merge_49t_1275 :
  (list_7??_120,t_1275 int) ->
    (list_7??_121,t_1275 int) -o (list_7??_122,t_1275 int)
:=
  (fun merge_1278 :
    (list_7??_109,t_1275 int) ->
      (list_7??_110,t_1275 int) -o (list_7??_111,t_1275 int)
  | nil_10, ys_1281 => ys_1281
  | xs_1282, nil_10 => xs_1282
  | (cons_11 x_1283 xs_1284), (cons_11 y_1285 ys_1286) =>
    (match (__lte__ x_1283 y_1285) in ?_212[0;0] -o ?_213[0;0] with
    | true_4 =>
      (cons_11??_114,??_115
        ?_215[0;0] x_1283
        ((merge_1278)
          xs_1284 (cons_11??_112,??_113 ?_214[0;0] y_1285 ys_1286)))
    | false_5 =>
      (cons_11??_118,??_119
        ?_217[0;0] y_1285
        ((merge_1278)
          (cons_11??_116,??_117 ?_216[0;0] x_1283 xs_1284) ys_1286))))

#[program]
def msort_50t_1288 :
  (list_7??_133,t_1288 int) -> (list_7??_134,t_1288 int)
:=
  (fun msort_1290 :
    (list_7??_123,t_1288 int) -> (list_7??_124,t_1288 int)
  | nil_10 => (nil_10??_125,??_126 ?_218[0;0])
  | (cons_11 z_1292 nil_10) =>
    (cons_11??_129,??_130
      ?_220[0;0] z_1292 (nil_10??_127,??_128 ?_219[0;0]))
  | zs_1293 =>
    (match ((split_48??_131) zs_1293) in ?_222[0;0] -o ?_221[0;0] with
    | (ex1_14 xs_1295 ys_1296) =>
      ((merge_49??_132) ((msort_1290) xs_1295) ((msort_1290) ys_1296))))

#[program]
def splitting_tree_51 :
  (list_7??_144,U int) -> (tree_11 (list_7??_145,U int))
:=
  (fun splitting_tree_1298 :
    (list_7??_135,U int) -> (tree_11 (list_7??_136,U int))
  | nil_10 =>
    (Leaf_15 ?_224[0;0] (nil_10??_137,??_138 ?_223[0;0]))
  | (cons_11 z_1300 nil_10) =>
    (Leaf_15
      ?_227[0;0]
      (cons_11??_141,??_142
        ?_226[0;0] z_1300 (nil_10??_139,??_140 ?_225[0;0])))
  | zs_1301 =>
    (match ((split_48??_143) zs_1301) in ?_230[0;0] -o ?_229[0;0] with
    | (ex1_14 xs_1303 ys_1304) =>
      let l_1305 := ((splitting_tree_1298) xs_1303) in
      let r_1306 := ((splitting_tree_1298) ys_1304) in
      (Node_16 ?_228[0;0] l_1305 r_1306)))

#[logical]
def reduce_splitting_tree_52 :
   (xs_1307 : (list_7??_174,U int)) ->
    (eq_1??_177
      ?_300[0;0]
      ((reduce_35)
        ?_299[0;0] ?_298[0;0]
        (fun _1308 : ?_293[0;0] -> ?_294[0;0]
        | x_1310 => x_1310)
        (fun _1311 : ?_295[0;0] -> ?_296[0;0] -> ?_297[0;0]
        | l_1314, r_1315 => ((merge_49??_175) l_1314 r_1315))
        ((splitting_tree_51) xs_1307))
      ((msort_50??_176) xs_1307))
:=
  (fun reduce_splitting_tree_1316 :
     (xs_1317 : (list_7??_146,U int)) ->
      (eq_1??_149
        ?_238[0;0]
        ((reduce_35)
          ?_237[0;0] ?_236[0;0]
          (fun _1318 : ?_231[0;0] -> ?_232[0;0]
          | x_1320 => x_1320)
          (fun _1321 : ?_233[0;0] -> ?_234[0;0] -> ?_235[0;0]
          | l_1324, r_1325 => ((merge_49??_147) l_1324 r_1325))
          ((splitting_tree_51) xs_1317))
        ((msort_50??_148) xs_1317))
  | nil_10 => (refl_1??_150 ?_239[0;0] ?_240[0;0])
  | (cons_11 z_1326 nil_10) => (refl_1??_151 ?_241[0;0] ?_242[0;0])
  | zs_1327 =>
    (match ((split_48??_152) zs_1327),
     (refl_1??_153 ?_243[0;0] ?_244[0;0]),
     (refl_1??_154 ?_245[0;0] ?_246[0;0]) in
        (h1_1328 : ?_247[0;0]) -o
         {(eq_1??_159
            ?_250[0;0]
            (match h1_1328 in ?_249[0;0] -o ?_248[0;0] with
            | (ex1_14 xs_1331 ys_1332) =>
              ((merge_49??_157)
                ((msort_50??_155) xs_1331)
                ((msort_50??_156) ys_1332)))
            ((msort_50??_158) zs_1327))} -o
           {(eq_1??_162
              ?_268[0;0]
              ((reduce_35)
                ?_260[0;0] ?_259[0;0]
                (fun _1334 : ?_251[0;0] -> ?_252[0;0]
                | x_1336 => x_1336)
                (fun _1337 : ?_253[0;0] -> ?_254[0;0] -> ?_255[0;0]
                | l_1340, r_1341 => ((merge_49??_160) l_1340 r_1341))
                (match h1_1328 in ?_258[0;0] -o ?_257[0;0] with
                | (ex1_14 xs_1343 ys_1344) =>
                  let l_1345 := ((splitting_tree_51) xs_1343) in
                  let r_1346 := ((splitting_tree_51) ys_1344) in
                  (Node_16 ?_256[0;0] l_1345 r_1346)))
              ((reduce_35)
                ?_267[0;0] ?_266[0;0]
                (fun _1347 : ?_261[0;0] -> ?_262[0;0]
                | x_1349 => x_1349)
                (fun _1350 : ?_263[0;0] -> ?_264[0;0] -> ?_265[0;0]
                | l_1353, r_1354 => ((merge_49??_161) l_1353 r_1354))
                ((splitting_tree_51) zs_1327)))} -o
             ?_269[0;0]
     with
    | (ex1_14 xs0_1355 ys0_1356), pf0_1357, pf1_1358 =>
      let pf_xs0_1359 := ((reduce_splitting_tree_1316) xs0_1355) in
      let pf_ys0_1360 := ((reduce_splitting_tree_1316) ys0_1356) in
      let pf0_1361 :=
        ((rwr_3??_165,??_166)
          ?_277[0;0] ?_276[0;0] ?_275[0;0]
          (fun _1362 : ?_270[0;0] -> ?_271[0;0]
          | xs_1364 =>
            (eq_1??_164
              ?_274[0;0] ((merge_49??_163) xs_1364 ?_272[0;0])
              ?_273[0;0]))
          pf_xs0_1359 pf0_1357)
      in
      let pf0_1365 :=
        ((rwr_3??_169,??_170)
          ?_285[0;0] ?_284[0;0] ?_283[0;0]
          (fun _1366 : ?_278[0;0] -> ?_279[0;0]
          | ys_1368 =>
            (eq_1??_168
              ?_282[0;0] ((merge_49??_167) ?_280[0;0] ys_1368)
              ?_281[0;0]))
          pf_ys0_1360 pf0_1361)
      in
      let pf0_1369 :=
        ((rwl_2??_172,??_173)
          ?_292[0;0] ?_291[0;0] ?_290[0;0]
          (fun _1370 : ?_286[0;0] -> ?_287[0;0]
          | x_1372 => (eq_1??_171 ?_289[0;0] x_1372 ?_288[0;0]))
          pf1_1358 pf0_1365)
      in pf0_1369))

#[program]
def splitting_ctree_53 :
   (xs_1373 : (list_7??_192,U int)) ->
    ch(__1375 :
           ((ctree_39) ?_332[0;0] ((splitting_tree_51) xs_1373)))   ->
      IO unit_9
:=
  (fun splitting_ctree_1376 :
     (xs_1377 : (list_7??_178,U int)) ->
      ch(__1379 :
             ((ctree_39) ?_301[0;0] ((splitting_tree_51) xs_1377)))   ->
        IO unit_9
  | nil_10, c_1380 =>
    let* c_1381 :=
      ((send c_1380)
        ((cleaf_42) ?_303[0;0] (nil_10??_179,??_180 ?_302[0;0])))
    in let* __1382 := close c_1381 in return tt_3??_181
  | (cons_11 z_1383 nil_10), c_1384 =>
    let* c_1385 :=
      ((send c_1384)
        ((cleaf_42)
          ?_306[0;0]
          (cons_11??_184,??_185
            ?_305[0;0] z_1383 (nil_10??_182,??_183 ?_304[0;0]))))
    in let* __1386 := close c_1385 in return tt_3??_186
  | zs_1387, c_1388 =>
    (match ((split_48??_187) zs_1387),
     (refl_1??_188 ?_307[0;0] ?_308[0;0]) in
        (h1_1389 : ?_309[0;0]) -o
         {(eq_1??_189
            ?_313[0;0]
            (match h1_1389 in ?_312[0;0] -o ?_311[0;0] with
            | (ex1_14 xs_1392 ys_1393) =>
              let l_1394 := ((splitting_tree_51) xs_1392) in
              let r_1395 := ((splitting_tree_51) ys_1393) in
              (Node_16 ?_310[0;0] l_1394 r_1395))
            ((splitting_tree_51) zs_1387))} -o
           ?_314[0;0]
     with
    | (ex1_14 xs_1396 ys_1397), pf_1398 =>
      let* cl_1399 :=
        fork
          (fun _1400 : ?_315[0;0] -o IO unit_9
          | c_1402 => ((splitting_ctree_1376) xs_1396 c_1402))
      in
      let* cr_1403 :=
        fork
          (fun _1404 : ?_316[0;0] -o IO unit_9
          | c_1406 => ((splitting_ctree_1376) ys_1397 c_1406))
      in
      let* _1407 := recv cl_1399 in
      (match _1407 in ?_331[0;0] -o ?_330[0;0] with
      | (ex1_14 l_1409 cl_1410) =>
        let* __1411 := close cl_1410 in
        let* _1412 := recv cr_1403 in
        (match _1412 in ?_329[0;0] -o ?_328[0;0] with
        | (ex1_14 r_1414 cr_1415) =>
          let* __1416 := close cr_1415 in
          let ct_1417 :=
            (((cnode_43) ?_319[0;0] ?_318[0;0] ?_317[0;0] l_1409 r_1414)
              : ((ctree_39)
                  ?_321[0;0]
                  (Node_16
                    ?_320[0;0] ((splitting_tree_51) xs_1396)
                    ((splitting_tree_51) ys_1397))))
          in
          let ct_1418 :=
            ((rwl_2??_190,??_191)
              ?_327[0;0] ?_326[0;0] ?_325[0;0]
              (fun _1419 : ?_322[0;0] -> ?_323[0;0]
              | t_1421 => ((ctree_39) ?_324[0;0] t_1421)) pf_1398 ct_1417)
          in let* c_1422 := ((send c_1388) ct_1418) in close c_1422))))

#[program]
def cmsort_54 :
   (xs_1423 : (list_7??_200,U int)) ->
    IO ((ssing_6??_202) ?_355[0;0] ((msort_50??_201) xs_1423))
:=
  (fun cmsort_1424 :
     (xs_1425 : (list_7??_193,U int)) ->
      IO ((ssing_6??_195) ?_333[0;0] ((msort_50??_194) xs_1425))
  | xs_1426 =>
    let* c_1427 :=
      fork
        (fun _1428 : ?_334[0;0] -o IO unit_9
        | c_1430 => ((splitting_ctree_53) xs_1426 c_1430))
    in
    let* _1431 := recv c_1427 in
    (match _1431 in ?_354[0;0] -o ?_353[0;0] with
    | (ex1_14 ct_1433 c_1434) =>
      let* __1435 := close c_1434 in
      let* _1436 :=
        ((creduce_47)
          ?_342[0;0] ?_341[0;0] ?_340[0;0]
          (fun _1437 : ?_335[0;0] -> ?_336[0;0]
          | x_1439 => x_1439)
          (fun _1440 : ?_337[0;0] -> ?_338[0;0] -> ?_339[0;0]
          | l_1443, r_1444 => ((merge_49??_196) l_1443 r_1444)) ct_1433)
      in
      (match _1436 in ?_352[0;0] -o ?_351[0;0] with
      | (ex1_14 result_1446 ct_1447) =>
        let result_1448 :=
          ((rwl_2??_198,??_199)
            ?_348[0;0] ?_347[0;0] ?_346[0;0]
            (fun _1449 : ?_343[0;0] -> ?_344[0;0]
            | x_1451 => ((ssing_6??_197) ?_345[0;0] x_1451))
            ((reduce_splitting_tree_52) xs_1426) result_1446)
        in
        let* __1452 := ((cfree_45) ?_350[0;0] ?_349[0;0] ct_1447) in
        return result_1448)))

#[program]
def mklist_55t_1453 : int -> (list_7??_208,t_1453 int) :=
  (fun mklist_1455 : int -> (list_7??_203,t_1453 int)
  | n_1457 =>
    (match (__lte__ n_1457 0) in ?_356[0;0] -o ?_357[0;0] with
    | true_4 => (nil_10??_204,??_205 ?_358[0;0])
    | false_5 =>
      (cons_11??_206,??_207
        ?_359[0;0] n_1457 ((mklist_1455) (__sub__ n_1457 1)))))

#[program]
def list_len_56t_1459 : (list_7??_210,t_1459 int) -> int :=
  (fun list_len_1461 : (list_7??_209,t_1459 int) -> int
  | nil_10 => 0
  | (cons_11 _1463 xs_1464) => (__add__ 1 ((list_len_1461) xs_1464)))

#[program]
def print_list_57t_1465 : (list_7??_212,t_1465 int) -> IO unit_9
:=
  (fun print_list_1467 : (list_7??_211,t_1465 int) -> IO unit_9
  | nil_10 => print "nil"
  | (cons_11 x_1469 xs_1470) =>
    let* __1471 := print ((string_of_int_33) x_1469) in
    let* __1472 := print " :: " in ((print_list_1467) xs_1470))

#[program]
def main_58 : IO unit_9 :=
  let test_1473 := ((mklist_55U) 100) in
  let* _1474 := ((cmsort_54) test_1473) in
  (match _1474 in ?_361[0;0] -o ?_360[0;0] with
  | (just_2 sorted_1476) => ((print_list_57??_213) sorted_1476))

[trans01 success]

-----------------------------------------

#[program]
def id_1s_69163 :
   (A_69164 : Types_69163) -> A_69164 -> A_69164
:=
  (fun id_69166 :  (A_69167 : Types_69163) -> A_69167 -> A_69167
  | A_69169, m_69170 => m_69170)

#[logical]
inductive eq_1s_69171 (A_69172 : Types_69171) (m_69173 : A_69172):
  A_69172 -> U
where
| refl_1 : (eq_1s_69171 A_69172 m_69173 m_69173)

#[program]
def rwl_2s_69175,r_69176 :
   {A_69177 : Types_69175} ->
     {m_69178 : A_69177} ->
       {n_69179 : A_69177} ->
         {B_69180 : A_69177 -> Typer_69176} ->
          {(eq_1s_69175 A_69177 m_69178 n_69179)} ->
            ((B_69180) m_69178) -> ((B_69180) n_69179)
:=
  (fun rwl_69184 :
     {A_69185 : Types_69175} ->
       {m_69186 : A_69185} ->
         {n_69187 : A_69185} ->
           {B_69188 : A_69185 -> Typer_69176} ->
            {(eq_1s_69175 A_69185 m_69186 n_69187)} ->
              ((B_69188) m_69186) -> ((B_69188) n_69187)
  | A_69192, m_69193, n_69194, B_69195, refl_1, __69196 => __69196)

#[program]
def rwr_3s_69197,r_69198 :
   {A_69199 : Types_69197} ->
     {m_69200 : A_69199} ->
       {n_69201 : A_69199} ->
         {B_69202 : A_69199 -> Typer_69198} ->
          {(eq_1s_69197 A_69199 m_69200 n_69201)} ->
            ((B_69202) n_69201) -> ((B_69202) m_69200)
:=
  (fun rwr_69206 :
     {A_69207 : Types_69197} ->
       {m_69208 : A_69207} ->
         {n_69209 : A_69207} ->
           {B_69210 : A_69207 -> Typer_69198} ->
            {(eq_1s_69197 A_69207 m_69208 n_69209)} ->
              ((B_69210) n_69209) -> ((B_69210) m_69208)
  | A_69214, m_69215, n_69216, B_69217, refl_1, __69218 => __69218)

#[logical]
def congr_4s_69219,r_69220,t_69221 :
   (A_69222 : Types_69219) ->
     (B_69223 : Typer_69220) ->
       (m_69224 : A_69222) ->
         (n_69225 : A_69222) ->
           (f_69226 : forallt_69221(__69227 : A_69222), B_69223) ->
            (eq_1s_69219 A_69222 m_69224 n_69225) ->
              (eq_1r_69220
                B_69223 ((f_69226) m_69224) ((f_69226) n_69225))
:=
  (fun congr_69229 :
     (A_69230 : Types_69219) ->
       (B_69231 : Typer_69220) ->
         (m_69232 : A_69230) ->
           (n_69233 : A_69230) ->
             (f_69234 :
              forallt_69221(__69235 : A_69230), B_69231) ->
              (eq_1s_69219 A_69230 m_69232 n_69233) ->
                (eq_1r_69220
                  B_69231 ((f_69234) m_69232) ((f_69234) n_69233))
  | A_69237, B_69238, m_69239, n_69240, f_69241, refl_1 =>
    (refl_1r_69220 B_69238 ((f_69241) n_69240)))

#[logical]
def axiom_K_5 :
   {A_69242 : U} ->
     {m_69243 : A_69242} ->
       (x_69244 : (eq_1U A_69242 m_69243 m_69243)) ->
        (eq_1U
          (eq_1U A_69242 m_69243 m_69243) x_69244
          (refl_1U A_69242 m_69243))
:=
  (fun axiom_K_69245 :
     {A_69246 : U} ->
       {m_69247 : A_69246} ->
         (x_69248 : (eq_1U A_69246 m_69247 m_69247)) ->
          (eq_1U
            (eq_1U A_69246 m_69247 m_69247) x_69248
            (refl_1U A_69246 m_69247))
  | A_69249, m_69250, refl_1 =>
    (refl_1U
      (eq_1U A_69249 m_69250 m_69250) (refl_1U A_69249 m_69250)))

#[program]
inductive sing_2s_69251,t_69252 (A_69253 : Types_69251):
  A_69253 -> Typet_69252
where
| just_2 (m_69255 : A_69253) : (sing_2s_69251,t_69252 A_69253 m_69255)

#[logical]
def ssing_6s_69256 :
   (A_69257 : Types_69256) -> A_69257 -> Types_69256
:=
  (fun ssing_69259 :
     (A_69260 : Types_69256) -> A_69260 -> Types_69256
  | A_69262, m_69263 => (sing_2s_69256,s_69256 A_69262 m_69263))

#[program]
def sing_elim_7s_69264,t_69265 :
   {A_69266 : Types_69264} ->
     {x_69267 : A_69266} ->
      (sing_2s_69264,t_69265 A_69266 x_69267) -> A_69266
:=
  (fun sing_elim_69269 :
     {A_69270 : Types_69264} ->
       {x_69271 : A_69270} ->
        (sing_2s_69264,t_69265 A_69270 x_69271) -> A_69270
  | A_69273, x_69274, (just_2 m_69275) => m_69275)

#[logical]
def sing_uniq_8s_69276,t_69277 :
   (A_69278 : Types_69276) ->
     (x0_69279 : A_69278) ->
       (x_69280 : (sing_2s_69276,t_69277 A_69278 x0_69279)) ->
        (eq_1s_69276
          A_69278 x0_69279
          ((sing_elim_7s_69276,t_69277) A_69278 x0_69279 x_69280))
:=
  (fun sing_uniq_69281 :
     (A_69282 : Types_69276) ->
       (x0_69283 : A_69282) ->
         (x_69284 : (sing_2s_69276,t_69277 A_69282 x0_69283)) ->
          (eq_1s_69276
            A_69282 x0_69283
            ((sing_elim_7s_69276,t_69277) A_69282 x0_69283 x_69284))
  | A_69285, x0_69286, (just_2 m_69287) =>
    (refl_1s_69276 A_69285 m_69287))

#[program]
inductive base_3s_69288 : Types_69288 where
| tt_3 : base_3s_69288

#[logical]
def unit_9 : U := base_3U

#[logical]
def unit_eta_10 :
   (x_69289 : unit_9) -> (eq_1U base_3U x_69289 tt_3U)
:=
  (fun unit_eta_69290 :
     (x_69291 : unit_9) -> (eq_1U base_3U x_69291 tt_3U)
  | tt_3 => (refl_1U base_3U tt_3U))

#[program]
inductive bool_4 : U where
| true_4 : bool_4
| false_5 : bool_4

#[program]
def not_11 : bool_4 -> bool_4 :=
  (fun not_69293 : bool_4 -> bool_4
  | true_4 => false_5
  | false_5 => true_4)

#[program]
def and_12 : bool_4 -> bool_4 -> bool_4 :=
  (fun and_69297 : bool_4 -> bool_4 -> bool_4
  | true_4, true_4 => true_4
  | true_4, false_5 => false_5
  | false_5, __69300 => false_5)

#[program]
def or_13 : bool_4 -> bool_4 -> bool_4 :=
  (fun or_69303 : bool_4 -> bool_4 -> bool_4
  | true_4, __69306 => true_4
  | false_5, true_4 => true_4
  | false_5, false_5 => false_5)

#[program]
def xor_14 : bool_4 -> bool_4 -> bool_4 :=
  (fun xor_69309 : bool_4 -> bool_4 -> bool_4
  | true_4, true_4 => false_5
  | true_4, false_5 => true_4
  | false_5, true_4 => true_4
  | false_5, false_5 => false_5)

#[program]
def string_of_bool_15 : bool_4 -> string :=
  (fun string_of_bool_69313 : bool_4 -> string
  | true_4 => "true"
  | false_5 => "false")

#[program]
inductive nat_5 : U where
| zero_6 : nat_5
| succ_7 (n_69315 : nat_5) : nat_5

#[program]
def lte_16 : nat_5 -> nat_5 -> bool_4 :=
  (fun lte_69318 : nat_5 -> nat_5 -> bool_4
  | zero_6, __69321 => true_4
  | (succ_7 n_69322), zero_6 => false_5
  | (succ_7 n_69323), (succ_7 n_69324) => ((lte_69318) n_69323 n_69324))

#[program]
def lt_17 : nat_5 -> nat_5 -> bool_4 :=
  (fun lt_69327 : nat_5 -> nat_5 -> bool_4
  | x_69330, y_69331 => ((lte_16) (succ_7 x_69330) y_69331))

#[program]
def pred_18 : nat_5 -> nat_5 :=
  (fun pred_69333 : nat_5 -> nat_5
  | zero_6 => zero_6
  | (succ_7 n_69335) => n_69335)

#[program]
def add_19 : nat_5 -> nat_5 -> nat_5 :=
  (fun add_69338 : nat_5 -> nat_5 -> nat_5
  | zero_6, __69341 => __69341
  | (succ_7 n_69342), __69343 => (succ_7 ((add_69338) n_69342 __69343)))

#[program]
def sub_20 : nat_5 -> nat_5 -> nat_5 :=
  (fun sub_69346 : nat_5 -> nat_5 -> nat_5
  | __69349, zero_6 => __69349
  | __69350, (succ_7 n_69351) => ((sub_69346) ((pred_18) __69350) n_69351))

#[program]
def mul_21 : nat_5 -> nat_5 -> nat_5 :=
  (fun mul_69354 : nat_5 -> nat_5 -> nat_5
  | zero_6, __69357 => zero_6
  | (succ_7 n_69358), __69359 =>
    ((add_19) __69359 ((mul_69354) n_69358 __69359)))

#[program]
def div_22 : nat_5 -> nat_5 -> nat_5 :=
  (fun div_69362 : nat_5 -> nat_5 -> nat_5
  | x_69365, y_69366 =>
    (match ((lt_17) x_69365 y_69366) in bool_4 -o nat_5 with
    | true_4 => zero_6
    | false_5 =>
      let loop_69368 :=
        (fun loop_69369 : nat_5 -> nat_5 -> nat_5
        | x_69372, y_69373 =>
          (match ((sub_20) x_69372 ((pred_18) y_69373)) in nat_5 -o nat_5
           with
          | zero_6 => zero_6
          | (succ_7 n_69375) => (succ_7 ((loop_69369) n_69375 y_69373))))
      in ((loop_69368) x_69365 y_69366)))

#[program]
def rem_23 : nat_5 -> nat_5 -> nat_5 :=
  (fun rem_69378 : nat_5 -> nat_5 -> nat_5
  | x_69381, y_69382 =>
    ((sub_20) x_69381 ((mul_21) ((div_22) x_69381 y_69382) y_69382)))

#[program]
inductive option_6s_69383 (A_69384 : Types_69383):
  Types_69383
where
| None_8 : (option_6s_69383 A_69384)
| Some_9 (m_69385 : A_69384) : (option_6s_69383 A_69384)

#[program]
inductive list_7s_69386,t_69387 (A_69388 : Types_69386):
  Typet_69387
where
| nil_10 : (list_7s_69386,t_69387 A_69388)
| cons_11
    (hd_69389 : A_69388) (tl_69390 : (list_7s_69386,t_69387 A_69388))
    : (list_7s_69386,t_69387 A_69388)

#[program]
def rcons_24s_69391,t_69392 :
   {A_69393 : Types_69391} ->
    (list_7s_69391,t_69392 A_69393) -o
      A_69393 -o (list_7s_69391,t_69392 A_69393)
:=
  (fun rcons_69396 :
     {A_69397 : Types_69391} ->
      (list_7s_69391,t_69392 A_69397) -o
        A_69397 -o (list_7s_69391,t_69392 A_69397)
  | A_69400, nil_10, __69401 =>
    (cons_11s_69391,t_69392
      A_69400 __69401 (nil_10s_69391,t_69392 A_69400))
  | A_69402, (cons_11 hd_69403 tl_69404), __69405 =>
    (cons_11s_69391,t_69392
      A_69402 hd_69403 ((rcons_69396) A_69402 tl_69404 __69405)))

#[program]
def free_list_25s_69406,t_69407 :
   {A_69408 : Types_69406} ->
    A_69408 -> unit_9 -> (list_7s_69406,t_69407 A_69408) -> unit_9
:=
  (fun free_list_69412 :
     {A_69413 : Types_69406} ->
      A_69413 -> unit_9 -> (list_7s_69406,t_69407 A_69413) -> unit_9
  | A_69417, f_69418, nil_10 => tt_3U
  | A_69419, f_69420, (cons_11 hd_69421 tl_69422) =>
    let __69423 := ((f_69420) hd_69421) in
    ((free_list_69412) A_69419 f_69420 tl_69422))

#[program]
inductive exists_8s_69424,r_69425 (A_69426 : Types_69424) (B_69427 : 
A_69426 -> Typer_69425): L where
| ex_12
    (m_69429 : A_69426) {n_69430 : ((B_69427) m_69429)}
    : (exists_8s_69424,r_69425 A_69426 B_69427)

#[program]
inductive exists0_9s_69431,r_69432 (A_69433 : Types_69431) (B_69434 : 
A_69433 -> Typer_69432): L where
| ex0_13
    {m_69436 : A_69433} (n_69437 : ((B_69434) m_69436))
    : (exists0_9s_69431,r_69432 A_69433 B_69434)

#[program]
inductive exists1_10s_69438,r_69439 (A_69440 : Types_69438) (B_69441 : 
A_69440 -> Typer_69439): L where
| ex1_14
    (m_69443 : A_69440) (n_69444 : ((B_69441) m_69443))
    : (exists1_10s_69438,r_69439 A_69440 B_69441)

#[logical]
def tensor_26s_69445,r_69446 :
  Types_69445 -> Typer_69446 -> L
:=
  (fun tensor_69449 : Types_69445 -> Typer_69446 -> L
  | A_69452, B_69453 =>
    (exists1_10s_69445,r_69446
      A_69452
      (fun _69454 : A_69452 -> Typer_69446
      | __69456 => B_69453)))

#[program]
def pow_27 : int -> int -> int :=
  (fun pow_69459 : int -> int -> int
  | x_69462, y_69463 =>
    let loop_69464 :=
      (fun loop_69465 : int -> int -> int
      | acc_69468, y_69469 =>
        (match (__lte__ y_69469 0) in bool_4 -o int with
        | true_4 => acc_69468
        | false_5 =>
          ((loop_69465) (__mul__ x_69462 acc_69468) (__sub__ y_69469 1))))
    in ((loop_69464) 1 y_69463))

#[program]
def powm_28 : int -> int -> int -> int :=
  (fun powm_69474 : int -> int -> int -> int
  | x_69478, y_69479, m_69480 =>
    let loop_69481 :=
      (fun loop_69482 : int -> int -> int
      | acc_69485, y_69486 =>
        (match (__lte__ y_69486 0) in bool_4 -o int with
        | true_4 => acc_69485
        | false_5 =>
          ((loop_69482)
            (__mod__ (__mul__ x_69478 acc_69485) m_69480) (__sub__ y_69486 1))))
    in ((loop_69481) 1 y_69479))

#[program]
def ord_29 : char -> int :=
  (fun ord_69489 : char -> int
  | c_69491 => (__ord__ c_69491))

#[program]
def chr_30 : int -> char :=
  (fun chr_69493 : int -> char
  | i_69495 => (__chr__ i_69495))

#[program]
def str_31 : char -> string :=
  (fun str_69497 : char -> string
  | c_69499 => (__push__ "" c_69499))

#[program]
def strlen_32 : string -> int :=
  (fun strlen_69501 : string -> int
  | s_69503 => (__size__ s_69503))

#[program]
def string_of_int_33 : int -> string :=
  (fun string_of_int_69505 : int -> string
  | i_69507 =>
    let aux_69508 :=
      (fun aux_69509 : int -> string
      | i_69511 =>
        (match (__lte__ 10 i_69511) in bool_4 -o string with
        | true_4 =>
          let r_69513 := (__mod__ i_69511 10) in
          let i_69514 := (__div__ i_69511 10) in
          (__push__ ((aux_69509) i_69514)
            ((chr_30) (__add__ r_69513 ((ord_29) 0))))
        | false_5 => ((str_31) ((chr_30) (__add__ i_69511 ((ord_29) 0))))))
    in
    (match (__lte__ 0 i_69507) in bool_4 -o string with
    | true_4 => ((aux_69508) i_69507)
    | false_5 => (__cat__ "~" ((aux_69508) (__neg__ i_69507)))))

#[program]
inductive tree_11 (A_69516 : U): U where
| Leaf_15 (x_69517 : A_69516) : (tree_11 A_69516)
| Node_16
    (l_69518 : (tree_11 A_69516)) (r_69519 : (tree_11 A_69516))
    : (tree_11 A_69516)

#[program]
inductive opr_12 (A_69520 : U): L where
| Free_17 : (opr_12 A_69520)
| Map_18 {B_69521 : U} (f_69522 : A_69520 -> B_69521) : (opr_12 A_69520)
| Reduce_19
    {B_69524 : U} (f_69525 : A_69520 -> B_69524)
    (g_69527 : B_69524 -> B_69524 -> B_69524) : (opr_12 A_69520)

#[program]
def map_34 :
   {A_69530 : U} ->
     {B_69531 : U} ->
      A_69530 -> B_69531 -> (tree_11 A_69530) -> (tree_11 B_69531)
:=
  (fun map_69535 :
     {A_69536 : U} ->
       {B_69537 : U} ->
        A_69536 -> B_69537 -> (tree_11 A_69536) -> (tree_11 B_69537)
  | A_69541, B_69542, f_69543, (Leaf_15 x_69544) =>
    (Leaf_15 B_69542 ((f_69543) x_69544))
  | A_69545, B_69546, f_69547, (Node_16 l_69548 r_69549) =>
    (Node_16
      B_69546 ((map_69535) A_69545 B_69546 f_69547 l_69548)
      ((map_69535) A_69545 B_69546 f_69547 r_69549)))

#[program]
def reduce_35 :
   {A_69550 : U} ->
     {B_69551 : U} ->
      A_69550 -> B_69551 ->
        B_69551 -> B_69551 -> B_69551 -> (tree_11 A_69550) -> B_69551
:=
  (fun reduce_69558 :
     {A_69559 : U} ->
       {B_69560 : U} ->
        A_69559 -> B_69560 ->
          B_69560 -> B_69560 -> B_69560 -> (tree_11 A_69559) -> B_69560
  | A_69567, B_69568, f_69569, g_69570, (Leaf_15 x_69571) =>
    ((f_69569) x_69571)
  | A_69572, B_69573, f_69574, g_69575, (Node_16 l_69576 r_69577) =>
    ((g_69575)
      ((reduce_69558) A_69572 B_69573 f_69574 g_69575 l_69576)
      ((reduce_69558) A_69572 B_69573 f_69574 g_69575 r_69577)))

#[logical]
def tree_p_36 :  {A_69578 : U} -> (tree_11 A_69578) -> proto :=
  (fun tree_p_69580 :  {A_69581 : U} -> (tree_11 A_69581) -> proto
  | A_69583, t_69584 =>
    (o_69585 : (opr_12 A_69583)) 
      (match o_69585 in (opr_12 A_69583) -o proto with
      | Free_17 => 
      | (Map_18 B_69587 f_69588) =>
        ((tree_p_69580) B_69587 ((map_34) A_69583 B_69587 f_69588 t_69584))
      | (Reduce_19 B_69589 f_69590 g_69591) =>
        (__69592 :
          ((ssing_6U)
            B_69589 ((reduce_35) A_69583 B_69589 f_69590 g_69591 t_69584))) 
          ((tree_p_69580) A_69583 t_69584)))

#[logical]
def ctree_ch_37 :  {A_69593 : U} -> (tree_11 A_69593) -> L :=
  (fun ctree_ch_69595 :  {A_69596 : U} -> (tree_11 A_69596) -> L
  | A_69598, t_69599 => ch((tree_p_36) A_69598 t_69599))

#[logical]
def ctree_hc_38 :  {A_69600 : U} -> (tree_11 A_69600) -> L :=
  (fun ctree_hc_69602 :  {A_69603 : U} -> (tree_11 A_69603) -> L
  | A_69605, t_69606 => hc((tree_p_36) A_69605 t_69606))

#[logical]
def ctree_39 :  {A_69607 : U} -> (tree_11 A_69607) -> L :=
  (fun ctree_69609 :  {A_69610 : U} -> (tree_11 A_69610) -> L
  | A_69612, t_69613 => IO ((ctree_hc_38) A_69612 t_69613))

#[program]
def leaf_worker_40 :
   {A_69614 : U} ->
     (x_69615 : A_69614) ->
      ((ctree_ch_37) A_69614 (Leaf_15 A_69614 x_69615)) -> IO unit_9
:=
  (fun leaf_worker_69617 :
     {A_69618 : U} ->
       (x_69619 : A_69618) ->
        ((ctree_ch_37) A_69618 (Leaf_15 A_69618 x_69619)) -> IO unit_9
  | A_69621, x_69622, c_69623 =>
    let* _69624 := recv c_69623 in
    (match _69624 in
       (exists1_10L,L
         (opr_12 A_69621)
         (fun _69626 : (opr_12 A_69621) -> L
         | o_69628 =>
           ch(match o_69628 in (opr_12 A_69621) -o proto with
                | Free_17 => 
                | (Map_18 B_69630 f_69631) =>
                  (((fun tree_p_69632 :
                       {A_69633 : U} -> (tree_11 A_69633) -> proto
                    | A_69635, t_69636 =>
                      (o_69637 : (opr_12 A_69635)) 
                        (match o_69637 in (opr_12 A_69635) -o proto with
                        | Free_17 => 
                        | (Map_18 B_69639 f_69640) =>
                          ((tree_p_69632)
                            B_69639
                            ((map_34) A_69635 B_69639 f_69640 t_69636))
                        | (Reduce_19 B_69641 f_69642 g_69643) =>
                          (__69644 :
                            ((ssing_6U)
                              B_69641
                              ((reduce_35)
                                A_69635 B_69641 f_69642 g_69643 t_69636))) 
                            ((tree_p_69632) A_69635 t_69636))))
                    B_69630
                    ((map_34)
                      A_69621 B_69630 f_69631 (Leaf_15 A_69621 x_69622)))
                | (Reduce_19 B_69645 f_69646 g_69647) =>
                  (__69648 :
                    ((ssing_6U)
                      B_69645
                      ((reduce_35)
                        A_69621 B_69645 f_69646 g_69647
                        (Leaf_15 A_69621 x_69622)))) 
                    (((fun tree_p_69649 :
                         {A_69650 : U} -> (tree_11 A_69650) -> proto
                      | A_69652, t_69653 =>
                        (o_69654 : (opr_12 A_69652)) 
                          (match o_69654 in (opr_12 A_69652) -o proto with
                          | Free_17 => 
                          | (Map_18 B_69656 f_69657) =>
                            ((tree_p_69649)
                              B_69656
                              ((map_34) A_69652 B_69656 f_69657 t_69653))
                          | (Reduce_19 B_69658 f_69659 g_69660) =>
                            (__69661 :
                              ((ssing_6U)
                                B_69658
                                ((reduce_35)
                                  A_69652 B_69658 f_69659 g_69660 t_69653))) 
                              ((tree_p_69649) A_69652 t_69653))))
                      A_69621 (Leaf_15 A_69621 x_69622))))) -o
         IO base_3U
     with
    | (ex1_14 m_69662 n_69663) =>
      (match m_69662, n_69663 in
          (o0_69664 : (opr_12 A_69621)) -o
           ch(match o0_69664 in (opr_12 A_69621) -o proto with
                | Free_17 => 
                | (Map_18 B_69667 f_69668) =>
                  ((tree_p_36)
                    B_69667 (Leaf_15 B_69667 ((f_69668) x_69622)))
                | (Reduce_19 B_69669 f_69670 g_69671) =>
                  (__69672 :
                    (sing_2U,U B_69669 ((f_69670) x_69622))) 
                    ((tree_p_36) A_69621 (Leaf_15 A_69621 x_69622))) -o
             IO base_3U
       with
      | Free_17, __69673 => close __69673
      | (Map_18 B_69674 f_69675), __69676 =>
        ((leaf_worker_69617) B_69674 ((f_69675) x_69622) __69676)
      | (Reduce_19 B_69677 f_69678 g_69679), __69680 =>
        let* c_69681 :=
          ((send __69680) (just_2U,U B_69677 ((f_69678) x_69622)))
        in ((leaf_worker_69617) A_69621 x_69622 c_69681))))

#[program]
def node_worker_41 :
   {A_69682 : U} ->
     {l_69683 : (tree_11 A_69682)} ->
       {r_69684 : (tree_11 A_69682)} ->
        ((ctree_hc_38) A_69682 l_69683) -o
          ((ctree_hc_38) A_69682 r_69684) -o
            ((ctree_ch_37) A_69682 (Node_16 A_69682 l_69683 r_69684)) -o
              IO unit_9
:=
  (fun node_worker_69688 :
     {A_69689 : U} ->
       {l_69690 : (tree_11 A_69689)} ->
         {r_69691 : (tree_11 A_69689)} ->
          ((ctree_hc_38) A_69689 l_69690) -o
            ((ctree_hc_38) A_69689 r_69691) -o
              ((ctree_ch_37) A_69689 (Node_16 A_69689 l_69690 r_69691)) -o
                IO unit_9
  | A_69695, l_69696, r_69697, __69698, __69699, __69700 =>
    let* _69701 := recv __69700 in
    (match _69701 in
       (exists1_10L,L
         (opr_12 A_69695)
         (fun _69703 : (opr_12 A_69695) -> L
         | o_69705 =>
           ch(match o_69705 in (opr_12 A_69695) -o proto with
                | Free_17 => 
                | (Map_18 B_69707 f_69708) =>
                  (((fun tree_p_69709 :
                       {A_69710 : U} -> (tree_11 A_69710) -> proto
                    | A_69712, t_69713 =>
                      (o_69714 : (opr_12 A_69712)) 
                        (match o_69714 in (opr_12 A_69712) -o proto with
                        | Free_17 => 
                        | (Map_18 B_69716 f_69717) =>
                          ((tree_p_69709)
                            B_69716
                            ((map_34) A_69712 B_69716 f_69717 t_69713))
                        | (Reduce_19 B_69718 f_69719 g_69720) =>
                          (__69721 :
                            ((ssing_6U)
                              B_69718
                              ((reduce_35)
                                A_69712 B_69718 f_69719 g_69720 t_69713))) 
                            ((tree_p_69709) A_69712 t_69713))))
                    B_69707
                    ((map_34)
                      A_69695 B_69707 f_69708
                      (Node_16 A_69695 l_69696 r_69697)))
                | (Reduce_19 B_69722 f_69723 g_69724) =>
                  (__69725 :
                    ((ssing_6U)
                      B_69722
                      ((reduce_35)
                        A_69695 B_69722 f_69723 g_69724
                        (Node_16 A_69695 l_69696 r_69697)))) 
                    (((fun tree_p_69726 :
                         {A_69727 : U} -> (tree_11 A_69727) -> proto
                      | A_69729, t_69730 =>
                        (o_69731 : (opr_12 A_69729)) 
                          (match o_69731 in (opr_12 A_69729) -o proto with
                          | Free_17 => 
                          | (Map_18 B_69733 f_69734) =>
                            ((tree_p_69726)
                              B_69733
                              ((map_34) A_69729 B_69733 f_69734 t_69730))
                          | (Reduce_19 B_69735 f_69736 g_69737) =>
                            (__69738 :
                              ((ssing_6U)
                                B_69735
                                ((reduce_35)
                                  A_69729 B_69735 f_69736 g_69737 t_69730))) 
                              ((tree_p_69726) A_69729 t_69730))))
                      A_69695 (Node_16 A_69695 l_69696 r_69697))))) -o
         IO base_3U
     with
    | (ex1_14 m_69739 n_69740) =>
      (match m_69739, n_69740 in
          (o0_69741 : (opr_12 A_69695)) -o
           ch(match o0_69741 in (opr_12 A_69695) -o proto with
                | Free_17 => 
                | (Map_18 B_69744 f_69745) =>
                  ((tree_p_36)
                    B_69744
                    ((map_34)
                      A_69695 B_69744 f_69745
                      (Node_16 A_69695 l_69696 r_69697)))
                | (Reduce_19 B_69746 f_69747 g_69748) =>
                  (__69749 :
                    (sing_2U,U
                      B_69746
                      ((reduce_35)
                        A_69695 B_69746 f_69747 g_69748
                        (Node_16 A_69695 l_69696 r_69697)))) 
                    ((tree_p_36)
                      A_69695 (Node_16 A_69695 l_69696 r_69697))) -o
             IO base_3U
       with
      | Free_17, __69750 =>
        let* l_ch_69751 := ((send __69698) (Free_17 A_69695)) in
        let* r_ch_69752 := ((send __69699) (Free_17 A_69695)) in
        let* __69753 := close l_ch_69751 in
        let* __69754 := close r_ch_69752 in close __69750
      | (Map_18 B_69755 f_69756), __69757 =>
        let* l_ch_69758 :=
          ((send __69698) (Map_18 A_69695 B_69755 f_69756))
        in
        let* r_ch_69759 :=
          ((send __69699) (Map_18 A_69695 B_69755 f_69756))
        in
        ((node_worker_69688)
          B_69755 ((map_34) A_69695 B_69755 f_69756 l_69696)
          ((map_34) A_69695 B_69755 f_69756 r_69697) l_ch_69758 r_ch_69759
          __69757)
      | (Reduce_19 B_69760 f_69761 g_69762), __69763 =>
        let* l_ch_69764 :=
          ((send __69698) (Reduce_19 A_69695 B_69760 f_69761 g_69762))
        in
        let* r_ch_69765 :=
          ((send __69699) (Reduce_19 A_69695 B_69760 f_69761 g_69762))
        in
        let* _69766 := recv l_ch_69764 in
        (match _69766 in
           (exists1_10U,L
             ((ssing_6U)
               B_69760 ((reduce_35) A_69695 B_69760 f_69761 g_69762 l_69696))
             (fun _69768 :
               ((ssing_6U)
                 B_69760
                 ((reduce_35) A_69695 B_69760 f_69761 g_69762 l_69696)) -> L
             | __69770 =>
               hc(((fun tree_p_69771 :
                         {A_69772 : U} -> (tree_11 A_69772) -> proto
                      | A_69774, t_69775 =>
                        (o_69776 : (opr_12 A_69774)) 
                          (match o_69776 in (opr_12 A_69774) -o proto with
                          | Free_17 => 
                          | (Map_18 B_69778 f_69779) =>
                            ((tree_p_69771)
                              B_69778
                              ((map_34) A_69774 B_69778 f_69779 t_69775))
                          | (Reduce_19 B_69780 f_69781 g_69782) =>
                            (__69783 :
                              ((ssing_6U)
                                B_69780
                                ((reduce_35)
                                  A_69774 B_69780 f_69781 g_69782 t_69775))) 
                              ((tree_p_69771) A_69774 t_69775))))
                      A_69695 l_69696))) -o
             IO unit_9
         with
        | (ex1_14 (just_2 m_69784) n_69785) =>
          let* _69786 := recv r_ch_69765 in
          (match _69786 in
             (exists1_10U,L
               ((ssing_6U)
                 B_69760
                 ((reduce_35) A_69695 B_69760 f_69761 g_69762 r_69697))
               (fun _69788 :
                 ((ssing_6U)
                   B_69760
                   ((reduce_35) A_69695 B_69760 f_69761 g_69762 r_69697)) ->
                   L
               | __69790 =>
                 hc(((fun tree_p_69791 :
                           {A_69792 : U} -> (tree_11 A_69792) -> proto
                        | A_69794, t_69795 =>
                          (o_69796 : (opr_12 A_69794)) 
                            (match o_69796 in (opr_12 A_69794) -o proto with
                            | Free_17 => 
                            | (Map_18 B_69798 f_69799) =>
                              ((tree_p_69791)
                                B_69798
                                ((map_34) A_69794 B_69798 f_69799 t_69795))
                            | (Reduce_19 B_69800 f_69801 g_69802) =>
                              (__69803 :
                                ((ssing_6U)
                                  B_69800
                                  ((reduce_35)
                                    A_69794 B_69800 f_69801 g_69802 t_69795))) 
                                ((tree_p_69791) A_69794 t_69795))))
                        A_69695 r_69697))) -o
               IO unit_9
           with
          | (ex1_14 (just_2 m_69804) n_69805) =>
            let* c_69806 :=
              ((send __69763)
                (just_2U,U B_69760 ((g_69762) m_69784 m_69804)))
            in
            ((node_worker_69688)
              A_69695 l_69696 r_69697 n_69785 n_69805 c_69806))))))

#[program]
def cleaf_42 :
   {A_69807 : U} ->
     (x_69808 : A_69807) ->
      ((ctree_39) A_69807 (Leaf_15 A_69807 x_69808))
:=
  (fun cleaf_69809 :
     {A_69810 : U} ->
       (x_69811 : A_69810) ->
        ((ctree_39) A_69810 (Leaf_15 A_69810 x_69811))
  | A_69812, x_69813 =>
    fork
      (fun _69814 :
        ((ctree_ch_37) A_69812 (Leaf_15 A_69812 x_69813)) -o IO unit_9
      | _69816 => ((leaf_worker_40) A_69812 x_69813 _69816)))

#[program]
def cnode_43 :
   {A_69817 : U} ->
     {l_69818 : (tree_11 A_69817)} ->
       {r_69819 : (tree_11 A_69817)} ->
        ((ctree_39) A_69817 l_69818) -o
          ((ctree_39) A_69817 r_69819) -o
            ((ctree_39) A_69817 (Node_16 A_69817 l_69818 r_69819))
:=
  (fun cnode_69822 :
     {A_69823 : U} ->
       {l_69824 : (tree_11 A_69823)} ->
         {r_69825 : (tree_11 A_69823)} ->
          ((ctree_39) A_69823 l_69824) -o
            ((ctree_39) A_69823 r_69825) -o
              ((ctree_39) A_69823 (Node_16 A_69823 l_69824 r_69825))
  | A_69828, l_69829, r_69830, __69831, __69832 =>
    let* l_ch_69833 := __69831 in
    let* r_ch_69834 := __69832 in
    fork
      (fun _69835 :
        ((ctree_ch_37) A_69828 (Node_16 A_69828 l_69829 r_69830)) -o
          IO unit_9
      | _69837 =>
        ((node_worker_41)
          A_69828 l_69829 r_69830 l_ch_69833 r_ch_69834 _69837)))

#[program]
def ctree_of_tree_44 :
   {A_69838 : U} ->
     (t_69839 : (tree_11 A_69838)) -> ((ctree_39) A_69838 t_69839)
:=
  (fun ctree_of_tree_69840 :
     {A_69841 : U} ->
       (t_69842 : (tree_11 A_69841)) -> ((ctree_39) A_69841 t_69842)
  | A_69843, (Leaf_15 x_69844) => ((cleaf_42) A_69843 x_69844)
  | A_69845, (Node_16 l_69846 r_69847) =>
    ((cnode_43)
      A_69845 l_69846 r_69847 ((ctree_of_tree_69840) A_69845 l_69846)
      ((ctree_of_tree_69840) A_69845 r_69847)))

#[program]
def cfree_45 :
   {A_69848 : U} ->
     {t_69849 : (tree_11 A_69848)} ->
      ((ctree_39) A_69848 t_69849) -> IO unit_9
:=
  (fun cfree_69851 :
     {A_69852 : U} ->
       {t_69853 : (tree_11 A_69852)} ->
        ((ctree_39) A_69852 t_69853) -> IO unit_9
  | A_69855, t_69856, ct_69857 =>
    let* c_69858 := ct_69857 in
    let* c_69859 := ((send c_69858) (Free_17 A_69855)) in close c_69859)

#[program]
def cmap_46 :
   {A_69860 : U} ->
     {B_69861 : U} ->
       {t_69862 : (tree_11 A_69860)} ->
         (f_69863 : A_69860 -> B_69861) ->
          ((ctree_39) A_69860 t_69862) ->
            ((ctree_39) B_69861 ((map_34) A_69860 B_69861 f_69863 t_69862))
:=
  (fun cmap_69866 :
     {A_69867 : U} ->
       {B_69868 : U} ->
         {t_69869 : (tree_11 A_69867)} ->
           (f_69870 : A_69867 -> B_69868) ->
            ((ctree_39) A_69867 t_69869) ->
              ((ctree_39) B_69868 ((map_34) A_69867 B_69868 f_69870 t_69869))
  | A_69873, B_69874, t_69875, f_69876, ct_69877 =>
    let* c_69878 := ct_69877 in
    let* c_69879 := ((send c_69878) (Map_18 A_69873 B_69874 f_69876))
    in return c_69879)

#[program]
def creduce_47 :
   {A_69880 : U} ->
     {B_69881 : U} ->
       {t_69882 : (tree_11 A_69880)} ->
         (f_69883 : A_69880 -> B_69881) ->
           (g_69885 : B_69881 -> B_69881 -> B_69881) ->
            ((ctree_39) A_69880 t_69882) ->
              IO ((tensor_26U,L)
                   ((ssing_6U)
                     B_69881
                     ((reduce_35) A_69880 B_69881 f_69883 g_69885 t_69882))
                   ((ctree_39) A_69880 t_69882))
:=
  (fun creduce_69889 :
     {A_69890 : U} ->
       {B_69891 : U} ->
         {t_69892 : (tree_11 A_69890)} ->
           (f_69893 : A_69890 -> B_69891) ->
             (g_69895 : B_69891 -> B_69891 -> B_69891) ->
              ((ctree_39) A_69890 t_69892) ->
                IO ((tensor_26U,L)
                     ((ssing_6U)
                       B_69891
                       ((reduce_35) A_69890 B_69891 f_69893 g_69895 t_69892))
                     ((ctree_39) A_69890 t_69892))
  | A_69899, B_69900, t_69901, f_69902, g_69903, ct_69904 =>
    let* c_69905 := ct_69904 in
    let* c_69906 :=
      ((send c_69905) (Reduce_19 A_69899 B_69900 f_69902 g_69903))
    in
    let* _69907 := recv c_69906 in
    (match _69907 in
       (exists1_10U,L
         ((ssing_6U)
           B_69900 ((reduce_35) A_69899 B_69900 f_69902 g_69903 t_69901))
         (fun _69909 :
           ((ssing_6U)
             B_69900 ((reduce_35) A_69899 B_69900 f_69902 g_69903 t_69901)) ->
             L
         | __69911 =>
           hc(((fun tree_p_69912 :
                     {A_69913 : U} -> (tree_11 A_69913) -> proto
                  | A_69915, t_69916 =>
                    (o_69917 : (opr_12 A_69915)) 
                      (match o_69917 in (opr_12 A_69915) -o proto with
                      | Free_17 => 
                      | (Map_18 B_69919 f_69920) =>
                        ((tree_p_69912)
                          B_69919 ((map_34) A_69915 B_69919 f_69920 t_69916))
                      | (Reduce_19 B_69921 f_69922 g_69923) =>
                        (__69924 :
                          ((ssing_6U)
                            B_69921
                            ((reduce_35)
                              A_69915 B_69921 f_69922 g_69923 t_69916))) 
                          ((tree_p_69912) A_69915 t_69916))))
                  A_69899 t_69901))) -o
         IO (exists1_10U,L
              ((ssing_6U)
                B_69900 ((reduce_35) A_69899 B_69900 f_69902 g_69903 t_69901))
              (fun _69925 :
                ((ssing_6U)
                  B_69900
                  ((reduce_35) A_69899 B_69900 f_69902 g_69903 t_69901)) -> L
              | __69927 => ((ctree_39) A_69899 t_69901)))
     with
    | (ex1_14 m_69928 n_69929) =>
      return (ex1_14U,L
               ((ssing_6U)
                 B_69900
                 ((reduce_35) A_69899 B_69900 f_69902 g_69903 t_69901))
               (fun _69930 :
                 ((ssing_6U)
                   B_69900
                   ((reduce_35) A_69899 B_69900 f_69902 g_69903 t_69901)) ->
                   L
               | __69932 => ((ctree_39) A_69899 t_69901)) m_69928
               return n_69929)))

#[program]
def split_48t_69933 :
  (list_7U,t_69933 int) ->
    ((tensor_26t_69933,t_69933)
      (list_7U,t_69933 int) (list_7U,t_69933 int))
:=
  (fun split_69935 :
    (list_7U,t_69933 int) ->
      ((tensor_26t_69933,t_69933)
        (list_7U,t_69933 int) (list_7U,t_69933 int))
  | nil_10 =>
    (ex1_14t_69933,t_69933
      (list_7U,t_69933 int)
      (fun _69937 : (list_7U,t_69933 int) -> Typet_69933
      | __69939 => (list_7U,t_69933 int)) (nil_10U,t_69933 int)
      (nil_10U,t_69933 int))
  | (cons_11 hd_69940 nil_10) =>
    (ex1_14t_69933,t_69933
      (list_7U,t_69933 int)
      (fun _69941 : (list_7U,t_69933 int) -> Typet_69933
      | __69943 => (list_7U,t_69933 int))
      (cons_11U,t_69933 int hd_69940 (nil_10U,t_69933 int))
      (nil_10U,t_69933 int))
  | (cons_11 hd_69944 (cons_11 hd_69945 tl_69946)) =>
    (match ((split_69935) tl_69946) in
       ((tensor_26t_69933,t_69933)
         (list_7U,t_69933 int) (list_7U,t_69933 int)) -o
         ((tensor_26t_69933,t_69933)
           (list_7U,t_69933 int) (list_7U,t_69933 int))
     with
    | (ex1_14 m_69948 n_69949) =>
      (ex1_14t_69933,t_69933
        (list_7U,t_69933 int)
        (fun _69950 : (list_7U,t_69933 int) -> Typet_69933
        | __69952 => (list_7U,t_69933 int))
        (cons_11U,t_69933 int hd_69944 m_69948)
        (cons_11U,t_69933 int hd_69945 n_69949))))

#[program]
def merge_49t_69953 :
  (list_7U,t_69953 int) ->
    (list_7U,t_69953 int) -o (list_7U,t_69953 int)
:=
  (fun merge_69956 :
    (list_7U,t_69953 int) ->
      (list_7U,t_69953 int) -o (list_7U,t_69953 int)
  | nil_10, __69959 => __69959
  | (cons_11 hd_69960 tl_69961), nil_10 =>
    (cons_11U,t_69953 int hd_69960 tl_69961)
  | (cons_11 hd_69962 tl_69963), (cons_11 hd_69964 tl_69965) =>
    (match (__lte__ hd_69962 hd_69964) in
       bool_4 -o (list_7U,t_69953 int)
     with
    | true_4 =>
      (cons_11U,t_69953
        int hd_69962
        ((merge_69956)
          tl_69963 (cons_11U,t_69953 int hd_69964 tl_69965)))
    | false_5 =>
      (cons_11U,t_69953
        int hd_69964
        ((merge_69956)
          (cons_11U,t_69953 int hd_69962 tl_69963) tl_69965))))

#[program]
def msort_50t_69967 :
  (list_7U,t_69967 int) -> (list_7U,t_69967 int)
:=
  (fun msort_69969 :
    (list_7U,t_69967 int) -> (list_7U,t_69967 int)
  | nil_10 => (nil_10U,t_69967 int)
  | (cons_11 hd_69971 nil_10) =>
    (cons_11U,t_69967 int hd_69971 (nil_10U,t_69967 int))
  | (cons_11 hd_69972 (cons_11 hd_69973 tl_69974)) =>
    (match ((split_48t_69967)
             (cons_11U,t_69967
               int hd_69972 (cons_11U,t_69967 int hd_69973 tl_69974))) in
       ((tensor_26t_69967,t_69967)
         (list_7U,t_69967 int) (list_7U,t_69967 int)) -o
         (list_7U,t_69967 int)
     with
    | (ex1_14 m_69976 n_69977) =>
      ((merge_49t_69967)
        ((msort_69969) m_69976) ((msort_69969) n_69977))))

#[program]
def splitting_tree_51 :
  (list_7U,U int) -> (tree_11 (list_7U,U int))
:=
  (fun splitting_tree_69979 :
    (list_7U,U int) -> (tree_11 (list_7U,U int))
  | nil_10 => (Leaf_15 (list_7U,U int) (nil_10U,U int))
  | (cons_11 hd_69981 nil_10) =>
    (Leaf_15
      (list_7U,U int)
      (cons_11U,U int hd_69981 (nil_10U,U int)))
  | (cons_11 hd_69982 (cons_11 hd_69983 tl_69984)) =>
    (match ((split_48U)
             (cons_11U,U
               int hd_69982 (cons_11U,U int hd_69983 tl_69984))) in
       ((tensor_26U,U) (list_7U,U int) (list_7U,U int)) -o
         (tree_11 (list_7U,U int))
     with
    | (ex1_14 m_69986 n_69987) =>
      let l_69988 := ((splitting_tree_69979) m_69986) in
      let r_69989 := ((splitting_tree_69979) n_69987) in
      (Node_16 (list_7U,U int) l_69988 r_69989)))

#[logical]
def reduce_splitting_tree_52 :
   (xs_69990 : (list_7U,U int)) ->
    (eq_1U
      (list_7U,U int)
      ((reduce_35)
        (list_7U,U int) (list_7U,U int)
        (fun _69991 : (list_7U,U int) -> (list_7U,U int)
        | __69993 => __69993)
        (fun _69994 :
          (list_7U,U int) ->
            (list_7U,U int) -> (list_7U,U int)
        | __69997, __69998 => ((merge_49U) __69997 __69998))
        ((splitting_tree_51) xs_69990))
      ((msort_50U) xs_69990))
:=
  (fun reduce_splitting_tree_69999 :
     (xs_70000 : (list_7U,U int)) ->
      (eq_1U
        (list_7U,U int)
        ((reduce_35)
          (list_7U,U int) (list_7U,U int)
          (fun _70001 : (list_7U,U int) -> (list_7U,U int)
          | __70003 => __70003)
          (fun _70004 :
            (list_7U,U int) ->
              (list_7U,U int) -> (list_7U,U int)
          | __70007, __70008 => ((merge_49U) __70007 __70008))
          ((splitting_tree_51) xs_70000))
        ((msort_50U) xs_70000))
  | nil_10 =>
    (refl_1U
      (list_7U,U int)
      ((reduce_35)
        (list_7U,U int) (list_7U,U int)
        (fun _70009 : (list_7U,U int) -> (list_7U,U int)
        | __70011 => __70011)
        (fun _70012 :
          (list_7U,U int) ->
            (list_7U,U int) -> (list_7U,U int)
        | __70015, __70016 => ((merge_49U) __70015 __70016))
        ((splitting_tree_51) (nil_10U,U int))))
  | (cons_11 hd_70017 nil_10) =>
    (refl_1U
      (list_7U,U int)
      ((reduce_35)
        (list_7U,U int) (list_7U,U int)
        (fun _70018 : (list_7U,U int) -> (list_7U,U int)
        | __70020 => __70020)
        (fun _70021 :
          (list_7U,U int) ->
            (list_7U,U int) -> (list_7U,U int)
        | __70024, __70025 => ((merge_49U) __70024 __70025))
        ((splitting_tree_51)
          (cons_11U,U int hd_70017 (nil_10U,U int)))))
  | (cons_11 hd_70026 (cons_11 hd_70027 tl_70028)) =>
    (match ((split_48U)
             (cons_11U,U
               int hd_70026 (cons_11U,U int hd_70027 tl_70028))),
     (refl_1U
       (list_7U,U int)
       (match ((split_48U)
                (cons_11U,U
                  int hd_70026 (cons_11U,U int hd_70027 tl_70028))) in
          ((tensor_26U,U) (list_7U,U int) (list_7U,U int)) -o
            (list_7U,U int)
        with
       | (ex1_14 m_70030 n_70031) =>
         ((merge_49U)
           ((msort_50U) m_70030) ((msort_50U) n_70031)))),
     (refl_1U
       (list_7U,U int)
       ((reduce_35)
         (list_7U,U int) (list_7U,U int)
         (fun _70032 : (list_7U,U int) -> (list_7U,U int)
         | __70034 => __70034)
         (fun _70035 :
           (list_7U,U int) ->
             (list_7U,U int) -> (list_7U,U int)
         | __70038, __70039 => ((merge_49U) __70038 __70039))
         (match ((split_48U)
                  (cons_11U,U
                    int hd_70026 (cons_11U,U int hd_70027 tl_70028))) in
            ((tensor_26U,U)
              (list_7U,U int) (list_7U,U int)) -o
              (tree_11 (list_7U,U int))
          with
         | (ex1_14 m_70041 n_70042) =>
           let l_70043 := ((splitting_tree_51) m_70041) in
           let r_70044 := ((splitting_tree_51) n_70042) in
           (Node_16 (list_7U,U int) l_70043 r_70044)))) in
        (h1_70045 :
         ((tensor_26U,U) (list_7U,U int) (list_7U,U int))) -o
         {(eq_1U
            (list_7U,U int)
            (match h1_70045 in
               ((tensor_26U,U)
                 (list_7U,U int) (list_7U,U int)) -o
                 (list_7U,U int)
             with
            | (ex1_14 m_70048 n_70049) =>
              ((merge_49U)
                ((msort_50U) m_70048) ((msort_50U) n_70049)))
            ((msort_50U)
              (cons_11U,U
                int hd_70026 (cons_11U,U int hd_70027 tl_70028))))} -o
           {(eq_1U
              (list_7U,U int)
              ((reduce_35)
                (list_7U,U int) (list_7U,U int)
                (fun _70051 : (list_7U,U int) -> (list_7U,U int)
                | __70053 => __70053)
                (fun _70054 :
                  (list_7U,U int) ->
                    (list_7U,U int) -> (list_7U,U int)
                | __70057, __70058 => ((merge_49U) __70057 __70058))
                (match h1_70045 in
                   ((tensor_26U,U)
                     (list_7U,U int) (list_7U,U int)) -o
                     (tree_11 (list_7U,U int))
                 with
                | (ex1_14 m_70060 n_70061) =>
                  let l_70062 := ((splitting_tree_51) m_70060) in
                  let r_70063 := ((splitting_tree_51) n_70061) in
                  (Node_16 (list_7U,U int) l_70062 r_70063)))
              ((reduce_35)
                (list_7U,U int) (list_7U,U int)
                (fun _70064 : (list_7U,U int) -> (list_7U,U int)
                | __70066 => __70066)
                (fun _70067 :
                  (list_7U,U int) ->
                    (list_7U,U int) -> (list_7U,U int)
                | __70070, __70071 => ((merge_49U) __70070 __70071))
                ((splitting_tree_51)
                  (cons_11U,U
                    int hd_70026 (cons_11U,U int hd_70027 tl_70028)))))} -o
             (eq_1U
               (list_7U,U int)
               ((reduce_35)
                 (list_7U,U int) (list_7U,U int)
                 (fun _70072 : (list_7U,U int) -> (list_7U,U int)
                 | __70074 => __70074)
                 (fun _70075 :
                   (list_7U,U int) ->
                     (list_7U,U int) -> (list_7U,U int)
                 | __70078, __70079 => ((merge_49U) __70078 __70079))
                 ((splitting_tree_51)
                   (cons_11U,U
                     int hd_70026 (cons_11U,U int hd_70027 tl_70028))))
               ((msort_50U)
                 (cons_11U,U
                   int hd_70026 (cons_11U,U int hd_70027 tl_70028))))
     with
    | (ex1_14 m_70080 n_70081), __70082, __70083 =>
      let pf_xs0_70084 := ((reduce_splitting_tree_69999) m_70080) in
      let pf_ys0_70085 := ((reduce_splitting_tree_69999) n_70081) in
      let pf0_70086 :=
        ((rwr_3U,U)
          (list_7U,U int)
          ((reduce_35)
            (list_7U,U int) (list_7U,U int)
            (fun _70087 : (list_7U,U int) -> (list_7U,U int)
            | __70089 => __70089)
            (fun _70090 :
              (list_7U,U int) ->
                (list_7U,U int) -> (list_7U,U int)
            | __70093, __70094 => ((merge_49U) __70093 __70094))
            ((splitting_tree_51) m_70080))
          ((msort_50U) m_70080)
          (fun _70095 : (list_7U,U int) -> U
          | __70097 =>
            (eq_1U
              (list_7U,U int)
              ((merge_49U) __70097 ((msort_50U) n_70081))
              ((msort_50U)
                (cons_11U,U
                  int hd_70026 (cons_11U,U int hd_70027 tl_70028)))))
          pf_xs0_70084 __70082)
      in
      let pf0_70098 :=
        ((rwr_3U,U)
          (list_7U,U int)
          ((reduce_35)
            (list_7U,U int) (list_7U,U int)
            (fun _70099 : (list_7U,U int) -> (list_7U,U int)
            | __70101 => __70101)
            (fun _70102 :
              (list_7U,U int) ->
                (list_7U,U int) -> (list_7U,U int)
            | __70105, __70106 => ((merge_49U) __70105 __70106))
            ((splitting_tree_51) n_70081))
          ((msort_50U) n_70081)
          (fun _70107 : (list_7U,U int) -> U
          | __70109 =>
            (eq_1U
              (list_7U,U int)
              ((merge_49U)
                ((reduce_35)
                  (list_7U,U int) (list_7U,U int)
                  (fun _70110 :
                    (list_7U,U int) -> (list_7U,U int)
                  | __70112 => __70112)
                  (fun _70113 :
                    (list_7U,U int) ->
                      (list_7U,U int) -> (list_7U,U int)
                  | __70116, __70117 => ((merge_49U) __70116 __70117))
                  ((splitting_tree_51) m_70080))
                __70109)
              ((msort_50U)
                (cons_11U,U
                  int hd_70026 (cons_11U,U int hd_70027 tl_70028)))))
          pf_ys0_70085 pf0_70086)
      in
      let pf0_70118 :=
        ((rwl_2U,U)
          (list_7U,U int)
          ((reduce_35)
            (list_7U,U int) (list_7U,U int)
            (fun _70119 : (list_7U,U int) -> (list_7U,U int)
            | __70121 => __70121)
            (fun _70122 :
              (list_7U,U int) ->
                (list_7U,U int) -> (list_7U,U int)
            | __70125, __70126 => ((merge_49U) __70125 __70126))
            (match (ex1_14U,U
                     (list_7U,U int)
                     (fun _70127 : (list_7U,U int) -> U
                     | __70129 => (list_7U,U int)) m_70080 n_70081) in
               ((tensor_26U,U)
                 (list_7U,U int) (list_7U,U int)) -o
                 (tree_11 (list_7U,U int))
             with
            | (ex1_14 m_70131 n_70132) =>
              let l_70133 := ((splitting_tree_51) m_70131) in
              let r_70134 := ((splitting_tree_51) n_70132) in
              (Node_16 (list_7U,U int) l_70133 r_70134)))
          ((reduce_35)
            (list_7U,U int) (list_7U,U int)
            (fun _70135 : (list_7U,U int) -> (list_7U,U int)
            | __70137 => __70137)
            (fun _70138 :
              (list_7U,U int) ->
                (list_7U,U int) -> (list_7U,U int)
            | __70141, __70142 => ((merge_49U) __70141 __70142))
            ((splitting_tree_51)
              (cons_11U,U
                int hd_70026 (cons_11U,U int hd_70027 tl_70028))))
          (fun _70143 : (list_7U,U int) -> U
          | __70145 =>
            (eq_1U
              (list_7U,U int) __70145
              ((msort_50U)
                (cons_11U,U
                  int hd_70026 (cons_11U,U int hd_70027 tl_70028)))))
          __70083 pf0_70098)
      in pf0_70118))

#[program]
def splitting_ctree_53 :
   (xs_70146 : (list_7U,U int)) ->
    ch(__70148 :
           ((ctree_39) (list_7U,U int) ((splitting_tree_51) xs_70146))) 
            ->
      IO unit_9
:=
  (fun splitting_ctree_70149 :
     (xs_70150 : (list_7U,U int)) ->
      ch(__70152 :
             ((ctree_39)
               (list_7U,U int) ((splitting_tree_51) xs_70150))) 
              ->
        IO unit_9
  | nil_10, __70153 =>
    let* c_70154 :=
      ((send __70153)
        ((cleaf_42) (list_7U,U int) (nil_10U,U int)))
    in let* __70155 := close c_70154 in return tt_3U
  | (cons_11 hd_70156 nil_10), __70157 =>
    let* c_70158 :=
      ((send __70157)
        ((cleaf_42)
          (list_7U,U int)
          (cons_11U,U int hd_70156 (nil_10U,U int))))
    in let* __70159 := close c_70158 in return tt_3U
  | (cons_11 hd_70160 (cons_11 hd_70161 tl_70162)), __70163 =>
    (match ((split_48U)
             (cons_11U,U
               int hd_70160 (cons_11U,U int hd_70161 tl_70162))),
     (refl_1U
       (tree_11 (list_7U,U int))
       (match ((split_48U)
                (cons_11U,U
                  int hd_70160 (cons_11U,U int hd_70161 tl_70162))) in
          ((tensor_26U,U) (list_7U,U int) (list_7U,U int)) -o
            (tree_11 (list_7U,U int))
        with
       | (ex1_14 m_70165 n_70166) =>
         let l_70167 := ((splitting_tree_51) m_70165) in
         let r_70168 := ((splitting_tree_51) n_70166) in
         (Node_16 (list_7U,U int) l_70167 r_70168))) in
        (h1_70169 :
         ((tensor_26U,U) (list_7U,U int) (list_7U,U int))) -o
         {(eq_1U
            (tree_11 (list_7U,U int))
            (match h1_70169 in
               ((tensor_26U,U)
                 (list_7U,U int) (list_7U,U int)) -o
                 (tree_11 (list_7U,U int))
             with
            | (ex1_14 m_70172 n_70173) =>
              let l_70174 := ((splitting_tree_51) m_70172) in
              let r_70175 := ((splitting_tree_51) n_70173) in
              (Node_16 (list_7U,U int) l_70174 r_70175))
            ((splitting_tree_51)
              (cons_11U,U
                int hd_70160 (cons_11U,U int hd_70161 tl_70162))))} -o
           IO unit_9
     with
    | (ex1_14 m_70176 n_70177), __70178 =>
      let* cl_70179 :=
        fork
          (fun _70180 :
            ch(__70182 :
                   ((ctree_39)
                     (list_7U,U int) ((splitting_tree_51) m_70176))) 
                    -o
              IO unit_9
          | _70183 => ((splitting_ctree_70149) m_70176 _70183))
      in
      let* cr_70184 :=
        fork
          (fun _70185 :
            ch(__70187 :
                   ((ctree_39)
                     (list_7U,U int) ((splitting_tree_51) n_70177))) 
                    -o
              IO unit_9
          | _70188 => ((splitting_ctree_70149) n_70177 _70188))
      in
      let* _70189 := recv cl_70179 in
      (match _70189 in
         (exists1_10L,L
           ((ctree_39) (list_7U,U int) ((splitting_tree_51) m_70176))
           (fun _70191 :
             ((ctree_39) (list_7U,U int) ((splitting_tree_51) m_70176)) ->
               L
           | __70193 => hc)) -o IO base_3U
       with
      | (ex1_14 m_70194 n_70195) =>
        let* __70196 := close n_70195 in
        let* _70197 := recv cr_70184 in
        (match _70197 in
           (exists1_10L,L
             ((ctree_39) (list_7U,U int) ((splitting_tree_51) n_70177))
             (fun _70199 :
               ((ctree_39)
                 (list_7U,U int) ((splitting_tree_51) n_70177)) -> L
             | __70201 => hc)) -o IO base_3U
         with
        | (ex1_14 m_70202 n_70203) =>
          let* __70204 := close n_70203 in
          let ct_70205 :=
            (((cnode_43)
               (list_7U,U int) ((splitting_tree_51) m_70176)
               ((splitting_tree_51) n_70177) m_70194 m_70202)
              : ((ctree_39)
                  (list_7U,U int)
                  (Node_16
                    (list_7U,U int) ((splitting_tree_51) m_70176)
                    ((splitting_tree_51) n_70177))))
          in
          let ct_70206 :=
            ((rwl_2U,L)
              (tree_11 (list_7U,U int))
              (Node_16
                (list_7U,U int) ((splitting_tree_51) m_70176)
                ((splitting_tree_51) n_70177))
              ((splitting_tree_51)
                (cons_11U,U
                  int hd_70160 (cons_11U,U int hd_70161 tl_70162)))
              (fun _70207 : (tree_11 (list_7U,U int)) -> L
              | __70209 => ((ctree_39) (list_7U,U int) __70209))
              __70178 ct_70205)
          in let* c_70210 := ((send __70163) ct_70206) in close c_70210))))

#[program]
def cmsort_54 :
   (xs_70211 : (list_7U,U int)) ->
    IO ((ssing_6U) (list_7U,U int) ((msort_50U) xs_70211))
:=
  (fun cmsort_70212 :
     (xs_70213 : (list_7U,U int)) ->
      IO ((ssing_6U)
           (list_7U,U int) ((msort_50U) xs_70213))
  | xs_70214 =>
    let* c_70215 :=
      fork
        (fun _70216 :
          ch(__70218 :
                 ((ctree_39)
                   (list_7U,U int) ((splitting_tree_51) xs_70214))) 
                  -o
            IO unit_9
        | _70219 => ((splitting_ctree_53) xs_70214 _70219))
    in
    let* _70220 := recv c_70215 in
    (match _70220 in
       (exists1_10L,L
         ((ctree_39) (list_7U,U int) ((splitting_tree_51) xs_70214))
         (fun _70222 :
           ((ctree_39) (list_7U,U int) ((splitting_tree_51) xs_70214)) ->
             L
         | __70224 => hc)) -o
         IO (((fun _70225 : (list_7U,U int) -> U
              | __70227 => ((ssing_6U) (list_7U,U int) __70227)))
              ((msort_50U) xs_70214))
     with
    | (ex1_14 m_70228 n_70229) =>
      let* __70230 := close n_70229 in
      let* _70231 :=
        ((creduce_47)
          (list_7U,U int) (list_7U,U int)
          ((splitting_tree_51) xs_70214)
          (fun _70232 : (list_7U,U int) -> (list_7U,U int)
          | __70234 => __70234)
          (fun _70235 :
            (list_7U,U int) ->
              (list_7U,U int) -> (list_7U,U int)
          | __70238, __70239 => ((merge_49U) __70238 __70239)) m_70228)
      in
      (match _70231 in
         ((tensor_26U,L)
           ((ssing_6U)
             (list_7U,U int)
             ((reduce_35)
               (list_7U,U int) (list_7U,U int)
               (fun _70241 : (list_7U,U int) -> (list_7U,U int)
               | __70243 => __70243)
               (fun _70244 :
                 (list_7U,U int) ->
                   (list_7U,U int) -> (list_7U,U int)
               | __70247, __70248 => ((merge_49U) __70247 __70248))
               ((splitting_tree_51) xs_70214)))
           ((ctree_39) (list_7U,U int) ((splitting_tree_51) xs_70214))) -o
           IO (((fun _70249 : (list_7U,U int) -> U
                | __70251 => ((ssing_6U) (list_7U,U int) __70251)))
                ((msort_50U) xs_70214))
       with
      | (ex1_14 m_70252 n_70253) =>
        let result_70254 :=
          ((rwl_2U,U)
            (list_7U,U int)
            ((reduce_35)
              (list_7U,U int) (list_7U,U int)
              (fun _70255 : (list_7U,U int) -> (list_7U,U int)
              | __70257 => __70257)
              (fun _70258 :
                (list_7U,U int) ->
                  (list_7U,U int) -> (list_7U,U int)
              | __70261, __70262 => ((merge_49U) __70261 __70262))
              ((splitting_tree_51) xs_70214))
            ((msort_50U) xs_70214)
            (fun _70263 : (list_7U,U int) -> U
            | __70265 => ((ssing_6U) (list_7U,U int) __70265))
            ((reduce_splitting_tree_52) xs_70214) m_70252)
        in
        let* __70266 :=
          ((cfree_45)
            (list_7U,U int) ((splitting_tree_51) xs_70214) n_70253)
        in return result_70254)))

#[program]
def mklist_55t_70267 : int -> (list_7U,t_70267 int) :=
  (fun mklist_70269 : int -> (list_7U,t_70267 int)
  | n_70271 =>
    (match (__lte__ n_70271 0) in bool_4 -o (list_7U,t_70267 int) with
    | true_4 => (nil_10U,t_70267 int)
    | false_5 =>
      (cons_11U,t_70267
        int n_70271 ((mklist_70269) (__sub__ n_70271 1)))))

#[program]
def list_len_56t_70273 : (list_7U,t_70273 int) -> int :=
  (fun list_len_70275 : (list_7U,t_70273 int) -> int
  | nil_10 => 0
  | (cons_11 hd_70277 tl_70278) => (__add__ 1 ((list_len_70275) tl_70278)))

#[program]
def print_list_57t_70279 : (list_7U,t_70279 int) -> IO unit_9 :=
  (fun print_list_70281 : (list_7U,t_70279 int) -> IO unit_9
  | nil_10 => print "nil"
  | (cons_11 hd_70283 tl_70284) =>
    let* __70285 := print ((string_of_int_33) hd_70283) in
    let* __70286 := print " :: " in ((print_list_70281) tl_70284))

#[program]
def main_58 : IO unit_9 :=
  let test_70287 := ((mklist_55U) 100) in
  let* _70288 := ((cmsort_54) test_70287) in
  (match _70288 in
     ((ssing_6U) (list_7U,U int) ((msort_50U) test_70287)) -o
       IO unit_9
   with
  | (just_2 m_70290) => ((print_list_57U) m_70290))

[trans1e success]

-----------------------------------------

#[program]
def idU_60 := fun id_197538 (A_197539) -> (m_197540) ->
                m_197540

#[program]
def idL_59 := fun id_197541 (A_197542) -> (m_197543) ->
                m_197543

#[logical]
inductive eqU_14 where
| reflU_21 of layout[]

#[logical]
inductive eqL_13 where
| reflL_20 of layout[]

#[program]
def rwlUU_64 :=
  fun rwl_197544 {A_197545} -> {m_197546} -> {n_197547} -> {B_197548} ->
  {__197549} -> (__197550) ->
    (match {NULL} with
    | reflU_21  => __197550)

#[program]
def rwlUL_63 :=
  fun rwl_197551 {A_197552} -> {m_197553} -> {n_197554} -> {B_197555} ->
  {__197556} -> (__197557) ->
    (match {NULL} with
    | reflU_21  => __197557)

#[program]
def rwlLU_62 :=
  fun rwl_197558 {A_197559} -> {m_197560} -> {n_197561} -> {B_197562} ->
  {__197563} -> (__197564) ->
    (match {NULL} with
    | reflL_20  => __197564)

#[program]
def rwlLL_61 :=
  fun rwl_197565 {A_197566} -> {m_197567} -> {n_197568} -> {B_197569} ->
  {__197570} -> (__197571) ->
    (match {NULL} with
    | reflL_20  => __197571)

#[program]
def rwrUU_68 :=
  fun rwr_197572 {A_197573} -> {m_197574} -> {n_197575} -> {B_197576} ->
  {__197577} -> (__197578) ->
    (match {NULL} with
    | reflU_21  => __197578)

#[program]
def rwrUL_67 :=
  fun rwr_197579 {A_197580} -> {m_197581} -> {n_197582} -> {B_197583} ->
  {__197584} -> (__197585) ->
    (match {NULL} with
    | reflU_21  => __197585)

#[program]
def rwrLU_66 :=
  fun rwr_197586 {A_197587} -> {m_197588} -> {n_197589} -> {B_197590} ->
  {__197591} -> (__197592) ->
    (match {NULL} with
    | reflL_20  => __197592)

#[program]
def rwrLL_65 :=
  fun rwr_197593 {A_197594} -> {m_197595} -> {n_197596} -> {B_197597} ->
  {__197598} -> (__197599) ->
    (match {NULL} with
    | reflL_20  => __197599)

#[logical]
def congrUUU_76 := NULL

#[logical]
def congrUUL_75 := NULL

#[logical]
def congrULU_74 := NULL

#[logical]
def congrULL_73 := NULL

#[logical]
def congrLUU_72 := NULL

#[logical]
def congrLUL_71 := NULL

#[logical]
def congrLLU_70 := NULL

#[logical]
def congrLLL_69 := NULL

#[logical]
def axiom_K_5 := NULL

#[program]
inductive singUU_18 where
| justUU_25 of layout[R]

#[program]
inductive singUL_17 where
| justUL_24 of layout[R]

#[program]
inductive singLU_16 where


#[program]
inductive singLL_15 where
| justLL_22 of layout[R]

#[logical]
def ssingU_78 := NULL

#[logical]
def ssingL_77 := NULL

#[program]
def sing_elimUU_82 :=
  fun sing_elim_197600 {A_197601} -> {x_197602} -> (__197603) ->
    (match __197603 with
    | justUU_25 m_197604 => m_197604)

#[program]
def sing_elimUL_81 :=
  fun sing_elim_197605 {A_197606} -> {x_197607} -> (__197608) ->
    (match __197608 with
    | justUL_24 m_197609 => m_197609)

#[program]
def sing_elimLU_80 :=
  fun sing_elim_197610 {A_197611} -> {x_197612} -> (__197613) ->
    (match __197613 with
    )

#[program]
def sing_elimLL_79 :=
  fun sing_elim_197614 {A_197615} -> {x_197616} -> (__197617) ->
    (match __197617 with
    | justLL_22 m_197618 => m_197618)

#[logical]
def sing_uniqUU_86 := NULL

#[logical]
def sing_uniqUL_85 := NULL

#[logical]
def sing_uniqLU_84 := NULL

#[logical]
def sing_uniqLL_83 := NULL

#[program]
inductive baseU_20 where
| ttU_27 of layout[]

#[program]
inductive baseL_19 where
| ttL_26 of layout[]

#[logical]
def unit_9 := NULL

#[logical]
def unit_eta_10 := NULL

#[program]
inductive bool_4 where
| true_4 of layout[]
| false_5 of layout[]

#[program]
def not_11 :=
  fun not_197619 (__197620) ->
    (match __197620 with
    | true_4  => false_5 | false_5  => true_4)

#[program]
def and_12 :=
  fun and_197621 (__197622) -> (__197623) ->
    (match __197622 with
    | true_4  =>
      (match __197623 with
      | true_4  => true_4 | false_5  => false_5)
    | false_5  => false_5)

#[program]
def or_13 :=
  fun or_197624 (__197625) -> (__197626) ->
    (match __197625 with
    | true_4  => true_4
    | false_5  =>
      (match __197626 with
      | true_4  => true_4 | false_5  => false_5))

#[program]
def xor_14 :=
  fun xor_197627 (__197628) -> (__197629) ->
    (match __197628 with
    | true_4  =>
      (match __197629 with
      | true_4  => false_5 | false_5  => true_4)
    | false_5  =>
      (match __197629 with
      | true_4  => true_4 | false_5  => false_5))

#[program]
def string_of_bool_15 :=
  fun string_of_bool_197630 (__197631) ->
    (match __197631 with
    | true_4  => "true" | false_5  => "false")

#[program]
inductive nat_5 where
| zero_6 of layout[]
| succ_7 of layout[R]

#[program]
def lte_16 :=
  fun lte_197632 (__197633) -> (__197634) ->
    (match __197633 with
    | zero_6  => true_4
    | succ_7 n_197635 =>
      (match __197634 with
      | zero_6  => false_5
      | succ_7 n_197636 => ((lte_197632) n_197635 n_197636)))

#[program]
def lt_17 :=
  fun lt_197637 (x_197638) -> (y_197639) ->
    ((lte_16) (succ_7 x_197638) y_197639)

#[program]
def pred_18 :=
  fun pred_197640 (__197641) ->
    (match __197641 with
    | zero_6  => zero_6 | succ_7 n_197642 => n_197642)

#[program]
def add_19 :=
  fun add_197643 (__197644) -> (__197645) ->
    (match __197644 with
    | zero_6  => __197645
    | succ_7 n_197646 => (succ_7 ((add_197643) n_197646 __197645)))

#[program]
def sub_20 :=
  fun sub_197647 (__197648) -> (__197649) ->
    (match __197649 with
    | zero_6  => __197648
    | succ_7 n_197650 => ((sub_197647) ((pred_18) __197648) n_197650))

#[program]
def mul_21 :=
  fun mul_197651 (__197652) -> (__197653) ->
    (match __197652 with
    | zero_6  => zero_6
    | succ_7 n_197654 => ((add_19) __197653 ((mul_197651) n_197654 __197653)))

#[program]
def div_22 :=
  fun div_197655 (x_197656) -> (y_197657) ->
    (match ((lt_17) x_197656 y_197657) with
    | true_4  => zero_6
    | false_5  =>
      let loop_197658 :=
        fun loop_197659 (x_197660) -> (y_197661) ->
          (match ((sub_20) x_197660 ((pred_18) y_197661)) with
          | zero_6  => zero_6
          | succ_7 n_197662 => (succ_7 ((loop_197659) n_197662 y_197661)))
      in ((loop_197658) x_197656 y_197657))

#[program]
def rem_23 :=
  fun rem_197663 (x_197664) -> (y_197665) ->
    ((sub_20) x_197664 ((mul_21) ((div_22) x_197664 y_197665) y_197665))

#[program]
inductive optionU_22 where
| NoneU_30 of layout[]
| SomeU_31 of layout[R]

#[program]
inductive optionL_21 where
| NoneL_28 of layout[]
| SomeL_29 of layout[R]

#[program]
inductive listUU_26 where
| nilUU_38 of layout[]
| consUU_39 of layout[R, R]

#[program]
inductive listUL_25 where
| nilUL_36 of layout[]
| consUL_37 of layout[R, R]

#[program]
inductive listLU_24 where
| nilLU_34 of layout[]

#[program]
inductive listLL_23 where
| nilLL_32 of layout[]
| consLL_33 of layout[R, R]

#[program]
def rconsUU_90 :=
  fun rcons_197666 {A_197667} -> (__197668) -o (__197669) -o
    (match __197668 with
    | nilUU_38  => (consUU_39 __197669 nilUU_38)
    | consUU_39 hd_197670 tl_197671 =>
      (consUU_39 hd_197670 ((rcons_197666) NULL tl_197671 __197669)))

#[program]
def rconsUL_89 :=
  fun rcons_197672 {A_197673} -> (__197674) -o (__197675) -o
    (match __197674 with
    | nilUL_36  => (consUL_37 __197675 nilUL_36)
    | consUL_37 hd_197676 tl_197677 =>
      (consUL_37 hd_197676 ((rcons_197672) NULL tl_197677 __197675)))

#[program]
def rconsLL_87 :=
  fun rcons_197678 {A_197679} -> (__197680) -o (__197681) -o
    (match __197680 with
    | nilLL_32  => (consLL_33 __197681 nilLL_32)
    | consLL_33 hd_197682 tl_197683 =>
      (consLL_33 hd_197682 ((rcons_197678) NULL tl_197683 __197681)))

#[program]
def free_listUU_94 :=
  fun free_list_197684 {A_197685} -> (f_197686) -> (__197687) ->
    (match __197687 with
    | nilUU_38  => ttU_27
    | consUU_39 hd_197688 tl_197689 =>
      let __197690 := ((f_197686) hd_197688) in
      ((free_list_197684) NULL f_197686 tl_197689))

#[program]
def free_listUL_93 :=
  fun free_list_197691 {A_197692} -> (f_197693) -> (__197694) ->
    (match __197694 with
    | nilUL_36  => ttU_27
    | consUL_37 hd_197695 tl_197696 =>
      let __197697 := ((f_197693) hd_197695) in
      ((free_list_197691) NULL f_197693 tl_197696))

#[program]
def free_listLL_91 :=
  fun free_list_197698 {A_197699} -> (f_197700) -> (__197701) ->
    (match __197701 with
    | nilLL_32  => ttU_27
    | consLL_33 hd_197702 tl_197703 =>
      let __197704 := ((f_197700) hd_197702) in
      ((free_list_197698) NULL f_197700 tl_197703))

#[program]
inductive existsUU_30 where
| exUU_43 of layout[R, N]

#[program]
inductive existsUL_29 where
| exUL_42 of layout[R, N]

#[program]
inductive existsLU_28 where
| exLU_41 of layout[R, N]

#[program]
inductive existsLL_27 where
| exLL_40 of layout[R, N]

#[program]
inductive exists0UU_34 where
| ex0UU_47 of layout[N, R]

#[program]
inductive exists0UL_33 where
| ex0UL_46 of layout[N, R]

#[program]
inductive exists0LU_32 where
| ex0LU_45 of layout[N, R]

#[program]
inductive exists0LL_31 where
| ex0LL_44 of layout[N, R]

#[program]
inductive exists1UU_38 where
| ex1UU_51 of layout[R, R]

#[program]
inductive exists1UL_37 where
| ex1UL_50 of layout[R, R]

#[program]
inductive exists1LU_36 where
| ex1LU_49 of layout[R, R]

#[program]
inductive exists1LL_35 where
| ex1LL_48 of layout[R, R]

#[logical]
def tensorUU_98 := NULL

#[logical]
def tensorUL_97 := NULL

#[logical]
def tensorLU_96 := NULL

#[logical]
def tensorLL_95 := NULL

#[program]
def pow_27 :=
  fun pow_197705 (x_197706) -> (y_197707) ->
    let loop_197708 :=
      fun loop_197709 (acc_197710) -> (y_197711) ->
        (match (__lte__ y_197711 0) with
        | true_4  => acc_197710
        | false_5  =>
          ((loop_197709) (__mul__ x_197706 acc_197710) (__sub__ y_197711 1)))
    in ((loop_197708) 1 y_197707)

#[program]
def powm_28 :=
  fun powm_197712 (x_197713) -> (y_197714) -> (m_197715) ->
    let loop_197716 :=
      fun loop_197717 (acc_197718) -> (y_197719) ->
        (match (__lte__ y_197719 0) with
        | true_4  => acc_197718
        | false_5  =>
          ((loop_197717)
            (__mod__ (__mul__ x_197713 acc_197718) m_197715)
            (__sub__ y_197719 1)))
    in ((loop_197716) 1 y_197714)

#[program]
def ord_29 := fun ord_197720 (c_197721) ->
                (__ord__ c_197721)

#[program]
def chr_30 := fun chr_197722 (i_197723) ->
                (__chr__ i_197723)

#[program]
def str_31 := fun str_197724 (c_197725) ->
                (__push__ "" c_197725)

#[program]
def strlen_32 := fun strlen_197726 (s_197727) ->
                   (__size__ s_197727)

#[program]
def string_of_int_33 :=
  fun string_of_int_197728 (i_197729) ->
    let aux_197730 :=
      fun aux_197731 (i_197732) ->
        (match (__lte__ 10 i_197732) with
        | true_4  =>
          let r_197733 := (__mod__ i_197732 10) in
          let i_197734 := (__div__ i_197732 10) in
          (__push__ ((aux_197731) i_197734)
            ((chr_30) (__add__ r_197733 ((ord_29) 0))))
        | false_5  => ((str_31) ((chr_30) (__add__ i_197732 ((ord_29) 0)))))
    in
    (match (__lte__ 0 i_197729) with
    | true_4  => ((aux_197730) i_197729)
    | false_5  => (__cat__ "~" ((aux_197730) (__neg__ i_197729))))

#[program]
inductive tree_11 where
| Leaf_15 of layout[R]
| Node_16 of layout[R, R]

#[program]
inductive opr_12 where
| Free_17 of layout[]
| Map_18 of layout[N, R]
| Reduce_19 of layout[N, R, R]

#[program]
def map_34 :=
  fun map_197735 {A_197736} -> {B_197737} -> (f_197738) -> (__197739) ->
    (match __197739 with
    | Leaf_15 x_197740 => (Leaf_15 ((f_197738) x_197740))
    | Node_16 l_197741 r_197742 =>
      (Node_16
        ((map_197735) NULL NULL f_197738 l_197741)
        ((map_197735) NULL NULL f_197738 r_197742)))

#[program]
def reduce_35 :=
  fun reduce_197743 {A_197744} -> {B_197745} -> (f_197746) -> (g_197747) ->
  (__197748) ->
    (match __197748 with
    | Leaf_15 x_197749 => ((f_197746) x_197749)
    | Node_16 l_197750 r_197751 =>
      ((g_197747)
        ((reduce_197743) NULL NULL f_197746 g_197747 l_197750)
        ((reduce_197743) NULL NULL f_197746 g_197747 r_197751)))

#[logical]
def tree_p_36 := NULL

#[logical]
def ctree_ch_37 := NULL

#[logical]
def ctree_hc_38 := NULL

#[logical]
def ctree_39 := NULL

#[program]
def leaf_worker_40 :=
  fun leaf_worker_197752 {A_197753} -> (x_197754) -> (c_197755) ->
    let* _197756 := recv[R,L] c_197755 in
    (match _197756 with
    | ex1LL_48 m_197757 n_197758 =>
      (match m_197757 with
      | Free_17  => close[true] n_197758
      | Map_18 B_197759 f_197760 =>
        ((leaf_worker_197752) NULL ((f_197760) x_197754) n_197758)
      | Reduce_19 B_197761 f_197762 g_197763 =>
        let* c_197764 :=
          ((send[R,U] n_197758) (justUU_25 ((f_197762) x_197754)))
        in ((leaf_worker_197752) NULL x_197754 c_197764)))

#[program]
def node_worker_41 :=
  fun node_worker_197765 {A_197766} -> {l_197767} -> {r_197768} ->
  (__197769) -o (__197770) -o (__197771) -o
    let* _197772 := recv[R,L] __197771 in
    (match _197772 with
    | ex1LL_48 m_197773 n_197774 =>
      (match m_197773 with
      | Free_17  =>
        let* l_ch_197775 := ((send[R,L] __197769) Free_17) in
        let* r_ch_197776 := ((send[R,L] __197770) Free_17) in
        let* __197777 := close[false] l_ch_197775 in
        let* __197778 := close[false] r_ch_197776 in close[true] n_197774
      | Map_18 B_197779 f_197780 =>
        let* l_ch_197781 := ((send[R,L] __197769) (Map_18 NULL f_197780)) in
        let* r_ch_197782 := ((send[R,L] __197770) (Map_18 NULL f_197780)) in
        ((node_worker_197765)
          NULL NULL NULL l_ch_197781 r_ch_197782 n_197774)
      | Reduce_19 B_197783 f_197784 g_197785 =>
        let* l_ch_197786 :=
          ((send[R,L] __197769) (Reduce_19 NULL f_197784 g_197785))
        in
        let* r_ch_197787 :=
          ((send[R,L] __197770) (Reduce_19 NULL f_197784 g_197785))
        in
        let* _197788 := recv[R,U] l_ch_197786 in
        (match _197788 with
        | ex1UL_50 m_197789 n_197790 =>
          (match m_197789 with
          | justUU_25 m_197791 =>
            let* _197792 := recv[R,U] r_ch_197787 in
            (match _197792 with
            | ex1UL_50 m_197793 n_197794 =>
              (match m_197793 with
              | justUU_25 m_197795 =>
                let* c_197796 :=
                  ((send[R,U] n_197774)
                    (justUU_25 ((g_197785) m_197791 m_197795)))
                in
                ((node_worker_197765)
                  NULL NULL NULL n_197790 n_197794 c_197796)))))))

#[program]
def cleaf_42 :=
  fun cleaf_197797 {A_197798} -> (x_197799) ->
    fork fun _197800 (_197801) -o
           ((leaf_worker_40) NULL x_197799 _197801)

#[program]
def cnode_43 :=
  fun cnode_197802 {A_197803} -> {l_197804} -> {r_197805} -> (__197806) -o
  (__197807) -o
    let* l_ch_197808 := __197806 in
    let* r_ch_197809 := __197807 in
    fork
      fun _197810 (_197811) -o
        ((node_worker_41) NULL NULL NULL l_ch_197808 r_ch_197809 _197811)

#[program]
def ctree_of_tree_44 :=
  fun ctree_of_tree_197812 {A_197813} -> (t_197814) ->
    (match t_197814 with
    | Leaf_15 x_197815 => ((cleaf_42) NULL x_197815)
    | Node_16 l_197816 r_197817 =>
      ((cnode_43)
        NULL NULL NULL ((ctree_of_tree_197812) NULL l_197816)
        ((ctree_of_tree_197812) NULL r_197817)))

#[program]
def cfree_45 :=
  fun cfree_197818 {A_197819} -> {t_197820} -> (ct_197821) ->
    let* c_197822 := ct_197821 in
    let* c_197823 := ((send[R,L] c_197822) Free_17) in close[false] c_197823

#[program]
def cmap_46 :=
  fun cmap_197824 {A_197825} -> {B_197826} -> {t_197827} -> (f_197828) ->
  (ct_197829) ->
    let* c_197830 := ct_197829 in
    let* c_197831 := ((send[R,L] c_197830) (Map_18 NULL f_197828)) in
    return c_197831

#[program]
def creduce_47 :=
  fun creduce_197832 {A_197833} -> {B_197834} -> {t_197835} -> (f_197836) ->
  (g_197837) -> (ct_197838) ->
    let* c_197839 := ct_197838 in
    let* c_197840 :=
      ((send[R,L] c_197839) (Reduce_19 NULL f_197836 g_197837))
    in
    let* _197841 := recv[R,U] c_197840 in
    (match _197841 with
    | ex1UL_50 m_197842 n_197843 =>
      return (ex1UL_50 m_197842 return n_197843))

#[program]
def splitU_100 :=
  fun split_197844 (__197845) ->
    (match __197845 with
    | nilUU_38  => (ex1UU_51 nilUU_38 nilUU_38)
    | consUU_39 hd_197846 tl_197847 =>
      (match tl_197847 with
      | nilUU_38  => (ex1UU_51 (consUU_39 hd_197846 nilUU_38) nilUU_38)
      | consUU_39 hd_197848 tl_197849 =>
        (match ((split_197844) tl_197849) with
        | ex1UU_51 m_197850 n_197851 =>
          (ex1UU_51
            (consUU_39 hd_197846 m_197850) (consUU_39 hd_197848 n_197851)))))

#[program]
def splitL_99 :=
  fun split_197852 (__197853) ->
    (match __197853 with
    | nilUL_36  => (ex1LL_48 nilUL_36 nilUL_36)
    | consUL_37 hd_197854 tl_197855 =>
      (match tl_197855 with
      | nilUL_36  => (ex1LL_48 (consUL_37 hd_197854 nilUL_36) nilUL_36)
      | consUL_37 hd_197856 tl_197857 =>
        (match ((split_197852) tl_197857) with
        | ex1LL_48 m_197858 n_197859 =>
          (ex1LL_48
            (consUL_37 hd_197854 m_197858) (consUL_37 hd_197856 n_197859)))))

#[program]
def mergeU_102 :=
  fun merge_197860 (__197861) -> (__197862) -o
    (match __197861 with
    | nilUU_38  => __197862
    | consUU_39 hd_197863 tl_197864 =>
      (match __197862 with
      | nilUU_38  => (consUU_39 hd_197863 tl_197864)
      | consUU_39 hd_197865 tl_197866 =>
        (match (__lte__ hd_197863 hd_197865) with
        | true_4  =>
          (consUU_39
            hd_197863
            ((merge_197860) tl_197864 (consUU_39 hd_197865 tl_197866)))
        | false_5  =>
          (consUU_39
            hd_197865
            ((merge_197860) (consUU_39 hd_197863 tl_197864) tl_197866)))))

#[program]
def mergeL_101 :=
  fun merge_197867 (__197868) -> (__197869) -o
    (match __197868 with
    | nilUL_36  => __197869
    | consUL_37 hd_197870 tl_197871 =>
      (match __197869 with
      | nilUL_36  => (consUL_37 hd_197870 tl_197871)
      | consUL_37 hd_197872 tl_197873 =>
        (match (__lte__ hd_197870 hd_197872) with
        | true_4  =>
          (consUL_37
            hd_197870
            ((merge_197867) tl_197871 (consUL_37 hd_197872 tl_197873)))
        | false_5  =>
          (consUL_37
            hd_197872
            ((merge_197867) (consUL_37 hd_197870 tl_197871) tl_197873)))))

#[program]
def msortU_104 :=
  fun msort_197874 (__197875) ->
    (match __197875 with
    | nilUU_38  => nilUU_38
    | consUU_39 hd_197876 tl_197877 =>
      (match tl_197877 with
      | nilUU_38  => (consUU_39 hd_197876 nilUU_38)
      | consUU_39 hd_197878 tl_197879 =>
        (match ((splitU_100)
                 (consUU_39 hd_197876 (consUU_39 hd_197878 tl_197879))) with
        | ex1UU_51 m_197880 n_197881 =>
          ((mergeU_102) ((msort_197874) m_197880) ((msort_197874) n_197881)))))

#[program]
def msortL_103 :=
  fun msort_197882 (__197883) ->
    (match __197883 with
    | nilUL_36  => nilUL_36
    | consUL_37 hd_197884 tl_197885 =>
      (match tl_197885 with
      | nilUL_36  => (consUL_37 hd_197884 nilUL_36)
      | consUL_37 hd_197886 tl_197887 =>
        (match ((splitL_99)
                 (consUL_37 hd_197884 (consUL_37 hd_197886 tl_197887))) with
        | ex1LL_48 m_197888 n_197889 =>
          ((mergeL_101) ((msort_197882) m_197888) ((msort_197882) n_197889)))))

#[program]
def splitting_tree_51 :=
  fun splitting_tree_197890 (__197891) ->
    (match __197891 with
    | nilUU_38  => (Leaf_15 nilUU_38)
    | consUU_39 hd_197892 tl_197893 =>
      (match tl_197893 with
      | nilUU_38  => (Leaf_15 (consUU_39 hd_197892 nilUU_38))
      | consUU_39 hd_197894 tl_197895 =>
        (match ((splitU_100)
                 (consUU_39 hd_197892 (consUU_39 hd_197894 tl_197895))) with
        | ex1UU_51 m_197896 n_197897 =>
          let l_197898 := ((splitting_tree_197890) m_197896) in
          let r_197899 := ((splitting_tree_197890) n_197897) in
          (Node_16 l_197898 r_197899))))

#[logical]
def reduce_splitting_tree_52 := NULL

#[program]
def splitting_ctree_53 :=
  fun splitting_ctree_197900 (xs_197901) -> (__197902) ->
    (match xs_197901 with
    | nilUU_38  =>
      let* c_197903 := ((send[R,L] __197902) ((cleaf_42) NULL nilUU_38)) in
      let* __197904 := close[true] c_197903 in return ttU_27
    | consUU_39 hd_197905 tl_197906 =>
      (match tl_197906 with
      | nilUU_38  =>
        let* c_197907 :=
          ((send[R,L] __197902)
            ((cleaf_42) NULL (consUU_39 hd_197905 nilUU_38)))
        in let* __197908 := close[true] c_197907 in return ttU_27
      | consUU_39 hd_197909 tl_197910 =>
        (match ((splitU_100)
                 (consUU_39 hd_197905 (consUU_39 hd_197909 tl_197910))) with
        | ex1UU_51 m_197911 n_197912 =>
          let* cl_197913 :=
            fork
              fun _197914 (_197915) -o
                ((splitting_ctree_197900) m_197911 _197915)
          in
          let* cr_197916 :=
            fork
              fun _197917 (_197918) -o
                ((splitting_ctree_197900) n_197912 _197918)
          in
          let* _197919 := recv[R,L] cl_197913 in
          (match _197919 with
          | ex1LL_48 m_197920 n_197921 =>
            let* __197922 := close[false] n_197921 in
            let* _197923 := recv[R,L] cr_197916 in
            (match _197923 with
            | ex1LL_48 m_197924 n_197925 =>
              let* __197926 := close[false] n_197925 in
              let ct_197927 := ((cnode_43) NULL NULL NULL m_197920 m_197924)
              in
              let ct_197928 :=
                ((rwlUL_63) NULL NULL NULL NULL NULL ct_197927)
              in
              let* c_197929 := ((send[R,L] __197902) ct_197928) in
              close[true] c_197929)))))

#[program]
def cmsort_54 :=
  fun cmsort_197930 (xs_197931) ->
    let* c_197932 :=
      fork fun _197933 (_197934) -o
             ((splitting_ctree_53) xs_197931 _197934)
    in
    let* _197935 := recv[R,L] c_197932 in
    (match _197935 with
    | ex1LL_48 m_197936 n_197937 =>
      let* __197938 := close[false] n_197937 in
      let* _197939 :=
        ((creduce_47)
          NULL NULL NULL fun _197940 (x_197941) ->
                           x_197941
          fun _197942 (l_197943) -> (r_197944) ->
            ((mergeU_102) l_197943 r_197944)
          m_197936)
      in
      (match _197939 with
      | ex1UL_50 m_197945 n_197946 =>
        let result_197947 := ((rwlUU_64) NULL NULL NULL NULL NULL m_197945)
        in
        let* __197948 := ((cfree_45) NULL NULL n_197946) in
        return result_197947))

#[program]
def mklistU_106 :=
  fun mklist_197949 (n_197950) ->
    (match (__lte__ n_197950 0) with
    | true_4  => nilUU_38
    | false_5  => (consUU_39 n_197950 ((mklist_197949) (__sub__ n_197950 1))))

#[program]
def mklistL_105 :=
  fun mklist_197951 (n_197952) ->
    (match (__lte__ n_197952 0) with
    | true_4  => nilUL_36
    | false_5  => (consUL_37 n_197952 ((mklist_197951) (__sub__ n_197952 1))))

#[program]
def list_lenU_108 :=
  fun list_len_197953 (__197954) ->
    (match __197954 with
    | nilUU_38  => 0
    | consUU_39 hd_197955 tl_197956 =>
      (__add__ 1 ((list_len_197953) tl_197956)))

#[program]
def list_lenL_107 :=
  fun list_len_197957 (__197958) ->
    (match __197958 with
    | nilUL_36  => 0
    | consUL_37 hd_197959 tl_197960 =>
      (__add__ 1 ((list_len_197957) tl_197960)))

#[program]
def print_listU_110 :=
  fun print_list_197961 (__197962) ->
    (match __197962 with
    | nilUU_38  => print "nil"
    | consUU_39 hd_197963 tl_197964 =>
      let* __197965 := print ((string_of_int_33) hd_197963) in
      let* __197966 := print " :: " in ((print_list_197961) tl_197964))

#[program]
def print_listL_109 :=
  fun print_list_197967 (__197968) ->
    (match __197968 with
    | nilUL_36  => print "nil"
    | consUL_37 hd_197969 tl_197970 =>
      let* __197971 := print ((string_of_int_33) hd_197969) in
      let* __197972 := print " :: " in ((print_list_197967) tl_197970))

#[program]
def main :=
  let test_197973 := ((mklistU_106) 100) in
  let* _197974 := ((cmsort_54) test_197973) in
  (match _197974 with
  | justUU_25 m_197975 => ((print_listU_110) m_197975))

[trans12 success]

-----------------------------------------

#[program]
def idU_60 := fun id_198414 (A_198415) -> (m_198416) ->
                m_198416

#[program]
def idL_59 := fun id_198417 (A_198418) -> (m_198419) ->
                m_198419

#[logical]
inductive eqU_14 where
| reflU_21 of layout[]

#[logical]
inductive eqL_13 where
| reflL_20 of layout[]

#[program]
def rwlUU_64 :=
  fun rwl_198420 {A_198421} -> {m_198422} -> {n_198423} -> {B_198424} ->
  {__198425} -> (__198426) ->
    __198426

#[program]
def rwlUL_63 :=
  fun rwl_198427 {A_198428} -> {m_198429} -> {n_198430} -> {B_198431} ->
  {__198432} -> (__198433) ->
    __198433

#[program]
def rwlLU_62 :=
  fun rwl_198434 {A_198435} -> {m_198436} -> {n_198437} -> {B_198438} ->
  {__198439} -> (__198440) ->
    __198440

#[program]
def rwlLL_61 :=
  fun rwl_198441 {A_198442} -> {m_198443} -> {n_198444} -> {B_198445} ->
  {__198446} -> (__198447) ->
    __198447

#[program]
def rwrUU_68 :=
  fun rwr_198448 {A_198449} -> {m_198450} -> {n_198451} -> {B_198452} ->
  {__198453} -> (__198454) ->
    __198454

#[program]
def rwrUL_67 :=
  fun rwr_198455 {A_198456} -> {m_198457} -> {n_198458} -> {B_198459} ->
  {__198460} -> (__198461) ->
    __198461

#[program]
def rwrLU_66 :=
  fun rwr_198462 {A_198463} -> {m_198464} -> {n_198465} -> {B_198466} ->
  {__198467} -> (__198468) ->
    __198468

#[program]
def rwrLL_65 :=
  fun rwr_198469 {A_198470} -> {m_198471} -> {n_198472} -> {B_198473} ->
  {__198474} -> (__198475) ->
    __198475

#[logical]
def congrUUU_76 := NULL

#[logical]
def congrUUL_75 := NULL

#[logical]
def congrULU_74 := NULL

#[logical]
def congrULL_73 := NULL

#[logical]
def congrLUU_72 := NULL

#[logical]
def congrLUL_71 := NULL

#[logical]
def congrLLU_70 := NULL

#[logical]
def congrLLL_69 := NULL

#[logical]
def axiom_K_5 := NULL

#[program]
inductive singUU_18 where
| justUU_25 of layout[R]

#[program]
inductive singUL_17 where
| justUL_24 of layout[R]

#[program]
inductive singLU_16 where


#[program]
inductive singLL_15 where
| justLL_22 of layout[R]

#[logical]
def ssingU_78 := NULL

#[logical]
def ssingL_77 := NULL

#[program]
def sing_elimUU_82 :=
  fun sing_elim_198476 {A_198477} -> {x_198478} -> (__198479) ->
    (match __198479 with
    | justUU_25 m_198480 => m_198480)

#[program]
def sing_elimUL_81 :=
  fun sing_elim_198481 {A_198482} -> {x_198483} -> (__198484) ->
    (match __198484 with
    | justUL_24 m_198485 => m_198485)

#[program]
def sing_elimLU_80 :=
  fun sing_elim_198486 {A_198487} -> {x_198488} -> (__198489) ->
    !!

#[program]
def sing_elimLL_79 :=
  fun sing_elim_198490 {A_198491} -> {x_198492} -> (__198493) ->
    (match __198493 with
    | justLL_22 m_198494 => m_198494)

#[logical]
def sing_uniqUU_86 := NULL

#[logical]
def sing_uniqUL_85 := NULL

#[logical]
def sing_uniqLU_84 := NULL

#[logical]
def sing_uniqLL_83 := NULL

#[program]
inductive baseU_20 where
| ttU_27 of layout[]

#[program]
inductive baseL_19 where
| ttL_26 of layout[]

#[logical]
def unit_9 := NULL

#[logical]
def unit_eta_10 := NULL

#[program]
inductive bool_4 where
| true_4 of layout[]
| false_5 of layout[]

#[program]
def not_11 :=
  fun not_198495 (__198496) ->
    (match __198496 with
    | true_4  => false_5 | false_5  => true_4)

#[program]
def and_12 :=
  fun and_198497 (__198498) -> (__198499) ->
    (match __198498 with
    | true_4  =>
      (match __198499 with
      | true_4  => true_4 | false_5  => false_5)
    | false_5  => false_5)

#[program]
def or_13 :=
  fun or_198500 (__198501) -> (__198502) ->
    (match __198501 with
    | true_4  => true_4
    | false_5  =>
      (match __198502 with
      | true_4  => true_4 | false_5  => false_5))

#[program]
def xor_14 :=
  fun xor_198503 (__198504) -> (__198505) ->
    (match __198504 with
    | true_4  =>
      (match __198505 with
      | true_4  => false_5 | false_5  => true_4)
    | false_5  =>
      (match __198505 with
      | true_4  => true_4 | false_5  => false_5))

#[program]
def string_of_bool_15 :=
  fun string_of_bool_198506 (__198507) ->
    (match __198507 with
    | true_4  => "true" | false_5  => "false")

#[program]
inductive nat_5 where
| zero_6 of layout[]
| succ_7 of layout[R]

#[program]
def lte_16 :=
  fun lte_198508 (__198509) -> (__198510) ->
    (match __198509 with
    | zero_6  => true_4
    | succ_7 n_198511 =>
      (match __198510 with
      | zero_6  => false_5
      | succ_7 n_198512 => ((lte_198508) n_198511 n_198512)))

#[program]
def lt_17 :=
  fun lt_198513 (x_198514) -> (y_198515) ->
    ((lte_16) (succ_7 x_198514) y_198515)

#[program]
def pred_18 :=
  fun pred_198516 (__198517) ->
    (match __198517 with
    | zero_6  => zero_6 | succ_7 n_198518 => n_198518)

#[program]
def add_19 :=
  fun add_198519 (__198520) -> (__198521) ->
    (match __198520 with
    | zero_6  => __198521
    | succ_7 n_198522 => (succ_7 ((add_198519) n_198522 __198521)))

#[program]
def sub_20 :=
  fun sub_198523 (__198524) -> (__198525) ->
    (match __198525 with
    | zero_6  => __198524
    | succ_7 n_198526 => ((sub_198523) ((pred_18) __198524) n_198526))

#[program]
def mul_21 :=
  fun mul_198527 (__198528) -> (__198529) ->
    (match __198528 with
    | zero_6  => zero_6
    | succ_7 n_198530 => ((add_19) __198529 ((mul_198527) n_198530 __198529)))

#[program]
def div_22 :=
  fun div_198531 (x_198532) -> (y_198533) ->
    (match ((lt_17) x_198532 y_198533) with
    | true_4  => zero_6
    | false_5  =>
      let loop_198534 :=
        fun loop_198535 (x_198536) -> (y_198537) ->
          (match ((sub_20) x_198536 ((pred_18) y_198537)) with
          | zero_6  => zero_6
          | succ_7 n_198538 => (succ_7 ((loop_198535) n_198538 y_198537)))
      in ((loop_198534) x_198532 y_198533))

#[program]
def rem_23 :=
  fun rem_198539 (x_198540) -> (y_198541) ->
    ((sub_20) x_198540 ((mul_21) ((div_22) x_198540 y_198541) y_198541))

#[program]
inductive optionU_22 where
| NoneU_30 of layout[]
| SomeU_31 of layout[R]

#[program]
inductive optionL_21 where
| NoneL_28 of layout[]
| SomeL_29 of layout[R]

#[program]
inductive listUU_26 where
| nilUU_38 of layout[]
| consUU_39 of layout[R, R]

#[program]
inductive listUL_25 where
| nilUL_36 of layout[]
| consUL_37 of layout[R, R]

#[program]
inductive listLU_24 where
| nilLU_34 of layout[]

#[program]
inductive listLL_23 where
| nilLL_32 of layout[]
| consLL_33 of layout[R, R]

#[program]
def rconsUU_90 :=
  fun rcons_198542 {A_198543} -> (__198544) -o (__198545) -o
    (match __198544 with
    | nilUU_38  => (consUU_39 __198545 nilUU_38)
    | consUU_39 hd_198546 tl_198547 =>
      (consUU_39 hd_198546 ((rcons_198542) NULL tl_198547 __198545)))

#[program]
def rconsUL_89 :=
  fun rcons_198548 {A_198549} -> (__198550) -o (__198551) -o
    (match __198550 with
    | nilUL_36  => (consUL_37 __198551 nilUL_36)
    | consUL_37 hd_198552 tl_198553 =>
      (consUL_37 hd_198552 ((rcons_198548) NULL tl_198553 __198551)))

#[program]
def rconsLL_87 :=
  fun rcons_198554 {A_198555} -> (__198556) -o (__198557) -o
    (match __198556 with
    | nilLL_32  => (consLL_33 __198557 nilLL_32)
    | consLL_33 hd_198558 tl_198559 =>
      (consLL_33 hd_198558 ((rcons_198554) NULL tl_198559 __198557)))

#[program]
def free_listUU_94 :=
  fun free_list_198560 {A_198561} -> (f_198562) -> (__198563) ->
    (match __198563 with
    | nilUU_38  => ttU_27
    | consUU_39 hd_198564 tl_198565 =>
      let __198566 := ((f_198562) hd_198564) in
      ((free_list_198560) NULL f_198562 tl_198565))

#[program]
def free_listUL_93 :=
  fun free_list_198567 {A_198568} -> (f_198569) -> (__198570) ->
    (match __198570 with
    | nilUL_36  => ttU_27
    | consUL_37 hd_198571 tl_198572 =>
      let __198573 := ((f_198569) hd_198571) in
      ((free_list_198567) NULL f_198569 tl_198572))

#[program]
def free_listLL_91 :=
  fun free_list_198574 {A_198575} -> (f_198576) -> (__198577) ->
    (match __198577 with
    | nilLL_32  => ttU_27
    | consLL_33 hd_198578 tl_198579 =>
      let __198580 := ((f_198576) hd_198578) in
      ((free_list_198574) NULL f_198576 tl_198579))

#[program]
inductive existsUU_30 where
| exUU_43 of layout[R, N]

#[program]
inductive existsUL_29 where
| exUL_42 of layout[R, N]

#[program]
inductive existsLU_28 where
| exLU_41 of layout[R, N]

#[program]
inductive existsLL_27 where
| exLL_40 of layout[R, N]

#[program]
inductive exists0UU_34 where
| ex0UU_47 of layout[N, R]

#[program]
inductive exists0UL_33 where
| ex0UL_46 of layout[N, R]

#[program]
inductive exists0LU_32 where
| ex0LU_45 of layout[N, R]

#[program]
inductive exists0LL_31 where
| ex0LL_44 of layout[N, R]

#[program]
inductive exists1UU_38 where
| ex1UU_51 of layout[R, R]

#[program]
inductive exists1UL_37 where
| ex1UL_50 of layout[R, R]

#[program]
inductive exists1LU_36 where
| ex1LU_49 of layout[R, R]

#[program]
inductive exists1LL_35 where
| ex1LL_48 of layout[R, R]

#[logical]
def tensorUU_98 := NULL

#[logical]
def tensorUL_97 := NULL

#[logical]
def tensorLU_96 := NULL

#[logical]
def tensorLL_95 := NULL

#[program]
def pow_27 :=
  fun pow_198581 (x_198582) -> (y_198583) ->
    let loop_198584 :=
      fun loop_198585 (acc_198586) -> (y_198587) ->
        (match (__lte__ y_198587 0) with
        | true_4  => acc_198586
        | false_5  =>
          ((loop_198585) (__mul__ x_198582 acc_198586) (__sub__ y_198587 1)))
    in ((loop_198584) 1 y_198583)

#[program]
def powm_28 :=
  fun powm_198588 (x_198589) -> (y_198590) -> (m_198591) ->
    let loop_198592 :=
      fun loop_198593 (acc_198594) -> (y_198595) ->
        (match (__lte__ y_198595 0) with
        | true_4  => acc_198594
        | false_5  =>
          ((loop_198593)
            (__mod__ (__mul__ x_198589 acc_198594) m_198591)
            (__sub__ y_198595 1)))
    in ((loop_198592) 1 y_198590)

#[program]
def ord_29 := fun ord_198596 (c_198597) ->
                (__ord__ c_198597)

#[program]
def chr_30 := fun chr_198598 (i_198599) ->
                (__chr__ i_198599)

#[program]
def str_31 := fun str_198600 (c_198601) ->
                (__push__ "" c_198601)

#[program]
def strlen_32 := fun strlen_198602 (s_198603) ->
                   (__size__ s_198603)

#[program]
def string_of_int_33 :=
  fun string_of_int_198604 (i_198605) ->
    let aux_198606 :=
      fun aux_198607 (i_198608) ->
        (match (__lte__ 10 i_198608) with
        | true_4  =>
          let r_198609 := (__mod__ i_198608 10) in
          let i_198610 := (__div__ i_198608 10) in
          (__push__ ((aux_198607) i_198610)
            ((chr_30) (__add__ r_198609 ((ord_29) 0))))
        | false_5  => ((str_31) ((chr_30) (__add__ i_198608 ((ord_29) 0)))))
    in
    (match (__lte__ 0 i_198605) with
    | true_4  => ((aux_198606) i_198605)
    | false_5  => (__cat__ "~" ((aux_198606) (__neg__ i_198605))))

#[program]
inductive tree_11 where
| Leaf_15 of layout[R]
| Node_16 of layout[R, R]

#[program]
inductive opr_12 where
| Free_17 of layout[]
| Map_18 of layout[N, R]
| Reduce_19 of layout[N, R, R]

#[program]
def map_34 :=
  fun map_198611 {A_198612} -> {B_198613} -> (f_198614) -> (__198615) ->
    (match __198615 with
    | Leaf_15 x_198616 => (Leaf_15 ((f_198614) x_198616))
    | Node_16 l_198617 r_198618 =>
      (Node_16
        ((map_198611) NULL NULL f_198614 l_198617)
        ((map_198611) NULL NULL f_198614 r_198618)))

#[program]
def reduce_35 :=
  fun reduce_198619 {A_198620} -> {B_198621} -> (f_198622) -> (g_198623) ->
  (__198624) ->
    (match __198624 with
    | Leaf_15 x_198625 => ((f_198622) x_198625)
    | Node_16 l_198626 r_198627 =>
      ((g_198623)
        ((reduce_198619) NULL NULL f_198622 g_198623 l_198626)
        ((reduce_198619) NULL NULL f_198622 g_198623 r_198627)))

#[logical]
def tree_p_36 := NULL

#[logical]
def ctree_ch_37 := NULL

#[logical]
def ctree_hc_38 := NULL

#[logical]
def ctree_39 := NULL

#[program]
def leaf_worker_40 :=
  fun leaf_worker_198628 {A_198629} -> (x_198630) -> (c_198631) ->
    let* _198632 := recv[R,L] c_198631 in
    (match _198632 with
    | ex1LL_48 m_198633 n_198634 =>
      (match m_198633 with
      | Free_17  => close[true] n_198634
      | Map_18 B_198635 f_198636 =>
        ((leaf_worker_198628) NULL ((f_198636) x_198630) n_198634)
      | Reduce_19 B_198637 f_198638 g_198639 =>
        let* c_198640 :=
          ((send[R,U] n_198634) (justUU_25 ((f_198638) x_198630)))
        in ((leaf_worker_198628) NULL x_198630 c_198640)))

#[program]
def node_worker_41 :=
  fun node_worker_198641 {A_198642} -> {l_198643} -> {r_198644} ->
  (__198645) -o (__198646) -o (__198647) -o
    let* _198648 := recv[R,L] __198647 in
    (match _198648 with
    | ex1LL_48 m_198649 n_198650 =>
      (match m_198649 with
      | Free_17  =>
        let* l_ch_198651 := ((send[R,L] __198645) Free_17) in
        let* r_ch_198652 := ((send[R,L] __198646) Free_17) in
        let* __198653 := close[false] l_ch_198651 in
        let* __198654 := close[false] r_ch_198652 in close[true] n_198650
      | Map_18 B_198655 f_198656 =>
        let* l_ch_198657 := ((send[R,L] __198645) (Map_18 NULL f_198656)) in
        let* r_ch_198658 := ((send[R,L] __198646) (Map_18 NULL f_198656)) in
        ((node_worker_198641)
          NULL NULL NULL l_ch_198657 r_ch_198658 n_198650)
      | Reduce_19 B_198659 f_198660 g_198661 =>
        let* l_ch_198662 :=
          ((send[R,L] __198645) (Reduce_19 NULL f_198660 g_198661))
        in
        let* r_ch_198663 :=
          ((send[R,L] __198646) (Reduce_19 NULL f_198660 g_198661))
        in
        let* _198664 := recv[R,U] l_ch_198662 in
        (match _198664 with
        | ex1UL_50 m_198665 n_198666 =>
          (match m_198665 with
          | justUU_25 m_198667 =>
            let* _198668 := recv[R,U] r_ch_198663 in
            (match _198668 with
            | ex1UL_50 m_198669 n_198670 =>
              (match m_198669 with
              | justUU_25 m_198671 =>
                let* c_198672 :=
                  ((send[R,U] n_198650)
                    (justUU_25 ((g_198661) m_198667 m_198671)))
                in
                ((node_worker_198641)
                  NULL NULL NULL n_198666 n_198670 c_198672)))))))

#[program]
def cleaf_42 :=
  fun cleaf_198673 {A_198674} -> (x_198675) ->
    fork fun _198676 (_198677) -o
           ((leaf_worker_40) NULL x_198675 _198677)

#[program]
def cnode_43 :=
  fun cnode_198678 {A_198679} -> {l_198680} -> {r_198681} -> (__198682) -o
  (__198683) -o
    let* l_ch_198684 := __198682 in
    let* r_ch_198685 := __198683 in
    fork
      fun _198686 (_198687) -o
        ((node_worker_41) NULL NULL NULL l_ch_198684 r_ch_198685 _198687)

#[program]
def ctree_of_tree_44 :=
  fun ctree_of_tree_198688 {A_198689} -> (t_198690) ->
    (match t_198690 with
    | Leaf_15 x_198691 => ((cleaf_42) NULL x_198691)
    | Node_16 l_198692 r_198693 =>
      ((cnode_43)
        NULL NULL NULL ((ctree_of_tree_198688) NULL l_198692)
        ((ctree_of_tree_198688) NULL r_198693)))

#[program]
def cfree_45 :=
  fun cfree_198694 {A_198695} -> {t_198696} -> (ct_198697) ->
    let* c_198698 := ct_198697 in
    let* c_198699 := ((send[R,L] c_198698) Free_17) in close[false] c_198699

#[program]
def cmap_46 :=
  fun cmap_198700 {A_198701} -> {B_198702} -> {t_198703} -> (f_198704) ->
  (ct_198705) ->
    let* c_198706 := ct_198705 in
    let* c_198707 := ((send[R,L] c_198706) (Map_18 NULL f_198704)) in
    return c_198707

#[program]
def creduce_47 :=
  fun creduce_198708 {A_198709} -> {B_198710} -> {t_198711} -> (f_198712) ->
  (g_198713) -> (ct_198714) ->
    let* c_198715 := ct_198714 in
    let* c_198716 :=
      ((send[R,L] c_198715) (Reduce_19 NULL f_198712 g_198713))
    in
    let* _198717 := recv[R,U] c_198716 in
    (match _198717 with
    | ex1UL_50 m_198718 n_198719 =>
      return (ex1UL_50 m_198718 return n_198719))

#[program]
def splitU_100 :=
  fun split_198720 (__198721) ->
    (match __198721 with
    | nilUU_38  => (ex1UU_51 nilUU_38 nilUU_38)
    | consUU_39 hd_198722 tl_198723 =>
      (match tl_198723 with
      | nilUU_38  => (ex1UU_51 (consUU_39 hd_198722 nilUU_38) nilUU_38)
      | consUU_39 hd_198724 tl_198725 =>
        (match ((split_198720) tl_198725) with
        | ex1UU_51 m_198726 n_198727 =>
          (ex1UU_51
            (consUU_39 hd_198722 m_198726) (consUU_39 hd_198724 n_198727)))))

#[program]
def splitL_99 :=
  fun split_198728 (__198729) ->
    (match __198729 with
    | nilUL_36  => (ex1LL_48 nilUL_36 nilUL_36)
    | consUL_37 hd_198730 tl_198731 =>
      (match tl_198731 with
      | nilUL_36  => (ex1LL_48 (consUL_37 hd_198730 nilUL_36) nilUL_36)
      | consUL_37 hd_198732 tl_198733 =>
        (match ((split_198728) tl_198733) with
        | ex1LL_48 m_198734 n_198735 =>
          (ex1LL_48
            (consUL_37 hd_198730 m_198734) (consUL_37 hd_198732 n_198735)))))

#[program]
def mergeU_102 :=
  fun merge_198736 (__198737) -> (__198738) -o
    (match __198737 with
    | nilUU_38  => __198738
    | consUU_39 hd_198739 tl_198740 =>
      (match __198738 with
      | nilUU_38  => (consUU_39 hd_198739 tl_198740)
      | consUU_39 hd_198741 tl_198742 =>
        (match (__lte__ hd_198739 hd_198741) with
        | true_4  =>
          (consUU_39
            hd_198739
            ((merge_198736) tl_198740 (consUU_39 hd_198741 tl_198742)))
        | false_5  =>
          (consUU_39
            hd_198741
            ((merge_198736) (consUU_39 hd_198739 tl_198740) tl_198742)))))

#[program]
def mergeL_101 :=
  fun merge_198743 (__198744) -> (__198745) -o
    (match __198744 with
    | nilUL_36  => __198745
    | consUL_37 hd_198746 tl_198747 =>
      (match __198745 with
      | nilUL_36  => (consUL_37 hd_198746 tl_198747)
      | consUL_37 hd_198748 tl_198749 =>
        (match (__lte__ hd_198746 hd_198748) with
        | true_4  =>
          (consUL_37
            hd_198746
            ((merge_198743) tl_198747 (consUL_37 hd_198748 tl_198749)))
        | false_5  =>
          (consUL_37
            hd_198748
            ((merge_198743) (consUL_37 hd_198746 tl_198747) tl_198749)))))

#[program]
def msortU_104 :=
  fun msort_198750 (__198751) ->
    (match __198751 with
    | nilUU_38  => nilUU_38
    | consUU_39 hd_198752 tl_198753 =>
      (match tl_198753 with
      | nilUU_38  => (consUU_39 hd_198752 nilUU_38)
      | consUU_39 hd_198754 tl_198755 =>
        (match ((splitU_100)
                 (consUU_39 hd_198752 (consUU_39 hd_198754 tl_198755))) with
        | ex1UU_51 m_198756 n_198757 =>
          ((mergeU_102) ((msort_198750) m_198756) ((msort_198750) n_198757)))))

#[program]
def msortL_103 :=
  fun msort_198758 (__198759) ->
    (match __198759 with
    | nilUL_36  => nilUL_36
    | consUL_37 hd_198760 tl_198761 =>
      (match tl_198761 with
      | nilUL_36  => (consUL_37 hd_198760 nilUL_36)
      | consUL_37 hd_198762 tl_198763 =>
        (match ((splitL_99)
                 (consUL_37 hd_198760 (consUL_37 hd_198762 tl_198763))) with
        | ex1LL_48 m_198764 n_198765 =>
          ((mergeL_101) ((msort_198758) m_198764) ((msort_198758) n_198765)))))

#[program]
def splitting_tree_51 :=
  fun splitting_tree_198766 (__198767) ->
    (match __198767 with
    | nilUU_38  => (Leaf_15 nilUU_38)
    | consUU_39 hd_198768 tl_198769 =>
      (match tl_198769 with
      | nilUU_38  => (Leaf_15 (consUU_39 hd_198768 nilUU_38))
      | consUU_39 hd_198770 tl_198771 =>
        (match ((splitU_100)
                 (consUU_39 hd_198768 (consUU_39 hd_198770 tl_198771))) with
        | ex1UU_51 m_198772 n_198773 =>
          let l_198774 := ((splitting_tree_198766) m_198772) in
          let r_198775 := ((splitting_tree_198766) n_198773) in
          (Node_16 l_198774 r_198775))))

#[logical]
def reduce_splitting_tree_52 := NULL

#[program]
def splitting_ctree_53 :=
  fun splitting_ctree_198776 (xs_198777) -> (__198778) ->
    (match xs_198777 with
    | nilUU_38  =>
      let* c_198779 := ((send[R,L] __198778) ((cleaf_42) NULL nilUU_38)) in
      let* __198780 := close[true] c_198779 in return ttU_27
    | consUU_39 hd_198781 tl_198782 =>
      (match tl_198782 with
      | nilUU_38  =>
        let* c_198783 :=
          ((send[R,L] __198778)
            ((cleaf_42) NULL (consUU_39 hd_198781 nilUU_38)))
        in let* __198784 := close[true] c_198783 in return ttU_27
      | consUU_39 hd_198785 tl_198786 =>
        (match ((splitU_100)
                 (consUU_39 hd_198781 (consUU_39 hd_198785 tl_198786))) with
        | ex1UU_51 m_198787 n_198788 =>
          let* cl_198789 :=
            fork
              fun _198790 (_198791) -o
                ((splitting_ctree_198776) m_198787 _198791)
          in
          let* cr_198792 :=
            fork
              fun _198793 (_198794) -o
                ((splitting_ctree_198776) n_198788 _198794)
          in
          let* _198795 := recv[R,L] cl_198789 in
          (match _198795 with
          | ex1LL_48 m_198796 n_198797 =>
            let* __198798 := close[false] n_198797 in
            let* _198799 := recv[R,L] cr_198792 in
            (match _198799 with
            | ex1LL_48 m_198800 n_198801 =>
              let* __198802 := close[false] n_198801 in
              let ct_198803 := ((cnode_43) NULL NULL NULL m_198796 m_198800)
              in
              let ct_198804 :=
                ((rwlUL_63) NULL NULL NULL NULL NULL ct_198803)
              in
              let* c_198805 := ((send[R,L] __198778) ct_198804) in
              close[true] c_198805)))))

#[program]
def cmsort_54 :=
  fun cmsort_198806 (xs_198807) ->
    let* c_198808 :=
      fork fun _198809 (_198810) -o
             ((splitting_ctree_53) xs_198807 _198810)
    in
    let* _198811 := recv[R,L] c_198808 in
    (match _198811 with
    | ex1LL_48 m_198812 n_198813 =>
      let* __198814 := close[false] n_198813 in
      let* _198815 :=
        ((creduce_47)
          NULL NULL NULL fun _198816 (x_198817) ->
                           x_198817
          fun _198818 (l_198819) -> (r_198820) ->
            ((mergeU_102) l_198819 r_198820)
          m_198812)
      in
      (match _198815 with
      | ex1UL_50 m_198821 n_198822 =>
        let result_198823 := ((rwlUU_64) NULL NULL NULL NULL NULL m_198821)
        in
        let* __198824 := ((cfree_45) NULL NULL n_198822) in
        return result_198823))

#[program]
def mklistU_106 :=
  fun mklist_198825 (n_198826) ->
    (match (__lte__ n_198826 0) with
    | true_4  => nilUU_38
    | false_5  => (consUU_39 n_198826 ((mklist_198825) (__sub__ n_198826 1))))

#[program]
def mklistL_105 :=
  fun mklist_198827 (n_198828) ->
    (match (__lte__ n_198828 0) with
    | true_4  => nilUL_36
    | false_5  => (consUL_37 n_198828 ((mklist_198827) (__sub__ n_198828 1))))

#[program]
def list_lenU_108 :=
  fun list_len_198829 (__198830) ->
    (match __198830 with
    | nilUU_38  => 0
    | consUU_39 hd_198831 tl_198832 =>
      (__add__ 1 ((list_len_198829) tl_198832)))

#[program]
def list_lenL_107 :=
  fun list_len_198833 (__198834) ->
    (match __198834 with
    | nilUL_36  => 0
    | consUL_37 hd_198835 tl_198836 =>
      (__add__ 1 ((list_len_198833) tl_198836)))

#[program]
def print_listU_110 :=
  fun print_list_198837 (__198838) ->
    (match __198838 with
    | nilUU_38  => print "nil"
    | consUU_39 hd_198839 tl_198840 =>
      let* __198841 := print ((string_of_int_33) hd_198839) in
      let* __198842 := print " :: " in ((print_list_198837) tl_198840))

#[program]
def print_listL_109 :=
  fun print_list_198843 (__198844) ->
    (match __198844 with
    | nilUL_36  => print "nil"
    | consUL_37 hd_198845 tl_198846 =>
      let* __198847 := print ((string_of_int_33) hd_198845) in
      let* __198848 := print " :: " in ((print_list_198843) tl_198846))

#[program]
def main :=
  let test_198849 := ((mklistU_106) 100) in
  let* _198850 := ((cmsort_54) test_198849) in
  (match _198850 with
  | justUU_25 m_198851 => ((print_listU_110) m_198851))

[trans2e success]

-----------------------------------------

def idU_60 := fun id_199311 (A_199312) -> (m_199313) -> m_199313

def idL_59 := fun id_199314 (A_199315) -> (m_199316) -> m_199316

def rwlUU_64 :=
  fun rwl_199317 (A_199318) -> (m_199319) -> (n_199320) -> (B_199321) ->
  (__199322) -> (__199323) -> __199323

def rwlUL_63 :=
  fun rwl_199324 (A_199325) -> (m_199326) -> (n_199327) -> (B_199328) ->
  (__199329) -> (__199330) -> __199330

def rwlLU_62 :=
  fun rwl_199331 (A_199332) -> (m_199333) -> (n_199334) -> (B_199335) ->
  (__199336) -> (__199337) -> __199337

def rwlLL_61 :=
  fun rwl_199338 (A_199339) -> (m_199340) -> (n_199341) -> (B_199342) ->
  (__199343) -> (__199344) -> __199344

def rwrUU_68 :=
  fun rwr_199345 (A_199346) -> (m_199347) -> (n_199348) -> (B_199349) ->
  (__199350) -> (__199351) -> __199351

def rwrUL_67 :=
  fun rwr_199352 (A_199353) -> (m_199354) -> (n_199355) -> (B_199356) ->
  (__199357) -> (__199358) -> __199358

def rwrLU_66 :=
  fun rwr_199359 (A_199360) -> (m_199361) -> (n_199362) -> (B_199363) ->
  (__199364) -> (__199365) -> __199365

def rwrLL_65 :=
  fun rwr_199366 (A_199367) -> (m_199368) -> (n_199369) -> (B_199370) ->
  (__199371) -> (__199372) -> __199372

def sing_elimUU_82 :=
  fun sing_elim_199373 (A_199374) -> (x_199375) -> (__199376) -> __199376

def sing_elimUL_81 :=
  fun sing_elim_199377 (A_199378) -> (x_199379) -> (__199380) -> __199380

def sing_elimLU_80 :=
  fun sing_elim_199381 (A_199382) -> (x_199383) -> (__199384) -> !!

def sing_elimLL_79 :=
  fun sing_elim_199385 (A_199386) -> (x_199387) -> (__199388) -> __199388

def not_11 :=
  fun not_199389 (__199390) ->
    (match __199390 with
    | true_4 => constr0(false_5) | false_5 => constr0(true_4))

def and_12 :=
  fun and_199391 (__199392) -> (__199393) ->
    (match __199392 with
    | true_4 =>
      (match __199393 with
      | true_4 => constr0(true_4) | false_5 => constr0(false_5))
    | false_5 => constr0(false_5))

def or_13 :=
  fun or_199394 (__199395) -> (__199396) ->
    (match __199395 with
    | true_4 => constr0(true_4)
    | false_5 =>
      (match __199396 with
      | true_4 => constr0(true_4) | false_5 => constr0(false_5)))

def xor_14 :=
  fun xor_199397 (__199398) -> (__199399) ->
    (match __199398 with
    | true_4 =>
      (match __199399 with
      | true_4 => constr0(false_5) | false_5 => constr0(true_4))
    | false_5 =>
      (match __199399 with
      | true_4 => constr0(true_4) | false_5 => constr0(false_5)))

def string_of_bool_15 :=
  fun string_of_bool_199400 (__199401) ->
    (match __199401 with
    | true_4 => "true" | false_5 => "false")

def lte_16 :=
  fun lte_199402 (__199403) -> (__199404) ->
    (match __199403 with
    | zero_6 => constr0(true_4)
    | _ =>
      (match __199403 with
      | succ_7 n_199405 =>
        (match __199404 with
        | zero_6 => constr0(false_5)
        | _ =>
          (match __199404 with
          | succ_7 n_199406 => ((lte_199402) n_199405 n_199406)))))

def lt_17 :=
  fun lt_199407 (x_199408) -> (y_199409) ->
    ((lte_16) (succ_7 x_199408) y_199409)

def pred_18 :=
  fun pred_199410 (__199411) ->
    (match __199411 with
    | zero_6 => constr0(zero_6)
    | _ => (match __199411 with
           | succ_7 n_199412 => n_199412))

def add_19 :=
  fun add_199413 (__199414) -> (__199415) ->
    (match __199414 with
    | zero_6 => __199415
    | _ =>
      (match __199414 with
      | succ_7 n_199416 => (succ_7 ((add_199413) n_199416 __199415))))

def sub_20 :=
  fun sub_199417 (__199418) -> (__199419) ->
    (match __199419 with
    | zero_6 => __199418
    | _ =>
      (match __199419 with
      | succ_7 n_199420 => ((sub_199417) ((pred_18) __199418) n_199420)))

def mul_21 :=
  fun mul_199421 (__199422) -> (__199423) ->
    (match __199422 with
    | zero_6 => constr0(zero_6)
    | _ =>
      (match __199422 with
      | succ_7 n_199424 =>
        ((add_19) __199423 ((mul_199421) n_199424 __199423))))

def div_22 :=
  fun div_199425 (x_199426) -> (y_199427) ->
    (match ((lt_17) x_199426 y_199427) with
    | true_4 => constr0(zero_6)
    | false_5 =>
      let loop_199428 :=
        fun loop_199429 (x_199430) -> (y_199431) ->
          (match ((sub_20) x_199430 ((pred_18) y_199431)) with
          | zero_6 => constr0(zero_6)
          | _ =>
            (match ((sub_20) x_199430 ((pred_18) y_199431)) with
            | succ_7 n_199432 => (succ_7 ((loop_199429) n_199432 y_199431))))
      in ((loop_199428) x_199426 y_199427))

def rem_23 :=
  fun rem_199433 (x_199434) -> (y_199435) ->
    ((sub_20) x_199434 ((mul_21) ((div_22) x_199434 y_199435) y_199435))

def rconsUU_90 :=
  fun rcons_199436 (A_199437) -> (__199438) -o (__199439) -o
    (match __199438 with
    | nilUU_38 => (consUU_39 __199439 constr0(nilUU_38))
    | _ =>
      (match __199438 with
      | consUU_39 hd_199440 tl_199441 =>
        (consUU_39 hd_199440 ((rcons_199436) NULL tl_199441 __199439))))

def rconsUL_89 :=
  fun rcons_199442 (A_199443) -> (__199444) -o (__199445) -o
    (match __199444 with
    | nilUL_36 => (consUL_37 __199445 constr0(nilUL_36))
    | _ =>
      (match __199444 with
      | consUL_37 hd_199446 tl_199447 =>
        (consUL_37 hd_199446 ((rcons_199442) NULL tl_199447 __199445))))

def rconsLL_87 :=
  fun rcons_199448 (A_199449) -> (__199450) -o (__199451) -o
    (match __199450 with
    | nilLL_32 => (consLL_33 __199451 constr0(nilLL_32))
    | _ =>
      (match __199450 with
      | consLL_33 hd_199452 tl_199453 =>
        (consLL_33 hd_199452 ((rcons_199448) NULL tl_199453 __199451))))

def free_listUU_94 :=
  fun free_list_199454 (A_199455) -> (f_199456) -> (__199457) ->
    (match __199457 with
    | nilUU_38 => constr0(ttU_27)
    | _ =>
      (match __199457 with
      | consUU_39 hd_199458 tl_199459 =>
        let __199460 := ((f_199456) hd_199458) in
        ((free_list_199454) NULL f_199456 tl_199459)))

def free_listUL_93 :=
  fun free_list_199461 (A_199462) -> (f_199463) -> (__199464) ->
    (match __199464 with
    | nilUL_36 => constr0(ttU_27)
    | _ =>
      (match __199464 with
      | consUL_37 hd_199465 tl_199466 =>
        let __199467 := ((f_199463) hd_199465) in
        ((free_list_199461) NULL f_199463 tl_199466)))

def free_listLL_91 :=
  fun free_list_199468 (A_199469) -> (f_199470) -> (__199471) ->
    (match __199471 with
    | nilLL_32 => constr0(ttU_27)
    | _ =>
      (match __199471 with
      | consLL_33 hd_199472 tl_199473 =>
        let __199474 := ((f_199470) hd_199472) in
        ((free_list_199468) NULL f_199470 tl_199473)))

def pow_27 :=
  fun pow_199475 (x_199476) -> (y_199477) ->
    let loop_199478 :=
      fun loop_199479 (acc_199480) -> (y_199481) ->
        (match (__lte__ y_199481 0) with
        | true_4 => acc_199480
        | false_5 =>
          ((loop_199479) (__mul__ x_199476 acc_199480) (__sub__ y_199481 1)))
    in ((loop_199478) 1 y_199477)

def powm_28 :=
  fun powm_199482 (x_199483) -> (y_199484) -> (m_199485) ->
    let loop_199486 :=
      fun loop_199487 (acc_199488) -> (y_199489) ->
        (match (__lte__ y_199489 0) with
        | true_4 => acc_199488
        | false_5 =>
          ((loop_199487)
            (__mod__ (__mul__ x_199483 acc_199488) m_199485)
              (__sub__ y_199489 1)))
    in ((loop_199486) 1 y_199484)

def ord_29 := fun ord_199490 (c_199491) -> (__ord__ c_199491)

def chr_30 := fun chr_199492 (i_199493) -> (__chr__ i_199493)

def str_31 := fun str_199494 (c_199495) -> (__push__ "" c_199495)

def strlen_32 := fun strlen_199496 (s_199497) -> (__size__ s_199497)

def string_of_int_33 :=
  fun string_of_int_199498 (i_199499) ->
    let aux_199500 :=
      fun aux_199501 (i_199502) ->
        (match (__lte__ 10 i_199502) with
        | true_4 =>
          let r_199503 := (__mod__ i_199502 10) in
          let i_199504 := (__div__ i_199502 10) in
          (__push__ ((aux_199501) i_199504)
            ((chr_30) (__add__ r_199503 ((ord_29) 0))))
        | false_5 => ((str_31) ((chr_30) (__add__ i_199502 ((ord_29) 0)))))
    in
    (match (__lte__ 0 i_199499) with
    | true_4 => ((aux_199500) i_199499)
    | false_5 => (__cat__ "~" ((aux_199500) (__neg__ i_199499))))

def map_34 :=
  fun map_199505 (A_199506) -> (B_199507) -> (f_199508) -> (__199509) ->
    (match __199509 with
    | Leaf_15 x_199510 => (Leaf_15 ((f_199508) x_199510))
    | Node_16 l_199511 r_199512 =>
      (Node_16
        ((map_199505) NULL NULL f_199508 l_199511)
        ((map_199505) NULL NULL f_199508 r_199512)))

def reduce_35 :=
  fun reduce_199513 (A_199514) -> (B_199515) -> (f_199516) -> (g_199517) ->
  (__199518) ->
    (match __199518 with
    | Leaf_15 x_199519 => ((f_199516) x_199519)
    | Node_16 l_199520 r_199521 =>
      ((g_199517)
        ((reduce_199513) NULL NULL f_199516 g_199517 l_199520)
          ((reduce_199513) NULL NULL f_199516 g_199517 r_199521)))

def leaf_worker_40 :=
  fun leaf_worker_199522 (A_199523) -> (x_199524) -> (c_199525) ->
    lazy(let _199526 := force(lazy(recv[L](c_199525))) in
         force((match _199526 with
               | ex1LL_48 m_199527 n_199528 =>
                 (match m_199527 with
                 | Free_17 => lazy(close[true] n_199528)
                 | _ =>
                   (match m_199527 with
                   | Map_18 f_199529 =>
                     ((leaf_worker_199522)
                       NULL ((f_199529) x_199524) n_199528)
                   | Reduce_19 f_199530 g_199531 =>
                     lazy(let c_199532 :=
                            force(((lam (x_199533) ->
                                      lazy(send(n_199528, x_199533)))
                                    ((f_199530) x_199524)))
                          in
                          force(((leaf_worker_199522) NULL x_199524 c_199532))))))))

def node_worker_41 :=
  fun node_worker_199534 (A_199535) -> (l_199536) -> (r_199537) ->
  (__199538) -o (__199539) -o (__199540) -o
    lazy(let _199541 := force(lazy(recv[L](__199540))) in
         force((match _199541 with
               | ex1LL_48 m_199542 n_199543 =>
                 (match m_199542 with
                 | Free_17 =>
                   lazy(let l_ch_199544 :=
                          force(((lam (x_199545) ->
                                    lazy(send(__199538, x_199545)))
                                  constr0(Free_17)))
                        in
                        let r_ch_199546 :=
                          force(((lam (x_199547) ->
                                    lazy(send(__199539, x_199547)))
                                  constr0(Free_17)))
                        in
                        let __199548 := force(lazy(close[false] l_ch_199544))
                        in
                        let __199549 := force(lazy(close[false] r_ch_199546))
                        in force(lazy(close[true] n_199543)))
                 | _ =>
                   (match m_199542 with
                   | Map_18 f_199550 =>
                     lazy(let l_ch_199551 :=
                            force(((lam (x_199552) ->
                                      lazy(send(__199538, x_199552)))
                                    (Map_18 f_199550)))
                          in
                          let r_ch_199553 :=
                            force(((lam (x_199554) ->
                                      lazy(send(__199539, x_199554)))
                                    (Map_18 f_199550)))
                          in
                          force(((node_worker_199534)
                                  NULL NULL NULL l_ch_199551 r_ch_199553
                                    n_199543)))
                   | Reduce_19 f_199555 g_199556 =>
                     lazy(let l_ch_199557 :=
                            force(((lam (x_199558) ->
                                      lazy(send(__199538, x_199558)))
                                    (Reduce_19 f_199555 g_199556)))
                          in
                          let r_ch_199559 :=
                            force(((lam (x_199560) ->
                                      lazy(send(__199539, x_199560)))
                                    (Reduce_19 f_199555 g_199556)))
                          in
                          let _199561 := force(lazy(recv[U](l_ch_199557))) in
                          force((match _199561 with
                                | ex1UL_50 m_199562 n_199563 =>
                                  lazy(let _199564 :=
                                         force(lazy(recv[U](r_ch_199559)))
                                       in
                                       force((match _199564 with
                                             | ex1UL_50 m_199565 n_199566 =>
                                               lazy(let c_199567 :=
                                                      force(((lam (x_199568) ->
                                                                lazy(
                                                                send(n_199543, x_199568)))
                                                              ((g_199556)
                                                                m_199562
                                                                  m_199565)))
                                                    in
                                                    force(((node_worker_199534)
                                                            NULL NULL NULL
                                                              n_199563
                                                              n_199566
                                                              c_199567))))))))))))))

def cleaf_42 :=
  fun cleaf_199569 (A_199570) -> (x_199571) ->
    lazy(fork
           fun _199572 (_199573) -o ((leaf_worker_40) NULL x_199571 _199573))

def cnode_43 :=
  fun cnode_199574 (A_199575) -> (l_199576) -> (r_199577) -> (__199578) -o
  (__199579) -o
    lazy(let l_ch_199580 := force(__199578) in
         let r_ch_199581 := force(__199579) in
         force(lazy(fork
                      fun _199582 (_199583) -o
                        ((node_worker_41)
                          NULL NULL NULL l_ch_199580 r_ch_199581 _199583))))

def ctree_of_tree_44 :=
  fun ctree_of_tree_199584 (A_199585) -> (t_199586) ->
    (match t_199586 with
    | Leaf_15 x_199587 => ((cleaf_42) NULL x_199587)
    | Node_16 l_199588 r_199589 =>
      ((cnode_43)
        NULL NULL NULL ((ctree_of_tree_199584) NULL l_199588)
          ((ctree_of_tree_199584) NULL r_199589)))

def cfree_45 :=
  fun cfree_199590 (A_199591) -> (t_199592) -> (ct_199593) ->
    lazy(let c_199594 := force(ct_199593) in
         let c_199595 :=
           force(((lam (x_199596) -> lazy(send(c_199594, x_199596)))
                   constr0(Free_17)))
         in force(lazy(close[false] c_199595)))

def cmap_46 :=
  fun cmap_199597 (A_199598) -> (B_199599) -> (t_199600) -> (f_199601) ->
  (ct_199602) ->
    lazy(let c_199603 := force(ct_199602) in
         let c_199604 :=
           force(((lam (x_199605) -> lazy(send(c_199603, x_199605)))
                   (Map_18 f_199601)))
         in force(lazy(c_199604)))

def creduce_47 :=
  fun creduce_199606 (A_199607) -> (B_199608) -> (t_199609) -> (f_199610) ->
  (g_199611) -> (ct_199612) ->
    lazy(let c_199613 := force(ct_199612) in
         let c_199614 :=
           force(((lam (x_199615) -> lazy(send(c_199613, x_199615)))
                   (Reduce_19 f_199610 g_199611)))
         in
         let _199616 := force(lazy(recv[U](c_199614))) in
         force((match _199616 with
               | ex1UL_50 m_199617 n_199618 =>
                 lazy((ex1UL_50 m_199617 lazy(n_199618))))))

def splitU_100 :=
  fun split_199619 (__199620) ->
    (match __199620 with
    | nilUU_38 => (ex1UU_51 constr0(nilUU_38) constr0(nilUU_38))
    | _ =>
      (match __199620 with
      | consUU_39 hd_199621 tl_199622 =>
        (match tl_199622 with
        | nilUU_38 =>
          (ex1UU_51
            (consUU_39 hd_199621 constr0(nilUU_38)) constr0(nilUU_38))
        | _ =>
          (match tl_199622 with
          | consUU_39 hd_199623 tl_199624 =>
            (match ((split_199619) tl_199624) with
            | ex1UU_51 m_199625 n_199626 =>
              (ex1UU_51
                (consUU_39 hd_199621 m_199625) (consUU_39 hd_199623 n_199626)))))))

def splitL_99 :=
  fun split_199627 (__199628) ->
    (match __199628 with
    | nilUL_36 => (ex1LL_48 constr0(nilUL_36) constr0(nilUL_36))
    | _ =>
      (match __199628 with
      | consUL_37 hd_199629 tl_199630 =>
        (match tl_199630 with
        | nilUL_36 =>
          (ex1LL_48
            (consUL_37 hd_199629 constr0(nilUL_36)) constr0(nilUL_36))
        | _ =>
          (match tl_199630 with
          | consUL_37 hd_199631 tl_199632 =>
            (match ((split_199627) tl_199632) with
            | ex1LL_48 m_199633 n_199634 =>
              (ex1LL_48
                (consUL_37 hd_199629 m_199633) (consUL_37 hd_199631 n_199634)))))))

def mergeU_102 :=
  fun merge_199635 (__199636) -> (__199637) -o
    (match __199636 with
    | nilUU_38 => __199637
    | _ =>
      (match __199636 with
      | consUU_39 hd_199638 tl_199639 =>
        (match __199637 with
        | nilUU_38 => (consUU_39 hd_199638 tl_199639)
        | _ =>
          (match __199637 with
          | consUU_39 hd_199640 tl_199641 =>
            (match (__lte__ hd_199638 hd_199640) with
            | true_4 =>
              (consUU_39
                hd_199638
                ((merge_199635) tl_199639 (consUU_39 hd_199640 tl_199641)))
            | false_5 =>
              (consUU_39
                hd_199640
                ((merge_199635) (consUU_39 hd_199638 tl_199639) tl_199641)))))))

def mergeL_101 :=
  fun merge_199642 (__199643) -> (__199644) -o
    (match __199643 with
    | nilUL_36 => __199644
    | _ =>
      (match __199643 with
      | consUL_37 hd_199645 tl_199646 =>
        (match __199644 with
        | nilUL_36 => (consUL_37 hd_199645 tl_199646)
        | _ =>
          (match __199644 with
          | consUL_37 hd_199647 tl_199648 =>
            (match (__lte__ hd_199645 hd_199647) with
            | true_4 =>
              (consUL_37
                hd_199645
                ((merge_199642) tl_199646 (consUL_37 hd_199647 tl_199648)))
            | false_5 =>
              (consUL_37
                hd_199647
                ((merge_199642) (consUL_37 hd_199645 tl_199646) tl_199648)))))))

def msortU_104 :=
  fun msort_199649 (__199650) ->
    (match __199650 with
    | nilUU_38 => constr0(nilUU_38)
    | _ =>
      (match __199650 with
      | consUU_39 hd_199651 tl_199652 =>
        (match tl_199652 with
        | nilUU_38 => (consUU_39 hd_199651 constr0(nilUU_38))
        | _ =>
          (match tl_199652 with
          | consUU_39 hd_199653 tl_199654 =>
            (match ((splitU_100)
                     (consUU_39 hd_199651 (consUU_39 hd_199653 tl_199654))) with
            | ex1UU_51 m_199655 n_199656 =>
              ((mergeU_102)
                ((msort_199649) m_199655) ((msort_199649) n_199656)))))))

def msortL_103 :=
  fun msort_199657 (__199658) ->
    (match __199658 with
    | nilUL_36 => constr0(nilUL_36)
    | _ =>
      (match __199658 with
      | consUL_37 hd_199659 tl_199660 =>
        (match tl_199660 with
        | nilUL_36 => (consUL_37 hd_199659 constr0(nilUL_36))
        | _ =>
          (match tl_199660 with
          | consUL_37 hd_199661 tl_199662 =>
            (match ((splitL_99)
                     (consUL_37 hd_199659 (consUL_37 hd_199661 tl_199662))) with
            | ex1LL_48 m_199663 n_199664 =>
              ((mergeL_101)
                ((msort_199657) m_199663) ((msort_199657) n_199664)))))))

def splitting_tree_51 :=
  fun splitting_tree_199665 (__199666) ->
    (match __199666 with
    | nilUU_38 => (Leaf_15 constr0(nilUU_38))
    | _ =>
      (match __199666 with
      | consUU_39 hd_199667 tl_199668 =>
        (match tl_199668 with
        | nilUU_38 => (Leaf_15 (consUU_39 hd_199667 constr0(nilUU_38)))
        | _ =>
          (match tl_199668 with
          | consUU_39 hd_199669 tl_199670 =>
            (match ((splitU_100)
                     (consUU_39 hd_199667 (consUU_39 hd_199669 tl_199670))) with
            | ex1UU_51 m_199671 n_199672 =>
              let l_199673 := ((splitting_tree_199665) m_199671) in
              let r_199674 := ((splitting_tree_199665) n_199672) in
              (Node_16 l_199673 r_199674))))))

def splitting_ctree_53 :=
  fun splitting_ctree_199675 (xs_199676) -> (__199677) ->
    (match xs_199676 with
    | nilUU_38 =>
      lazy(let c_199678 :=
             force(((lam (x_199679) -> lazy(send(__199677, x_199679)))
                     ((cleaf_42) NULL constr0(nilUU_38))))
           in
           let __199680 := force(lazy(close[true] c_199678)) in
           force(lazy(constr0(ttU_27))))
    | _ =>
      (match xs_199676 with
      | consUU_39 hd_199681 tl_199682 =>
        (match tl_199682 with
        | nilUU_38 =>
          lazy(let c_199683 :=
                 force(((lam (x_199684) -> lazy(send(__199677, x_199684)))
                         ((cleaf_42)
                           NULL (consUU_39 hd_199681 constr0(nilUU_38)))))
               in
               let __199685 := force(lazy(close[true] c_199683)) in
               force(lazy(constr0(ttU_27))))
        | _ =>
          (match tl_199682 with
          | consUU_39 hd_199686 tl_199687 =>
            (match ((splitU_100)
                     (consUU_39 hd_199681 (consUU_39 hd_199686 tl_199687))) with
            | ex1UU_51 m_199688 n_199689 =>
              lazy(let cl_199690 :=
                     force(lazy(fork
                                  fun _199691 (_199692) -o
                                    ((splitting_ctree_199675)
                                      m_199688 _199692)))
                   in
                   let cr_199693 :=
                     force(lazy(fork
                                  fun _199694 (_199695) -o
                                    ((splitting_ctree_199675)
                                      n_199689 _199695)))
                   in
                   let _199696 := force(lazy(recv[L](cl_199690))) in
                   force((match _199696 with
                         | ex1LL_48 m_199697 n_199698 =>
                           lazy(let __199699 :=
                                  force(lazy(close[false] n_199698))
                                in
                                let _199700 :=
                                  force(lazy(recv[L](cr_199693)))
                                in
                                force((match _199700 with
                                      | ex1LL_48 m_199701 n_199702 =>
                                        lazy(let __199703 :=
                                               force(lazy(close[false]
                                                            n_199702))
                                             in
                                             force(let ct_199704 :=
                                                     ((cnode_43)
                                                       NULL NULL NULL
                                                         m_199697 m_199701)
                                                   in
                                                   let ct_199705 :=
                                                     ((rwlUL_63)
                                                       NULL NULL NULL NULL
                                                         NULL ct_199704)
                                                   in
                                                   lazy(let c_199706 :=
                                                          force(((lam (x_199707) ->
                                                                    lazy(
                                                                    send(__199677, x_199707)))
                                                                  ct_199705))
                                                        in
                                                        force(lazy(close[true]
                                                                    c_199706))))))))))))))))

def cmsort_54 :=
  fun cmsort_199708 (xs_199709) ->
    lazy(let c_199710 :=
           force(lazy(fork
                        fun _199711 (_199712) -o
                          ((splitting_ctree_53) xs_199709 _199712)))
         in
         let _199713 := force(lazy(recv[L](c_199710))) in
         force((match _199713 with
               | ex1LL_48 m_199714 n_199715 =>
                 lazy(let __199716 := force(lazy(close[false] n_199715)) in
                      let _199717 :=
                        force(((creduce_47)
                                NULL NULL NULL
                                  fun _199718 (x_199719) -> x_199719
                                    fun _199720 (l_199721) -> (r_199722) ->
                                      ((mergeU_102) l_199721 r_199722)
                                      m_199714))
                        in
                        force((match _199717 with
                              | ex1UL_50 m_199723 n_199724 =>
                                let result_199725 :=
                                  ((rwlUU_64)
                                    NULL NULL NULL NULL NULL m_199723)
                                in
                                lazy(let __199726 :=
                                       force(((cfree_45) NULL NULL n_199724))
                                     in force(lazy(result_199725)))))))))

def mklistU_106 :=
  fun mklist_199727 (n_199728) ->
    (match (__lte__ n_199728 0) with
    | true_4 => constr0(nilUU_38)
    | false_5 => (consUU_39 n_199728 ((mklist_199727) (__sub__ n_199728 1))))

def mklistL_105 :=
  fun mklist_199729 (n_199730) ->
    (match (__lte__ n_199730 0) with
    | true_4 => constr0(nilUL_36)
    | false_5 => (consUL_37 n_199730 ((mklist_199729) (__sub__ n_199730 1))))

def list_lenU_108 :=
  fun list_len_199731 (__199732) ->
    (match __199732 with
    | nilUU_38 => 0
    | _ =>
      (match __199732 with
      | consUU_39 hd_199733 tl_199734 =>
        (__add__ 1 ((list_len_199731) tl_199734))))

def list_lenL_107 :=
  fun list_len_199735 (__199736) ->
    (match __199736 with
    | nilUL_36 => 0
    | _ =>
      (match __199736 with
      | consUL_37 hd_199737 tl_199738 =>
        (__add__ 1 ((list_len_199735) tl_199738))))

def print_listU_110 :=
  fun print_list_199739 (__199740) ->
    (match __199740 with
    | nilUU_38 => lazy(print "nil")
    | _ =>
      (match __199740 with
      | consUU_39 hd_199741 tl_199742 =>
        lazy(let __199743 :=
               force(lazy(print ((string_of_int_33) hd_199741)))
             in
             let __199744 := force(lazy(print " :: ")) in
             force(((print_list_199739) tl_199742)))))

def print_listL_109 :=
  fun print_list_199745 (__199746) ->
    (match __199746 with
    | nilUL_36 => lazy(print "nil")
    | _ =>
      (match __199746 with
      | consUL_37 hd_199747 tl_199748 =>
        lazy(let __199749 :=
               force(lazy(print ((string_of_int_33) hd_199747)))
             in
             let __199750 := force(lazy(print " :: ")) in
             force(((print_list_199745) tl_199748)))))

def main :=
  let test_199751 := ((mklistU_106) 100) in
  lazy(let _199752 := force(((cmsort_54) test_199751)) in
       force(((print_listU_110) _199752)))

[trans23 success]

-----------------------------------------

def idU_60 := lam (A_200351) -> (m_200352) -> m_200352

def idL_59 := lam (A_200353) -> (m_200354) -> m_200354

def rwlUU_64 :=
  lam (A_200355) -> (m_200356) -> (n_200357) -> (B_200358) -> (__200359) ->
  (__200360) -> __200360

def rwlUL_63 :=
  lam (A_200361) -> (m_200362) -> (n_200363) -> (B_200364) -> (__200365) ->
  (__200366) -> __200366

def rwlLU_62 :=
  lam (A_200367) -> (m_200368) -> (n_200369) -> (B_200370) -> (__200371) ->
  (__200372) -> __200372

def rwlLL_61 :=
  lam (A_200373) -> (m_200374) -> (n_200375) -> (B_200376) -> (__200377) ->
  (__200378) -> __200378

def rwrUU_68 :=
  lam (A_200379) -> (m_200380) -> (n_200381) -> (B_200382) -> (__200383) ->
  (__200384) -> __200384

def rwrUL_67 :=
  lam (A_200385) -> (m_200386) -> (n_200387) -> (B_200388) -> (__200389) ->
  (__200390) -> __200390

def rwrLU_66 :=
  lam (A_200391) -> (m_200392) -> (n_200393) -> (B_200394) -> (__200395) ->
  (__200396) -> __200396

def rwrLL_65 :=
  lam (A_200397) -> (m_200398) -> (n_200399) -> (B_200400) -> (__200401) ->
  (__200402) -> __200402

def sing_elimUU_82 := lam (A_200403) -> (x_200404) -> (__200405) -> __200405

def sing_elimUL_81 := lam (A_200406) -> (x_200407) -> (__200408) -> __200408

def sing_elimLU_80 := lam (A_200409) -> (x_200410) -> (__200411) -> !!

def sing_elimLL_79 := lam (A_200412) -> (x_200413) -> (__200414) -> __200414

def not_11 :=
  lam (__200415) ->
    (match __200415 with
    | true_4 => constr0(false_5) | false_5 => constr0(true_4))

def and_12 :=
  lam (__200416) -> (__200417) ->
    (match __200416 with
    | true_4 =>
      (match __200417 with
      | true_4 => constr0(true_4) | false_5 => constr0(false_5))
    | false_5 => constr0(false_5))

def or_13 :=
  lam (__200418) -> (__200419) ->
    (match __200418 with
    | true_4 => constr0(true_4)
    | false_5 =>
      (match __200419 with
      | true_4 => constr0(true_4) | false_5 => constr0(false_5)))

def xor_14 :=
  lam (__200420) -> (__200421) ->
    (match __200420 with
    | true_4 =>
      (match __200421 with
      | true_4 => constr0(false_5) | false_5 => constr0(true_4))
    | false_5 =>
      (match __200421 with
      | true_4 => constr0(true_4) | false_5 => constr0(false_5)))

def string_of_bool_15 :=
  lam (__200422) ->
    (match __200422 with
    | true_4 => "true" | false_5 => "false")

def lte_16 :=
  fun lte_200423 (__200424) -> (__200425) ->
    (match __200424 with
    | zero_6 => constr0(true_4)
    | _ =>
      (match __200424 with
      | succ_7 n_200426 =>
        (match __200425 with
        | zero_6 => constr0(false_5)
        | _ =>
          (match __200425 with
          | succ_7 n_200427 => ((lte_200423) n_200426 n_200427)))))

def lt_17 :=
  lam (x_200428) -> (y_200429) -> ((lte_16) (succ_7 x_200428) y_200429)

def pred_18 :=
  lam (__200430) ->
    (match __200430 with
    | zero_6 => constr0(zero_6)
    | _ => (match __200430 with
           | succ_7 n_200431 => n_200431))

def add_19 :=
  fun add_200432 (__200433) -> (__200434) ->
    (match __200433 with
    | zero_6 => __200434
    | _ =>
      (match __200433 with
      | succ_7 n_200435 => (succ_7 ((add_200432) n_200435 __200434))))

def sub_20 :=
  fun sub_200436 (__200437) -> (__200438) ->
    (match __200438 with
    | zero_6 => __200437
    | _ =>
      (match __200438 with
      | succ_7 n_200439 => ((sub_200436) ((pred_18) __200437) n_200439)))

def mul_21 :=
  fun mul_200440 (__200441) -> (__200442) ->
    (match __200441 with
    | zero_6 => constr0(zero_6)
    | _ =>
      (match __200441 with
      | succ_7 n_200443 =>
        ((add_19) __200442 ((mul_200440) n_200443 __200442))))

def div_22 :=
  lam (x_200444) -> (y_200445) ->
    (match ((lt_17) x_200444 y_200445) with
    | true_4 => constr0(zero_6)
    | false_5 =>
      let loop_200446 :=
        fun loop_200447 (x_200448) -> (y_200449) ->
          (match ((sub_20) x_200448 ((pred_18) y_200449)) with
          | zero_6 => constr0(zero_6)
          | _ =>
            (match ((sub_20) x_200448 ((pred_18) y_200449)) with
            | succ_7 n_200450 => (succ_7 ((loop_200447) n_200450 y_200449))))
      in ((loop_200446) x_200444 y_200445))

def rem_23 :=
  lam (x_200451) -> (y_200452) ->
    ((sub_20) x_200451 ((mul_21) ((div_22) x_200451 y_200452) y_200452))

def rconsUU_90 :=
  fun rcons_200453 (A_200454) -> (__200455) -o (__200456) -o
    (match __200455 with
    | nilUU_38 => (consUU_39 __200456 constr0(nilUU_38))
    | _ =>
      (match __200455 with
      | consUU_39 hd_200457 tl_200458 =>
        (consUU_39 hd_200457 ((rcons_200453) NULL tl_200458 __200456))))

def rconsUL_89 :=
  fun rcons_200459 (A_200460) -> (__200461) -o (__200462) -o
    (match __200461 with
    | nilUL_36 => (consUL_37 __200462 constr0(nilUL_36))
    | _ =>
      (match __200461 with
      | consUL_37 hd_200463 tl_200464 =>
        (consUL_37 hd_200463 ((rcons_200459) NULL tl_200464 __200462))))

def rconsLL_87 :=
  fun rcons_200465 (A_200466) -> (__200467) -o (__200468) -o
    (match __200467 with
    | nilLL_32 => (consLL_33 __200468 constr0(nilLL_32))
    | _ =>
      (match __200467 with
      | consLL_33 hd_200469 tl_200470 =>
        (consLL_33 hd_200469 ((rcons_200465) NULL tl_200470 __200468))))

def free_listUU_94 :=
  fun free_list_200471 (A_200472) -> (f_200473) -> (__200474) ->
    (match __200474 with
    | nilUU_38 => constr0(ttU_27)
    | _ =>
      (match __200474 with
      | consUU_39 hd_200475 tl_200476 =>
        let __200477 := ((f_200473) hd_200475) in
        ((free_list_200471) NULL f_200473 tl_200476)))

def free_listUL_93 :=
  fun free_list_200478 (A_200479) -> (f_200480) -> (__200481) ->
    (match __200481 with
    | nilUL_36 => constr0(ttU_27)
    | _ =>
      (match __200481 with
      | consUL_37 hd_200482 tl_200483 =>
        let __200484 := ((f_200480) hd_200482) in
        ((free_list_200478) NULL f_200480 tl_200483)))

def free_listLL_91 :=
  fun free_list_200485 (A_200486) -> (f_200487) -> (__200488) ->
    (match __200488 with
    | nilLL_32 => constr0(ttU_27)
    | _ =>
      (match __200488 with
      | consLL_33 hd_200489 tl_200490 =>
        let __200491 := ((f_200487) hd_200489) in
        ((free_list_200485) NULL f_200487 tl_200490)))

def pow_27 :=
  lam (x_200492) -> (y_200493) ->
    let loop_200494 :=
      fun loop_200495 (acc_200496) -> (y_200497) ->
        (match (__lte__ y_200497 0) with
        | true_4 => acc_200496
        | false_5 =>
          ((loop_200495) (__mul__ x_200492 acc_200496) (__sub__ y_200497 1)))
    in ((loop_200494) 1 y_200493)

def powm_28 :=
  lam (x_200498) -> (y_200499) -> (m_200500) ->
    let loop_200501 :=
      fun loop_200502 (acc_200503) -> (y_200504) ->
        (match (__lte__ y_200504 0) with
        | true_4 => acc_200503
        | false_5 =>
          ((loop_200502)
            (__mod__ (__mul__ x_200498 acc_200503) m_200500)
              (__sub__ y_200504 1)))
    in ((loop_200501) 1 y_200499)

def ord_29 := lam (c_200505) -> (__ord__ c_200505)

def chr_30 := lam (i_200506) -> (__chr__ i_200506)

def str_31 := lam (c_200507) -> (__push__ "" c_200507)

def strlen_32 := lam (s_200508) -> (__size__ s_200508)

def string_of_int_33 :=
  lam (i_200509) ->
    let aux_200510 :=
      fun aux_200511 (i_200512) ->
        (match (__lte__ 10 i_200512) with
        | true_4 =>
          let r_200513 := (__mod__ i_200512 10) in
          let i_200514 := (__div__ i_200512 10) in
          (__push__ ((aux_200511) i_200514)
            ((chr_30) (__add__ r_200513 ((ord_29) 0))))
        | false_5 => ((str_31) ((chr_30) (__add__ i_200512 ((ord_29) 0)))))
    in
    (match (__lte__ 0 i_200509) with
    | true_4 => ((aux_200510) i_200509)
    | false_5 => (__cat__ "~" ((aux_200510) (__neg__ i_200509))))

def map_34 :=
  fun map_200515 (A_200516) -> (B_200517) -> (f_200518) -> (__200519) ->
    (match __200519 with
    | Leaf_15 x_200520 => (Leaf_15 ((f_200518) x_200520))
    | Node_16 l_200521 r_200522 =>
      (Node_16
        ((map_200515) NULL NULL f_200518 l_200521)
        ((map_200515) NULL NULL f_200518 r_200522)))

def reduce_35 :=
  fun reduce_200523 (A_200524) -> (B_200525) -> (f_200526) -> (g_200527) ->
  (__200528) ->
    (match __200528 with
    | Leaf_15 x_200529 => ((f_200526) x_200529)
    | Node_16 l_200530 r_200531 =>
      ((g_200527)
        ((reduce_200523) NULL NULL f_200526 g_200527 l_200530)
          ((reduce_200523) NULL NULL f_200526 g_200527 r_200531)))

def leaf_worker_40 :=
  fun leaf_worker_200532 (A_200533) -> (x_200534) -> (c_200535) ->
    lazy(let _200536 := recv[L](c_200535) in
         (match _200536 with
         | ex1LL_48 m_200537 n_200538 =>
           (match m_200537 with
           | Free_17 => close[true] n_200538
           | _ =>
             (match m_200537 with
             | Map_18 f_200539 =>
               force(((leaf_worker_200532)
                       NULL ((f_200539) x_200534) n_200538))
             | Reduce_19 f_200540 g_200541 =>
               let c_200542 := send(n_200538, ((f_200540) x_200534)) in
               force(((leaf_worker_200532) NULL x_200534 c_200542))))))

def node_worker_41 :=
  fun node_worker_200543 (A_200544) -> (l_200545) -> (r_200546) ->
  (__200547) -o (__200548) -o (__200549) -o
    lazy(let _200550 := recv[L](__200549) in
         (match _200550 with
         | ex1LL_48 m_200551 n_200552 =>
           (match m_200551 with
           | Free_17 =>
             let l_ch_200553 := send(__200547, constr0(Free_17)) in
             let r_ch_200554 := send(__200548, constr0(Free_17)) in
             let __200555 := close[false] l_ch_200553 in
             let __200556 := close[false] r_ch_200554 in close[true] n_200552
           | _ =>
             (match m_200551 with
             | Map_18 f_200557 =>
               let l_ch_200558 := send(__200547, (Map_18 f_200557)) in
               let r_ch_200559 := send(__200548, (Map_18 f_200557)) in
               force(((node_worker_200543)
                       NULL NULL NULL l_ch_200558 r_ch_200559 n_200552))
             | Reduce_19 f_200560 g_200561 =>
               let l_ch_200562 :=
                 send(__200547, (Reduce_19 f_200560 g_200561))
               in
               let r_ch_200563 :=
                 send(__200548, (Reduce_19 f_200560 g_200561))
               in
               let _200564 := recv[U](l_ch_200562) in
               (match _200564 with
               | ex1UL_50 m_200565 n_200566 =>
                 let _200567 := recv[U](r_ch_200563) in
                 (match _200567 with
                 | ex1UL_50 m_200568 n_200569 =>
                   let c_200570 :=
                     send(n_200552, ((g_200561) m_200565 m_200568))
                   in
                   force(((node_worker_200543)
                           NULL NULL NULL n_200566 n_200569 c_200570))))))))

def cleaf_42 :=
  lam (A_200571) -> (x_200572) ->
    lazy(fork lam (_200573) -o ((leaf_worker_40) NULL x_200572 _200573))

def cnode_43 :=
  lam (A_200574) -> (l_200575) -> (r_200576) -> (__200577) -o (__200578) -o
    lazy(let l_ch_200579 := force(__200577) in
         let r_ch_200580 := force(__200578) in
         fork
           lam (_200581) -o
             ((node_worker_41)
               NULL NULL NULL l_ch_200579 r_ch_200580 _200581))

def ctree_of_tree_44 :=
  fun ctree_of_tree_200582 (A_200583) -> (t_200584) ->
    (match t_200584 with
    | Leaf_15 x_200585 => ((cleaf_42) NULL x_200585)
    | Node_16 l_200586 r_200587 =>
      ((cnode_43)
        NULL NULL NULL ((ctree_of_tree_200582) NULL l_200586)
          ((ctree_of_tree_200582) NULL r_200587)))

def cfree_45 :=
  lam (A_200588) -> (t_200589) -> (ct_200590) ->
    lazy(let c_200591 := force(ct_200590) in
         let c_200592 := send(c_200591, constr0(Free_17)) in
         close[false] c_200592)

def cmap_46 :=
  lam (A_200593) -> (B_200594) -> (t_200595) -> (f_200596) -> (ct_200597) ->
    lazy(let c_200598 := force(ct_200597) in
         let c_200599 := send(c_200598, (Map_18 f_200596)) in c_200599)

def creduce_47 :=
  lam (A_200600) -> (B_200601) -> (t_200602) -> (f_200603) -> (g_200604) ->
  (ct_200605) ->
    lazy(let c_200606 := force(ct_200605) in
         let c_200607 := send(c_200606, (Reduce_19 f_200603 g_200604)) in
         let _200608 := recv[U](c_200607) in
         (match _200608 with
         | ex1UL_50 m_200609 n_200610 => (ex1UL_50 m_200609 lazy(n_200610))))

def splitU_100 :=
  fun split_200611 (__200612) ->
    (match __200612 with
    | nilUU_38 => (ex1UU_51 constr0(nilUU_38) constr0(nilUU_38))
    | _ =>
      (match __200612 with
      | consUU_39 hd_200613 tl_200614 =>
        (match tl_200614 with
        | nilUU_38 =>
          (ex1UU_51
            (consUU_39 hd_200613 constr0(nilUU_38)) constr0(nilUU_38))
        | _ =>
          (match tl_200614 with
          | consUU_39 hd_200615 tl_200616 =>
            (match ((split_200611) tl_200616) with
            | ex1UU_51 m_200617 n_200618 =>
              (ex1UU_51
                (consUU_39 hd_200613 m_200617) (consUU_39 hd_200615 n_200618)))))))

def splitL_99 :=
  fun split_200619 (__200620) ->
    (match __200620 with
    | nilUL_36 => (ex1LL_48 constr0(nilUL_36) constr0(nilUL_36))
    | _ =>
      (match __200620 with
      | consUL_37 hd_200621 tl_200622 =>
        (match tl_200622 with
        | nilUL_36 =>
          (ex1LL_48
            (consUL_37 hd_200621 constr0(nilUL_36)) constr0(nilUL_36))
        | _ =>
          (match tl_200622 with
          | consUL_37 hd_200623 tl_200624 =>
            (match ((split_200619) tl_200624) with
            | ex1LL_48 m_200625 n_200626 =>
              (ex1LL_48
                (consUL_37 hd_200621 m_200625) (consUL_37 hd_200623 n_200626)))))))

def mergeU_102 :=
  fun merge_200627 (__200628) -> (__200629) -o
    (match __200628 with
    | nilUU_38 => __200629
    | _ =>
      (match __200628 with
      | consUU_39 hd_200630 tl_200631 =>
        (match __200629 with
        | nilUU_38 => (consUU_39 hd_200630 tl_200631)
        | _ =>
          (match __200629 with
          | consUU_39 hd_200632 tl_200633 =>
            (match (__lte__ hd_200630 hd_200632) with
            | true_4 =>
              (consUU_39
                hd_200630
                ((merge_200627) tl_200631 (consUU_39 hd_200632 tl_200633)))
            | false_5 =>
              (consUU_39
                hd_200632
                ((merge_200627) (consUU_39 hd_200630 tl_200631) tl_200633)))))))

def mergeL_101 :=
  fun merge_200634 (__200635) -> (__200636) -o
    (match __200635 with
    | nilUL_36 => __200636
    | _ =>
      (match __200635 with
      | consUL_37 hd_200637 tl_200638 =>
        (match __200636 with
        | nilUL_36 => (consUL_37 hd_200637 tl_200638)
        | _ =>
          (match __200636 with
          | consUL_37 hd_200639 tl_200640 =>
            (match (__lte__ hd_200637 hd_200639) with
            | true_4 =>
              (consUL_37
                hd_200637
                ((merge_200634) tl_200638 (consUL_37 hd_200639 tl_200640)))
            | false_5 =>
              (consUL_37
                hd_200639
                ((merge_200634) (consUL_37 hd_200637 tl_200638) tl_200640)))))))

def msortU_104 :=
  fun msort_200641 (__200642) ->
    (match __200642 with
    | nilUU_38 => constr0(nilUU_38)
    | _ =>
      (match __200642 with
      | consUU_39 hd_200643 tl_200644 =>
        (match tl_200644 with
        | nilUU_38 => (consUU_39 hd_200643 constr0(nilUU_38))
        | _ =>
          (match tl_200644 with
          | consUU_39 hd_200645 tl_200646 =>
            (match ((splitU_100)
                     (consUU_39 hd_200643 (consUU_39 hd_200645 tl_200646))) with
            | ex1UU_51 m_200647 n_200648 =>
              ((mergeU_102)
                ((msort_200641) m_200647) ((msort_200641) n_200648)))))))

def msortL_103 :=
  fun msort_200649 (__200650) ->
    (match __200650 with
    | nilUL_36 => constr0(nilUL_36)
    | _ =>
      (match __200650 with
      | consUL_37 hd_200651 tl_200652 =>
        (match tl_200652 with
        | nilUL_36 => (consUL_37 hd_200651 constr0(nilUL_36))
        | _ =>
          (match tl_200652 with
          | consUL_37 hd_200653 tl_200654 =>
            (match ((splitL_99)
                     (consUL_37 hd_200651 (consUL_37 hd_200653 tl_200654))) with
            | ex1LL_48 m_200655 n_200656 =>
              ((mergeL_101)
                ((msort_200649) m_200655) ((msort_200649) n_200656)))))))

def splitting_tree_51 :=
  fun splitting_tree_200657 (__200658) ->
    (match __200658 with
    | nilUU_38 => (Leaf_15 constr0(nilUU_38))
    | _ =>
      (match __200658 with
      | consUU_39 hd_200659 tl_200660 =>
        (match tl_200660 with
        | nilUU_38 => (Leaf_15 (consUU_39 hd_200659 constr0(nilUU_38)))
        | _ =>
          (match tl_200660 with
          | consUU_39 hd_200661 tl_200662 =>
            (match ((splitU_100)
                     (consUU_39 hd_200659 (consUU_39 hd_200661 tl_200662))) with
            | ex1UU_51 m_200663 n_200664 =>
              let l_200665 := ((splitting_tree_200657) m_200663) in
              let r_200666 := ((splitting_tree_200657) n_200664) in
              (Node_16 l_200665 r_200666))))))

def splitting_ctree_53 :=
  fun splitting_ctree_200667 (xs_200668) -> (__200669) ->
    (match xs_200668 with
    | nilUU_38 =>
      lazy(let c_200670 :=
             send(__200669, ((cleaf_42) NULL constr0(nilUU_38)))
           in let __200671 := close[true] c_200670 in constr0(ttU_27))
    | _ =>
      (match xs_200668 with
      | consUU_39 hd_200672 tl_200673 =>
        (match tl_200673 with
        | nilUU_38 =>
          lazy(let c_200674 :=
                 send(__200669, ((cleaf_42)
                                  NULL
                                    (consUU_39 hd_200672 constr0(nilUU_38))))
               in let __200675 := close[true] c_200674 in constr0(ttU_27))
        | _ =>
          (match tl_200673 with
          | consUU_39 hd_200676 tl_200677 =>
            (match ((splitU_100)
                     (consUU_39 hd_200672 (consUU_39 hd_200676 tl_200677))) with
            | ex1UU_51 m_200678 n_200679 =>
              lazy(let cl_200680 :=
                     fork
                       lam (_200681) -o
                         ((splitting_ctree_200667) m_200678 _200681)
                   in
                   let cr_200682 :=
                     fork
                       lam (_200683) -o
                         ((splitting_ctree_200667) n_200679 _200683)
                   in
                   let _200684 := recv[L](cl_200680) in
                   (match _200684 with
                   | ex1LL_48 m_200685 n_200686 =>
                     let __200687 := close[false] n_200686 in
                     let _200688 := recv[L](cr_200682) in
                     (match _200688 with
                     | ex1LL_48 m_200689 n_200690 =>
                       let __200691 := close[false] n_200690 in
                       let ct_200692 :=
                         ((cnode_43) NULL NULL NULL m_200685 m_200689)
                       in
                       let ct_200693 :=
                         ((rwlUL_63) NULL NULL NULL NULL NULL ct_200692)
                       in
                       let c_200694 := send(__200669, ct_200693) in
                       close[true] c_200694))))))))

def cmsort_54 :=
  lam (xs_200695) ->
    lazy(let c_200696 :=
           fork lam (_200697) -o ((splitting_ctree_53) xs_200695 _200697)
         in
         let _200698 := recv[L](c_200696) in
         (match _200698 with
         | ex1LL_48 m_200699 n_200700 =>
           let __200701 := close[false] n_200700 in
           let _200702 :=
             force(((creduce_47)
                     NULL NULL NULL lam (x_200703) -> x_200703
                       lam (l_200704) -> (r_200705) ->
                         ((mergeU_102) l_200704 r_200705)
                       m_200699))
           in
           (match _200702 with
           | ex1UL_50 m_200706 n_200707 =>
             let result_200708 :=
               ((rwlUU_64) NULL NULL NULL NULL NULL m_200706)
             in
             let __200709 := force(((cfree_45) NULL NULL n_200707)) in
             result_200708)))

def mklistU_106 :=
  fun mklist_200710 (n_200711) ->
    (match (__lte__ n_200711 0) with
    | true_4 => constr0(nilUU_38)
    | false_5 => (consUU_39 n_200711 ((mklist_200710) (__sub__ n_200711 1))))

def mklistL_105 :=
  fun mklist_200712 (n_200713) ->
    (match (__lte__ n_200713 0) with
    | true_4 => constr0(nilUL_36)
    | false_5 => (consUL_37 n_200713 ((mklist_200712) (__sub__ n_200713 1))))

def list_lenU_108 :=
  fun list_len_200714 (__200715) ->
    (match __200715 with
    | nilUU_38 => 0
    | _ =>
      (match __200715 with
      | consUU_39 hd_200716 tl_200717 =>
        (__add__ 1 ((list_len_200714) tl_200717))))

def list_lenL_107 :=
  fun list_len_200718 (__200719) ->
    (match __200719 with
    | nilUL_36 => 0
    | _ =>
      (match __200719 with
      | consUL_37 hd_200720 tl_200721 =>
        (__add__ 1 ((list_len_200718) tl_200721))))

def print_listU_110 :=
  fun print_list_200722 (__200723) ->
    (match __200723 with
    | nilUU_38 => lazy(print "nil")
    | _ =>
      (match __200723 with
      | consUU_39 hd_200724 tl_200725 =>
        lazy(let __200726 := print ((string_of_int_33) hd_200724) in
             let __200727 := print " :: " in
             force(((print_list_200722) tl_200725)))))

def print_listL_109 :=
  fun print_list_200728 (__200729) ->
    (match __200729 with
    | nilUL_36 => lazy(print "nil")
    | _ =>
      (match __200729 with
      | consUL_37 hd_200730 tl_200731 =>
        lazy(let __200732 := print ((string_of_int_33) hd_200730) in
             let __200733 := print " :: " in
             force(((print_list_200728) tl_200731)))))

def main :=
  let test_200734 := ((mklistU_106) 100) in
  lazy(let _200735 := force(((cmsort_54) test_200734)) in
       force(((print_listU_110) _200735)))

[trans3e success]

-----------------------------------------

fn idU_1(A_2%U, m_3%U) {
  
  return m_3;
}

fn idL_4(A_5%U, m_6%U) {
  
  return m_6;
}

fn rwlUU_7(A_8%U, m_9%U, n_10%U, B_11%U, __12%U, __13%U) {
  
  return __13;
}

fn rwlUL_14(A_15%U, m_16%U, n_17%U, B_18%U, __19%U, __20%U) {
  
  return __20;
}

fn rwlLU_21(A_22%U, m_23%U, n_24%U, B_25%U, __26%U, __27%U) {
  
  return __27;
}

fn rwlLL_28(A_29%U, m_30%U, n_31%U, B_32%U, __33%U, __34%U) {
  
  return __34;
}

fn rwrUU_35(A_36%U, m_37%U, n_38%U, B_39%U, __40%U, __41%U) {
  
  return __41;
}

fn rwrUL_42(A_43%U, m_44%U, n_45%U, B_46%U, __47%U, __48%U) {
  
  return __48;
}

fn rwrLU_49(A_50%U, m_51%U, n_52%U, B_53%U, __54%U, __55%U) {
  
  return __55;
}

fn rwrLL_56(A_57%U, m_58%U, n_59%U, B_60%U, __61%U, __62%U) {
  
  return __62;
}

fn sing_elimUU_63(A_64%U, x_65%U, __66%U) {
  
  return __66;
}

fn sing_elimUL_67(A_68%U, x_69%U, __70%U) {
  
  return __70;
}

fn sing_elimLU_71(A_72%U, x_73%U, __74%U) {
  absurd;
  return NULL;
}

fn sing_elimLL_75(A_76%U, x_77%U, __78%U) {
  
  return __78;
}

fn not_79(__80%U) {
  match(__80){ true_4 => {
                 x_81 := false_5;
               }
               false_5 => {
                 x_81 := true_4;
               }
  }
  return x_81;
}

fn and_82(__83%U, __84%U) {
  match(__83){
    true_4 => {
      match(__84){
        true_4 => {
          x_86 := true_4;
        }
        false_5 => {
          x_86 := false_5;
        }
      }
      x_85 := x_86;
    }
    false_5 => {
      x_85 := false_5;
    }
  }
  return x_85;
}

fn or_87(__88%U, __89%U) {
  match(__88){
    true_4 => {
      x_90 := true_4;
    }
    false_5 => {
      match(__89){
        true_4 => {
          x_91 := true_4;
        }
        false_5 => {
          x_91 := false_5;
        }
      }
      x_90 := x_91;
    }
  }
  return x_90;
}

fn xor_92(__93%U, __94%U) {
  match(__93){
    true_4 => {
      match(__94){
        true_4 => {
          x_96 := false_5;
        }
        false_5 => {
          x_96 := true_4;
        }
      }
      x_95 := x_96;
    }
    false_5 => {
      match(__94){
        true_4 => {
          x_97 := true_4;
        }
        false_5 => {
          x_97 := false_5;
        }
      }
      x_95 := x_97;
    }
  }
  return x_95;
}

fn string_of_bool_98(__99%U) {
  match(__99){
    true_4 => {
      x_101 := str("true");
      x_100 := x_101;
    }
    false_5 => {
      x_102 := str("false");
      x_100 := x_102;
    }
  }
  return x_100;
}

fn lte_103(__104%U, __105%U) {
  match(__104){
    zero_6 => {
      x_106 := true_4;
    }
    _ => {
      match[U](__104){
        succ_7(n_108) => {
          match(__105){
            zero_6 => {
              x_109 := false_5;
            }
            _ => {
              match[U](__105){
                succ_7(n_111) => {
                  x_112 := lte_103(n_108, n_111);
                  x_110 := x_112;
                }
              }
              x_109 := x_110;
            }
          }
          x_107 := x_109;
        }
      }
      x_106 := x_107;
    }
  }
  return x_106;
}

fn lt_113(x_114%U, y_115%U) {
  x_117 := mkconstr(succ_7, [x_114]);
  x_116 := lte_103(x_117, y_115);
  return x_116;
}

fn pred_118(__119%U) {
  match(__119){
    zero_6 => {
      x_120 := zero_6;
    }
    _ => {
      match[U](__119){ succ_7(n_122) => {
                         x_121 := n_122;
                       } }
      x_120 := x_121;
    }
  }
  return x_120;
}

fn add_123(__124%U, __125%U) {
  match(__124){
    zero_6 => {
      x_126 := __125;
    }
    _ => {
      match[U](__124){
        succ_7(n_128) => {
          x_129 := add_123(n_128, __125);
          x_130 := mkconstr(succ_7, [x_129]);
          x_127 := x_130;
        }
      }
      x_126 := x_127;
    }
  }
  return x_126;
}

fn sub_131(__132%U, __133%U) {
  match(__133){
    zero_6 => {
      x_134 := __132;
    }
    _ => {
      match[U](__133){
        succ_7(n_136) => {
          x_138 := pred_118(__132);
          x_137 := sub_131(x_138, n_136);
          x_135 := x_137;
        }
      }
      x_134 := x_135;
    }
  }
  return x_134;
}

fn mul_139(__140%U, __141%U) {
  match(__140){
    zero_6 => {
      x_142 := zero_6;
    }
    _ => {
      match[U](__140){
        succ_7(n_144) => {
          x_146 := mul_139(n_144, __141);
          x_145 := add_123(__141, x_146);
          x_143 := x_145;
        }
      }
      x_142 := x_143;
    }
  }
  return x_142;
}

fn div_147(x_148%U, y_149%U) {
  x_151 := lt_113(x_148, y_149);
  match(x_151){
    true_4 => {
      x_150 := zero_6;
    }
    false_5 => {
      x_153 :=
        fn loop_154(x_155%U, y_156%U) {
          x_159 := pred_118(y_156);
          x_158 := sub_131(x_155, x_159);
          match(x_158){
            zero_6 => {
              x_157 := zero_6;
            }
            _ => {
              x_162 := pred_118(y_156);
              x_161 := sub_131(x_155, x_162);
              match[U](x_161){
                succ_7(n_163) => {
                  x_164 := loop_154(n_163, y_156);
                  x_165 := mkconstr(succ_7, [x_164]);
                  x_160 := x_165;
                }
              }
              x_157 := x_160;
            }
          }
          return x_157;
        };
      loop_152 := x_153;
      x_166 := loop_152(x_148, y_149);
      x_150 := x_166;
    }
  }
  return x_150;
}

fn rem_167(x_168%U, y_169%U) {
  x_172 := div_147(x_168, y_169);
  x_171 := mul_139(x_172, y_169);
  x_170 := sub_131(x_168, x_171);
  return x_170;
}

fn rconsUU_173(A_174%U, __175%L, __176%L) {
  match(__175){
    nilUU_38 => {
      x_178 := mkconstr(consUU_39, [__176, nilUU_38]);
      x_177 := x_178;
    }
    _ => {
      match[U](__175){
        consUU_39(hd_180, tl_181) => {
          x_182 := rconsUU_173(NULL, tl_181, __176);
          x_183 := mkconstr(consUU_39, [hd_180, x_182]);
          x_179 := x_183;
        }
      }
      x_177 := x_179;
    }
  }
  return x_177;
}

fn rconsUL_184(A_185%U, __186%L, __187%L) {
  match(__186){
    nilUL_36 => {
      x_189 := mkconstr(consUL_37, [__187, nilUL_36]);
      x_188 := x_189;
    }
    _ => {
      match[L](__186){
        consUL_37(hd_191, tl_192) => {
          x_193 := rconsUL_184(NULL, tl_192, __187);
          x_194 := mkconstr(consUL_37, [hd_191, x_193]);
          x_190 := x_194;
        }
      }
      x_188 := x_190;
    }
  }
  return x_188;
}

fn rconsLL_195(A_196%U, __197%L, __198%L) {
  match(__197){
    nilLL_32 => {
      x_200 := mkconstr(consLL_33, [__198, nilLL_32]);
      x_199 := x_200;
    }
    _ => {
      match[L](__197){
        consLL_33(hd_202, tl_203) => {
          x_204 := rconsLL_195(NULL, tl_203, __198);
          x_205 := mkconstr(consLL_33, [hd_202, x_204]);
          x_201 := x_205;
        }
      }
      x_199 := x_201;
    }
  }
  return x_199;
}

fn free_listUU_206(A_207%U, f_208%U, __209%U) {
  match(__209){
    nilUU_38 => {
      x_210 := ttU_27;
    }
    _ => {
      match[U](__209){
        consUU_39(hd_212, tl_213) => {
          x_215 := f_208(hd_212);
          __214 := x_215;
          x_216 := free_listUU_206(NULL, f_208, tl_213);
          x_211 := x_216;
        }
      }
      x_210 := x_211;
    }
  }
  return x_210;
}

fn free_listUL_217(A_218%U, f_219%U, __220%U) {
  match(__220){
    nilUL_36 => {
      x_221 := ttU_27;
    }
    _ => {
      match[L](__220){
        consUL_37(hd_223, tl_224) => {
          x_226 := f_219(hd_223);
          __225 := x_226;
          x_227 := free_listUL_217(NULL, f_219, tl_224);
          x_222 := x_227;
        }
      }
      x_221 := x_222;
    }
  }
  return x_221;
}

fn free_listLL_228(A_229%U, f_230%U, __231%U) {
  match(__231){
    nilLL_32 => {
      x_232 := ttU_27;
    }
    _ => {
      match[L](__231){
        consLL_33(hd_234, tl_235) => {
          x_237 := f_230(hd_234);
          __236 := x_237;
          x_238 := free_listLL_228(NULL, f_230, tl_235);
          x_233 := x_238;
        }
      }
      x_232 := x_233;
    }
  }
  return x_232;
}

fn pow_239(x_240%U, y_241%U) {
  x_243 :=
    fn loop_244(acc_245%U, y_246%U) {
      x_248 := lte(y_246, 0);
      match(x_248){
        true_4 => {
          x_247 := acc_245;
        }
        false_5 => {
          x_250 := mul(x_240, acc_245);
          x_251 := sub(y_246, 1);
          x_249 := loop_244(x_250, x_251);
          x_247 := x_249;
        }
      }
      return x_247;
    };
  loop_242 := x_243;
  x_252 := loop_242(1, y_241);
  return x_252;
}

fn powm_253(x_254%U, y_255%U, m_256%U) {
  x_258 :=
    fn loop_259(acc_260%U, y_261%U) {
      x_263 := lte(y_261, 0);
      match(x_263){
        true_4 => {
          x_262 := acc_260;
        }
        false_5 => {
          x_266 := mul(x_254, acc_260);
          x_265 := mod(x_266, m_256);
          x_267 := sub(y_261, 1);
          x_264 := loop_259(x_265, x_267);
          x_262 := x_264;
        }
      }
      return x_262;
    };
  loop_257 := x_258;
  x_268 := loop_257(1, y_255);
  return x_268;
}

fn ord_269(c_270%U) {
  x_271 := ord(c_270);
  return x_271;
}

fn chr_272(i_273%U) {
  x_274 := chr(i_273);
  return x_274;
}

fn str_275(c_276%U) {
  x_278 := str("");
  x_277 := push(x_278, c_276);
  return x_277;
}

fn strlen_279(s_280%U) {
  x_281 := size(s_280);
  return x_281;
}

fn string_of_int_282(i_283%U) {
  x_285 :=
    fn aux_286(i_287%U) {
      x_289 := lte(10, i_287);
      match(x_289){
        true_4 => {
          x_291 := mod(i_287, 10);
          r_290 := x_291;
          x_293 := div(i_287, 10);
          i_292 := x_293;
          x_295 := aux_286(i_292);
          x_298 := ord_269(0);
          x_297 := add(r_290, x_298);
          x_296 := chr_272(x_297);
          x_294 := push(x_295, x_296);
          x_288 := x_294;
        }
        false_5 => {
          x_302 := ord_269(0);
          x_301 := add(i_287, x_302);
          x_300 := chr_272(x_301);
          x_299 := str_275(x_300);
          x_288 := x_299;
        }
      }
      return x_288;
    };
  aux_284 := x_285;
  x_304 := lte(0, i_283);
  match(x_304){
    true_4 => {
      x_305 := aux_284(i_283);
      x_303 := x_305;
    }
    false_5 => {
      x_307 := str("~");
      x_309 := neg(i_283);
      x_308 := aux_284(x_309);
      x_306 := cat(x_307, x_308);
      x_303 := x_306;
    }
  }
  return x_303;
}

fn map_310(A_311%U, B_312%U, f_313%U, __314%U) {
  match[U](__314){
    Leaf_15(x_316) => {
      x_317 := f_313(x_316);
      x_318 := mkconstr(Leaf_15, [x_317]);
      x_315 := x_318;
    }
    Node_16(l_319, r_320) => {
      x_321 := map_310(NULL, NULL, f_313, l_319);
      x_322 := map_310(NULL, NULL, f_313, r_320);
      x_323 := mkconstr(Node_16, [x_321, x_322]);
      x_315 := x_323;
    }
  }
  return x_315;
}

fn reduce_324(A_325%U, B_326%U, f_327%U, g_328%U, __329%U) {
  match[U](__329){
    Leaf_15(x_331) => {
      x_332 := f_327(x_331);
      x_330 := x_332;
    }
    Node_16(l_333, r_334) => {
      x_336 := reduce_324(NULL, NULL, f_327, g_328, l_333);
      x_337 := reduce_324(NULL, NULL, f_327, g_328, r_334);
      x_335 := g_328(x_336, x_337);
      x_330 := x_335;
    }
  }
  return x_330;
}

fn leaf_worker_338(A_339%U, x_340%U, c_341%U) {
  x_342 :=
    lazy {
      x_344 := recv[L](c_341);
      _343 := x_344;
      match[L](_343){
        ex1LL_48(m_346, n_347) => {
          match(m_346){
            Free_17 => {
              x_349 := close[true](n_347);
              x_348 := x_349;
            }
            _ => {
              match[L](m_346){
                Map_18(f_351) => {
                  x_354 := f_351(x_340);
                  x_353 := leaf_worker_338(NULL, x_354, n_347);
                  x_352 := force(x_353);
                  x_350 := x_352;
                }
                Reduce_19(f_355, g_356) => {
                  x_359 := f_355(x_340);
                  x_358 := send(n_347, x_359);
                  c_357 := x_358;
                  x_361 := leaf_worker_338(NULL, x_340, c_357);
                  x_360 := force(x_361);
                  x_350 := x_360;
                }
              }
              x_348 := x_350;
            }
          }
          x_345 := x_348;
        }
      }
      return x_345;
    };
  return x_342;
}

fn node_worker_362(A_363%U, l_364%U, r_365%U, __366%L, __367%L, __368%L) {
  x_369 :=
    lazy {
      x_371 := recv[L](__368);
      _370 := x_371;
      match[L](_370){
        ex1LL_48(m_373, n_374) => {
          match(m_373){
            Free_17 => {
              x_377 := send(__366, Free_17);
              l_ch_376 := x_377;
              x_379 := send(__367, Free_17);
              r_ch_378 := x_379;
              x_381 := close[false](l_ch_376);
              __380 := x_381;
              x_383 := close[false](r_ch_378);
              __382 := x_383;
              x_384 := close[true](n_374);
              x_375 := x_384;
            }
            _ => {
              match[L](m_373){
                Map_18(f_386) => {
                  x_389 := mkconstr(Map_18, [f_386]);
                  x_388 := send(__366, x_389);
                  l_ch_387 := x_388;
                  x_392 := mkconstr(Map_18, [f_386]);
                  x_391 := send(__367, x_392);
                  r_ch_390 := x_391;
                  x_394 := node_worker_362(NULL, NULL, NULL, l_ch_387, r_ch_390, n_374);
                  x_393 := force(x_394);
                  x_385 := x_393;
                }
                Reduce_19(f_395, g_396) => {
                  x_399 := mkconstr(Reduce_19, [f_395, g_396]);
                  x_398 := send(__366, x_399);
                  l_ch_397 := x_398;
                  x_402 := mkconstr(Reduce_19, [f_395, g_396]);
                  x_401 := send(__367, x_402);
                  r_ch_400 := x_401;
                  x_404 := recv[U](l_ch_397);
                  _403 := x_404;
                  match[L](_403){
                    ex1UL_50(m_406, n_407) => {
                      x_409 := recv[U](r_ch_400);
                      _408 := x_409;
                      match[L](_408){
                        ex1UL_50(m_411, n_412) => {
                          x_415 := g_396(m_406, m_411);
                          x_414 := send(n_374, x_415);
                          c_413 := x_414;
                          x_417 := node_worker_362(NULL, NULL, NULL, n_407, n_412, c_413);
                          x_416 := force(x_417);
                          x_410 := x_416;
                        }
                      }
                      x_405 := x_410;
                    }
                  }
                  x_385 := x_405;
                }
              }
              x_375 := x_385;
            }
          }
          x_372 := x_375;
        }
      }
      return x_372;
    };
  return x_369;
}

fn cleaf_418(A_419%U, x_420%U) {
  x_421 :=
    lazy {
      x_423 :=
        fn lam_424(_425%L) {
          x_426 := leaf_worker_338(NULL, x_420, _425);
          return x_426;
        };
      x_422 := fork(x_423);
      return x_422;
    };
  return x_421;
}

fn cnode_427(A_428%U, l_429%U, r_430%U, __431%L, __432%L) {
  x_433 :=
    lazy {
      x_435 := force(__431);
      l_ch_434 := x_435;
      x_437 := force(__432);
      r_ch_436 := x_437;
      x_439 :=
        fn lam_440(_441%L) {
          x_442 := node_worker_362(NULL, NULL, NULL, l_ch_434, r_ch_436, _441);
          return x_442;
        };
      x_438 := fork(x_439);
      return x_438;
    };
  return x_433;
}

fn ctree_of_tree_443(A_444%U, t_445%U) {
  match[U](t_445){
    Leaf_15(x_447) => {
      x_448 := cleaf_418(NULL, x_447);
      x_446 := x_448;
    }
    Node_16(l_449, r_450) => {
      x_452 := ctree_of_tree_443(NULL, l_449);
      x_453 := ctree_of_tree_443(NULL, r_450);
      x_451 := cnode_427(NULL, NULL, NULL, x_452, x_453);
      x_446 := x_451;
    }
  }
  return x_446;
}

fn cfree_454(A_455%U, t_456%U, ct_457%U) {
  x_458 :=
    lazy {
      x_460 := force(ct_457);
      c_459 := x_460;
      x_462 := send(c_459, Free_17);
      c_461 := x_462;
      x_463 := close[false](c_461);
      return x_463;
    };
  return x_458;
}

fn cmap_464(A_465%U, B_466%U, t_467%U, f_468%U, ct_469%U) {
  x_470 :=
    lazy {
      x_472 := force(ct_469);
      c_471 := x_472;
      x_475 := mkconstr(Map_18, [f_468]);
      x_474 := send(c_471, x_475);
      c_473 := x_474;
      return c_473;
    };
  return x_470;
}

fn creduce_476(A_477%U, B_478%U, t_479%U, f_480%U, g_481%U, ct_482%U) {
  x_483 :=
    lazy {
      x_485 := force(ct_482);
      c_484 := x_485;
      x_488 := mkconstr(Reduce_19, [f_480, g_481]);
      x_487 := send(c_484, x_488);
      c_486 := x_487;
      x_490 := recv[U](c_486);
      _489 := x_490;
      match[L](_489){
        ex1UL_50(m_492, n_493) => {
          x_494 := lazy { 
                          return n_493; };
          x_495 := mkconstr(ex1UL_50, [m_492, x_494]);
          x_491 := x_495;
        }
      }
      return x_491;
    };
  return x_483;
}

fn splitU_496(__497%U) {
  match(__497){
    nilUU_38 => {
      x_499 := mkconstr(ex1UU_51, [nilUU_38, nilUU_38]);
      x_498 := x_499;
    }
    _ => {
      match[U](__497){
        consUU_39(hd_501, tl_502) => {
          match(tl_502){
            nilUU_38 => {
              x_504 := mkconstr(consUU_39, [hd_501, nilUU_38]);
              x_505 := mkconstr(ex1UU_51, [x_504, nilUU_38]);
              x_503 := x_505;
            }
            _ => {
              match[U](tl_502){
                consUU_39(hd_507, tl_508) => {
                  x_510 := splitU_496(tl_508);
                  match[L](x_510){
                    ex1UU_51(m_511, n_512) => {
                      x_513 := mkconstr(consUU_39, [hd_501, m_511]);
                      x_514 := mkconstr(consUU_39, [hd_507, n_512]);
                      x_515 := mkconstr(ex1UU_51, [x_513, x_514]);
                      x_509 := x_515;
                    }
                  }
                  x_506 := x_509;
                }
              }
              x_503 := x_506;
            }
          }
          x_500 := x_503;
        }
      }
      x_498 := x_500;
    }
  }
  return x_498;
}

fn splitL_516(__517%U) {
  match(__517){
    nilUL_36 => {
      x_519 := mkconstr(ex1LL_48, [nilUL_36, nilUL_36]);
      x_518 := x_519;
    }
    _ => {
      match[L](__517){
        consUL_37(hd_521, tl_522) => {
          match(tl_522){
            nilUL_36 => {
              x_524 := mkconstr(consUL_37, [hd_521, nilUL_36]);
              x_525 := mkconstr(ex1LL_48, [x_524, nilUL_36]);
              x_523 := x_525;
            }
            _ => {
              match[L](tl_522){
                consUL_37(hd_527, tl_528) => {
                  x_530 := splitL_516(tl_528);
                  match[L](x_530){
                    ex1LL_48(m_531, n_532) => {
                      x_533 := mkconstr(consUL_37, [hd_521, m_531]);
                      x_534 := mkconstr(consUL_37, [hd_527, n_532]);
                      x_535 := mkconstr(ex1LL_48, [x_533, x_534]);
                      x_529 := x_535;
                    }
                  }
                  x_526 := x_529;
                }
              }
              x_523 := x_526;
            }
          }
          x_520 := x_523;
        }
      }
      x_518 := x_520;
    }
  }
  return x_518;
}

fn mergeU_536(__537%U, __538%L) {
  match(__537){
    nilUU_38 => {
      x_539 := __538;
    }
    _ => {
      match[U](__537){
        consUU_39(hd_541, tl_542) => {
          match(__538){
            nilUU_38 => {
              x_544 := mkconstr(consUU_39, [hd_541, tl_542]);
              x_543 := x_544;
            }
            _ => {
              match[U](__538){
                consUU_39(hd_546, tl_547) => {
                  x_549 := lte(hd_541, hd_546);
                  match(x_549){
                    true_4 => {
                      x_551 := mkconstr(consUU_39, [hd_546, tl_547]);
                      x_550 := mergeU_536(tl_542, x_551);
                      x_552 := mkconstr(consUU_39, [hd_541, x_550]);
                      x_548 := x_552;
                    }
                    false_5 => {
                      x_554 := mkconstr(consUU_39, [hd_541, tl_542]);
                      x_553 := mergeU_536(x_554, tl_547);
                      x_555 := mkconstr(consUU_39, [hd_546, x_553]);
                      x_548 := x_555;
                    }
                  }
                  x_545 := x_548;
                }
              }
              x_543 := x_545;
            }
          }
          x_540 := x_543;
        }
      }
      x_539 := x_540;
    }
  }
  return x_539;
}

fn mergeL_556(__557%U, __558%L) {
  match(__557){
    nilUL_36 => {
      x_559 := __558;
    }
    _ => {
      match[L](__557){
        consUL_37(hd_561, tl_562) => {
          match(__558){
            nilUL_36 => {
              x_564 := mkconstr(consUL_37, [hd_561, tl_562]);
              x_563 := x_564;
            }
            _ => {
              match[L](__558){
                consUL_37(hd_566, tl_567) => {
                  x_569 := lte(hd_561, hd_566);
                  match(x_569){
                    true_4 => {
                      x_571 := mkconstr(consUL_37, [hd_566, tl_567]);
                      x_570 := mergeL_556(tl_562, x_571);
                      x_572 := mkconstr(consUL_37, [hd_561, x_570]);
                      x_568 := x_572;
                    }
                    false_5 => {
                      x_574 := mkconstr(consUL_37, [hd_561, tl_562]);
                      x_573 := mergeL_556(x_574, tl_567);
                      x_575 := mkconstr(consUL_37, [hd_566, x_573]);
                      x_568 := x_575;
                    }
                  }
                  x_565 := x_568;
                }
              }
              x_563 := x_565;
            }
          }
          x_560 := x_563;
        }
      }
      x_559 := x_560;
    }
  }
  return x_559;
}

fn msortU_576(__577%U) {
  match(__577){
    nilUU_38 => {
      x_578 := nilUU_38;
    }
    _ => {
      match[U](__577){
        consUU_39(hd_580, tl_581) => {
          match(tl_581){
            nilUU_38 => {
              x_583 := mkconstr(consUU_39, [hd_580, nilUU_38]);
              x_582 := x_583;
            }
            _ => {
              match[U](tl_581){
                consUU_39(hd_585, tl_586) => {
                  x_589 := mkconstr(consUU_39, [hd_585, tl_586]);
                  x_590 := mkconstr(consUU_39, [hd_580, x_589]);
                  x_588 := splitU_496(x_590);
                  match[L](x_588){
                    ex1UU_51(m_591, n_592) => {
                      x_594 := msortU_576(m_591);
                      x_595 := msortU_576(n_592);
                      x_593 := mergeU_536(x_594, x_595);
                      x_587 := x_593;
                    }
                  }
                  x_584 := x_587;
                }
              }
              x_582 := x_584;
            }
          }
          x_579 := x_582;
        }
      }
      x_578 := x_579;
    }
  }
  return x_578;
}

fn msortL_596(__597%U) {
  match(__597){
    nilUL_36 => {
      x_598 := nilUL_36;
    }
    _ => {
      match[L](__597){
        consUL_37(hd_600, tl_601) => {
          match(tl_601){
            nilUL_36 => {
              x_603 := mkconstr(consUL_37, [hd_600, nilUL_36]);
              x_602 := x_603;
            }
            _ => {
              match[L](tl_601){
                consUL_37(hd_605, tl_606) => {
                  x_609 := mkconstr(consUL_37, [hd_605, tl_606]);
                  x_610 := mkconstr(consUL_37, [hd_600, x_609]);
                  x_608 := splitL_516(x_610);
                  match[L](x_608){
                    ex1LL_48(m_611, n_612) => {
                      x_614 := msortL_596(m_611);
                      x_615 := msortL_596(n_612);
                      x_613 := mergeL_556(x_614, x_615);
                      x_607 := x_613;
                    }
                  }
                  x_604 := x_607;
                }
              }
              x_602 := x_604;
            }
          }
          x_599 := x_602;
        }
      }
      x_598 := x_599;
    }
  }
  return x_598;
}

fn splitting_tree_616(__617%U) {
  match(__617){
    nilUU_38 => {
      x_619 := mkconstr(Leaf_15, [nilUU_38]);
      x_618 := x_619;
    }
    _ => {
      match[U](__617){
        consUU_39(hd_621, tl_622) => {
          match(tl_622){
            nilUU_38 => {
              x_624 := mkconstr(consUU_39, [hd_621, nilUU_38]);
              x_625 := mkconstr(Leaf_15, [x_624]);
              x_623 := x_625;
            }
            _ => {
              match[U](tl_622){
                consUU_39(hd_627, tl_628) => {
                  x_631 := mkconstr(consUU_39, [hd_627, tl_628]);
                  x_632 := mkconstr(consUU_39, [hd_621, x_631]);
                  x_630 := splitU_496(x_632);
                  match[L](x_630){
                    ex1UU_51(m_633, n_634) => {
                      x_636 := splitting_tree_616(m_633);
                      l_635 := x_636;
                      x_638 := splitting_tree_616(n_634);
                      r_637 := x_638;
                      x_639 := mkconstr(Node_16, [l_635, r_637]);
                      x_629 := x_639;
                    }
                  }
                  x_626 := x_629;
                }
              }
              x_623 := x_626;
            }
          }
          x_620 := x_623;
        }
      }
      x_618 := x_620;
    }
  }
  return x_618;
}

fn splitting_ctree_640(xs_641%U, __642%U) {
  match(xs_641){
    nilUU_38 => {
      x_644 :=
        lazy {
          x_647 := cleaf_418(NULL, nilUU_38);
          x_646 := send(__642, x_647);
          c_645 := x_646;
          x_649 := close[true](c_645);
          __648 := x_649;
          return ttU_27;
        };
      x_643 := x_644;
    }
    _ => {
      match[U](xs_641){
        consUU_39(hd_651, tl_652) => {
          match(tl_652){
            nilUU_38 => {
              x_654 :=
                lazy {
                  x_658 := mkconstr(consUU_39, [hd_651, nilUU_38]);
                  x_657 := cleaf_418(NULL, x_658);
                  x_656 := send(__642, x_657);
                  c_655 := x_656;
                  x_660 := close[true](c_655);
                  __659 := x_660;
                  return ttU_27;
                };
              x_653 := x_654;
            }
            _ => {
              match[U](tl_652){
                consUU_39(hd_662, tl_663) => {
                  x_666 := mkconstr(consUU_39, [hd_662, tl_663]);
                  x_667 := mkconstr(consUU_39, [hd_651, x_666]);
                  x_665 := splitU_496(x_667);
                  match[L](x_665){
                    ex1UU_51(m_668, n_669) => {
                      x_670 :=
                        lazy {
                          x_673 :=
                            fn lam_674(_675%L) {
                              x_676 := splitting_ctree_640(m_668, _675);
                              return x_676;
                            };
                          x_672 := fork(x_673);
                          cl_671 := x_672;
                          x_679 :=
                            fn lam_680(_681%L) {
                              x_682 := splitting_ctree_640(n_669, _681);
                              return x_682;
                            };
                          x_678 := fork(x_679);
                          cr_677 := x_678;
                          x_684 := recv[L](cl_671);
                          _683 := x_684;
                          match[L](_683){
                            ex1LL_48(m_686, n_687) => {
                              x_689 := close[false](n_687);
                              __688 := x_689;
                              x_691 := recv[L](cr_677);
                              _690 := x_691;
                              match[L](_690){
                                ex1LL_48(m_693, n_694) => {
                                  x_696 := close[false](n_694);
                                  __695 := x_696;
                                  x_698 := cnode_427(NULL, NULL, NULL, m_686, m_693);
                                  ct_697 := x_698;
                                  x_700 := rwlUL_14(NULL, NULL, NULL, NULL, NULL, ct_697);
                                  ct_699 := x_700;
                                  x_702 := send(__642, ct_699);
                                  c_701 := x_702;
                                  x_703 := close[true](c_701);
                                  x_692 := x_703;
                                }
                              }
                              x_685 := x_692;
                            }
                          }
                          return x_685;
                        };
                      x_664 := x_670;
                    }
                  }
                  x_661 := x_664;
                }
              }
              x_653 := x_661;
            }
          }
          x_650 := x_653;
        }
      }
      x_643 := x_650;
    }
  }
  return x_643;
}

fn cmsort_704(xs_705%U) {
  x_706 :=
    lazy {
      x_709 :=
        fn lam_710(_711%L) {
          x_712 := splitting_ctree_640(xs_705, _711);
          return x_712;
        };
      x_708 := fork(x_709);
      c_707 := x_708;
      x_714 := recv[L](c_707);
      _713 := x_714;
      match[L](_713){
        ex1LL_48(m_716, n_717) => {
          x_719 := close[false](n_717);
          __718 := x_719;
          x_723 := fn lam_724(x_725%U) { 
                                         return x_725; };
          x_726 :=
            fn lam_727(l_728%U, r_729%U) {
              x_730 := mergeU_536(l_728, r_729);
              return x_730;
            };
          x_722 := creduce_476(NULL, NULL, NULL, x_723, x_726, m_716);
          x_721 := force(x_722);
          _720 := x_721;
          match[L](_720){
            ex1UL_50(m_732, n_733) => {
              x_735 := rwlUU_7(NULL, NULL, NULL, NULL, NULL, m_732);
              result_734 := x_735;
              x_738 := cfree_454(NULL, NULL, n_733);
              x_737 := force(x_738);
              __736 := x_737;
              x_731 := result_734;
            }
          }
          x_715 := x_731;
        }
      }
      return x_715;
    };
  return x_706;
}

fn mklistU_739(n_740%U) {
  x_742 := lte(n_740, 0);
  match(x_742){
    true_4 => {
      x_741 := nilUU_38;
    }
    false_5 => {
      x_744 := sub(n_740, 1);
      x_743 := mklistU_739(x_744);
      x_745 := mkconstr(consUU_39, [n_740, x_743]);
      x_741 := x_745;
    }
  }
  return x_741;
}

fn mklistL_746(n_747%U) {
  x_749 := lte(n_747, 0);
  match(x_749){
    true_4 => {
      x_748 := nilUL_36;
    }
    false_5 => {
      x_751 := sub(n_747, 1);
      x_750 := mklistL_746(x_751);
      x_752 := mkconstr(consUL_37, [n_747, x_750]);
      x_748 := x_752;
    }
  }
  return x_748;
}

fn list_lenU_753(__754%U) {
  match(__754){
    nilUU_38 => {
      x_755 := 0;
    }
    _ => {
      match[U](__754){
        consUU_39(hd_757, tl_758) => {
          x_760 := list_lenU_753(tl_758);
          x_759 := add(1, x_760);
          x_756 := x_759;
        }
      }
      x_755 := x_756;
    }
  }
  return x_755;
}

fn list_lenL_761(__762%U) {
  match(__762){
    nilUL_36 => {
      x_763 := 0;
    }
    _ => {
      match[L](__762){
        consUL_37(hd_765, tl_766) => {
          x_768 := list_lenL_761(tl_766);
          x_767 := add(1, x_768);
          x_764 := x_767;
        }
      }
      x_763 := x_764;
    }
  }
  return x_763;
}

fn print_listU_769(__770%U) {
  match(__770){
    nilUU_38 => {
      x_772 :=
        lazy { x_774 := str("nil");
               x_773 := print(x_774);
               return x_773; };
      x_771 := x_772;
    }
    _ => {
      match[U](__770){
        consUU_39(hd_776, tl_777) => {
          x_778 :=
            lazy {
              x_781 := string_of_int_282(hd_776);
              x_780 := print(x_781);
              __779 := x_780;
              x_784 := str(" :: ");
              x_783 := print(x_784);
              __782 := x_783;
              x_786 := print_listU_769(tl_777);
              x_785 := force(x_786);
              return x_785;
            };
          x_775 := x_778;
        }
      }
      x_771 := x_775;
    }
  }
  return x_771;
}

fn print_listL_787(__788%U) {
  match(__788){
    nilUL_36 => {
      x_790 :=
        lazy { x_792 := str("nil");
               x_791 := print(x_792);
               return x_791; };
      x_789 := x_790;
    }
    _ => {
      match[L](__788){
        consUL_37(hd_794, tl_795) => {
          x_796 :=
            lazy {
              x_799 := string_of_int_282(hd_794);
              x_798 := print(x_799);
              __797 := x_798;
              x_802 := str(" :: ");
              x_801 := print(x_802);
              __800 := x_801;
              x_804 := print_listL_787(tl_795);
              x_803 := force(x_804);
              return x_803;
            };
          x_793 := x_796;
        }
      }
      x_789 := x_793;
    }
  }
  return x_789;
}

main := {
  x_806 := mklistU_739(100);
  test_805 := x_806;
  x_807 :=
    lazy {
      x_810 := cmsort_704(test_805);
      x_809 := force(x_810);
      _808 := x_809;
      x_812 := print_listU_769(_808);
      x_811 := force(x_812);
      return x_811;
    };
  return x_807;
};

[trans34 success]

-----------------------------------------

fn idU_1(A_2%U, m_3%U) {
  
  return m_3;
}

fn idL_4(A_5%U, m_6%U) {
  
  return m_6;
}

fn rwlUU_7(A_8%U, m_9%U, n_10%U, B_11%U, __12%U, __13%U) {
  
  return __13;
}

fn rwlUL_14(A_15%U, m_16%U, n_17%U, B_18%U, __19%U, __20%U) {
  
  return __20;
}

fn rwlLU_21(A_22%U, m_23%U, n_24%U, B_25%U, __26%U, __27%U) {
  
  return __27;
}

fn rwlLL_28(A_29%U, m_30%U, n_31%U, B_32%U, __33%U, __34%U) {
  
  return __34;
}

fn rwrUU_35(A_36%U, m_37%U, n_38%U, B_39%U, __40%U, __41%U) {
  
  return __41;
}

fn rwrUL_42(A_43%U, m_44%U, n_45%U, B_46%U, __47%U, __48%U) {
  
  return __48;
}

fn rwrLU_49(A_50%U, m_51%U, n_52%U, B_53%U, __54%U, __55%U) {
  
  return __55;
}

fn rwrLL_56(A_57%U, m_58%U, n_59%U, B_60%U, __61%U, __62%U) {
  
  return __62;
}

fn sing_elimUU_63(A_64%U, x_65%U, __66%U) {
  
  return __66;
}

fn sing_elimUL_67(A_68%U, x_69%U, __70%U) {
  
  return __70;
}

fn sing_elimLU_71(A_72%U, x_73%U, __74%U) {
  absurd;
  return NULL;
}

fn sing_elimLL_75(A_76%U, x_77%U, __78%U) {
  
  return __78;
}

fn not_79(__80%U) {
  match(__80){ true_4 => {
                 x_81 := false_5;
               }
               false_5 => {
                 x_81 := true_4;
               }
  }
  return x_81;
}

fn and_82(__83%U, __84%U) {
  match(__83){
    true_4 => {
      match(__84){
        true_4 => {
          x_86 := true_4;
        }
        false_5 => {
          x_86 := false_5;
        }
      }
      x_85 := x_86;
    }
    false_5 => {
      x_85 := false_5;
    }
  }
  return x_85;
}

fn or_87(__88%U, __89%U) {
  match(__88){
    true_4 => {
      x_90 := true_4;
    }
    false_5 => {
      match(__89){
        true_4 => {
          x_91 := true_4;
        }
        false_5 => {
          x_91 := false_5;
        }
      }
      x_90 := x_91;
    }
  }
  return x_90;
}

fn xor_92(__93%U, __94%U) {
  match(__93){
    true_4 => {
      match(__94){
        true_4 => {
          x_96 := false_5;
        }
        false_5 => {
          x_96 := true_4;
        }
      }
      x_95 := x_96;
    }
    false_5 => {
      match(__94){
        true_4 => {
          x_97 := true_4;
        }
        false_5 => {
          x_97 := false_5;
        }
      }
      x_95 := x_97;
    }
  }
  return x_95;
}

fn string_of_bool_98(__99%U) {
  match(__99){
    true_4 => {
      x_101 := str("true");
      x_100 := x_101;
    }
    false_5 => {
      x_102 := str("false");
      x_100 := x_102;
    }
  }
  return x_100;
}

fn lte_103(__104%U, __105%U) {
  match(__104){
    zero_6 => {
      x_106 := true_4;
    }
    _ => {
      match[U](__104){
        succ_7(n_108) => {
          match(__105){
            zero_6 => {
              x_109 := false_5;
            }
            _ => {
              match[U](__105){
                succ_7(n_111) => {
                  x_112 := lte_103(n_108, n_111);
                  x_110 := x_112;
                }
              }
              x_109 := x_110;
            }
          }
          x_107 := x_109;
        }
      }
      x_106 := x_107;
    }
  }
  return x_106;
}

fn lt_113(x_114%U, y_115%U) {
  x_117 := mkconstr(succ_7, [x_114]);
  x_116 := lte_103(x_117, y_115);
  return x_116;
}

fn pred_118(__119%U) {
  match(__119){
    zero_6 => {
      x_120 := zero_6;
    }
    _ => {
      match[U](__119){ succ_7(n_122) => {
                         x_121 := n_122;
                       } }
      x_120 := x_121;
    }
  }
  return x_120;
}

fn add_123(__124%U, __125%U) {
  match(__124){
    zero_6 => {
      x_126 := __125;
    }
    _ => {
      match[U](__124){
        succ_7(n_128) => {
          x_129 := add_123(n_128, __125);
          x_130 := mkconstr(succ_7, [x_129]);
          x_127 := x_130;
        }
      }
      x_126 := x_127;
    }
  }
  return x_126;
}

fn sub_131(__132%U, __133%U) {
  match(__133){
    zero_6 => {
      x_134 := __132;
    }
    _ => {
      match[U](__133){
        succ_7(n_136) => {
          x_138 := pred_118(__132);
          x_137 := sub_131(x_138, n_136);
          x_135 := x_137;
        }
      }
      x_134 := x_135;
    }
  }
  return x_134;
}

fn mul_139(__140%U, __141%U) {
  match(__140){
    zero_6 => {
      x_142 := zero_6;
    }
    _ => {
      match[U](__140){
        succ_7(n_144) => {
          x_146 := mul_139(n_144, __141);
          x_145 := add_123(__141, x_146);
          x_143 := x_145;
        }
      }
      x_142 := x_143;
    }
  }
  return x_142;
}

fn div_147(x_148%U, y_149%U) {
  x_151 := lt_113(x_148, y_149);
  match(x_151){
    true_4 => {
      x_150 := zero_6;
    }
    false_5 => {
      x_153 :=
        fn loop_154(x_155%U, y_156%U) {
          x_159 := pred_118(y_156);
          x_158 := sub_131(x_155, x_159);
          match(x_158){
            zero_6 => {
              x_157 := zero_6;
            }
            _ => {
              x_162 := pred_118(y_156);
              x_161 := sub_131(x_155, x_162);
              match[U](x_161){
                succ_7(n_163) => {
                  x_164 := loop_154(n_163, y_156);
                  x_165 := mkconstr(succ_7, [x_164]);
                  x_160 := x_165;
                }
              }
              x_157 := x_160;
            }
          }
          return x_157;
        };
      loop_152 := x_153;
      x_166 := loop_152(x_148, y_149);
      x_150 := x_166;
    }
  }
  return x_150;
}

fn rem_167(x_168%U, y_169%U) {
  x_172 := div_147(x_168, y_169);
  x_171 := mul_139(x_172, y_169);
  x_170 := sub_131(x_168, x_171);
  return x_170;
}

fn rconsUU_173(A_174%U, __175%L, __176%L) {
  match(__175){
    nilUU_38 => {
      x_178 := mkconstr(consUU_39, [__176, nilUU_38]);
      x_177 := x_178;
    }
    _ => {
      match[U](__175){
        consUU_39(hd_180, tl_181) => {
          x_182 := rconsUU_173(NULL, tl_181, __176);
          x_183 := mkconstr(consUU_39, [hd_180, x_182]);
          x_179 := x_183;
        }
      }
      x_177 := x_179;
    }
  }
  return x_177;
}

fn rconsUL_184(A_185%U, __186%L, __187%L) {
  match(__186){
    nilUL_36 => {
      x_189 := mkconstr(consUL_37, [__187, nilUL_36]);
      x_188 := x_189;
    }
    _ => {
      match[L](__186){
        consUL_37(hd_191, tl_192) => {
          x_193 := rconsUL_184(NULL, tl_192, __187);
          x_194 := reconstr(__186, consUL_37, [hd_191, x_193]);
          x_190 := x_194;
        }
      }
      x_188 := x_190;
    }
  }
  return x_188;
}

fn rconsLL_195(A_196%U, __197%L, __198%L) {
  match(__197){
    nilLL_32 => {
      x_200 := mkconstr(consLL_33, [__198, nilLL_32]);
      x_199 := x_200;
    }
    _ => {
      match[L](__197){
        consLL_33(hd_202, tl_203) => {
          x_204 := rconsLL_195(NULL, tl_203, __198);
          x_205 := reconstr(__197, consLL_33, [hd_202, x_204]);
          x_201 := x_205;
        }
      }
      x_199 := x_201;
    }
  }
  return x_199;
}

fn free_listUU_206(A_207%U, f_208%U, __209%U) {
  match(__209){
    nilUU_38 => {
      x_210 := ttU_27;
    }
    _ => {
      match[U](__209){
        consUU_39(hd_212, tl_213) => {
          x_215 := f_208(hd_212);
          __214 := x_215;
          x_216 := free_listUU_206(NULL, f_208, tl_213);
          x_211 := x_216;
        }
      }
      x_210 := x_211;
    }
  }
  return x_210;
}

fn free_listUL_217(A_218%U, f_219%U, __220%U) {
  match(__220){
    nilUL_36 => {
      x_221 := ttU_27;
    }
    _ => {
      match[L](__220){
        consUL_37(hd_223, tl_224) => {
          x_226 := f_219(hd_223);
          __225 := x_226;
          x_227 := free_listUL_217(NULL, f_219, tl_224);
          x_222 := x_227;
          free(__220);
        }
      }
      x_221 := x_222;
    }
  }
  return x_221;
}

fn free_listLL_228(A_229%U, f_230%U, __231%U) {
  match(__231){
    nilLL_32 => {
      x_232 := ttU_27;
    }
    _ => {
      match[L](__231){
        consLL_33(hd_234, tl_235) => {
          x_237 := f_230(hd_234);
          __236 := x_237;
          x_238 := free_listLL_228(NULL, f_230, tl_235);
          x_233 := x_238;
          free(__231);
        }
      }
      x_232 := x_233;
    }
  }
  return x_232;
}

fn pow_239(x_240%U, y_241%U) {
  x_243 :=
    fn loop_244(acc_245%U, y_246%U) {
      x_248 := lte(y_246, 0);
      match(x_248){
        true_4 => {
          x_247 := acc_245;
        }
        false_5 => {
          x_250 := mul(x_240, acc_245);
          x_251 := sub(y_246, 1);
          x_249 := loop_244(x_250, x_251);
          x_247 := x_249;
        }
      }
      return x_247;
    };
  loop_242 := x_243;
  x_252 := loop_242(1, y_241);
  return x_252;
}

fn powm_253(x_254%U, y_255%U, m_256%U) {
  x_258 :=
    fn loop_259(acc_260%U, y_261%U) {
      x_263 := lte(y_261, 0);
      match(x_263){
        true_4 => {
          x_262 := acc_260;
        }
        false_5 => {
          x_266 := mul(x_254, acc_260);
          x_265 := mod(x_266, m_256);
          x_267 := sub(y_261, 1);
          x_264 := loop_259(x_265, x_267);
          x_262 := x_264;
        }
      }
      return x_262;
    };
  loop_257 := x_258;
  x_268 := loop_257(1, y_255);
  return x_268;
}

fn ord_269(c_270%U) {
  x_271 := ord(c_270);
  return x_271;
}

fn chr_272(i_273%U) {
  x_274 := chr(i_273);
  return x_274;
}

fn str_275(c_276%U) {
  x_278 := str("");
  x_277 := push(x_278, c_276);
  return x_277;
}

fn strlen_279(s_280%U) {
  x_281 := size(s_280);
  return x_281;
}

fn string_of_int_282(i_283%U) {
  x_285 :=
    fn aux_286(i_287%U) {
      x_289 := lte(10, i_287);
      match(x_289){
        true_4 => {
          x_291 := mod(i_287, 10);
          r_290 := x_291;
          x_293 := div(i_287, 10);
          i_292 := x_293;
          x_295 := aux_286(i_292);
          x_298 := ord_269(0);
          x_297 := add(r_290, x_298);
          x_296 := chr_272(x_297);
          x_294 := push(x_295, x_296);
          x_288 := x_294;
        }
        false_5 => {
          x_302 := ord_269(0);
          x_301 := add(i_287, x_302);
          x_300 := chr_272(x_301);
          x_299 := str_275(x_300);
          x_288 := x_299;
        }
      }
      return x_288;
    };
  aux_284 := x_285;
  x_304 := lte(0, i_283);
  match(x_304){
    true_4 => {
      x_305 := aux_284(i_283);
      x_303 := x_305;
    }
    false_5 => {
      x_307 := str("~");
      x_309 := neg(i_283);
      x_308 := aux_284(x_309);
      x_306 := cat(x_307, x_308);
      x_303 := x_306;
    }
  }
  return x_303;
}

fn map_310(A_311%U, B_312%U, f_313%U, __314%U) {
  match[U](__314){
    Leaf_15(x_316) => {
      x_317 := f_313(x_316);
      x_318 := mkconstr(Leaf_15, [x_317]);
      x_315 := x_318;
    }
    Node_16(l_319, r_320) => {
      x_321 := map_310(NULL, NULL, f_313, l_319);
      x_322 := map_310(NULL, NULL, f_313, r_320);
      x_323 := mkconstr(Node_16, [x_321, x_322]);
      x_315 := x_323;
    }
  }
  return x_315;
}

fn reduce_324(A_325%U, B_326%U, f_327%U, g_328%U, __329%U) {
  match[U](__329){
    Leaf_15(x_331) => {
      x_332 := f_327(x_331);
      x_330 := x_332;
    }
    Node_16(l_333, r_334) => {
      x_336 := reduce_324(NULL, NULL, f_327, g_328, l_333);
      x_337 := reduce_324(NULL, NULL, f_327, g_328, r_334);
      x_335 := g_328(x_336, x_337);
      x_330 := x_335;
    }
  }
  return x_330;
}

fn leaf_worker_338(A_339%U, x_340%U, c_341%U) {
  x_342 :=
    lazy {
      x_344 := recv[L](c_341);
      _343 := x_344;
      match[L](_343){
        ex1LL_48(m_346, n_347) => {
          match(m_346){
            Free_17 => {
              x_349 := close[true](n_347);
              x_348 := x_349;
            }
            _ => {
              match[L](m_346){
                Map_18(f_351) => {
                  x_354 := f_351(x_340);
                  x_353 := leaf_worker_338(NULL, x_354, n_347);
                  x_352 := force(x_353);
                  x_350 := x_352;
                  free(m_346);
                }
                Reduce_19(f_355, g_356) => {
                  x_359 := f_355(x_340);
                  x_358 := send(n_347, x_359);
                  c_357 := x_358;
                  x_361 := leaf_worker_338(NULL, x_340, c_357);
                  x_360 := force(x_361);
                  x_350 := x_360;
                  free(m_346);
                }
              }
              x_348 := x_350;
            }
          }
          x_345 := x_348;
          free(_343);
        }
      }
      return x_345;
    };
  return x_342;
}

fn node_worker_362(A_363%U, l_364%U, r_365%U, __366%L, __367%L, __368%L) {
  x_369 :=
    lazy {
      x_371 := recv[L](__368);
      _370 := x_371;
      match[L](_370){
        ex1LL_48(m_373, n_374) => {
          match(m_373){
            Free_17 => {
              x_377 := send(__366, Free_17);
              l_ch_376 := x_377;
              x_379 := send(__367, Free_17);
              r_ch_378 := x_379;
              x_381 := close[false](l_ch_376);
              __380 := x_381;
              x_383 := close[false](r_ch_378);
              __382 := x_383;
              x_384 := close[true](n_374);
              x_375 := x_384;
            }
            _ => {
              match[L](m_373){
                Map_18(f_386) => {
                  x_389 := reconstr(m_373, Map_18, [f_386]);
                  x_388 := send(__366, x_389);
                  l_ch_387 := x_388;
                  x_392 := mkconstr(Map_18, [f_386]);
                  x_391 := send(__367, x_392);
                  r_ch_390 := x_391;
                  x_394 := node_worker_362(NULL, NULL, NULL, l_ch_387, r_ch_390, n_374);
                  x_393 := force(x_394);
                  x_385 := x_393;
                }
                Reduce_19(f_395, g_396) => {
                  x_399 := reconstr(m_373, Reduce_19, [f_395, g_396]);
                  x_398 := send(__366, x_399);
                  l_ch_397 := x_398;
                  x_402 := mkconstr(Reduce_19, [f_395, g_396]);
                  x_401 := send(__367, x_402);
                  r_ch_400 := x_401;
                  x_404 := recv[U](l_ch_397);
                  _403 := x_404;
                  match[L](_403){
                    ex1UL_50(m_406, n_407) => {
                      x_409 := recv[U](r_ch_400);
                      _408 := x_409;
                      match[L](_408){
                        ex1UL_50(m_411, n_412) => {
                          x_415 := g_396(m_406, m_411);
                          x_414 := send(n_374, x_415);
                          c_413 := x_414;
                          x_417 := node_worker_362(NULL, NULL, NULL, n_407, n_412, c_413);
                          x_416 := force(x_417);
                          x_410 := x_416;
                          free(_408);
                        }
                      }
                      x_405 := x_410;
                      free(_403);
                    }
                  }
                  x_385 := x_405;
                }
              }
              x_375 := x_385;
            }
          }
          x_372 := x_375;
          free(_370);
        }
      }
      return x_372;
    };
  return x_369;
}

fn cleaf_418(A_419%U, x_420%U) {
  x_421 :=
    lazy {
      x_423 :=
        fn lam_424(_425%L) {
          x_426 := leaf_worker_338(NULL, x_420, _425);
          return x_426;
        };
      x_422 := fork(x_423);
      return x_422;
    };
  return x_421;
}

fn cnode_427(A_428%U, l_429%U, r_430%U, __431%L, __432%L) {
  x_433 :=
    lazy {
      x_435 := force(__431);
      l_ch_434 := x_435;
      x_437 := force(__432);
      r_ch_436 := x_437;
      x_439 :=
        fn lam_440(_441%L) {
          x_442 := node_worker_362(NULL, NULL, NULL, l_ch_434, r_ch_436, _441);
          return x_442;
        };
      x_438 := fork(x_439);
      return x_438;
    };
  return x_433;
}

fn ctree_of_tree_443(A_444%U, t_445%U) {
  match[U](t_445){
    Leaf_15(x_447) => {
      x_448 := cleaf_418(NULL, x_447);
      x_446 := x_448;
    }
    Node_16(l_449, r_450) => {
      x_452 := ctree_of_tree_443(NULL, l_449);
      x_453 := ctree_of_tree_443(NULL, r_450);
      x_451 := cnode_427(NULL, NULL, NULL, x_452, x_453);
      x_446 := x_451;
    }
  }
  return x_446;
}

fn cfree_454(A_455%U, t_456%U, ct_457%U) {
  x_458 :=
    lazy {
      x_460 := force(ct_457);
      c_459 := x_460;
      x_462 := send(c_459, Free_17);
      c_461 := x_462;
      x_463 := close[false](c_461);
      return x_463;
    };
  return x_458;
}

fn cmap_464(A_465%U, B_466%U, t_467%U, f_468%U, ct_469%U) {
  x_470 :=
    lazy {
      x_472 := force(ct_469);
      c_471 := x_472;
      x_475 := mkconstr(Map_18, [f_468]);
      x_474 := send(c_471, x_475);
      c_473 := x_474;
      return c_473;
    };
  return x_470;
}

fn creduce_476(A_477%U, B_478%U, t_479%U, f_480%U, g_481%U, ct_482%U) {
  x_483 :=
    lazy {
      x_485 := force(ct_482);
      c_484 := x_485;
      x_488 := mkconstr(Reduce_19, [f_480, g_481]);
      x_487 := send(c_484, x_488);
      c_486 := x_487;
      x_490 := recv[U](c_486);
      _489 := x_490;
      match[L](_489){
        ex1UL_50(m_492, n_493) => {
          x_494 := lazy { 
                          return n_493; };
          x_495 := reconstr(_489, ex1UL_50, [m_492, x_494]);
          x_491 := x_495;
        }
      }
      return x_491;
    };
  return x_483;
}

fn splitU_496(__497%U) {
  match(__497){
    nilUU_38 => {
      x_499 := mkconstr(ex1UU_51, [nilUU_38, nilUU_38]);
      x_498 := x_499;
    }
    _ => {
      match[U](__497){
        consUU_39(hd_501, tl_502) => {
          match(tl_502){
            nilUU_38 => {
              x_504 := mkconstr(consUU_39, [hd_501, nilUU_38]);
              x_505 := mkconstr(ex1UU_51, [x_504, nilUU_38]);
              x_503 := x_505;
            }
            _ => {
              match[U](tl_502){
                consUU_39(hd_507, tl_508) => {
                  x_510 := splitU_496(tl_508);
                  match[L](x_510){
                    ex1UU_51(m_511, n_512) => {
                      x_513 := reconstr(x_510, consUU_39, [hd_501, m_511]);
                      x_514 := mkconstr(consUU_39, [hd_507, n_512]);
                      x_515 := mkconstr(ex1UU_51, [x_513, x_514]);
                      x_509 := x_515;
                    }
                  }
                  x_506 := x_509;
                }
              }
              x_503 := x_506;
            }
          }
          x_500 := x_503;
        }
      }
      x_498 := x_500;
    }
  }
  return x_498;
}

fn splitL_516(__517%U) {
  match(__517){
    nilUL_36 => {
      x_519 := mkconstr(ex1LL_48, [nilUL_36, nilUL_36]);
      x_518 := x_519;
    }
    _ => {
      match[L](__517){
        consUL_37(hd_521, tl_522) => {
          match(tl_522){
            nilUL_36 => {
              x_524 := reconstr(__517, consUL_37, [hd_521, nilUL_36]);
              x_525 := mkconstr(ex1LL_48, [x_524, nilUL_36]);
              x_523 := x_525;
            }
            _ => {
              match[L](tl_522){
                consUL_37(hd_527, tl_528) => {
                  x_530 := splitL_516(tl_528);
                  match[L](x_530){
                    ex1LL_48(m_531, n_532) => {
                      x_533 := reconstr(x_530, consUL_37, [hd_521, m_531]);
                      x_534 := reconstr(tl_522, consUL_37, [hd_527, n_532]);
                      x_535 := reconstr(__517, ex1LL_48, [x_533, x_534]);
                      x_529 := x_535;
                    }
                  }
                  x_526 := x_529;
                }
              }
              x_523 := x_526;
            }
          }
          x_520 := x_523;
        }
      }
      x_518 := x_520;
    }
  }
  return x_518;
}

fn mergeU_536(__537%U, __538%L) {
  match(__537){
    nilUU_38 => {
      x_539 := __538;
    }
    _ => {
      match[U](__537){
        consUU_39(hd_541, tl_542) => {
          match(__538){
            nilUU_38 => {
              x_544 := mkconstr(consUU_39, [hd_541, tl_542]);
              x_543 := x_544;
            }
            _ => {
              match[U](__538){
                consUU_39(hd_546, tl_547) => {
                  x_549 := lte(hd_541, hd_546);
                  match(x_549){
                    true_4 => {
                      x_551 := mkconstr(consUU_39, [hd_546, tl_547]);
                      x_550 := mergeU_536(tl_542, x_551);
                      x_552 := mkconstr(consUU_39, [hd_541, x_550]);
                      x_548 := x_552;
                    }
                    false_5 => {
                      x_554 := mkconstr(consUU_39, [hd_541, tl_542]);
                      x_553 := mergeU_536(x_554, tl_547);
                      x_555 := mkconstr(consUU_39, [hd_546, x_553]);
                      x_548 := x_555;
                    }
                  }
                  x_545 := x_548;
                }
              }
              x_543 := x_545;
            }
          }
          x_540 := x_543;
        }
      }
      x_539 := x_540;
    }
  }
  return x_539;
}

fn mergeL_556(__557%U, __558%L) {
  match(__557){
    nilUL_36 => {
      x_559 := __558;
    }
    _ => {
      match[L](__557){
        consUL_37(hd_561, tl_562) => {
          match(__558){
            nilUL_36 => {
              x_564 := reconstr(__557, consUL_37, [hd_561, tl_562]);
              x_563 := x_564;
            }
            _ => {
              match[L](__558){
                consUL_37(hd_566, tl_567) => {
                  x_569 := lte(hd_561, hd_566);
                  match(x_569){
                    true_4 => {
                      x_571 := reconstr(__558, consUL_37, [hd_566, tl_567]);
                      x_570 := mergeL_556(tl_562, x_571);
                      x_572 := reconstr(__557, consUL_37, [hd_561, x_570]);
                      x_568 := x_572;
                    }
                    false_5 => {
                      x_574 := reconstr(__558, consUL_37, [hd_561, tl_562]);
                      x_573 := mergeL_556(x_574, tl_567);
                      x_575 := reconstr(__557, consUL_37, [hd_566, x_573]);
                      x_568 := x_575;
                    }
                  }
                  x_565 := x_568;
                }
              }
              x_563 := x_565;
            }
          }
          x_560 := x_563;
        }
      }
      x_559 := x_560;
    }
  }
  return x_559;
}

fn msortU_576(__577%U) {
  match(__577){
    nilUU_38 => {
      x_578 := nilUU_38;
    }
    _ => {
      match[U](__577){
        consUU_39(hd_580, tl_581) => {
          match(tl_581){
            nilUU_38 => {
              x_583 := mkconstr(consUU_39, [hd_580, nilUU_38]);
              x_582 := x_583;
            }
            _ => {
              match[U](tl_581){
                consUU_39(hd_585, tl_586) => {
                  x_589 := mkconstr(consUU_39, [hd_585, tl_586]);
                  x_590 := mkconstr(consUU_39, [hd_580, x_589]);
                  x_588 := splitU_496(x_590);
                  match[L](x_588){
                    ex1UU_51(m_591, n_592) => {
                      x_594 := msortU_576(m_591);
                      x_595 := msortU_576(n_592);
                      x_593 := mergeU_536(x_594, x_595);
                      x_587 := x_593;
                      free(x_588);
                    }
                  }
                  x_584 := x_587;
                }
              }
              x_582 := x_584;
            }
          }
          x_579 := x_582;
        }
      }
      x_578 := x_579;
    }
  }
  return x_578;
}

fn msortL_596(__597%U) {
  match(__597){
    nilUL_36 => {
      x_598 := nilUL_36;
    }
    _ => {
      match[L](__597){
        consUL_37(hd_600, tl_601) => {
          match(tl_601){
            nilUL_36 => {
              x_603 := reconstr(__597, consUL_37, [hd_600, nilUL_36]);
              x_602 := x_603;
            }
            _ => {
              match[L](tl_601){
                consUL_37(hd_605, tl_606) => {
                  x_609 := reconstr(tl_601, consUL_37, [hd_605, tl_606]);
                  x_610 := reconstr(__597, consUL_37, [hd_600, x_609]);
                  x_608 := splitL_516(x_610);
                  match[L](x_608){
                    ex1LL_48(m_611, n_612) => {
                      x_614 := msortL_596(m_611);
                      x_615 := msortL_596(n_612);
                      x_613 := mergeL_556(x_614, x_615);
                      x_607 := x_613;
                      free(x_608);
                    }
                  }
                  x_604 := x_607;
                }
              }
              x_602 := x_604;
            }
          }
          x_599 := x_602;
        }
      }
      x_598 := x_599;
    }
  }
  return x_598;
}

fn splitting_tree_616(__617%U) {
  match(__617){
    nilUU_38 => {
      x_619 := mkconstr(Leaf_15, [nilUU_38]);
      x_618 := x_619;
    }
    _ => {
      match[U](__617){
        consUU_39(hd_621, tl_622) => {
          match(tl_622){
            nilUU_38 => {
              x_624 := mkconstr(consUU_39, [hd_621, nilUU_38]);
              x_625 := mkconstr(Leaf_15, [x_624]);
              x_623 := x_625;
            }
            _ => {
              match[U](tl_622){
                consUU_39(hd_627, tl_628) => {
                  x_631 := mkconstr(consUU_39, [hd_627, tl_628]);
                  x_632 := mkconstr(consUU_39, [hd_621, x_631]);
                  x_630 := splitU_496(x_632);
                  match[L](x_630){
                    ex1UU_51(m_633, n_634) => {
                      x_636 := splitting_tree_616(m_633);
                      l_635 := x_636;
                      x_638 := splitting_tree_616(n_634);
                      r_637 := x_638;
                      x_639 := reconstr(x_630, Node_16, [l_635, r_637]);
                      x_629 := x_639;
                    }
                  }
                  x_626 := x_629;
                }
              }
              x_623 := x_626;
            }
          }
          x_620 := x_623;
        }
      }
      x_618 := x_620;
    }
  }
  return x_618;
}

fn splitting_ctree_640(xs_641%U, __642%U) {
  match(xs_641){
    nilUU_38 => {
      x_644 :=
        lazy {
          x_647 := cleaf_418(NULL, nilUU_38);
          x_646 := send(__642, x_647);
          c_645 := x_646;
          x_649 := close[true](c_645);
          __648 := x_649;
          return ttU_27;
        };
      x_643 := x_644;
    }
    _ => {
      match[U](xs_641){
        consUU_39(hd_651, tl_652) => {
          match(tl_652){
            nilUU_38 => {
              x_654 :=
                lazy {
                  x_658 := mkconstr(consUU_39, [hd_651, nilUU_38]);
                  x_657 := cleaf_418(NULL, x_658);
                  x_656 := send(__642, x_657);
                  c_655 := x_656;
                  x_660 := close[true](c_655);
                  __659 := x_660;
                  return ttU_27;
                };
              x_653 := x_654;
            }
            _ => {
              match[U](tl_652){
                consUU_39(hd_662, tl_663) => {
                  x_666 := mkconstr(consUU_39, [hd_662, tl_663]);
                  x_667 := mkconstr(consUU_39, [hd_651, x_666]);
                  x_665 := splitU_496(x_667);
                  match[L](x_665){
                    ex1UU_51(m_668, n_669) => {
                      x_670 :=
                        lazy {
                          x_673 :=
                            fn lam_674(_675%L) {
                              x_676 := splitting_ctree_640(m_668, _675);
                              return x_676;
                            };
                          x_672 := fork(x_673);
                          cl_671 := x_672;
                          x_679 :=
                            fn lam_680(_681%L) {
                              x_682 := splitting_ctree_640(n_669, _681);
                              return x_682;
                            };
                          x_678 := fork(x_679);
                          cr_677 := x_678;
                          x_684 := recv[L](cl_671);
                          _683 := x_684;
                          match[L](_683){
                            ex1LL_48(m_686, n_687) => {
                              x_689 := close[false](n_687);
                              __688 := x_689;
                              x_691 := recv[L](cr_677);
                              _690 := x_691;
                              match[L](_690){
                                ex1LL_48(m_693, n_694) => {
                                  x_696 := close[false](n_694);
                                  __695 := x_696;
                                  x_698 := cnode_427(NULL, NULL, NULL, m_686, m_693);
                                  ct_697 := x_698;
                                  x_700 := rwlUL_14(NULL, NULL, NULL, NULL, NULL, ct_697);
                                  ct_699 := x_700;
                                  x_702 := send(__642, ct_699);
                                  c_701 := x_702;
                                  x_703 := close[true](c_701);
                                  x_692 := x_703;
                                  free(_690);
                                }
                              }
                              x_685 := x_692;
                              free(_683);
                            }
                          }
                          return x_685;
                        };
                      x_664 := x_670;
                      free(x_665);
                    }
                  }
                  x_661 := x_664;
                }
              }
              x_653 := x_661;
            }
          }
          x_650 := x_653;
        }
      }
      x_643 := x_650;
    }
  }
  return x_643;
}

fn cmsort_704(xs_705%U) {
  x_706 :=
    lazy {
      x_709 :=
        fn lam_710(_711%L) {
          x_712 := splitting_ctree_640(xs_705, _711);
          return x_712;
        };
      x_708 := fork(x_709);
      c_707 := x_708;
      x_714 := recv[L](c_707);
      _713 := x_714;
      match[L](_713){
        ex1LL_48(m_716, n_717) => {
          x_719 := close[false](n_717);
          __718 := x_719;
          x_723 := fn lam_724(x_725%U) { 
                                         return x_725; };
          x_726 :=
            fn lam_727(l_728%U, r_729%U) {
              x_730 := mergeU_536(l_728, r_729);
              return x_730;
            };
          x_722 := creduce_476(NULL, NULL, NULL, x_723, x_726, m_716);
          x_721 := force(x_722);
          _720 := x_721;
          match[L](_720){
            ex1UL_50(m_732, n_733) => {
              x_735 := rwlUU_7(NULL, NULL, NULL, NULL, NULL, m_732);
              result_734 := x_735;
              x_738 := cfree_454(NULL, NULL, n_733);
              x_737 := force(x_738);
              __736 := x_737;
              x_731 := result_734;
              free(_720);
            }
          }
          x_715 := x_731;
          free(_713);
        }
      }
      return x_715;
    };
  return x_706;
}

fn mklistU_739(n_740%U) {
  x_742 := lte(n_740, 0);
  match(x_742){
    true_4 => {
      x_741 := nilUU_38;
    }
    false_5 => {
      x_744 := sub(n_740, 1);
      x_743 := mklistU_739(x_744);
      x_745 := mkconstr(consUU_39, [n_740, x_743]);
      x_741 := x_745;
    }
  }
  return x_741;
}

fn mklistL_746(n_747%U) {
  x_749 := lte(n_747, 0);
  match(x_749){
    true_4 => {
      x_748 := nilUL_36;
    }
    false_5 => {
      x_751 := sub(n_747, 1);
      x_750 := mklistL_746(x_751);
      x_752 := mkconstr(consUL_37, [n_747, x_750]);
      x_748 := x_752;
    }
  }
  return x_748;
}

fn list_lenU_753(__754%U) {
  match(__754){
    nilUU_38 => {
      x_755 := 0;
    }
    _ => {
      match[U](__754){
        consUU_39(hd_757, tl_758) => {
          x_760 := list_lenU_753(tl_758);
          x_759 := add(1, x_760);
          x_756 := x_759;
        }
      }
      x_755 := x_756;
    }
  }
  return x_755;
}

fn list_lenL_761(__762%U) {
  match(__762){
    nilUL_36 => {
      x_763 := 0;
    }
    _ => {
      match[L](__762){
        consUL_37(hd_765, tl_766) => {
          x_768 := list_lenL_761(tl_766);
          x_767 := add(1, x_768);
          x_764 := x_767;
          free(__762);
        }
      }
      x_763 := x_764;
    }
  }
  return x_763;
}

fn print_listU_769(__770%U) {
  match(__770){
    nilUU_38 => {
      x_772 :=
        lazy { x_774 := str("nil");
               x_773 := print(x_774);
               return x_773; };
      x_771 := x_772;
    }
    _ => {
      match[U](__770){
        consUU_39(hd_776, tl_777) => {
          x_778 :=
            lazy {
              x_781 := string_of_int_282(hd_776);
              x_780 := print(x_781);
              __779 := x_780;
              x_784 := str(" :: ");
              x_783 := print(x_784);
              __782 := x_783;
              x_786 := print_listU_769(tl_777);
              x_785 := force(x_786);
              return x_785;
            };
          x_775 := x_778;
        }
      }
      x_771 := x_775;
    }
  }
  return x_771;
}

fn print_listL_787(__788%U) {
  match(__788){
    nilUL_36 => {
      x_790 :=
        lazy { x_792 := str("nil");
               x_791 := print(x_792);
               return x_791; };
      x_789 := x_790;
    }
    _ => {
      match[L](__788){
        consUL_37(hd_794, tl_795) => {
          x_796 :=
            lazy {
              x_799 := string_of_int_282(hd_794);
              x_798 := print(x_799);
              __797 := x_798;
              x_802 := str(" :: ");
              x_801 := print(x_802);
              __800 := x_801;
              x_804 := print_listL_787(tl_795);
              x_803 := force(x_804);
              return x_803;
            };
          x_793 := x_796;
          free(__788);
        }
      }
      x_789 := x_793;
    }
  }
  return x_789;
}

main := {
  x_806 := mklistU_739(100);
  test_805 := x_806;
  x_807 :=
    lazy {
      x_810 := cmsort_704(test_805);
      x_809 := force(x_810);
      _808 := x_809;
      x_812 := print_listU_769(_808);
      x_811 := force(x_812);
      return x_811;
    };
  return x_807;
};

[trans4e success]

-----------------------------------------

fn fn0_idU_813(A_2, m_3) {
  
  return m_3;
}

fn fn1_idU_814(env) {
  A_2 := env[1];
  m_3 := env[2];
  x_815 := fn0_idU_813(A_2, m_3);
  return x_815;
}

fn fn0_idL_816(A_5, m_6) {
  
  return m_6;
}

fn fn1_idL_817(env) {
  A_5 := env[1];
  m_6 := env[2];
  x_818 := fn0_idL_816(A_5, m_6);
  return x_818;
}

fn fn0_rwlUU_819(A_8, m_9, n_10, B_11, __12, __13) {
  
  return __13;
}

fn fn1_rwlUU_820(env) {
  A_8 := env[1];
  m_9 := env[2];
  n_10 := env[3];
  B_11 := env[4];
  __12 := env[5];
  __13 := env[6];
  x_821 := fn0_rwlUU_819(A_8, m_9, n_10, B_11, __12, __13);
  return x_821;
}

fn fn0_rwlUL_822(A_15, m_16, n_17, B_18, __19, __20) {
  
  return __20;
}

fn fn1_rwlUL_823(env) {
  A_15 := env[1];
  m_16 := env[2];
  n_17 := env[3];
  B_18 := env[4];
  __19 := env[5];
  __20 := env[6];
  x_824 := fn0_rwlUL_822(A_15, m_16, n_17, B_18, __19, __20);
  return x_824;
}

fn fn0_rwlLU_825(A_22, m_23, n_24, B_25, __26, __27) {
  
  return __27;
}

fn fn1_rwlLU_826(env) {
  A_22 := env[1];
  m_23 := env[2];
  n_24 := env[3];
  B_25 := env[4];
  __26 := env[5];
  __27 := env[6];
  x_827 := fn0_rwlLU_825(A_22, m_23, n_24, B_25, __26, __27);
  return x_827;
}

fn fn0_rwlLL_828(A_29, m_30, n_31, B_32, __33, __34) {
  
  return __34;
}

fn fn1_rwlLL_829(env) {
  A_29 := env[1];
  m_30 := env[2];
  n_31 := env[3];
  B_32 := env[4];
  __33 := env[5];
  __34 := env[6];
  x_830 := fn0_rwlLL_828(A_29, m_30, n_31, B_32, __33, __34);
  return x_830;
}

fn fn0_rwrUU_831(A_36, m_37, n_38, B_39, __40, __41) {
  
  return __41;
}

fn fn1_rwrUU_832(env) {
  A_36 := env[1];
  m_37 := env[2];
  n_38 := env[3];
  B_39 := env[4];
  __40 := env[5];
  __41 := env[6];
  x_833 := fn0_rwrUU_831(A_36, m_37, n_38, B_39, __40, __41);
  return x_833;
}

fn fn0_rwrUL_834(A_43, m_44, n_45, B_46, __47, __48) {
  
  return __48;
}

fn fn1_rwrUL_835(env) {
  A_43 := env[1];
  m_44 := env[2];
  n_45 := env[3];
  B_46 := env[4];
  __47 := env[5];
  __48 := env[6];
  x_836 := fn0_rwrUL_834(A_43, m_44, n_45, B_46, __47, __48);
  return x_836;
}

fn fn0_rwrLU_837(A_50, m_51, n_52, B_53, __54, __55) {
  
  return __55;
}

fn fn1_rwrLU_838(env) {
  A_50 := env[1];
  m_51 := env[2];
  n_52 := env[3];
  B_53 := env[4];
  __54 := env[5];
  __55 := env[6];
  x_839 := fn0_rwrLU_837(A_50, m_51, n_52, B_53, __54, __55);
  return x_839;
}

fn fn0_rwrLL_840(A_57, m_58, n_59, B_60, __61, __62) {
  
  return __62;
}

fn fn1_rwrLL_841(env) {
  A_57 := env[1];
  m_58 := env[2];
  n_59 := env[3];
  B_60 := env[4];
  __61 := env[5];
  __62 := env[6];
  x_842 := fn0_rwrLL_840(A_57, m_58, n_59, B_60, __61, __62);
  return x_842;
}

fn fn0_sing_elimUU_843(A_64, x_65, __66) {
  
  return __66;
}

fn fn1_sing_elimUU_844(env) {
  A_64 := env[1];
  x_65 := env[2];
  __66 := env[3];
  x_845 := fn0_sing_elimUU_843(A_64, x_65, __66);
  return x_845;
}

fn fn0_sing_elimUL_846(A_68, x_69, __70) {
  
  return __70;
}

fn fn1_sing_elimUL_847(env) {
  A_68 := env[1];
  x_69 := env[2];
  __70 := env[3];
  x_848 := fn0_sing_elimUL_846(A_68, x_69, __70);
  return x_848;
}

fn fn0_sing_elimLU_849(A_72, x_73, __74) {
  absurd;
  return NULL;
}

fn fn1_sing_elimLU_850(env) {
  A_72 := env[1];
  x_73 := env[2];
  __74 := env[3];
  x_851 := fn0_sing_elimLU_849(A_72, x_73, __74);
  return x_851;
}

fn fn0_sing_elimLL_852(A_76, x_77, __78) {
  
  return __78;
}

fn fn1_sing_elimLL_853(env) {
  A_76 := env[1];
  x_77 := env[2];
  __78 := env[3];
  x_854 := fn0_sing_elimLL_852(A_76, x_77, __78);
  return x_854;
}

fn fn0_not_855(__80) {
  switch(__80){
    true_4 => {
      move1(x_81, false_5);
      break;
    }
    false_5 => {
      move1(x_81, true_4);
      break;
    }
  }
  return x_81;
}

fn fn1_not_856(env) {
  __80 := env[1];
  x_857 := fn0_not_855(__80);
  return x_857;
}

fn fn0_and_858(__83, __84) {
  switch(__83){
    true_4 => {
      switch(__84){
        true_4 => {
          move1(x_86, true_4);
          break;
        }
        false_5 => {
          move1(x_86, false_5);
          break;
        }
      }
      move1(x_85, x_86);
      break;
    }
    false_5 => {
      move1(x_85, false_5);
      break;
    }
  }
  return x_85;
}

fn fn1_and_859(env) {
  __83 := env[1];
  __84 := env[2];
  x_860 := fn0_and_858(__83, __84);
  return x_860;
}

fn fn0_or_861(__88, __89) {
  switch(__88){
    true_4 => {
      move1(x_90, true_4);
      break;
    }
    false_5 => {
      switch(__89){
        true_4 => {
          move1(x_91, true_4);
          break;
        }
        false_5 => {
          move1(x_91, false_5);
          break;
        }
      }
      move1(x_90, x_91);
      break;
    }
  }
  return x_90;
}

fn fn1_or_862(env) {
  __88 := env[1];
  __89 := env[2];
  x_863 := fn0_or_861(__88, __89);
  return x_863;
}

fn fn0_xor_864(__93, __94) {
  switch(__93){
    true_4 => {
      switch(__94){
        true_4 => {
          move1(x_96, false_5);
          break;
        }
        false_5 => {
          move1(x_96, true_4);
          break;
        }
      }
      move1(x_95, x_96);
      break;
    }
    false_5 => {
      switch(__94){
        true_4 => {
          move1(x_97, true_4);
          break;
        }
        false_5 => {
          move1(x_97, false_5);
          break;
        }
      }
      move1(x_95, x_97);
      break;
    }
  }
  return x_95;
}

fn fn1_xor_865(env) {
  __93 := env[1];
  __94 := env[2];
  x_866 := fn0_xor_864(__93, __94);
  return x_866;
}

fn fn0_string_of_bool_867(__99) {
  switch(__99){
    true_4 => {
      str(x_101, "true")
      move1(x_100, x_101);
      break;
    }
    false_5 => {
      str(x_102, "false")
      move1(x_100, x_102);
      break;
    }
  }
  return x_100;
}

fn fn1_string_of_bool_868(env) {
  __99 := env[1];
  x_869 := fn0_string_of_bool_867(__99);
  return x_869;
}

fn fn0_lte_870(__104, __105) {
  switch(__104){
    zero_6 => {
      move1(x_106, true_4);
      break;
    }
    _ => {
      getbox(n_108, __104, 0);
      switch(__105){
        zero_6 => {
          move1(x_109, false_5);
          break;
        }
        _ => {
          getbox(n_111, __105, 0);
          x_112 := fn0_lte_870(n_108, n_111);
          move1(x_110, x_112);
          move1(x_109, x_110);
          break;
        }
      }
      move1(x_107, x_109);
      move1(x_106, x_107);
      break;
    }
  }
  return x_106;
}

fn fn1_lte_871(env) {
  __104 := env[1];
  __105 := env[2];
  x_872 := fn0_lte_870(__104, __105);
  return x_872;
}

fn fn0_lt_873(x_114, y_115) {
  mkbox(x_117, succ_7, 1);
  setbox(x_117, x_114, 0);
  x_116 := fn0_lte_870(x_117, y_115);
  return x_116;
}

fn fn1_lt_874(env) {
  x_114 := env[1];
  y_115 := env[2];
  x_875 := fn0_lt_873(x_114, y_115);
  return x_875;
}

fn fn0_pred_876(__119) {
  switch(__119){
    zero_6 => {
      move1(x_120, zero_6);
      break;
    }
    _ => {
      getbox(n_122, __119, 0);
      move1(x_121, n_122);
      move1(x_120, x_121);
      break;
    }
  }
  return x_120;
}

fn fn1_pred_877(env) {
  __119 := env[1];
  x_878 := fn0_pred_876(__119);
  return x_878;
}

fn fn0_add_879(__124, __125) {
  switch(__124){
    zero_6 => {
      move1(x_126, __125);
      break;
    }
    _ => {
      getbox(n_128, __124, 0);
      x_129 := fn0_add_879(n_128, __125);
      mkbox(x_130, succ_7, 1);
      setbox(x_130, x_129, 0);
      move1(x_127, x_130);
      move1(x_126, x_127);
      break;
    }
  }
  return x_126;
}

fn fn1_add_880(env) {
  __124 := env[1];
  __125 := env[2];
  x_881 := fn0_add_879(__124, __125);
  return x_881;
}

fn fn0_sub_882(__132, __133) {
  switch(__133){
    zero_6 => {
      move1(x_134, __132);
      break;
    }
    _ => {
      getbox(n_136, __133, 0);
      x_138 := fn0_pred_876(__132);
      x_137 := fn0_sub_882(x_138, n_136);
      move1(x_135, x_137);
      move1(x_134, x_135);
      break;
    }
  }
  return x_134;
}

fn fn1_sub_883(env) {
  __132 := env[1];
  __133 := env[2];
  x_884 := fn0_sub_882(__132, __133);
  return x_884;
}

fn fn0_mul_885(__140, __141) {
  switch(__140){
    zero_6 => {
      move1(x_142, zero_6);
      break;
    }
    _ => {
      getbox(n_144, __140, 0);
      x_146 := fn0_mul_885(n_144, __141);
      x_145 := fn0_add_879(__141, x_146);
      move1(x_143, x_145);
      move1(x_142, x_143);
      break;
    }
  }
  return x_142;
}

fn fn1_mul_886(env) {
  __140 := env[1];
  __141 := env[2];
  x_887 := fn0_mul_885(__140, __141);
  return x_887;
}

fn fn0_div_888(x_148, y_149) {
  x_151 := fn0_lt_873(x_148, y_149);
  switch(x_151){
    true_4 => {
      move1(x_150, zero_6);
      break;
    }
    false_5 => {
      mkclo1(x_153, fn1_loop_890, fvc:=2, argc:=2);
      setclo(x_153, pred_118, 1);
      setclo(x_153, sub_131, 2);
      move1(loop_152, x_153);
      appc(x_894, loop_152, x_148);
      appc(x_895, x_894, y_149);
      move1(x_166, x_895);
      move1(x_150, x_166);
      break;
    }
  }
  return x_150;
}

fn fn1_div_889(env) {
  x_148 := env[1];
  y_149 := env[2];
  x_897 := fn0_div_888(x_148, y_149);
  return x_897;
}

fn fn0_rem_898(x_168, y_169) {
  x_172 := fn0_div_888(x_168, y_169);
  x_171 := fn0_mul_885(x_172, y_169);
  x_170 := fn0_sub_882(x_168, x_171);
  return x_170;
}

fn fn1_rem_899(env) {
  x_168 := env[1];
  y_169 := env[2];
  x_900 := fn0_rem_898(x_168, y_169);
  return x_900;
}

fn fn0_rconsUU_901(A_174, __175, __176) {
  switch(__175){
    nilUU_38 => {
      mkbox(x_178, consUU_39, 2);
      setbox(x_178, __176, 0);
      setbox(x_178, nilUU_38, 1);
      move1(x_177, x_178);
      break;
    }
    _ => {
      getbox(hd_180, __175, 0);
      getbox(tl_181, __175, 1);
      x_182 := fn0_rconsUU_901(NULL, tl_181, __176);
      mkbox(x_183, consUU_39, 2);
      setbox(x_183, hd_180, 0);
      setbox(x_183, x_182, 1);
      move1(x_179, x_183);
      move1(x_177, x_179);
      break;
    }
  }
  return x_177;
}

fn fn1_rconsUU_902(env) {
  A_174 := env[1];
  __175 := env[2];
  __176 := env[3];
  x_903 := fn0_rconsUU_901(A_174, __175, __176);
  return x_903;
}

fn fn0_rconsUL_904(A_185, __186, __187) {
  switch(__186){
    nilUL_36 => {
      mkbox(x_189, consUL_37, 2);
      setbox(x_189, __187, 0);
      setbox(x_189, nilUL_36, 1);
      move1(x_188, x_189);
      break;
    }
    _ => {
      getbox(hd_191, __186, 0);
      getbox(tl_192, __186, 1);
      x_193 := fn0_rconsUL_904(NULL, tl_192, __187);
      rebox(x_194, __186, consUL_37);
      setbox(x_194, hd_191, 0);
      setbox(x_194, x_193, 1);
      move1(x_190, x_194);
      move1(x_188, x_190);
      break;
    }
  }
  return x_188;
}

fn fn1_rconsUL_905(env) {
  A_185 := env[1];
  __186 := env[2];
  __187 := env[3];
  x_906 := fn0_rconsUL_904(A_185, __186, __187);
  return x_906;
}

fn fn0_rconsLL_907(A_196, __197, __198) {
  switch(__197){
    nilLL_32 => {
      mkbox(x_200, consLL_33, 2);
      setbox(x_200, __198, 0);
      setbox(x_200, nilLL_32, 1);
      move1(x_199, x_200);
      break;
    }
    _ => {
      getbox(hd_202, __197, 0);
      getbox(tl_203, __197, 1);
      x_204 := fn0_rconsLL_907(NULL, tl_203, __198);
      rebox(x_205, __197, consLL_33);
      setbox(x_205, hd_202, 0);
      setbox(x_205, x_204, 1);
      move1(x_201, x_205);
      move1(x_199, x_201);
      break;
    }
  }
  return x_199;
}

fn fn1_rconsLL_908(env) {
  A_196 := env[1];
  __197 := env[2];
  __198 := env[3];
  x_909 := fn0_rconsLL_907(A_196, __197, __198);
  return x_909;
}

fn fn0_free_listUU_910(A_207, f_208, __209) {
  switch(__209){
    nilUU_38 => {
      move1(x_210, ttU_27);
      break;
    }
    _ => {
      getbox(hd_212, __209, 0);
      getbox(tl_213, __209, 1);
      appc(x_912, f_208, hd_212);
      move1(x_215, x_912);
      move1(__214, x_215);
      x_216 := fn0_free_listUU_910(NULL, f_208, tl_213);
      move1(x_211, x_216);
      move1(x_210, x_211);
      break;
    }
  }
  return x_210;
}

fn fn1_free_listUU_911(env) {
  A_207 := env[1];
  f_208 := env[2];
  __209 := env[3];
  x_914 := fn0_free_listUU_910(A_207, f_208, __209);
  return x_914;
}

fn fn0_free_listUL_915(A_218, f_219, __220) {
  switch(__220){
    nilUL_36 => {
      move1(x_221, ttU_27);
      break;
    }
    _ => {
      getbox(hd_223, __220, 0);
      getbox(tl_224, __220, 1);
      appc(x_917, f_219, hd_223);
      move1(x_226, x_917);
      move1(__225, x_226);
      x_227 := fn0_free_listUL_915(NULL, f_219, tl_224);
      move1(x_222, x_227);
      free(__220);
      move1(x_221, x_222);
      break;
    }
  }
  return x_221;
}

fn fn1_free_listUL_916(env) {
  A_218 := env[1];
  f_219 := env[2];
  __220 := env[3];
  x_919 := fn0_free_listUL_915(A_218, f_219, __220);
  return x_919;
}

fn fn0_free_listLL_920(A_229, f_230, __231) {
  switch(__231){
    nilLL_32 => {
      move1(x_232, ttU_27);
      break;
    }
    _ => {
      getbox(hd_234, __231, 0);
      getbox(tl_235, __231, 1);
      appc(x_922, f_230, hd_234);
      move1(x_237, x_922);
      move1(__236, x_237);
      x_238 := fn0_free_listLL_920(NULL, f_230, tl_235);
      move1(x_233, x_238);
      free(__231);
      move1(x_232, x_233);
      break;
    }
  }
  return x_232;
}

fn fn1_free_listLL_921(env) {
  A_229 := env[1];
  f_230 := env[2];
  __231 := env[3];
  x_924 := fn0_free_listLL_920(A_229, f_230, __231);
  return x_924;
}

fn fn0_pow_925(x_240, y_241) {
  mkclo1(x_243, fn1_loop_927, fvc:=1, argc:=2);
  setclo(x_243, x_240, 1);
  move1(loop_242, x_243);
  appc(x_931, loop_242, 1);
  appc(x_932, x_931, y_241);
  move1(x_252, x_932);
  return x_252;
}

fn fn1_pow_926(env) {
  x_240 := env[1];
  y_241 := env[2];
  x_934 := fn0_pow_925(x_240, y_241);
  return x_934;
}

fn fn0_powm_935(x_254, y_255, m_256) {
  mkclo1(x_258, fn1_loop_937, fvc:=2, argc:=2);
  setclo(x_258, x_254, 1);
  setclo(x_258, m_256, 2);
  move1(loop_257, x_258);
  appc(x_941, loop_257, 1);
  appc(x_942, x_941, y_255);
  move1(x_268, x_942);
  return x_268;
}

fn fn1_powm_936(env) {
  x_254 := env[1];
  y_255 := env[2];
  m_256 := env[3];
  x_944 := fn0_powm_935(x_254, y_255, m_256);
  return x_944;
}

fn fn0_ord_945(c_270) {
  ord(x_271, c_270);
  return x_271;
}

fn fn1_ord_946(env) {
  c_270 := env[1];
  x_947 := fn0_ord_945(c_270);
  return x_947;
}

fn fn0_chr_948(i_273) {
  chr(x_274, i_273);
  return x_274;
}

fn fn1_chr_949(env) {
  i_273 := env[1];
  x_950 := fn0_chr_948(i_273);
  return x_950;
}

fn fn0_str_951(c_276) {
  str(x_278, "")
  push(x_277, x_278, c_276);
  return x_277;
}

fn fn1_str_952(env) {
  c_276 := env[1];
  x_953 := fn0_str_951(c_276);
  return x_953;
}

fn fn0_strlen_954(s_280) {
  size(x_281, s_280);
  return x_281;
}

fn fn1_strlen_955(env) {
  s_280 := env[1];
  x_956 := fn0_strlen_954(s_280);
  return x_956;
}

fn fn0_string_of_int_957(i_283) {
  mkclo1(x_285, fn1_aux_959, fvc:=3, argc:=1);
  setclo(x_285, ord_269, 1);
  setclo(x_285, chr_272, 2);
  setclo(x_285, str_275, 3);
  move1(aux_284, x_285);
  lte(x_304, 0, i_283);
  switch(x_304){
    true_4 => {
      appc(x_962, aux_284, i_283);
      move1(x_305, x_962);
      move1(x_303, x_305);
      break;
    }
    false_5 => {
      str(x_307, "~")
      neg(x_309, i_283);
      appc(x_964, aux_284, x_309);
      move1(x_308, x_964);
      cat(x_306, x_307, x_308);
      move1(x_303, x_306);
      break;
    }
  }
  return x_303;
}

fn fn1_string_of_int_958(env) {
  i_283 := env[1];
  x_966 := fn0_string_of_int_957(i_283);
  return x_966;
}

fn fn0_map_967(A_311, B_312, f_313, __314) {
  switch(ctagof(__314)){
    Leaf_15 => {
      getbox(x_316, __314, 0);
      appc(x_969, f_313, x_316);
      move1(x_317, x_969);
      mkbox(x_318, Leaf_15, 1);
      setbox(x_318, x_317, 0);
      move1(x_315, x_318);
      break;
    }
    Node_16 => {
      getbox(l_319, __314, 0);
      getbox(r_320, __314, 1);
      x_321 := fn0_map_967(NULL, NULL, f_313, l_319);
      x_322 := fn0_map_967(NULL, NULL, f_313, r_320);
      mkbox(x_323, Node_16, 2);
      setbox(x_323, x_321, 0);
      setbox(x_323, x_322, 1);
      move1(x_315, x_323);
      break;
    }
  }
  return x_315;
}

fn fn1_map_968(env) {
  A_311 := env[1];
  B_312 := env[2];
  f_313 := env[3];
  __314 := env[4];
  x_971 := fn0_map_967(A_311, B_312, f_313, __314);
  return x_971;
}

fn fn0_reduce_972(A_325, B_326, f_327, g_328, __329) {
  switch(ctagof(__329)){
    Leaf_15 => {
      getbox(x_331, __329, 0);
      appc(x_974, f_327, x_331);
      move1(x_332, x_974);
      move1(x_330, x_332);
      break;
    }
    Node_16 => {
      getbox(l_333, __329, 0);
      getbox(r_334, __329, 1);
      x_336 := fn0_reduce_972(NULL, NULL, f_327, g_328, l_333);
      x_337 := fn0_reduce_972(NULL, NULL, f_327, g_328, r_334);
      appc(x_976, g_328, x_336);
      appc(x_977, x_976, x_337);
      move1(x_335, x_977);
      move1(x_330, x_335);
      break;
    }
  }
  return x_330;
}

fn fn1_reduce_973(env) {
  A_325 := env[1];
  B_326 := env[2];
  f_327 := env[3];
  g_328 := env[4];
  __329 := env[5];
  x_979 := fn0_reduce_972(A_325, B_326, f_327, g_328, __329);
  return x_979;
}

fn fn0_leaf_worker_980(A_339, x_340, c_341) {
  lazy(x_342, lazy__982, 3);
  setlazy(x_342, leaf_worker_338, 0);
  setlazy(x_342, x_340, 1);
  setlazy(x_342, c_341, 2);
  return x_342;
}

fn fn1_leaf_worker_981(env) {
  A_339 := env[1];
  x_340 := env[2];
  c_341 := env[3];
  x_987 := fn0_leaf_worker_980(A_339, x_340, c_341);
  return x_987;
}

fn fn0_node_worker_988(A_363, l_364, r_365, __366, __367, __368) {
  lazy(x_369, lazy__990, 4);
  setlazy(x_369, node_worker_362, 0);
  setlazy(x_369, __366, 1);
  setlazy(x_369, __367, 2);
  setlazy(x_369, __368, 3);
  return x_369;
}

fn fn1_node_worker_989(env) {
  A_363 := env[1];
  l_364 := env[2];
  r_365 := env[3];
  __366 := env[4];
  __367 := env[5];
  __368 := env[6];
  x_994 := fn0_node_worker_988(A_363, l_364, r_365, __366, __367, __368);
  return x_994;
}

fn fn0_cleaf_995(A_419, x_420) {
  lazy(x_421, lazy__997, 2);
  setlazy(x_421, leaf_worker_338, 0);
  setlazy(x_421, x_420, 1);
  return x_421;
}

fn fn1_cleaf_996(env) {
  A_419 := env[1];
  x_420 := env[2];
  x_999 := fn0_cleaf_995(A_419, x_420);
  return x_999;
}

fn fn0_cnode_1000(A_428, l_429, r_430, __431, __432) {
  lazy(x_433, lazy__1002, 3);
  setlazy(x_433, node_worker_362, 0);
  setlazy(x_433, __431, 1);
  setlazy(x_433, __432, 2);
  return x_433;
}

fn fn1_cnode_1001(env) {
  A_428 := env[1];
  l_429 := env[2];
  r_430 := env[3];
  __431 := env[4];
  __432 := env[5];
  x_1004 := fn0_cnode_1000(A_428, l_429, r_430, __431, __432);
  return x_1004;
}

fn fn0_ctree_of_tree_1005(A_444, t_445) {
  switch(ctagof(t_445)){
    Leaf_15 => {
      getbox(x_447, t_445, 0);
      x_448 := fn0_cleaf_995(NULL, x_447);
      move1(x_446, x_448);
      break;
    }
    Node_16 => {
      getbox(l_449, t_445, 0);
      getbox(r_450, t_445, 1);
      x_452 := fn0_ctree_of_tree_1005(NULL, l_449);
      x_453 := fn0_ctree_of_tree_1005(NULL, r_450);
      x_451 := fn0_cnode_1000(NULL, NULL, NULL, x_452, x_453);
      move1(x_446, x_451);
      break;
    }
  }
  return x_446;
}

fn fn1_ctree_of_tree_1006(env) {
  A_444 := env[1];
  t_445 := env[2];
  x_1007 := fn0_ctree_of_tree_1005(A_444, t_445);
  return x_1007;
}

fn fn0_cfree_1008(A_455, t_456, ct_457) {
  lazy(x_458, lazy__1010, 1);
  setlazy(x_458, ct_457, 0);
  return x_458;
}

fn fn1_cfree_1009(env) {
  A_455 := env[1];
  t_456 := env[2];
  ct_457 := env[3];
  x_1011 := fn0_cfree_1008(A_455, t_456, ct_457);
  return x_1011;
}

fn fn0_cmap_1012(A_465, B_466, t_467, f_468, ct_469) {
  lazy(x_470, lazy__1014, 2);
  setlazy(x_470, f_468, 0);
  setlazy(x_470, ct_469, 1);
  return x_470;
}

fn fn1_cmap_1013(env) {
  A_465 := env[1];
  B_466 := env[2];
  t_467 := env[3];
  f_468 := env[4];
  ct_469 := env[5];
  x_1015 := fn0_cmap_1012(A_465, B_466, t_467, f_468, ct_469);
  return x_1015;
}

fn fn0_creduce_1016(A_477, B_478, t_479, f_480, g_481, ct_482) {
  lazy(x_483, lazy__1018, 3);
  setlazy(x_483, f_480, 0);
  setlazy(x_483, g_481, 1);
  setlazy(x_483, ct_482, 2);
  return x_483;
}

fn fn1_creduce_1017(env) {
  A_477 := env[1];
  B_478 := env[2];
  t_479 := env[3];
  f_480 := env[4];
  g_481 := env[5];
  ct_482 := env[6];
  x_1020 := fn0_creduce_1016(A_477, B_478, t_479, f_480, g_481, ct_482);
  return x_1020;
}

fn fn0_splitU_1021(__497) {
  switch(__497){
    nilUU_38 => {
      mkbox(x_499, ex1UU_51, 2);
      setbox(x_499, nilUU_38, 0);
      setbox(x_499, nilUU_38, 1);
      move1(x_498, x_499);
      break;
    }
    _ => {
      getbox(hd_501, __497, 0);
      getbox(tl_502, __497, 1);
      switch(tl_502){
        nilUU_38 => {
          mkbox(x_504, consUU_39, 2);
          setbox(x_504, hd_501, 0);
          setbox(x_504, nilUU_38, 1);
          mkbox(x_505, ex1UU_51, 2);
          setbox(x_505, x_504, 0);
          setbox(x_505, nilUU_38, 1);
          move1(x_503, x_505);
          break;
        }
        _ => {
          getbox(hd_507, tl_502, 0);
          getbox(tl_508, tl_502, 1);
          x_510 := fn0_splitU_1021(tl_508);
          getbox(m_511, x_510, 0);
          getbox(n_512, x_510, 1);
          rebox(x_513, x_510, consUU_39);
          setbox(x_513, hd_501, 0);
          setbox(x_513, m_511, 1);
          mkbox(x_514, consUU_39, 2);
          setbox(x_514, hd_507, 0);
          setbox(x_514, n_512, 1);
          mkbox(x_515, ex1UU_51, 2);
          setbox(x_515, x_513, 0);
          setbox(x_515, x_514, 1);
          move1(x_509, x_515);
          move1(x_506, x_509);
          move1(x_503, x_506);
          break;
        }
      }
      move1(x_500, x_503);
      move1(x_498, x_500);
      break;
    }
  }
  return x_498;
}

fn fn1_splitU_1022(env) {
  __497 := env[1];
  x_1023 := fn0_splitU_1021(__497);
  return x_1023;
}

fn fn0_splitL_1024(__517) {
  switch(__517){
    nilUL_36 => {
      mkbox(x_519, ex1LL_48, 2);
      setbox(x_519, nilUL_36, 0);
      setbox(x_519, nilUL_36, 1);
      move1(x_518, x_519);
      break;
    }
    _ => {
      getbox(hd_521, __517, 0);
      getbox(tl_522, __517, 1);
      switch(tl_522){
        nilUL_36 => {
          rebox(x_524, __517, consUL_37);
          setbox(x_524, hd_521, 0);
          setbox(x_524, nilUL_36, 1);
          mkbox(x_525, ex1LL_48, 2);
          setbox(x_525, x_524, 0);
          setbox(x_525, nilUL_36, 1);
          move1(x_523, x_525);
          break;
        }
        _ => {
          getbox(hd_527, tl_522, 0);
          getbox(tl_528, tl_522, 1);
          x_530 := fn0_splitL_1024(tl_528);
          getbox(m_531, x_530, 0);
          getbox(n_532, x_530, 1);
          rebox(x_533, x_530, consUL_37);
          setbox(x_533, hd_521, 0);
          setbox(x_533, m_531, 1);
          rebox(x_534, tl_522, consUL_37);
          setbox(x_534, hd_527, 0);
          setbox(x_534, n_532, 1);
          rebox(x_535, __517, ex1LL_48);
          setbox(x_535, x_533, 0);
          setbox(x_535, x_534, 1);
          move1(x_529, x_535);
          move1(x_526, x_529);
          move1(x_523, x_526);
          break;
        }
      }
      move1(x_520, x_523);
      move1(x_518, x_520);
      break;
    }
  }
  return x_518;
}

fn fn1_splitL_1025(env) {
  __517 := env[1];
  x_1026 := fn0_splitL_1024(__517);
  return x_1026;
}

fn fn0_mergeU_1027(__537, __538) {
  switch(__537){
    nilUU_38 => {
      move1(x_539, __538);
      break;
    }
    _ => {
      getbox(hd_541, __537, 0);
      getbox(tl_542, __537, 1);
      switch(__538){
        nilUU_38 => {
          mkbox(x_544, consUU_39, 2);
          setbox(x_544, hd_541, 0);
          setbox(x_544, tl_542, 1);
          move1(x_543, x_544);
          break;
        }
        _ => {
          getbox(hd_546, __538, 0);
          getbox(tl_547, __538, 1);
          lte(x_549, hd_541, hd_546);
          switch(x_549){
            true_4 => {
              mkbox(x_551, consUU_39, 2);
              setbox(x_551, hd_546, 0);
              setbox(x_551, tl_547, 1);
              x_550 := fn0_mergeU_1027(tl_542, x_551);
              mkbox(x_552, consUU_39, 2);
              setbox(x_552, hd_541, 0);
              setbox(x_552, x_550, 1);
              move1(x_548, x_552);
              break;
            }
            false_5 => {
              mkbox(x_554, consUU_39, 2);
              setbox(x_554, hd_541, 0);
              setbox(x_554, tl_542, 1);
              x_553 := fn0_mergeU_1027(x_554, tl_547);
              mkbox(x_555, consUU_39, 2);
              setbox(x_555, hd_546, 0);
              setbox(x_555, x_553, 1);
              move1(x_548, x_555);
              break;
            }
          }
          move1(x_545, x_548);
          move1(x_543, x_545);
          break;
        }
      }
      move1(x_540, x_543);
      move1(x_539, x_540);
      break;
    }
  }
  return x_539;
}

fn fn1_mergeU_1028(env) {
  __537 := env[1];
  __538 := env[2];
  x_1029 := fn0_mergeU_1027(__537, __538);
  return x_1029;
}

fn fn0_mergeL_1030(__557, __558) {
  switch(__557){
    nilUL_36 => {
      move1(x_559, __558);
      break;
    }
    _ => {
      getbox(hd_561, __557, 0);
      getbox(tl_562, __557, 1);
      switch(__558){
        nilUL_36 => {
          rebox(x_564, __557, consUL_37);
          setbox(x_564, hd_561, 0);
          setbox(x_564, tl_562, 1);
          move1(x_563, x_564);
          break;
        }
        _ => {
          getbox(hd_566, __558, 0);
          getbox(tl_567, __558, 1);
          lte(x_569, hd_561, hd_566);
          switch(x_569){
            true_4 => {
              rebox(x_571, __558, consUL_37);
              setbox(x_571, hd_566, 0);
              setbox(x_571, tl_567, 1);
              x_570 := fn0_mergeL_1030(tl_562, x_571);
              rebox(x_572, __557, consUL_37);
              setbox(x_572, hd_561, 0);
              setbox(x_572, x_570, 1);
              move1(x_568, x_572);
              break;
            }
            false_5 => {
              rebox(x_574, __558, consUL_37);
              setbox(x_574, hd_561, 0);
              setbox(x_574, tl_562, 1);
              x_573 := fn0_mergeL_1030(x_574, tl_567);
              rebox(x_575, __557, consUL_37);
              setbox(x_575, hd_566, 0);
              setbox(x_575, x_573, 1);
              move1(x_568, x_575);
              break;
            }
          }
          move1(x_565, x_568);
          move1(x_563, x_565);
          break;
        }
      }
      move1(x_560, x_563);
      move1(x_559, x_560);
      break;
    }
  }
  return x_559;
}

fn fn1_mergeL_1031(env) {
  __557 := env[1];
  __558 := env[2];
  x_1032 := fn0_mergeL_1030(__557, __558);
  return x_1032;
}

fn fn0_msortU_1033(__577) {
  switch(__577){
    nilUU_38 => {
      move1(x_578, nilUU_38);
      break;
    }
    _ => {
      getbox(hd_580, __577, 0);
      getbox(tl_581, __577, 1);
      switch(tl_581){
        nilUU_38 => {
          mkbox(x_583, consUU_39, 2);
          setbox(x_583, hd_580, 0);
          setbox(x_583, nilUU_38, 1);
          move1(x_582, x_583);
          break;
        }
        _ => {
          getbox(hd_585, tl_581, 0);
          getbox(tl_586, tl_581, 1);
          mkbox(x_589, consUU_39, 2);
          setbox(x_589, hd_585, 0);
          setbox(x_589, tl_586, 1);
          mkbox(x_590, consUU_39, 2);
          setbox(x_590, hd_580, 0);
          setbox(x_590, x_589, 1);
          x_588 := fn0_splitU_1021(x_590);
          getbox(m_591, x_588, 0);
          getbox(n_592, x_588, 1);
          x_594 := fn0_msortU_1033(m_591);
          x_595 := fn0_msortU_1033(n_592);
          x_593 := fn0_mergeU_1027(x_594, x_595);
          move1(x_587, x_593);
          free(x_588);
          move1(x_584, x_587);
          move1(x_582, x_584);
          break;
        }
      }
      move1(x_579, x_582);
      move1(x_578, x_579);
      break;
    }
  }
  return x_578;
}

fn fn1_msortU_1034(env) {
  __577 := env[1];
  x_1035 := fn0_msortU_1033(__577);
  return x_1035;
}

fn fn0_msortL_1036(__597) {
  switch(__597){
    nilUL_36 => {
      move1(x_598, nilUL_36);
      break;
    }
    _ => {
      getbox(hd_600, __597, 0);
      getbox(tl_601, __597, 1);
      switch(tl_601){
        nilUL_36 => {
          rebox(x_603, __597, consUL_37);
          setbox(x_603, hd_600, 0);
          setbox(x_603, nilUL_36, 1);
          move1(x_602, x_603);
          break;
        }
        _ => {
          getbox(hd_605, tl_601, 0);
          getbox(tl_606, tl_601, 1);
          rebox(x_609, tl_601, consUL_37);
          setbox(x_609, hd_605, 0);
          setbox(x_609, tl_606, 1);
          rebox(x_610, __597, consUL_37);
          setbox(x_610, hd_600, 0);
          setbox(x_610, x_609, 1);
          x_608 := fn0_splitL_1024(x_610);
          getbox(m_611, x_608, 0);
          getbox(n_612, x_608, 1);
          x_614 := fn0_msortL_1036(m_611);
          x_615 := fn0_msortL_1036(n_612);
          x_613 := fn0_mergeL_1030(x_614, x_615);
          move1(x_607, x_613);
          free(x_608);
          move1(x_604, x_607);
          move1(x_602, x_604);
          break;
        }
      }
      move1(x_599, x_602);
      move1(x_598, x_599);
      break;
    }
  }
  return x_598;
}

fn fn1_msortL_1037(env) {
  __597 := env[1];
  x_1038 := fn0_msortL_1036(__597);
  return x_1038;
}

fn fn0_splitting_tree_1039(__617) {
  switch(__617){
    nilUU_38 => {
      mkbox(x_619, Leaf_15, 1);
      setbox(x_619, nilUU_38, 0);
      move1(x_618, x_619);
      break;
    }
    _ => {
      getbox(hd_621, __617, 0);
      getbox(tl_622, __617, 1);
      switch(tl_622){
        nilUU_38 => {
          mkbox(x_624, consUU_39, 2);
          setbox(x_624, hd_621, 0);
          setbox(x_624, nilUU_38, 1);
          mkbox(x_625, Leaf_15, 1);
          setbox(x_625, x_624, 0);
          move1(x_623, x_625);
          break;
        }
        _ => {
          getbox(hd_627, tl_622, 0);
          getbox(tl_628, tl_622, 1);
          mkbox(x_631, consUU_39, 2);
          setbox(x_631, hd_627, 0);
          setbox(x_631, tl_628, 1);
          mkbox(x_632, consUU_39, 2);
          setbox(x_632, hd_621, 0);
          setbox(x_632, x_631, 1);
          x_630 := fn0_splitU_1021(x_632);
          getbox(m_633, x_630, 0);
          getbox(n_634, x_630, 1);
          x_636 := fn0_splitting_tree_1039(m_633);
          move1(l_635, x_636);
          x_638 := fn0_splitting_tree_1039(n_634);
          move1(r_637, x_638);
          rebox(x_639, x_630, Node_16);
          setbox(x_639, l_635, 0);
          setbox(x_639, r_637, 1);
          move1(x_629, x_639);
          move1(x_626, x_629);
          move1(x_623, x_626);
          break;
        }
      }
      move1(x_620, x_623);
      move1(x_618, x_620);
      break;
    }
  }
  return x_618;
}

fn fn1_splitting_tree_1040(env) {
  __617 := env[1];
  x_1041 := fn0_splitting_tree_1039(__617);
  return x_1041;
}

fn fn0_splitting_ctree_1042(xs_641, __642) {
  switch(xs_641){
    nilUU_38 => {
      lazy(x_644, lazy__1044, 2);
      setlazy(x_644, cleaf_418, 0);
      setlazy(x_644, __642, 1);
      move1(x_643, x_644);
      break;
    }
    _ => {
      getbox(hd_651, xs_641, 0);
      getbox(tl_652, xs_641, 1);
      switch(tl_652){
        nilUU_38 => {
          lazy(x_654, lazy__1045, 3);
          setlazy(x_654, cleaf_418, 0);
          setlazy(x_654, __642, 1);
          setlazy(x_654, hd_651, 2);
          move1(x_653, x_654);
          break;
        }
        _ => {
          getbox(hd_662, tl_652, 0);
          getbox(tl_663, tl_652, 1);
          mkbox(x_666, consUU_39, 2);
          setbox(x_666, hd_662, 0);
          setbox(x_666, tl_663, 1);
          mkbox(x_667, consUU_39, 2);
          setbox(x_667, hd_651, 0);
          setbox(x_667, x_666, 1);
          x_665 := fn0_splitU_1021(x_667);
          getbox(m_668, x_665, 0);
          getbox(n_669, x_665, 1);
          lazy(x_670, lazy__1046, 6);
          setlazy(x_670, rwlUL_14, 0);
          setlazy(x_670, cnode_427, 1);
          setlazy(x_670, splitting_ctree_640, 2);
          setlazy(x_670, __642, 3);
          setlazy(x_670, m_668, 4);
          setlazy(x_670, n_669, 5);
          move1(x_664, x_670);
          free(x_665);
          move1(x_661, x_664);
          move1(x_653, x_661);
          break;
        }
      }
      move1(x_650, x_653);
      move1(x_643, x_650);
      break;
    }
  }
  return x_643;
}

fn fn1_splitting_ctree_1043(env) {
  xs_641 := env[1];
  __642 := env[2];
  x_1049 := fn0_splitting_ctree_1042(xs_641, __642);
  return x_1049;
}

fn fn0_cmsort_1050(xs_705) {
  lazy(x_706, lazy__1052, 6);
  setlazy(x_706, rwlUU_7, 0);
  setlazy(x_706, cfree_454, 1);
  setlazy(x_706, creduce_476, 2);
  setlazy(x_706, mergeU_536, 3);
  setlazy(x_706, splitting_ctree_640, 4);
  setlazy(x_706, xs_705, 5);
  return x_706;
}

fn fn1_cmsort_1051(env) {
  xs_705 := env[1];
  x_1056 := fn0_cmsort_1050(xs_705);
  return x_1056;
}

fn fn0_mklistU_1057(n_740) {
  lte(x_742, n_740, 0);
  switch(x_742){
    true_4 => {
      move1(x_741, nilUU_38);
      break;
    }
    false_5 => {
      sub(x_744, n_740, 1);
      x_743 := fn0_mklistU_1057(x_744);
      mkbox(x_745, consUU_39, 2);
      setbox(x_745, n_740, 0);
      setbox(x_745, x_743, 1);
      move1(x_741, x_745);
      break;
    }
  }
  return x_741;
}

fn fn1_mklistU_1058(env) {
  n_740 := env[1];
  x_1059 := fn0_mklistU_1057(n_740);
  return x_1059;
}

fn fn0_mklistL_1060(n_747) {
  lte(x_749, n_747, 0);
  switch(x_749){
    true_4 => {
      move1(x_748, nilUL_36);
      break;
    }
    false_5 => {
      sub(x_751, n_747, 1);
      x_750 := fn0_mklistL_1060(x_751);
      mkbox(x_752, consUL_37, 2);
      setbox(x_752, n_747, 0);
      setbox(x_752, x_750, 1);
      move1(x_748, x_752);
      break;
    }
  }
  return x_748;
}

fn fn1_mklistL_1061(env) {
  n_747 := env[1];
  x_1062 := fn0_mklistL_1060(n_747);
  return x_1062;
}

fn fn0_list_lenU_1063(__754) {
  switch(__754){
    nilUU_38 => {
      move1(x_755, 0);
      break;
    }
    _ => {
      getbox(tl_758, __754, 1);
      x_760 := fn0_list_lenU_1063(tl_758);
      add(x_759, 1, x_760);
      move1(x_756, x_759);
      move1(x_755, x_756);
      break;
    }
  }
  return x_755;
}

fn fn1_list_lenU_1064(env) {
  __754 := env[1];
  x_1065 := fn0_list_lenU_1063(__754);
  return x_1065;
}

fn fn0_list_lenL_1066(__762) {
  switch(__762){
    nilUL_36 => {
      move1(x_763, 0);
      break;
    }
    _ => {
      getbox(tl_766, __762, 1);
      x_768 := fn0_list_lenL_1066(tl_766);
      add(x_767, 1, x_768);
      move1(x_764, x_767);
      free(__762);
      move1(x_763, x_764);
      break;
    }
  }
  return x_763;
}

fn fn1_list_lenL_1067(env) {
  __762 := env[1];
  x_1068 := fn0_list_lenL_1066(__762);
  return x_1068;
}

fn fn0_print_listU_1069(__770) {
  switch(__770){
    nilUU_38 => {
      lazy(x_772, lazy__1071, 0);
      move1(x_771, x_772);
      break;
    }
    _ => {
      getbox(hd_776, __770, 0);
      getbox(tl_777, __770, 1);
      lazy(x_778, lazy__1072, 4);
      setlazy(x_778, string_of_int_282, 0);
      setlazy(x_778, print_listU_769, 1);
      setlazy(x_778, hd_776, 2);
      setlazy(x_778, tl_777, 3);
      move1(x_775, x_778);
      move1(x_771, x_775);
      break;
    }
  }
  return x_771;
}

fn fn1_print_listU_1070(env) {
  __770 := env[1];
  x_1073 := fn0_print_listU_1069(__770);
  return x_1073;
}

fn fn0_print_listL_1074(__788) {
  switch(__788){
    nilUL_36 => {
      lazy(x_790, lazy__1076, 0);
      move1(x_789, x_790);
      break;
    }
    _ => {
      getbox(hd_794, __788, 0);
      getbox(tl_795, __788, 1);
      lazy(x_796, lazy__1077, 4);
      setlazy(x_796, string_of_int_282, 0);
      setlazy(x_796, print_listL_787, 1);
      setlazy(x_796, hd_794, 2);
      setlazy(x_796, tl_795, 3);
      move1(x_793, x_796);
      free(__788);
      move1(x_789, x_793);
      break;
    }
  }
  return x_789;
}

fn fn1_print_listL_1075(env) {
  __788 := env[1];
  x_1078 := fn0_print_listL_1074(__788);
  return x_1078;
}

fn lazy__1080(env) {
  cmsort_704 := env[0];
  print_listU_769 := env[1];
  test_805 := env[2];
  x_810 := fn0_cmsort_1050(test_805);
  force(x_809, x_810);
  free(x_810);
  move1(_808, x_809);
  x_812 := fn0_print_listU_1069(_808);
  force(x_811, x_812);
  free(x_812);
  return x_811;
}

fn lazy__1077(env) {
  string_of_int_282 := env[0];
  print_listL_787 := env[1];
  hd_794 := env[2];
  tl_795 := env[3];
  x_799 := fn0_string_of_int_957(hd_794);
  print(x_798, x_799);
  move1(__797, x_798);
  str(x_802, " :: ")
  print(x_801, x_802);
  move1(__800, x_801);
  x_804 := fn0_print_listL_1074(tl_795);
  force(x_803, x_804);
  free(x_804);
  return x_803;
}

fn lazy__1076(env) {
  str(x_792, "nil")
  print(x_791, x_792);
  return x_791;
}

fn lazy__1072(env) {
  string_of_int_282 := env[0];
  print_listU_769 := env[1];
  hd_776 := env[2];
  tl_777 := env[3];
  x_781 := fn0_string_of_int_957(hd_776);
  print(x_780, x_781);
  move1(__779, x_780);
  str(x_784, " :: ")
  print(x_783, x_784);
  move1(__782, x_783);
  x_786 := fn0_print_listU_1069(tl_777);
  force(x_785, x_786);
  free(x_786);
  return x_785;
}

fn lazy__1071(env) {
  str(x_774, "nil")
  print(x_773, x_774);
  return x_773;
}

fn lazy__1052(env) {
  rwlUU_7 := env[0];
  cfree_454 := env[1];
  creduce_476 := env[2];
  mergeU_536 := env[3];
  splitting_ctree_640 := env[4];
  xs_705 := env[5];
  mkclo1(x_709, fn1_lam_1053, fvc:=2, argc:=1);
  setclo(x_709, splitting_ctree_640, 1);
  setclo(x_709, xs_705, 2);
  fork(x_708, x_709);
  move1(c_707, x_708);
  recv1(x_714, c_707);
  move1(_713, x_714);
  getbox(m_716, _713, 0);
  getbox(n_717, _713, 1);
  close1(x_719, n_717);
  move1(__718, x_719);
  mkclo1(x_723, fn1_lam_1054, fvc:=0, argc:=1);
  mkclo1(x_726, fn1_lam_1055, fvc:=1, argc:=2);
  setclo(x_726, mergeU_536, 1);
  x_722 := fn0_creduce_1016(NULL, NULL, NULL, x_723, x_726, m_716);
  force(x_721, x_722);
  free(x_722);
  move1(_720, x_721);
  getbox(m_732, _720, 0);
  getbox(n_733, _720, 1);
  x_735 := fn0_rwlUU_819(NULL, NULL, NULL, NULL, NULL, m_732);
  move1(result_734, x_735);
  x_738 := fn0_cfree_1008(NULL, NULL, n_733);
  force(x_737, x_738);
  free(x_738);
  move1(__736, x_737);
  move1(x_731, result_734);
  free(_720);
  move1(x_715, x_731);
  free(_713);
  return x_715;
}

fn fn1_lam_1053(env) {
  lam_710 := env[0];
  splitting_ctree_640 := env[1];
  xs_705 := env[2];
  _711 := env[3];
  x_712 := fn0_splitting_ctree_1042(xs_705, _711);
  return x_712;
}

fn fn1_lam_1054(env) {
  lam_724 := env[0];
  x_725 := env[1];
  return x_725;
}

fn fn1_lam_1055(env) {
  lam_727 := env[0];
  mergeU_536 := env[1];
  l_728 := env[2];
  r_729 := env[3];
  x_730 := fn0_mergeU_1027(l_728, r_729);
  return x_730;
}

fn lazy__1046(env) {
  rwlUL_14 := env[0];
  cnode_427 := env[1];
  splitting_ctree_640 := env[2];
  __642 := env[3];
  m_668 := env[4];
  n_669 := env[5];
  mkclo1(x_673, fn1_lam_1047, fvc:=2, argc:=1);
  setclo(x_673, splitting_ctree_640, 1);
  setclo(x_673, m_668, 2);
  fork(x_672, x_673);
  move1(cl_671, x_672);
  mkclo1(x_679, fn1_lam_1048, fvc:=2, argc:=1);
  setclo(x_679, splitting_ctree_640, 1);
  setclo(x_679, n_669, 2);
  fork(x_678, x_679);
  move1(cr_677, x_678);
  recv1(x_684, cl_671);
  move1(_683, x_684);
  getbox(m_686, _683, 0);
  getbox(n_687, _683, 1);
  close1(x_689, n_687);
  move1(__688, x_689);
  recv1(x_691, cr_677);
  move1(_690, x_691);
  getbox(m_693, _690, 0);
  getbox(n_694, _690, 1);
  close1(x_696, n_694);
  move1(__695, x_696);
  x_698 := fn0_cnode_1000(NULL, NULL, NULL, m_686, m_693);
  move1(ct_697, x_698);
  x_700 := fn0_rwlUL_822(NULL, NULL, NULL, NULL, NULL, ct_697);
  move1(ct_699, x_700);
  send(x_702, __642, ct_699);
  move1(c_701, x_702);
  close0(x_703, c_701);
  move1(x_692, x_703);
  free(_690);
  move1(x_685, x_692);
  free(_683);
  return x_685;
}

fn fn1_lam_1047(env) {
  lam_674 := env[0];
  splitting_ctree_640 := env[1];
  m_668 := env[2];
  _675 := env[3];
  x_676 := fn0_splitting_ctree_1042(m_668, _675);
  return x_676;
}

fn fn1_lam_1048(env) {
  lam_680 := env[0];
  splitting_ctree_640 := env[1];
  n_669 := env[2];
  _681 := env[3];
  x_682 := fn0_splitting_ctree_1042(n_669, _681);
  return x_682;
}

fn lazy__1045(env) {
  cleaf_418 := env[0];
  __642 := env[1];
  hd_651 := env[2];
  mkbox(x_658, consUU_39, 2);
  setbox(x_658, hd_651, 0);
  setbox(x_658, nilUU_38, 1);
  x_657 := fn0_cleaf_995(NULL, x_658);
  send(x_656, __642, x_657);
  move1(c_655, x_656);
  close0(x_660, c_655);
  move1(__659, x_660);
  return ttU_27;
}

fn lazy__1044(env) {
  cleaf_418 := env[0];
  __642 := env[1];
  x_647 := fn0_cleaf_995(NULL, nilUU_38);
  send(x_646, __642, x_647);
  move1(c_645, x_646);
  close0(x_649, c_645);
  move1(__648, x_649);
  return ttU_27;
}

fn lazy__1018(env) {
  f_480 := env[0];
  g_481 := env[1];
  ct_482 := env[2];
  force(x_485, ct_482);
  free(ct_482);
  move1(c_484, x_485);
  mkbox(x_488, Reduce_19, 2);
  setbox(x_488, f_480, 0);
  setbox(x_488, g_481, 1);
  send(x_487, c_484, x_488);
  move1(c_486, x_487);
  recv0(x_490, c_486);
  move1(_489, x_490);
  getbox(m_492, _489, 0);
  getbox(n_493, _489, 1);
  lazy(x_494, lazy__1019, 1);
  setlazy(x_494, n_493, 0);
  rebox(x_495, _489, ex1UL_50);
  setbox(x_495, m_492, 0);
  setbox(x_495, x_494, 1);
  move1(x_491, x_495);
  return x_491;
}

fn lazy__1019(env) {
  n_493 := env[0];
  return n_493;
}

fn lazy__1014(env) {
  f_468 := env[0];
  ct_469 := env[1];
  force(x_472, ct_469);
  free(ct_469);
  move1(c_471, x_472);
  mkbox(x_475, Map_18, 1);
  setbox(x_475, f_468, 0);
  send(x_474, c_471, x_475);
  move1(c_473, x_474);
  return c_473;
}

fn lazy__1010(env) {
  ct_457 := env[0];
  force(x_460, ct_457);
  free(ct_457);
  move1(c_459, x_460);
  send(x_462, c_459, Free_17);
  move1(c_461, x_462);
  close1(x_463, c_461);
  return x_463;
}

fn lazy__1002(env) {
  node_worker_362 := env[0];
  __431 := env[1];
  __432 := env[2];
  force(x_435, __431);
  free(__431);
  move1(l_ch_434, x_435);
  force(x_437, __432);
  free(__432);
  move1(r_ch_436, x_437);
  mkclo1(x_439, fn1_lam_1003, fvc:=3, argc:=1);
  setclo(x_439, node_worker_362, 1);
  setclo(x_439, l_ch_434, 2);
  setclo(x_439, r_ch_436, 3);
  fork(x_438, x_439);
  return x_438;
}

fn fn1_lam_1003(env) {
  lam_440 := env[0];
  node_worker_362 := env[1];
  l_ch_434 := env[2];
  r_ch_436 := env[3];
  _441 := env[4];
  x_442 := fn0_node_worker_988(NULL, NULL, NULL, l_ch_434, r_ch_436, _441);
  return x_442;
}

fn lazy__997(env) {
  leaf_worker_338 := env[0];
  x_420 := env[1];
  mkclo1(x_423, fn1_lam_998, fvc:=2, argc:=1);
  setclo(x_423, leaf_worker_338, 1);
  setclo(x_423, x_420, 2);
  fork(x_422, x_423);
  return x_422;
}

fn fn1_lam_998(env) {
  lam_424 := env[0];
  leaf_worker_338 := env[1];
  x_420 := env[2];
  _425 := env[3];
  x_426 := fn0_leaf_worker_980(NULL, x_420, _425);
  return x_426;
}

fn lazy__990(env) {
  node_worker_362 := env[0];
  __366 := env[1];
  __367 := env[2];
  __368 := env[3];
  recv1(x_371, __368);
  move1(_370, x_371);
  getbox(m_373, _370, 0);
  getbox(n_374, _370, 1);
  switch(m_373){
    Free_17 => {
      send(x_377, __366, Free_17);
      move1(l_ch_376, x_377);
      send(x_379, __367, Free_17);
      move1(r_ch_378, x_379);
      close1(x_381, l_ch_376);
      move1(__380, x_381);
      close1(x_383, r_ch_378);
      move1(__382, x_383);
      close0(x_384, n_374);
      move1(x_375, x_384);
      break;
    }
    _ => {
      switch(ctagof(m_373)){
        Map_18 => {
          getbox(f_386, m_373, 0);
          rebox(x_389, m_373, Map_18);
          setbox(x_389, f_386, 0);
          send(x_388, __366, x_389);
          move1(l_ch_387, x_388);
          mkbox(x_392, Map_18, 1);
          setbox(x_392, f_386, 0);
          send(x_391, __367, x_392);
          move1(r_ch_390, x_391);
          x_394 := fn0_node_worker_988(NULL, NULL, NULL, l_ch_387, r_ch_390, n_374);
          force(x_393, x_394);
          free(x_394);
          move1(x_385, x_393);
          break;
        }
        Reduce_19 => {
          getbox(f_395, m_373, 0);
          getbox(g_396, m_373, 1);
          rebox(x_399, m_373, Reduce_19);
          setbox(x_399, f_395, 0);
          setbox(x_399, g_396, 1);
          send(x_398, __366, x_399);
          move1(l_ch_397, x_398);
          mkbox(x_402, Reduce_19, 2);
          setbox(x_402, f_395, 0);
          setbox(x_402, g_396, 1);
          send(x_401, __367, x_402);
          move1(r_ch_400, x_401);
          recv0(x_404, l_ch_397);
          move1(_403, x_404);
          getbox(m_406, _403, 0);
          getbox(n_407, _403, 1);
          recv0(x_409, r_ch_400);
          move1(_408, x_409);
          getbox(m_411, _408, 0);
          getbox(n_412, _408, 1);
          appc(x_991, g_396, m_406);
          appc(x_992, x_991, m_411);
          move1(x_415, x_992);
          send(x_414, n_374, x_415);
          move1(c_413, x_414);
          x_417 := fn0_node_worker_988(NULL, NULL, NULL, n_407, n_412, c_413);
          force(x_416, x_417);
          free(x_417);
          move1(x_410, x_416);
          free(_408);
          move1(x_405, x_410);
          free(_403);
          move1(x_385, x_405);
          break;
        }
      }
      move1(x_375, x_385);
      break;
    }
  }
  move1(x_372, x_375);
  free(_370);
  return x_372;
}

fn lazy__982(env) {
  leaf_worker_338 := env[0];
  x_340 := env[1];
  c_341 := env[2];
  recv1(x_344, c_341);
  move1(_343, x_344);
  getbox(m_346, _343, 0);
  getbox(n_347, _343, 1);
  switch(m_346){
    Free_17 => {
      close0(x_349, n_347);
      move1(x_348, x_349);
      break;
    }
    _ => {
      switch(ctagof(m_346)){
        Map_18 => {
          getbox(f_351, m_346, 0);
          appc(x_983, f_351, x_340);
          move1(x_354, x_983);
          x_353 := fn0_leaf_worker_980(NULL, x_354, n_347);
          force(x_352, x_353);
          free(x_353);
          move1(x_350, x_352);
          free(m_346);
          break;
        }
        Reduce_19 => {
          getbox(f_355, m_346, 0);
          appc(x_985, f_355, x_340);
          move1(x_359, x_985);
          send(x_358, n_347, x_359);
          move1(c_357, x_358);
          x_361 := fn0_leaf_worker_980(NULL, x_340, c_357);
          force(x_360, x_361);
          free(x_361);
          move1(x_350, x_360);
          free(m_346);
          break;
        }
      }
      move1(x_348, x_350);
      break;
    }
  }
  move1(x_345, x_348);
  free(_343);
  return x_345;
}

fn fn1_aux_959(env) {
  aux_286 := env[0];
  ord_269 := env[1];
  chr_272 := env[2];
  str_275 := env[3];
  i_287 := env[4];
  lte(x_289, 10, i_287);
  switch(x_289){
    true_4 => {
      mod(x_291, i_287, 10);
      move1(r_290, x_291);
      div(x_293, i_287, 10);
      move1(i_292, x_293);
      appc(x_960, aux_286, i_292);
      move1(x_295, x_960);
      x_298 := fn0_ord_945(0);
      add(x_297, r_290, x_298);
      x_296 := fn0_chr_948(x_297);
      push(x_294, x_295, x_296);
      move1(x_288, x_294);
      break;
    }
    false_5 => {
      x_302 := fn0_ord_945(0);
      add(x_301, i_287, x_302);
      x_300 := fn0_chr_948(x_301);
      x_299 := fn0_str_951(x_300);
      move1(x_288, x_299);
      break;
    }
  }
  return x_288;
}

fn fn1_loop_937(env) {
  loop_259 := env[0];
  x_254 := env[1];
  m_256 := env[2];
  acc_260 := env[3];
  y_261 := env[4];
  lte(x_263, y_261, 0);
  switch(x_263){
    true_4 => {
      move1(x_262, acc_260);
      break;
    }
    false_5 => {
      mul(x_266, x_254, acc_260);
      mod(x_265, x_266, m_256);
      sub(x_267, y_261, 1);
      appc(x_938, loop_259, x_265);
      appc(x_939, x_938, x_267);
      move1(x_264, x_939);
      move1(x_262, x_264);
      break;
    }
  }
  return x_262;
}

fn fn1_loop_927(env) {
  loop_244 := env[0];
  x_240 := env[1];
  acc_245 := env[2];
  y_246 := env[3];
  lte(x_248, y_246, 0);
  switch(x_248){
    true_4 => {
      move1(x_247, acc_245);
      break;
    }
    false_5 => {
      mul(x_250, x_240, acc_245);
      sub(x_251, y_246, 1);
      appc(x_928, loop_244, x_250);
      appc(x_929, x_928, x_251);
      move1(x_249, x_929);
      move1(x_247, x_249);
      break;
    }
  }
  return x_247;
}

fn fn1_loop_890(env) {
  loop_154 := env[0];
  pred_118 := env[1];
  sub_131 := env[2];
  x_155 := env[3];
  y_156 := env[4];
  x_159 := fn0_pred_876(y_156);
  x_158 := fn0_sub_882(x_155, x_159);
  switch(x_158){
    zero_6 => {
      move1(x_157, zero_6);
      break;
    }
    _ => {
      x_162 := fn0_pred_876(y_156);
      x_161 := fn0_sub_882(x_155, x_162);
      getbox(n_163, x_161, 0);
      appc(x_891, loop_154, n_163);
      appc(x_892, x_891, y_156);
      move1(x_164, x_892);
      mkbox(x_165, succ_7, 1);
      setbox(x_165, x_164, 0);
      move1(x_160, x_165);
      move1(x_157, x_160);
      break;
    }
  }
  return x_157;
}

main {
  mkclo0(idU_1, fn1_idU_814, fvc:=0, argc:=2);
  mkclo0(idL_4, fn1_idL_817, fvc:=0, argc:=2);
  mkclo0(rwlUU_7, fn1_rwlUU_820, fvc:=0, argc:=6);
  mkclo0(rwlUL_14, fn1_rwlUL_823, fvc:=0, argc:=6);
  mkclo0(rwlLU_21, fn1_rwlLU_826, fvc:=0, argc:=6);
  mkclo0(rwlLL_28, fn1_rwlLL_829, fvc:=0, argc:=6);
  mkclo0(rwrUU_35, fn1_rwrUU_832, fvc:=0, argc:=6);
  mkclo0(rwrUL_42, fn1_rwrUL_835, fvc:=0, argc:=6);
  mkclo0(rwrLU_49, fn1_rwrLU_838, fvc:=0, argc:=6);
  mkclo0(rwrLL_56, fn1_rwrLL_841, fvc:=0, argc:=6);
  mkclo0(sing_elimUU_63, fn1_sing_elimUU_844, fvc:=0, argc:=3);
  mkclo0(sing_elimUL_67, fn1_sing_elimUL_847, fvc:=0, argc:=3);
  mkclo0(sing_elimLU_71, fn1_sing_elimLU_850, fvc:=0, argc:=3);
  mkclo0(sing_elimLL_75, fn1_sing_elimLL_853, fvc:=0, argc:=3);
  mkclo0(not_79, fn1_not_856, fvc:=0, argc:=1);
  mkclo0(and_82, fn1_and_859, fvc:=0, argc:=2);
  mkclo0(or_87, fn1_or_862, fvc:=0, argc:=2);
  mkclo0(xor_92, fn1_xor_865, fvc:=0, argc:=2);
  mkclo0(string_of_bool_98, fn1_string_of_bool_868, fvc:=0, argc:=1);
  mkclo0(lte_103, fn1_lte_871, fvc:=0, argc:=2);
  mkclo0(lt_113, fn1_lt_874, fvc:=0, argc:=2);
  mkclo0(pred_118, fn1_pred_877, fvc:=0, argc:=1);
  mkclo0(add_123, fn1_add_880, fvc:=0, argc:=2);
  mkclo0(sub_131, fn1_sub_883, fvc:=0, argc:=2);
  mkclo0(mul_139, fn1_mul_886, fvc:=0, argc:=2);
  mkclo0(div_147, fn1_div_889, fvc:=0, argc:=2);
  mkclo0(rem_167, fn1_rem_899, fvc:=0, argc:=2);
  mkclo0(rconsUU_173, fn1_rconsUU_902, fvc:=0, argc:=3);
  mkclo0(rconsUL_184, fn1_rconsUL_905, fvc:=0, argc:=3);
  mkclo0(rconsLL_195, fn1_rconsLL_908, fvc:=0, argc:=3);
  mkclo0(free_listUU_206, fn1_free_listUU_911, fvc:=0, argc:=3);
  mkclo0(free_listUL_217, fn1_free_listUL_916, fvc:=0, argc:=3);
  mkclo0(free_listLL_228, fn1_free_listLL_921, fvc:=0, argc:=3);
  mkclo0(pow_239, fn1_pow_926, fvc:=0, argc:=2);
  mkclo0(powm_253, fn1_powm_936, fvc:=0, argc:=3);
  mkclo0(ord_269, fn1_ord_946, fvc:=0, argc:=1);
  mkclo0(chr_272, fn1_chr_949, fvc:=0, argc:=1);
  mkclo0(str_275, fn1_str_952, fvc:=0, argc:=1);
  mkclo0(strlen_279, fn1_strlen_955, fvc:=0, argc:=1);
  mkclo0(string_of_int_282, fn1_string_of_int_958, fvc:=0, argc:=1);
  mkclo0(map_310, fn1_map_968, fvc:=0, argc:=4);
  mkclo0(reduce_324, fn1_reduce_973, fvc:=0, argc:=5);
  mkclo0(leaf_worker_338, fn1_leaf_worker_981, fvc:=0, argc:=3);
  mkclo0(node_worker_362, fn1_node_worker_989, fvc:=0, argc:=6);
  mkclo0(cleaf_418, fn1_cleaf_996, fvc:=0, argc:=2);
  mkclo0(cnode_427, fn1_cnode_1001, fvc:=0, argc:=5);
  mkclo0(ctree_of_tree_443, fn1_ctree_of_tree_1006, fvc:=0, argc:=2);
  mkclo0(cfree_454, fn1_cfree_1009, fvc:=0, argc:=3);
  mkclo0(cmap_464, fn1_cmap_1013, fvc:=0, argc:=5);
  mkclo0(creduce_476, fn1_creduce_1017, fvc:=0, argc:=6);
  mkclo0(splitU_496, fn1_splitU_1022, fvc:=0, argc:=1);
  mkclo0(splitL_516, fn1_splitL_1025, fvc:=0, argc:=1);
  mkclo0(mergeU_536, fn1_mergeU_1028, fvc:=0, argc:=2);
  mkclo0(mergeL_556, fn1_mergeL_1031, fvc:=0, argc:=2);
  mkclo0(msortU_576, fn1_msortU_1034, fvc:=0, argc:=1);
  mkclo0(msortL_596, fn1_msortL_1037, fvc:=0, argc:=1);
  mkclo0(splitting_tree_616, fn1_splitting_tree_1040, fvc:=0, argc:=1);
  mkclo0(splitting_ctree_640, fn1_splitting_ctree_1043, fvc:=0, argc:=2);
  mkclo0(cmsort_704, fn1_cmsort_1051, fvc:=0, argc:=1);
  mkclo0(mklistU_739, fn1_mklistU_1058, fvc:=0, argc:=1);
  mkclo0(mklistL_746, fn1_mklistL_1061, fvc:=0, argc:=1);
  mkclo0(list_lenU_753, fn1_list_lenU_1064, fvc:=0, argc:=1);
  mkclo0(list_lenL_761, fn1_list_lenL_1067, fvc:=0, argc:=1);
  mkclo0(print_listU_769, fn1_print_listU_1070, fvc:=0, argc:=1);
  mkclo0(print_listL_787, fn1_print_listL_1075, fvc:=0, argc:=1);
  x_806 := fn0_mklistU_1057(100);
  move1(test_805, x_806);
  lazy(x_807, lazy__1080, 3);
  setlazy(x_807, cmsort_704, 0);
  setlazy(x_807, print_listU_769, 1);
  setlazy(x_807, test_805, 2);
  force(x_1079, x_807);
  return x_1079;
}

[trans45 success]

-----------------------------------------

compilation success

-----------------------------------------

