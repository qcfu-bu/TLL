parsing success--------------------------

inductive unit_d1 : U =
| tt_c1 of : unit_d1

inductive bool_d2 : U =
| true_c2 of : bool_d2 | false_c3 of : bool_d2

program andb_i1 : bool_d2 → bool_d2 → bool_d2 =
  fn (b1_v285 : bool_d2) (b2_v286 : bool_d2) ⇒
    match b1_v285 as __v287 in ??1 with
    | true_c2  ⇒ b2_v286 | false_c3  ⇒ false_c3‹›
    end

program orb_i2 : bool_d2 → bool_d2 → bool_d2 =
  fn (b1_v290 : bool_d2) (b2_v291 : bool_d2) ⇒
    match b1_v290 as __v292 in ??2 with
    | true_c2  ⇒ true_c2‹› | false_c3  ⇒ b2_v291
    end

program notb_i3 : bool_d2 → bool_d2 =
  fn (b_v294 : bool_d2) ⇒
    match b_v294 as __v295 in ??3 with
    | true_c2  ⇒ false_c3‹› | false_c3  ⇒ true_c2‹›
    end

inductive nat_d3 : U =
| O_c4 of : nat_d3 | S_c5 of (n_v296 : nat_d3) : nat_d3

program lten_i4 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v299 : nat_d3) (y_v300 : nat_d3) ⇒
    match x_v299 as __v301 in ??4 with
    | O_c4  ⇒ true_c2‹›
    | S_c5 x_v302 ⇒
      match y_v300 as __v303 in ??5 with
      | O_c4  ⇒ false_c3‹› | S_c5 y_v304 ⇒ (lten_i4 x_v302 y_v304)
      end
    end

program gten_i5 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v307 : nat_d3) (y_v308 : nat_d3) ⇒
    match x_v307 as __v309 in ??6 with
    | O_c4  ⇒
      match y_v308 as __v310 in ??8 with
      | O_c4  ⇒ true_c2‹› | S_c5 __v311 ⇒ false_c3‹›
      end
    | S_c5 x_v312 ⇒
      match y_v308 as __v313 in ??7 with
      | O_c4  ⇒ true_c2‹› | S_c5 y_v314 ⇒ (gten_i5 x_v312 y_v314)
      end
    end

program ltn_i6 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v317 : nat_d3) (y_v318 : nat_d3) ⇒
    match x_v317 as __v319 in ??9 with
    | O_c4  ⇒
      match y_v318 as __v320 in ??11 with
      | O_c4  ⇒ false_c3‹› | S_c5 y_v321 ⇒ true_c2‹›
      end
    | S_c5 x_v322 ⇒
      match y_v318 as __v323 in ??10 with
      | O_c4  ⇒ false_c3‹› | S_c5 y_v324 ⇒ (ltn_i6 x_v322 y_v324)
      end
    end

program gtn_i7 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v327 : nat_d3) (y_v328 : nat_d3) ⇒
    match x_v327 as __v329 in ??12 with
    | O_c4  ⇒ false_c3‹›
    | S_c5 x_v330 ⇒
      match y_v328 as __v331 in ??13 with
      | O_c4  ⇒ true_c2‹› | S_c5 y_v332 ⇒ (gtn_i7 x_v330 y_v332)
      end
    end

program eqn_i8 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v335 : nat_d3) (y_v336 : nat_d3) ⇒
    match x_v335 as __v337 in ??14 with
    | O_c4  ⇒
      match y_v336 as __v338 in ??16 with
      | O_c4  ⇒ true_c2‹› | S_c5 __v339 ⇒ false_c3‹›
      end
    | S_c5 x_v340 ⇒
      match y_v336 as __v341 in ??15 with
      | O_c4  ⇒ false_c3‹› | S_c5 y_v342 ⇒ (eqn_i8 x_v340 y_v342)
      end
    end

program pred_i9 : nat_d3 → nat_d3 =
  fn (x_v344 : nat_d3) ⇒
    match x_v344 as __v345 in ??17 with
    | O_c4  ⇒ O_c4‹› | S_c5 x_v346 ⇒ x_v346
    end

program addn_i10 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v349 : nat_d3) (y_v350 : nat_d3) ⇒
    match x_v349 as __v351 in ??18 with
    | O_c4  ⇒ y_v350
    | S_c5 x_v352 ⇒ (S_c5‹› (addn_i10 x_v352 y_v350))
    end

program subn_i11 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v355 : nat_d3) (y_v356 : nat_d3) ⇒
    match y_v356 as __v357 in ??19 with
    | O_c4  ⇒ x_v355 | S_c5 y_v358 ⇒ (subn_i11 (pred_i9 x_v355) y_v358)
    end

program muln_i12 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v361 : nat_d3) (y_v362 : nat_d3) ⇒
    match x_v361 as __v363 in ??20 with
    | O_c4  ⇒ O_c4‹›
    | S_c5 x_v364 ⇒ (addn_i10 y_v362 (muln_i12 x_v364 y_v362))
    end

program divn_i13 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v367 : nat_d3) (y_v368 : nat_d3) ⇒
    match (ltn_i6 x_v367 y_v368) as __v369 in ??21 with
    | true_c2  ⇒ O_c4‹›
    | false_c3  ⇒ (S_c5‹› (divn_i13 (subn_i11 x_v367 y_v368) y_v368))
    end

program modn_i14 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v372 : nat_d3) (y_v373 : nat_d3) ⇒
    (subn_i11 x_v372 (muln_i12 (divn_i13 x_v372 y_v373) y_v373))

inductive ascii_d4 : U =
| Ascii_c6 of
    (b0_v374 : bool_d2) (b1_v375 : bool_d2) (b2_v376 : bool_d2)
    (b3_v377 : bool_d2) (b4_v378 : bool_d2) (b5_v379 : bool_d2)
    (b6_v380 : bool_d2) (b7_v381 : bool_d2) : ascii_d4

inductive string_d5 : U =
| EmptyString_c7 of : string_d5
| String_c8 of (c_v382 : ascii_d4) (s_v383 : string_d5) : string_d5

program cats_i15 : string_d5 → string_d5 → string_d5 =
  fn (s1_v386 : string_d5) (s2_v387 : string_d5) ⇒
    match s1_v386 as __v388 in ??22 with
    | EmptyString_c7  ⇒ s2_v387
    | String_c8 c_v389 s1_v390 ⇒
      (String_c8‹› c_v389 (cats_i15 s1_v390 s2_v387))
    end

program strlen_i16 : string_d5 → nat_d3 =
  fn (s_v392 : string_d5) ⇒
    match s_v392 as __v393 in ??23 with
    | EmptyString_c7  ⇒ O_c4‹›
    | String_c8 __v394 s_v395 ⇒ (S_c5‹› (strlen_i16 s_v395))
    end

inductive list_d6 ‹s_s396, t_s397›
  (A_v398 : Type‹s_s396›) : Type‹t_s397›
=
| nil_c9 of
    ‹s_s399, t_s400› (A_v401 : Type‹s_s399›)
    : (list_d6‹s_s399, t_s400› A_v401)
| cons_c10 of
    ‹s_s402, t_s403› (A_v404 : Type‹s_s402›) (hd_v405 : A_v404)
    (tl_v406 : (list_d6‹s_s402, t_s403› A_v404))
    : (list_d6‹s_s402, t_s403› A_v404)

program len_i17 ‹s_s407, t_s408› :
  ∀ {A_v409 : Type‹s_s407›} →
    (list_d6‹??24, t_s408› A_v409) →
      nat_d3 ⊗ (list_d6‹??25, t_s408› A_v409)
=
  fn {A_v412 : Type‹s_s407›}
     (xs_v413 : (list_d6‹??24, t_s408› A_v412)) ⇒
    match xs_v413 as __v414 in ??26 with
    | nil_c9  ⇒ ⟨O_c4‹›, nil_c9‹??36, ??35›⟩
    | cons_c10 x_v415 xs_v416 ⇒
      match (len_i17‹??29, ??28› ??27 xs_v416) as __v417 in ??30 with
      | ⟨n_v418, xs_v419⟩ ⇒
        ⟨(S_c5‹› n_v418), (cons_c10‹??33, ??32› x_v415 xs_v419)⟩
      end
    end

program append_i18 ‹s_s420, t_s421› :
  ∀ {A_v422 : Type‹s_s420›} →
    (list_d6‹??37, t_s421› A_v422) →
      (list_d6‹??38, t_s421› A_v422) ⊸ (list_d6‹??40, ??39› A_v422)
=
  fn {A_v425 : Type‹s_s420›}
     (xs_v426 : (list_d6‹??37, t_s421› A_v425)) ⇒
    ln (ys_v427 : ??41) ⇒
      match xs_v426 as __v428 in ??42 with
      | nil_c9  ⇒ ys_v427
      | cons_c10 x_v429 xs_v430 ⇒
        (cons_c10‹??48, ??47›
          x_v429 (append_i18‹??45, ??44› ??43 xs_v430 ys_v427))
      end

logical stdin_rec_i19 : unit_d1 → proto =
  fn (__v432 : unit_d1) ⇒
    ⇑(b_v433 : bool_d2) ⇒
      match b_v433 as __v434 in ??49 with
      | true_c2  ⇒ ⇓(__v435 : string_d5) ⇒ (stdin_rec_i19 tt_c1‹›)
      | false_c3  ⇒ end
      end

logical stdout_rec_i20 : unit_d1 → proto =
  fn (__v437 : unit_d1) ⇒
    ⇑(b_v438 : bool_d2) ⇒
      match b_v438 as __v439 in ??50 with
      | true_c2  ⇒ ⇑(__v440 : string_d5) ⇒ (stdout_rec_i20 tt_c1‹›)
      | false_c3  ⇒ end
      end

logical stderr_rec_i21 : unit_d1 → proto =
  fn (__v442 : unit_d1) ⇒
    ⇑(b_v443 : bool_d2) ⇒
      match b_v443 as __v444 in ??51 with
      | true_c2  ⇒ ⇑(__v445 : string_d5) ⇒ (stderr_rec_i21 tt_c1‹›)
      | false_c3  ⇒ end
      end

logical stdin_t_i22 : proto = (stdin_rec_i19 tt_c1‹›)

logical stdout_t_i23 : proto = (stdout_rec_i20 tt_c1‹›)

logical stderr_t_i24 : proto = (stderr_rec_i21 tt_c1‹›)

program readline_i25 : unit_d1 → IO string_d5 =
  fn (__v447 : unit_d1) ⇒
    let ch_v448 ⇐ open stdin in
    let ch_v449 ⇐ (send ch_v448 true_c2‹›) in
    let __v450 ⇐ recv ch_v449 in
    match __v450 as __v451 in ??52 with
    | ⟨s_v452, ch_v453⟩ ⇒
      let ch_v454 ⇐ (send ch_v453 false_c3‹›) in
      let __v455 ⇐ close ch_v454 in return s_v452
    end

program print_i26 : string_d5 → IO unit_d1 =
  fn (s_v457 : string_d5) ⇒
    let ch_v458 ⇐ open stdout in
    let ch_v459 ⇐ (send ch_v458 true_c2‹›) in
    let ch_v460 ⇐ (send ch_v459 s_v457) in
    let ch_v461 ⇐ (send ch_v460 false_c3‹›) in close ch_v461

program prerr_i27 : string_d5 → IO unit_d1 =
  fn (s_v463 : string_d5) ⇒
    let ch_v464 ⇐ open stderr in
    let ch_v465 ⇐ (send ch_v464 true_c2‹›) in
    let ch_v466 ⇐ (send ch_v465 s_v463) in
    let ch_v467 ⇐ (send ch_v466 false_c3‹›) in close ch_v467

program split_i28 ‹t_s468› :
  (list_d6‹??53, t_s468› nat_d3) →
    (list_d6‹??54, t_s468› nat_d3) ⊗ (list_d6‹??55, t_s468› nat_d3)
=
  fn (zs_v471 : (list_d6‹??53, t_s468› nat_d3)) ⇒
    match zs_v471 as __v472 in ??56 with
    | nil_c9  ⇒ ⟨nil_c9‹??77, ??76›, nil_c9‹??80, ??79›⟩
    | cons_c10 x_v473 zs_v474 ⇒
      match zs_v474 as __v475 in ??57 with
      | nil_c9  ⇒
        ⟨(cons_c10‹??71, ??70› x_v473 nil_c9‹??68, ??67›), nil_c9‹??74,
        ??73›⟩
      | cons_c10 y_v476 zs_v477 ⇒
        let __v478 = (split_i28‹??58› zs_v477) in
        match __v478 as __v479 in ??65 with
        | ⟨xs_v480, ys_v481⟩ ⇒
          ⟨(cons_c10‹??61, ??60› x_v473 xs_v480), (cons_c10‹??64,
                                                        ??63›
                                                          y_v476 ys_v481)⟩
        end
      end
    end

program merge_i29 ‹t_s482› :
  (list_d6‹??81, t_s482› nat_d3) →
    (list_d6‹??82, t_s482› nat_d3) ⊸ (list_d6‹??83, t_s482› nat_d3)
=
  fn (xs_v485 : (list_d6‹??81, t_s482› nat_d3)) ⇒
    ln (ys_v486 : ??84) ⇒
      match xs_v485 as __v487 in ??85 with
      | nil_c9  ⇒ ys_v486
      | cons_c10 x_v488 xs0_v489 ⇒
        match ys_v486 as __v490 in ??86 with
        | nil_c9  ⇒ (cons_c10‹??104, ??103› x_v488 xs0_v489)
        | cons_c10 y_v491 ys0_v492 ⇒
          match (lten_i4 x_v488 y_v491) as __v493 in ??87 with
          | true_c2  ⇒
            (cons_c10‹??101, ??100›
              x_v488
              (merge_i29‹??98›
                xs0_v489 (cons_c10‹??97, ??96› y_v491 ys0_v492)))
          | false_c3  ⇒
            (cons_c10‹??94, ??93›
              y_v491
              (merge_i29‹??91›
                (cons_c10‹??90, ??89› x_v488 xs0_v489) ys0_v492))
          end
        end
      end

program msort_i30 ‹t_s494› :
  (list_d6‹??105, t_s494› nat_d3) → (list_d6‹??106, t_s494› nat_d3)
=
  fn (zs_v496 : (list_d6‹??105, t_s494› nat_d3)) ⇒
    match zs_v496 as __v497 in ??107 with
    | nil_c9  ⇒ nil_c9‹??128, ??127›
    | cons_c10 x_v498 zs_v499 ⇒
      match zs_v499 as __v500 in ??108 with
      | nil_c9  ⇒
        (cons_c10‹??125, ??124› x_v498 nil_c9‹??122, ??121›)
      | cons_c10 y_v501 zs_v502 ⇒
        let __v503 =
          (split_i28‹??115›
            (cons_c10‹??114, ??113›
              x_v498 (cons_c10‹??111, ??110› y_v501 zs_v502)))
        in
        match __v503 as __v504 in ??119 with
        | ⟨xs_v505, ys_v506⟩ ⇒
          (merge_i29‹??118›
            (msort_i30‹??117› xs_v505) (msort_i30‹??116› ys_v506))
        end
      end
    end

inductive uniq_d7 ‹t_s507›
  (A_v508 : Type‹t_s507›) (a_v509 : A_v508) : Type‹t_s507›
=
| Uniq_c11 of
    ‹t_s510› (A_v511 : Type‹t_s510›) (a_v512 : A_v511)
    (m_v513 : A_v511) {pf_v514 : m_v513 ≡ a_v512}
    : (uniq_d7‹t_s510› A_v511 a_v512)

logical cmsort_ch_i31 ‹t_s515› :
  (list_d6‹??130, t_s515› nat_d3) → L
=
  fn (xs_v517 : (list_d6‹??130, t_s515› nat_d3)) ⇒
    ch⟨⇑(__v518 :
           (uniq_d7‹??133› ??132 (msort_i30‹??131› xs_v517))) ⇒ end⟩

program cmsort_worker_i32 ‹t_s519› :
  ∀ (zs_v520 : (list_d6‹??134, t_s519› nat_d3)) →
    (cmsort_ch_i31‹t_s519› zs_v520) ⊸ IO unit_d1
=
  fn (zs_v522 : (list_d6‹??134, t_s519› nat_d3)) ⇒
    ln (c_v523 : ??135) ⇒
      (match zs_v522 as _zs__v524 in
         (cmsort_ch_i31‹??136› _zs__v524) ⊸ IO unit_d1 with
       | nil_c9  ⇒
         ln (c_v526 : ??194) ⇒
           let c_v527 ⇐
             (send c_v526
               (Uniq_c11‹??201› nil_c9‹??198, ??197› refl ??195))
           in close c_v527
       | cons_c10 z0_v528 zs0_v529 ⇒
         ln (c_v530 : ??137) ⇒
           (match zs0_v529 as _zs0__v531 in
              (cmsort_ch_i31‹??141›
                (cons_c10‹??140, ??139› z0_v528 _zs0__v531)) ⊸
                IO unit_d1 with
            | nil_c9  ⇒
              ln (c_v533 : ??183) ⇒
                let c_v534 ⇐
                  (send c_v533
                    (Uniq_c11‹??193›
                      (cons_c10‹??190, ??189›
                        z0_v528 nil_c9‹??187, ??186›)
                      refl ??184))
                in close c_v534
            | cons_c10 z1_v535 zs1_v536 ⇒
              ln (c_v537 : ??142) ⇒
                (match (split_i28‹??149›
                         (cons_c10‹??148, ??147›
                           z0_v528
                           (cons_c10‹??145, ??144› z1_v535 zs1_v536))) as _p__v538 in
                   {_p__v538 ≡
                      (split_i28‹??156›
                        (cons_c10‹??155, ??154›
                          z0_v528
                          (cons_c10‹??152, ??151› z1_v535 zs1_v536)))} ⊸
                     IO unit_d1 with
                 | ⟨xs0_v540, ys0_v541⟩ ⇒
                   ln {e_v542 : ??158} ⇒
                     let r1_v543 ⇐
                       fork (r1_v544 : (cmsort_ch_i31‹??159› xs0_v540))
                       in (cmsort_worker_i32‹??160› xs0_v540 r1_v544)
                     in
                     let r2_v545 ⇐
                       fork (r2_v546 : (cmsort_ch_i31‹??161› ys0_v541))
                       in (cmsort_worker_i32‹??162› ys0_v541 r2_v546)
                     in
                     let __v547 ⇐ recv r1_v543 in
                     match __v547 as __v548 in ??181 with
                     | ⟨msg1_v549, r1_v550⟩ ⇒
                       let __v551 ⇐ recv r2_v545 in
                       match __v551 as __v552 in ??180 with
                       | ⟨msg2_v553, r2_v554⟩ ⇒
                         match msg1_v549 as __v555 in ??163 with
                         | Uniq_c11 xs1_v556 pf1_v557 ⇒
                           match msg2_v553 as __v558 in ??164 with
                           | Uniq_c11 xs2_v559 pf2_v560 ⇒
                             let zs_v561 =
                               (merge_i29‹??165› xs1_v556 xs2_v559)
                             in
                             let c_v562 ⇐
                               (send c_v537
                                 (Uniq_c11‹??179›
                                   zs_v561
                                   rew [p_v563, __v564 ⇒
                                     zs_v561 ≡
                                       let __v565 = p_v563 in
                                       match __v565 as __v566 in ??175 with
                                       | ⟨xs_v567, ys_v568⟩ ⇒
                                         (merge_i29‹??174›
                                           (msort_i30‹??173› xs_v567)
                                           (msort_i30‹??172› ys_v568))
                                       end]
                                     e_v542 in
                                   rew [l_v569, __v570 ⇒
                                     zs_v561 ≡
                                       (merge_i29‹??170›
                                         l_v569
                                         (msort_i30‹??169› ys0_v541))]
                                     pf1_v557 in
                                   rew [l_v571, __v572 ⇒
                                     zs_v561 ≡
                                       (merge_i29‹??167› xs1_v556 l_v571)]
                                     pf2_v560 in
                                   refl ??166))
                             in
                             let __v573 ⇐ close r1_v550 in
                             let __v574 ⇐ close r2_v554 in close c_v562
                           end
                         end
                       end
                     end
                 end refl ??182)
            end c_v530)
       end c_v523)

program cmsort_i33 ‹t_s575› :
  ∀ (zs_v576 : (list_d6‹??202, t_s575› nat_d3)) →
    IO (uniq_d7‹t_s575› ??204 (msort_i30‹??203› zs_v576))
=
  fn (zs_v577 : (list_d6‹??202, t_s575› nat_d3)) ⇒
    let c_v578 ⇐
      fork (c_v579 : (cmsort_ch_i31‹??205› zs_v577)) in
        (cmsort_worker_i32‹??206› zs_v577 c_v579)
    in
    let __v580 ⇐ recv c_v578 in
    match __v580 as __v581 in ??207 with
    | ⟨msg_v582, c_v583⟩ ⇒
      let __v584 ⇐ close c_v583 in return msg_v582
    end

program digits_i34 : (list_d6‹??208, U› ??209) =
  (cons_c10‹??242, ??241›
    "0"
    (cons_c10‹??239, ??238›
      "1"
      (cons_c10‹??236, ??235›
        "2"
        (cons_c10‹??233, ??232›
          "3"
          (cons_c10‹??230, ??229›
            "4"
            (cons_c10‹??227, ??226›
              "5"
              (cons_c10‹??224, ??223›
                "6"
                (cons_c10‹??221, ??220›
                  "7"
                  (cons_c10‹??218, ??217›
                    "8"
                    (cons_c10‹??215, ??214› "9" nil_c9‹??212, ??211›))))))))))

program get_at_i35 :
  ∀ {A_v585 : U} →
    nat_d3 → (list_d6‹??243, U› A_v585) → A_v585 → A_v585
=
  fn {A_v589 : U} (n_v590 : nat_d3)
     (xs_v591 : (list_d6‹??243, U› A_v589)) (a_v592 : A_v589) ⇒
    match n_v590 as __v593 in ??244 with
    | O_c4  ⇒
      match xs_v591 as __v594 in ??247 with
      | nil_c9  ⇒ a_v592 | cons_c10 x_v595 __v596 ⇒ x_v595
      end
    | S_c5 n_v597 ⇒
      match xs_v591 as __v598 in ??245 with
      | nil_c9  ⇒ a_v592
      | cons_c10 __v599 xs_v600 ⇒ (get_at_i35 ??246 n_v597 xs_v600 a_v592)
      end
    end

program string_of_digit_i36 : nat_d3 → string_d5 =
  fn (n_v602 : nat_d3) ⇒
    (get_at_i35 ??248 n_v602 digits_i34 EmptyString_c7‹›)

program string_of_nat_i37 : nat_d3 → string_d5 =
  fn (n_v604 : nat_d3) ⇒
    let s_v605 = (string_of_digit_i36 (modn_i14 n_v604 10)) in
    let n_v606 = (divn_i13 n_v604 10) in
    match (ltn_i6 O_c4‹› n_v606) as __v607 in ??249 with
    | true_c2  ⇒ (cats_i15 (string_of_nat_i37 n_v606) s_v605)
    | false_c3  ⇒ s_v605
    end

program string_of_list_i38 ‹t_s608› :
  (list_d6‹??250, t_s608› nat_d3) → string_d5
=
  fn (xs_v610 : (list_d6‹??250, t_s608› nat_d3)) ⇒
    match xs_v610 as __v611 in ??251 with
    | nil_c9  ⇒ "nil"
    | cons_c10 x_v612 xs_v613 ⇒
      (cats_i15
        (cats_i15 (string_of_nat_i37 x_v612) " :: ")
        (string_of_list_i38‹??252› xs_v613))
    end

program main_i39 : IO unit_d1 =
  let test1_v614 =
    ((cons_c10‹??276, ??275›
       5
       (cons_c10‹??273, ??272›
         2
         (cons_c10‹??270, ??269›
           1
           (cons_c10‹??267, ??266›
             6
             (cons_c10‹??264, ??263›
               4
               (cons_c10‹??261, ??260›
                 O_c4‹›
                 (cons_c10‹??258, ??257› 3 nil_c9‹??255, ??254›)))))))
      : (list_d6‹??277, U› ??278))
  in
  let test2_v615 =
    ((cons_c10‹??302, ??301›
       3
       (cons_c10‹??299, ??298›
         O_c4‹›
         (cons_c10‹??296, ??295›
           6
           (cons_c10‹??293, ??292›
             1
             (cons_c10‹??290, ??289›
               4
               (cons_c10‹??287, ??286›
                 2 (cons_c10‹??284, ??283› 5 nil_c9‹??281, ??280›)))))))
      : (list_d6‹??303, L› ??304))
  in
  let msg1_v616 ⇐ (cmsort_i33‹??305› test1_v614) in
  let msg2_v617 ⇐ (cmsort_i33‹??306› test2_v615) in
  match msg1_v616 as __v618 in ??307 with
  | Uniq_c11 sorted1_v619 __v620 ⇒
    match msg2_v617 as __v621 in ??308 with
    | Uniq_c11 sorted2_v622 __v623 ⇒
      let __v624 ⇐
        (print_i26
          (cats_i15 (string_of_list_i38‹??309› sorted1_v619) "\n"))
      in
      (print_i26
        (cats_i15 (string_of_list_i38‹??310› sorted2_v622) "\n"))
    end
  end

trans01 success--------------------------

inductive unit_d1 : U =
| tt_c1 of : unit_d1

inductive bool_d2 : U =
| true_c2 of : bool_d2 | false_c3 of : bool_d2

program andb_i1 : bool_d2 → bool_d2 → bool_d2 =
  fn (b1_v136936 : bool_d2) (b2_v136937 : bool_d2) ⇒
    match b1_v136936 as __v136938 in bool_d2 with
    | true_c2  ⇒ b2_v136937 | false_c3  ⇒ false_c3‹›
    end

program orb_i2 : bool_d2 → bool_d2 → bool_d2 =
  fn (b1_v136941 : bool_d2) (b2_v136942 : bool_d2) ⇒
    match b1_v136941 as __v136943 in bool_d2 with
    | true_c2  ⇒ true_c2‹› | false_c3  ⇒ b2_v136942
    end

program notb_i3 : bool_d2 → bool_d2 =
  fn (b_v136945 : bool_d2) ⇒
    match b_v136945 as __v136946 in bool_d2 with
    | true_c2  ⇒ false_c3‹› | false_c3  ⇒ true_c2‹›
    end

inductive nat_d3 : U =
| O_c4 of : nat_d3 | S_c5 of (n_v136947 : nat_d3) : nat_d3

program lten_i4 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v136950 : nat_d3) (y_v136951 : nat_d3) ⇒
    match x_v136950 as __v136952 in bool_d2 with
    | O_c4  ⇒ true_c2‹›
    | S_c5 x_v136953 ⇒
      match y_v136951 as __v136954 in bool_d2 with
      | O_c4  ⇒ false_c3‹›
      | S_c5 y_v136955 ⇒ (lten_i4 x_v136953 y_v136955)
      end
    end

program gten_i5 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v136958 : nat_d3) (y_v136959 : nat_d3) ⇒
    match x_v136958 as __v136960 in bool_d2 with
    | O_c4  ⇒
      match y_v136959 as __v136961 in bool_d2 with
      | O_c4  ⇒ true_c2‹› | S_c5 __v136962 ⇒ false_c3‹›
      end
    | S_c5 x_v136963 ⇒
      match y_v136959 as __v136964 in bool_d2 with
      | O_c4  ⇒ true_c2‹›
      | S_c5 y_v136965 ⇒ (gten_i5 x_v136963 y_v136965)
      end
    end

program ltn_i6 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v136968 : nat_d3) (y_v136969 : nat_d3) ⇒
    match x_v136968 as __v136970 in bool_d2 with
    | O_c4  ⇒
      match y_v136969 as __v136971 in bool_d2 with
      | O_c4  ⇒ false_c3‹› | S_c5 y_v136972 ⇒ true_c2‹›
      end
    | S_c5 x_v136973 ⇒
      match y_v136969 as __v136974 in bool_d2 with
      | O_c4  ⇒ false_c3‹›
      | S_c5 y_v136975 ⇒ (ltn_i6 x_v136973 y_v136975)
      end
    end

program gtn_i7 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v136978 : nat_d3) (y_v136979 : nat_d3) ⇒
    match x_v136978 as __v136980 in bool_d2 with
    | O_c4  ⇒ false_c3‹›
    | S_c5 x_v136981 ⇒
      match y_v136979 as __v136982 in bool_d2 with
      | O_c4  ⇒ true_c2‹›
      | S_c5 y_v136983 ⇒ (gtn_i7 x_v136981 y_v136983)
      end
    end

program eqn_i8 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v136986 : nat_d3) (y_v136987 : nat_d3) ⇒
    match x_v136986 as __v136988 in bool_d2 with
    | O_c4  ⇒
      match y_v136987 as __v136989 in bool_d2 with
      | O_c4  ⇒ true_c2‹› | S_c5 __v136990 ⇒ false_c3‹›
      end
    | S_c5 x_v136991 ⇒
      match y_v136987 as __v136992 in bool_d2 with
      | O_c4  ⇒ false_c3‹›
      | S_c5 y_v136993 ⇒ (eqn_i8 x_v136991 y_v136993)
      end
    end

program pred_i9 : nat_d3 → nat_d3 =
  fn (x_v136995 : nat_d3) ⇒
    match x_v136995 as __v136996 in nat_d3 with
    | O_c4  ⇒ O_c4‹› | S_c5 x_v136997 ⇒ x_v136997
    end

program addn_i10 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v137000 : nat_d3) (y_v137001 : nat_d3) ⇒
    match x_v137000 as __v137002 in nat_d3 with
    | O_c4  ⇒ y_v137001
    | S_c5 x_v137003 ⇒ (S_c5‹› (addn_i10 x_v137003 y_v137001))
    end

program subn_i11 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v137006 : nat_d3) (y_v137007 : nat_d3) ⇒
    match y_v137007 as __v137008 in nat_d3 with
    | O_c4  ⇒ x_v137006
    | S_c5 y_v137009 ⇒ (subn_i11 (pred_i9 x_v137006) y_v137009)
    end

program muln_i12 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v137012 : nat_d3) (y_v137013 : nat_d3) ⇒
    match x_v137012 as __v137014 in nat_d3 with
    | O_c4  ⇒ O_c4‹›
    | S_c5 x_v137015 ⇒ (addn_i10 y_v137013 (muln_i12 x_v137015 y_v137013))
    end

program divn_i13 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v137018 : nat_d3) (y_v137019 : nat_d3) ⇒
    match (ltn_i6 x_v137018 y_v137019) as __v137020 in nat_d3 with
    | true_c2  ⇒ O_c4‹›
    | false_c3  ⇒
      (S_c5‹› (divn_i13 (subn_i11 x_v137018 y_v137019) y_v137019))
    end

program modn_i14 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v137023 : nat_d3) (y_v137024 : nat_d3) ⇒
    (subn_i11 x_v137023 (muln_i12 (divn_i13 x_v137023 y_v137024) y_v137024))

inductive ascii_d4 : U =
| Ascii_c6 of
    (b0_v137025 : bool_d2) (b1_v137026 : bool_d2) (b2_v137027 : bool_d2)
    (b3_v137028 : bool_d2) (b4_v137029 : bool_d2) (b5_v137030 : bool_d2)
    (b6_v137031 : bool_d2) (b7_v137032 : bool_d2) : ascii_d4

inductive string_d5 : U =
| EmptyString_c7 of : string_d5
| String_c8 of (c_v137033 : ascii_d4) (s_v137034 : string_d5) : string_d5

program cats_i15 : string_d5 → string_d5 → string_d5 =
  fn (s1_v137037 : string_d5) (s2_v137038 : string_d5) ⇒
    match s1_v137037 as __v137039 in string_d5 with
    | EmptyString_c7  ⇒ s2_v137038
    | String_c8 c_v137040 s1_v137041 ⇒
      (String_c8‹› c_v137040 (cats_i15 s1_v137041 s2_v137038))
    end

program strlen_i16 : string_d5 → nat_d3 =
  fn (s_v137043 : string_d5) ⇒
    match s_v137043 as __v137044 in nat_d3 with
    | EmptyString_c7  ⇒ O_c4‹›
    | String_c8 __v137045 s_v137046 ⇒ (S_c5‹› (strlen_i16 s_v137046))
    end

inductive list_d6 ‹s_s137047, t_s137048›
  (A_v137049 : Type‹s_s137047›) : Type‹t_s137048›
=
| nil_c9 of
    ‹s_s137050, t_s137051› (A_v137052 : Type‹s_s137050›)
    : (list_d6‹s_s137050, t_s137051› A_v137052)
| cons_c10 of
    ‹s_s137053, t_s137054› (A_v137055 : Type‹s_s137053›)
    (hd_v137056 : A_v137055)
    (tl_v137057 : (list_d6‹s_s137053, t_s137054› A_v137055))
    : (list_d6‹s_s137053, t_s137054› A_v137055)

program len_i17 ‹s_s137058, t_s137059› :
  ∀ {A_v137060 : Type‹s_s137058›} →
    (list_d6‹s_s137058, t_s137059› A_v137060) →
      nat_d3 ⊗ (list_d6‹s_s137058, t_s137059› A_v137060)
=
  fn {A_v137063 : Type‹s_s137058›}
     (xs_v137064 : (list_d6‹s_s137058, t_s137059› A_v137063)) ⇒
    match xs_v137064 as __v137065 in
      nat_d3 ⊗ (list_d6‹s_s137058, t_s137059› A_v137063) with
    | nil_c9  ⇒ ⟨O_c4‹›, nil_c9‹s_s137058, t_s137059›⟩
    | cons_c10 x_v137067 xs_v137068 ⇒
      match (len_i17‹s_s137058, t_s137059› A_v137063 xs_v137068) as __v137069 in
        nat_d3 ⊗ (list_d6‹s_s137058, t_s137059› A_v137063) with
      | ⟨n_v137071, xs_v137072⟩ ⇒
        ⟨(S_c5‹› n_v137071), (cons_c10‹s_s137058, t_s137059›
                                     x_v137067 xs_v137072)⟩
      end
    end

program append_i18 ‹s_s137073, t_s137074› :
  ∀ {A_v137075 : Type‹s_s137073›} →
    (list_d6‹s_s137073, t_s137074› A_v137075) →
      (list_d6‹s_s137073, t_s137074› A_v137075) ⊸
        (list_d6‹s_s137073, t_s137074› A_v137075)
=
  fn {A_v137078 : Type‹s_s137073›}
     (xs_v137079 : (list_d6‹s_s137073, t_s137074› A_v137078)) ⇒
    ln (ys_v137080 : (list_d6‹s_s137073, t_s137074› A_v137078)) ⇒
      match xs_v137079 as __v137081 in
        (list_d6‹s_s137073, t_s137074› A_v137078) with
      | nil_c9  ⇒ ys_v137080
      | cons_c10 x_v137082 xs_v137083 ⇒
        (cons_c10‹s_s137073, t_s137074›
          x_v137082
          (append_i18‹s_s137073, t_s137074›
            A_v137078 xs_v137083 ys_v137080))
      end

logical stdin_rec_i19 : unit_d1 → proto =
  fn (__v137085 : unit_d1) ⇒
    ⇑(b_v137086 : bool_d2) ⇒
      match b_v137086 as __v137087 in proto with
      | true_c2  ⇒
        ⇓(__v137088 : string_d5) ⇒ (stdin_rec_i19 tt_c1‹›)
      | false_c3  ⇒ end
      end

logical stdout_rec_i20 : unit_d1 → proto =
  fn (__v137090 : unit_d1) ⇒
    ⇑(b_v137091 : bool_d2) ⇒
      match b_v137091 as __v137092 in proto with
      | true_c2  ⇒
        ⇑(__v137093 : string_d5) ⇒ (stdout_rec_i20 tt_c1‹›)
      | false_c3  ⇒ end
      end

logical stderr_rec_i21 : unit_d1 → proto =
  fn (__v137095 : unit_d1) ⇒
    ⇑(b_v137096 : bool_d2) ⇒
      match b_v137096 as __v137097 in proto with
      | true_c2  ⇒
        ⇑(__v137098 : string_d5) ⇒ (stderr_rec_i21 tt_c1‹›)
      | false_c3  ⇒ end
      end

logical stdin_t_i22 : proto = (stdin_rec_i19 tt_c1‹›)

logical stdout_t_i23 : proto = (stdout_rec_i20 tt_c1‹›)

logical stderr_t_i24 : proto = (stderr_rec_i21 tt_c1‹›)

program readline_i25 : unit_d1 → IO string_d5 =
  fn (__v137100 : unit_d1) ⇒
    let ch_v137101 ⇐ open stdin in
    let ch_v137102 ⇐ (send ch_v137101 true_c2‹›) in
    let __v137103 ⇐ recv ch_v137102 in
    match __v137103 as __v137104 in IO string_d5 with
    | ⟨s_v137105, ch_v137106⟩ ⇒
      let ch_v137107 ⇐ (send ch_v137106 false_c3‹›) in
      let __v137108 ⇐ close ch_v137107 in return s_v137105
    end

program print_i26 : string_d5 → IO unit_d1 =
  fn (s_v137110 : string_d5) ⇒
    let ch_v137111 ⇐ open stdout in
    let ch_v137112 ⇐ (send ch_v137111 true_c2‹›) in
    let ch_v137113 ⇐ (send ch_v137112 s_v137110) in
    let ch_v137114 ⇐ (send ch_v137113 false_c3‹›) in close ch_v137114

program prerr_i27 : string_d5 → IO unit_d1 =
  fn (s_v137116 : string_d5) ⇒
    let ch_v137117 ⇐ open stderr in
    let ch_v137118 ⇐ (send ch_v137117 true_c2‹›) in
    let ch_v137119 ⇐ (send ch_v137118 s_v137116) in
    let ch_v137120 ⇐ (send ch_v137119 false_c3‹›) in close ch_v137120

program split_i28 ‹t_s137121› :
  (list_d6‹U, t_s137121› nat_d3) →
    (list_d6‹U, t_s137121› nat_d3) ⊗ (list_d6‹U, t_s137121› nat_d3)
=
  fn (zs_v137124 : (list_d6‹U, t_s137121› nat_d3)) ⇒
    match zs_v137124 as __v137125 in
      (list_d6‹U, t_s137121› nat_d3) ⊗
        (list_d6‹U, t_s137121› nat_d3) with
    | nil_c9  ⇒ ⟨nil_c9‹U, t_s137121›, nil_c9‹U, t_s137121›⟩
    | cons_c10 x_v137127 zs_v137128 ⇒
      match zs_v137128 as __v137129 in
        (list_d6‹U, t_s137121› nat_d3) ⊗
          (list_d6‹U, t_s137121› nat_d3) with
      | nil_c9  ⇒
        ⟨(cons_c10‹U, t_s137121› x_v137127 nil_c9‹U, t_s137121›), nil_c9‹U,
        t_s137121›⟩
      | cons_c10 y_v137131 zs_v137132 ⇒
        let __v137133 = (split_i28‹t_s137121› zs_v137132) in
        match __v137133 as __v137134 in
          (list_d6‹U, t_s137121› nat_d3) ⊗
            (list_d6‹U, t_s137121› nat_d3) with
        | ⟨xs_v137136, ys_v137137⟩ ⇒
          ⟨(cons_c10‹U, t_s137121› x_v137127 xs_v137136), (cons_c10‹U,
                                                                t_s137121›
                                                                  y_v137131
                                                                  ys_v137137)⟩
        end
      end
    end

program merge_i29 ‹t_s137138› :
  (list_d6‹U, t_s137138› nat_d3) →
    (list_d6‹U, t_s137138› nat_d3) ⊸ (list_d6‹U, t_s137138› nat_d3)
=
  fn (xs_v137141 : (list_d6‹U, t_s137138› nat_d3)) ⇒
    ln (ys_v137142 : (list_d6‹U, t_s137138› nat_d3)) ⇒
      match xs_v137141 as __v137143 in
        (list_d6‹U, t_s137138› nat_d3) with
      | nil_c9  ⇒ ys_v137142
      | cons_c10 x_v137144 xs0_v137145 ⇒
        match ys_v137142 as __v137146 in
          (list_d6‹U, t_s137138› nat_d3) with
        | nil_c9  ⇒ (cons_c10‹U, t_s137138› x_v137144 xs0_v137145)
        | cons_c10 y_v137147 ys0_v137148 ⇒
          match (lten_i4 x_v137144 y_v137147) as __v137149 in
            (list_d6‹U, t_s137138› nat_d3) with
          | true_c2  ⇒
            (cons_c10‹U, t_s137138›
              x_v137144
              (merge_i29‹t_s137138›
                xs0_v137145
                (cons_c10‹U, t_s137138› y_v137147 ys0_v137148)))
          | false_c3  ⇒
            (cons_c10‹U, t_s137138›
              y_v137147
              (merge_i29‹t_s137138›
                (cons_c10‹U, t_s137138› x_v137144 xs0_v137145)
                ys0_v137148))
          end
        end
      end

program msort_i30 ‹t_s137150› :
  (list_d6‹U, t_s137150› nat_d3) → (list_d6‹U, t_s137150› nat_d3)
=
  fn (zs_v137152 : (list_d6‹U, t_s137150› nat_d3)) ⇒
    match zs_v137152 as __v137153 in (list_d6‹U, t_s137150› nat_d3) with
    | nil_c9  ⇒ nil_c9‹U, t_s137150›
    | cons_c10 x_v137154 zs_v137155 ⇒
      match zs_v137155 as __v137156 in
        (list_d6‹U, t_s137150› nat_d3) with
      | nil_c9  ⇒
        (cons_c10‹U, t_s137150› x_v137154 nil_c9‹U, t_s137150›)
      | cons_c10 y_v137157 zs_v137158 ⇒
        let __v137159 =
          (split_i28‹t_s137150›
            (cons_c10‹U, t_s137150›
              x_v137154 (cons_c10‹U, t_s137150› y_v137157 zs_v137158)))
        in
        match __v137159 as __v137160 in
          (list_d6‹U, t_s137150› nat_d3) with
        | ⟨xs_v137161, ys_v137162⟩ ⇒
          (merge_i29‹t_s137150›
            (msort_i30‹t_s137150› xs_v137161)
            (msort_i30‹t_s137150› ys_v137162))
        end
      end
    end

inductive uniq_d7 ‹t_s137163›
  (A_v137164 : Type‹t_s137163›) (a_v137165 : A_v137164) : Type‹t_s137163›
=
| Uniq_c11 of
    ‹t_s137166› (A_v137167 : Type‹t_s137166›) (a_v137168 : A_v137167)
    (m_v137169 : A_v137167) {pf_v137170 : m_v137169 ≡ a_v137168}
    : (uniq_d7‹t_s137166› A_v137167 a_v137168)

logical cmsort_ch_i31 ‹t_s137171› :
  (list_d6‹U, t_s137171› nat_d3) → L
=
  fn (xs_v137173 : (list_d6‹U, t_s137171› nat_d3)) ⇒
    ch⟨⇑(__v137174 :
           (uniq_d7‹t_s137171›
             (list_d6‹U, t_s137171› nat_d3)
             (msort_i30‹t_s137171› xs_v137173))) ⇒
           end⟩

program cmsort_worker_i32 ‹t_s137175› :
  ∀ (zs_v137176 : (list_d6‹U, t_s137175› nat_d3)) →
    (cmsort_ch_i31‹t_s137175› zs_v137176) ⊸ IO unit_d1
=
  fn (zs_v137178 : (list_d6‹U, t_s137175› nat_d3)) ⇒
    ln (c_v137179 : (cmsort_ch_i31‹t_s137175› zs_v137178)) ⇒
      (match zs_v137178 as _zs__v137180 in
         (cmsort_ch_i31‹t_s137175› _zs__v137180) ⊸ IO unit_d1 with
       | nil_c9  ⇒
         ln (c_v137182 : (cmsort_ch_i31‹t_s137175›
                           nil_c9‹U, t_s137175›)) ⇒
           let c_v137183 ⇐
             (send c_v137182
               (Uniq_c11‹t_s137175›
                 nil_c9‹U, t_s137175› refl nil_c9‹U, t_s137175›))
           in close c_v137183
       | cons_c10 z0_v137184 zs0_v137185 ⇒
         ln (c_v137186 : (cmsort_ch_i31‹t_s137175›
                           (cons_c10‹U, t_s137175›
                             z0_v137184 zs0_v137185))) ⇒
           (match zs0_v137185 as _zs0__v137187 in
              (cmsort_ch_i31‹t_s137175›
                (cons_c10‹U, t_s137175› z0_v137184 _zs0__v137187)) ⊸
                IO unit_d1 with
            | nil_c9  ⇒
              ln (c_v137189 : (cmsort_ch_i31‹t_s137175›
                                (cons_c10‹U, t_s137175›
                                  z0_v137184 nil_c9‹U, t_s137175›))) ⇒
                let c_v137190 ⇐
                  (send c_v137189
                    (Uniq_c11‹t_s137175›
                      (cons_c10‹U, t_s137175›
                        z0_v137184 nil_c9‹U, t_s137175›)
                      refl (cons_c10‹U, t_s137175›
                             z0_v137184 nil_c9‹U, t_s137175›)))
                in close c_v137190
            | cons_c10 z1_v137191 zs1_v137192 ⇒
              ln (c_v137193 : (cmsort_ch_i31‹t_s137175›
                                (cons_c10‹U, t_s137175›
                                  z0_v137184
                                  (cons_c10‹U, t_s137175›
                                    z1_v137191 zs1_v137192)))) ⇒
                (match (split_i28‹t_s137175›
                         (cons_c10‹U, t_s137175›
                           z0_v137184
                           (cons_c10‹U, t_s137175›
                             z1_v137191 zs1_v137192))) as _p__v137194 in
                   {_p__v137194 ≡
                      (split_i28‹t_s137175›
                        (cons_c10‹U, t_s137175›
                          z0_v137184
                          (cons_c10‹U, t_s137175› z1_v137191 zs1_v137192)))} ⊸
                     IO unit_d1 with
                 | ⟨xs0_v137196, ys0_v137197⟩ ⇒
                   ln {e_v137198 : (⟨xs0_v137196, ys0_v137197⟩
                                     : (list_d6‹U, t_s137175› nat_d3) ⊗
                                         (list_d6‹U, t_s137175› nat_d3)) ≡
                                     (split_i28‹t_s137175›
                                       (cons_c10‹U, t_s137175›
                                         z0_v137184
                                         (cons_c10‹U, t_s137175›
                                           z1_v137191 zs1_v137192)))} ⇒
                     let r1_v137200 ⇐
                       fork (r1_v137201 :
                         (cmsort_ch_i31‹t_s137175› xs0_v137196))
                       in
                         (cmsort_worker_i32‹t_s137175›
                           xs0_v137196 r1_v137201)
                     in
                     let r2_v137202 ⇐
                       fork (r2_v137203 :
                         (cmsort_ch_i31‹t_s137175› ys0_v137197))
                       in
                         (cmsort_worker_i32‹t_s137175›
                           ys0_v137197 r2_v137203)
                     in
                     let __v137204 ⇐ recv r1_v137200 in
                     match __v137204 as __v137205 in IO unit_d1 with
                     | ⟨msg1_v137206, r1_v137207⟩ ⇒
                       let __v137208 ⇐ recv r2_v137202 in
                       match __v137208 as __v137209 in IO unit_d1 with
                       | ⟨msg2_v137210, r2_v137211⟩ ⇒
                         match msg1_v137206 as __v137212 in IO unit_d1 with
                         | Uniq_c11 xs1_v137213 pf1_v137214 ⇒
                           match msg2_v137210 as __v137215 in IO unit_d1 with
                           | Uniq_c11 xs2_v137216 pf2_v137217 ⇒
                             let zs_v137218 =
                               (merge_i29‹t_s137175›
                                 xs1_v137213 xs2_v137216)
                             in
                             let c_v137219 ⇐
                               (send c_v137193
                                 (Uniq_c11‹t_s137175›
                                   zs_v137218
                                   rew [p_v137220, __v137221 ⇒
                                     zs_v137218 ≡
                                       let __v137222 = p_v137220 in
                                       match __v137222 as __v137223 in
                                         (list_d6‹U, t_s137175› nat_d3) with
                                       | ⟨xs_v137224, ys_v137225⟩ ⇒
                                         (merge_i29‹t_s137175›
                                           (msort_i30‹t_s137175›
                                             xs_v137224)
                                           (msort_i30‹t_s137175›
                                             ys_v137225))
                                       end]
                                     e_v137198 in
                                   rew [l_v137226, __v137227 ⇒
                                     zs_v137218 ≡
                                       (merge_i29‹t_s137175›
                                         l_v137226
                                         (msort_i30‹t_s137175›
                                           ys0_v137197))]
                                     pf1_v137214 in
                                   rew [l_v137228, __v137229 ⇒
                                     zs_v137218 ≡
                                       (merge_i29‹t_s137175›
                                         xs1_v137213 l_v137228)]
                                     pf2_v137217 in
                                   refl (merge_i29‹t_s137175›
                                          xs1_v137213 xs2_v137216)))
                             in
                             let __v137230 ⇐ close r1_v137207 in
                             let __v137231 ⇐ close r2_v137211 in
                             close c_v137219
                           end
                         end
                       end
                     end
                 end
                  refl (split_i28‹t_s137175›
                         (cons_c10‹U, t_s137175›
                           z0_v137184
                           (cons_c10‹U, t_s137175›
                             z1_v137191 zs1_v137192))))
            end c_v137186)
       end c_v137179)

program cmsort_i33 ‹t_s137232› :
  ∀ (zs_v137233 : (list_d6‹U, t_s137232› nat_d3)) →
    IO (uniq_d7‹t_s137232›
         (list_d6‹U, t_s137232› nat_d3)
         (msort_i30‹t_s137232› zs_v137233))
=
  fn (zs_v137234 : (list_d6‹U, t_s137232› nat_d3)) ⇒
    let c_v137235 ⇐
      fork (c_v137236 : (cmsort_ch_i31‹t_s137232› zs_v137234)) in
        (cmsort_worker_i32‹t_s137232› zs_v137234 c_v137236)
    in
    let __v137237 ⇐ recv c_v137235 in
    match __v137237 as __v137238 in
      IO (uniq_d7‹t_s137232›
           (list_d6‹U, t_s137232› nat_d3)
           (msort_i30‹t_s137232› zs_v137234)) with
    | ⟨msg_v137239, c_v137240⟩ ⇒
      let __v137241 ⇐ close c_v137240 in return msg_v137239
    end

program digits_i34 : (list_d6‹U, U› string_d5) =
  (cons_c10‹U, U›
    "0"
    (cons_c10‹U, U›
      "1"
      (cons_c10‹U, U›
        "2"
        (cons_c10‹U, U›
          "3"
          (cons_c10‹U, U›
            "4"
            (cons_c10‹U, U›
              "5"
              (cons_c10‹U, U›
                "6"
                (cons_c10‹U, U›
                  "7"
                  (cons_c10‹U, U›
                    "8" (cons_c10‹U, U› "9" nil_c9‹U, U›))))))))))

program get_at_i35 :
  ∀ {A_v137242 : U} →
    nat_d3 → (list_d6‹U, U› A_v137242) → A_v137242 → A_v137242
=
  fn {A_v137246 : U} (n_v137247 : nat_d3)
     (xs_v137248 : (list_d6‹U, U› A_v137246)) (a_v137249 : A_v137246) ⇒
    match n_v137247 as __v137250 in A_v137246 with
    | O_c4  ⇒
      match xs_v137248 as __v137251 in A_v137246 with
      | nil_c9  ⇒ a_v137249 | cons_c10 x_v137252 __v137253 ⇒ x_v137252
      end
    | S_c5 n_v137254 ⇒
      match xs_v137248 as __v137255 in A_v137246 with
      | nil_c9  ⇒ a_v137249
      | cons_c10 __v137256 xs_v137257 ⇒
        (get_at_i35 A_v137246 n_v137254 xs_v137257 a_v137249)
      end
    end

program string_of_digit_i36 : nat_d3 → string_d5 =
  fn (n_v137259 : nat_d3) ⇒
    (get_at_i35 string_d5 n_v137259 digits_i34 EmptyString_c7‹›)

program string_of_nat_i37 : nat_d3 → string_d5 =
  fn (n_v137261 : nat_d3) ⇒
    let s_v137262 = (string_of_digit_i36 (modn_i14 n_v137261 10)) in
    let n_v137263 = (divn_i13 n_v137261 10) in
    match (ltn_i6 O_c4‹› n_v137263) as __v137264 in string_d5 with
    | true_c2  ⇒ (cats_i15 (string_of_nat_i37 n_v137263) s_v137262)
    | false_c3  ⇒ s_v137262
    end

program string_of_list_i38 ‹t_s137265› :
  (list_d6‹U, t_s137265› nat_d3) → string_d5
=
  fn (xs_v137267 : (list_d6‹U, t_s137265› nat_d3)) ⇒
    match xs_v137267 as __v137268 in string_d5 with
    | nil_c9  ⇒ "nil"
    | cons_c10 x_v137269 xs_v137270 ⇒
      (cats_i15
        (cats_i15 (string_of_nat_i37 x_v137269) " :: ")
        (string_of_list_i38‹t_s137265› xs_v137270))
    end

program main_i39 : IO unit_d1 =
  let test1_v137271 =
    ((cons_c10‹U, U›
       5
       (cons_c10‹U, U›
         2
         (cons_c10‹U, U›
           1
           (cons_c10‹U, U›
             6
             (cons_c10‹U, U›
               4
               (cons_c10‹U, U›
                 O_c4‹› (cons_c10‹U, U› 3 nil_c9‹U, U›)))))))
      : (list_d6‹U, U› nat_d3))
  in
  let test2_v137272 =
    ((cons_c10‹U, L›
       3
       (cons_c10‹U, L›
         O_c4‹›
         (cons_c10‹U, L›
           6
           (cons_c10‹U, L›
             1
             (cons_c10‹U, L›
               4
               (cons_c10‹U, L› 2 (cons_c10‹U, L› 5 nil_c9‹U, L›)))))))
      : (list_d6‹U, L› nat_d3))
  in
  let msg1_v137273 ⇐ (cmsort_i33‹U› test1_v137271) in
  let msg2_v137274 ⇐ (cmsort_i33‹L› test2_v137272) in
  match msg1_v137273 as __v137275 in IO unit_d1 with
  | Uniq_c11 sorted1_v137276 __v137277 ⇒
    match msg2_v137274 as __v137278 in IO unit_d1 with
    | Uniq_c11 sorted2_v137279 __v137280 ⇒
      let __v137281 ⇐
        (print_i26
          (cats_i15 (string_of_list_i38‹U› sorted1_v137276) "\n"))
      in
      (print_i26 (cats_i15 (string_of_list_i38‹L› sorted2_v137279) "\n"))
    end
  end

trans1e success--------------------------

data unit_d1 =
| tt_c1 of size(0)

data bool_d2 =
| true_c2 of size(0) | false_c3 of size(0)

def andb_i1 =
  fn b1_v138085 b2_v138086 ⇒
    match b1_v138085 with
    | true_c2  ⇒ b2_v138086 | false_c3  ⇒ false_c3
    end

def orb_i2 =
  fn b1_v138087 b2_v138088 ⇒
    match b1_v138087 with
    | true_c2  ⇒ true_c2 | false_c3  ⇒ b2_v138088
    end

def notb_i3 =
  fn b_v138089 ⇒
    match b_v138089 with
    | true_c2  ⇒ false_c3 | false_c3  ⇒ true_c2
    end

data nat_d3 =
| O_c4 of size(0) | S_c5 of size(1)

def lten_i4 =
  fn x_v138090 y_v138091 ⇒
    match x_v138090 with
    | O_c4  ⇒ true_c2
    | S_c5 x_v138092 ⇒
      match y_v138091 with
      | O_c4  ⇒ false_c3
      | S_c5 y_v138093 ⇒ ((lten_i4 x_v138092) y_v138093)
      end
    end

def gten_i5 =
  fn x_v138094 y_v138095 ⇒
    match x_v138094 with
    | O_c4  ⇒
      match y_v138095 with
      | O_c4  ⇒ true_c2 | S_c5 __v138096 ⇒ false_c3
      end
    | S_c5 x_v138097 ⇒
      match y_v138095 with
      | O_c4  ⇒ true_c2
      | S_c5 y_v138098 ⇒ ((gten_i5 x_v138097) y_v138098)
      end
    end

def ltn_i6 =
  fn x_v138099 y_v138100 ⇒
    match x_v138099 with
    | O_c4  ⇒
      match y_v138100 with
      | O_c4  ⇒ false_c3 | S_c5 y_v138101 ⇒ true_c2
      end
    | S_c5 x_v138102 ⇒
      match y_v138100 with
      | O_c4  ⇒ false_c3
      | S_c5 y_v138103 ⇒ ((ltn_i6 x_v138102) y_v138103)
      end
    end

def gtn_i7 =
  fn x_v138104 y_v138105 ⇒
    match x_v138104 with
    | O_c4  ⇒ false_c3
    | S_c5 x_v138106 ⇒
      match y_v138105 with
      | O_c4  ⇒ true_c2 | S_c5 y_v138107 ⇒ ((gtn_i7 x_v138106) y_v138107)
      end
    end

def eqn_i8 =
  fn x_v138108 y_v138109 ⇒
    match x_v138108 with
    | O_c4  ⇒
      match y_v138109 with
      | O_c4  ⇒ true_c2 | S_c5 __v138110 ⇒ false_c3
      end
    | S_c5 x_v138111 ⇒
      match y_v138109 with
      | O_c4  ⇒ false_c3
      | S_c5 y_v138112 ⇒ ((eqn_i8 x_v138111) y_v138112)
      end
    end

def pred_i9 =
  fn x_v138113 ⇒
    match x_v138113 with
    | O_c4  ⇒ O_c4 | S_c5 x_v138114 ⇒ x_v138114
    end

def addn_i10 =
  fn x_v138115 y_v138116 ⇒
    match x_v138115 with
    | O_c4  ⇒ y_v138116
    | S_c5 x_v138117 ⇒ (S_c5 ((addn_i10 x_v138117) y_v138116))
    end

def subn_i11 =
  fn x_v138118 y_v138119 ⇒
    match y_v138119 with
    | O_c4  ⇒ x_v138118
    | S_c5 y_v138120 ⇒ ((subn_i11 (pred_i9 x_v138118)) y_v138120)
    end

def muln_i12 =
  fn x_v138121 y_v138122 ⇒
    match x_v138121 with
    | O_c4  ⇒ O_c4
    | S_c5 x_v138123 ⇒
      ((addn_i10 y_v138122) ((muln_i12 x_v138123) y_v138122))
    end

def divn_i13 =
  fn x_v138124 y_v138125 ⇒
    match ((ltn_i6 x_v138124) y_v138125) with
    | true_c2  ⇒ O_c4
    | false_c3  ⇒
      (S_c5 ((divn_i13 ((subn_i11 x_v138124) y_v138125)) y_v138125))
    end

def modn_i14 =
  fn x_v138126 y_v138127 ⇒
    ((subn_i11 x_v138126)
      ((muln_i12 ((divn_i13 x_v138126) y_v138127)) y_v138127))

data ascii_d4 =
| Ascii_c6 of size(8)

data string_d5 =
| EmptyString_c7 of size(0) | String_c8 of size(2)

def cats_i15 =
  fn s1_v138128 s2_v138129 ⇒
    match s1_v138128 with
    | EmptyString_c7  ⇒ s2_v138129
    | String_c8 c_v138130 s1_v138131 ⇒
      (String_c8 c_v138130 ((cats_i15 s1_v138131) s2_v138129))
    end

def strlen_i16 =
  fn s_v138132 ⇒
    match s_v138132 with
    | EmptyString_c7  ⇒ O_c4
    | String_c8 __v138133 s_v138134 ⇒ (S_c5 (strlen_i16 s_v138134))
    end

data listUU_d11 =
| nilUU_c18 of size(0) | consUU_c19 of size(2)

data listUL_d10 =
| nilUL_c16 of size(0) | consUL_c17 of size(2)

data listLU_d9 =
| nilLU_c14 of size(0)

data listLL_d8 =
| nilLL_c12 of size(0) | consLL_c13 of size(2)

def lenUU_i43 =
  fn A_v138135 xs_v138136 ⇒
    match xs_v138136 with
    | nilUU_c18  ⇒ (O_c4, nilUU_c18)
    | consUU_c19 x_v138137 xs_v138138 ⇒
      match ((lenUU_i43 NULL) xs_v138138) with
      | (n_v138139, xs_v138140) ⇒
        ((S_c5 n_v138139), (consUU_c19 x_v138137 xs_v138140))
      end
    end

def lenUL_i42 =
  fn A_v138141 xs_v138142 ⇒
    match xs_v138142 with
    | nilUL_c16  ⇒ (O_c4, nilUL_c16)
    | consUL_c17 x_v138143 xs_v138144 ⇒
      match ((lenUL_i42 NULL) xs_v138144) with
      | (n_v138145, xs_v138146) ⇒
        ((S_c5 n_v138145), (consUL_c17 x_v138143 xs_v138146))
      end
    end

def lenLL_i40 =
  fn A_v138147 xs_v138148 ⇒
    match xs_v138148 with
    | nilLL_c12  ⇒ (O_c4, nilLL_c12)
    | consLL_c13 x_v138149 xs_v138150 ⇒
      match ((lenLL_i40 NULL) xs_v138150) with
      | (n_v138151, xs_v138152) ⇒
        ((S_c5 n_v138151), (consLL_c13 x_v138149 xs_v138152))
      end
    end

def appendUU_i47 =
  fn A_v138153 xs_v138154 ⇒
    ln ys_v138155 ⇒
      match xs_v138154 with
      | nilUU_c18  ⇒ ys_v138155
      | consUU_c19 x_v138156 xs_v138157 ⇒
        (consUU_c19 x_v138156 (((appendUU_i47 NULL) xs_v138157) ys_v138155))
      end

def appendUL_i46 =
  fn A_v138158 xs_v138159 ⇒
    ln ys_v138160 ⇒
      match xs_v138159 with
      | nilUL_c16  ⇒ ys_v138160
      | consUL_c17 x_v138161 xs_v138162 ⇒
        (consUL_c17 x_v138161 (((appendUL_i46 NULL) xs_v138162) ys_v138160))
      end

def appendLL_i44 =
  fn A_v138163 xs_v138164 ⇒
    ln ys_v138165 ⇒
      match xs_v138164 with
      | nilLL_c12  ⇒ ys_v138165
      | consLL_c13 x_v138166 xs_v138167 ⇒
        (consLL_c13 x_v138166 (((appendLL_i44 NULL) xs_v138167) ys_v138165))
      end

def readline_i25 =
  fn __v138168 ⇒
    let ch_v138169 ⇐ open stdin in
    let ch_v138170 ⇐ (send ch_v138169 true_c2) in
    let __v138171 ⇐ recv ch_v138170 in
    match __v138171 with
    | (s_v138172, ch_v138173) ⇒
      let ch_v138174 ⇐ (send ch_v138173 false_c3) in
      let __v138175 ⇐ close⇑ ch_v138174 in return s_v138172
    end

def print_i26 =
  fn s_v138176 ⇒
    let ch_v138177 ⇐ open stdout in
    let ch_v138178 ⇐ (send ch_v138177 true_c2) in
    let ch_v138179 ⇐ (send ch_v138178 s_v138176) in
    let ch_v138180 ⇐ (send ch_v138179 false_c3) in close⇑ ch_v138180

def prerr_i27 =
  fn s_v138181 ⇒
    let ch_v138182 ⇐ open stderr in
    let ch_v138183 ⇐ (send ch_v138182 true_c2) in
    let ch_v138184 ⇐ (send ch_v138183 s_v138181) in
    let ch_v138185 ⇐ (send ch_v138184 false_c3) in close⇑ ch_v138185

def splitU_i49 =
  fn zs_v138186 ⇒
    match zs_v138186 with
    | nilUU_c18  ⇒ (nilUU_c18, nilUU_c18)
    | consUU_c19 x_v138187 zs_v138188 ⇒
      match zs_v138188 with
      | nilUU_c18  ⇒ ((consUU_c19 x_v138187 nilUU_c18), nilUU_c18)
      | consUU_c19 y_v138189 zs_v138190 ⇒
        let __v138191 = (splitU_i49 zs_v138190) in
        match __v138191 with
        | (xs_v138192, ys_v138193) ⇒
          ((consUU_c19 x_v138187 xs_v138192), (consUU_c19
                                                y_v138189 ys_v138193))
        end
      end
    end

def splitL_i48 =
  fn zs_v138194 ⇒
    match zs_v138194 with
    | nilUL_c16  ⇒ (nilUL_c16, nilUL_c16)
    | consUL_c17 x_v138195 zs_v138196 ⇒
      match zs_v138196 with
      | nilUL_c16  ⇒ ((consUL_c17 x_v138195 nilUL_c16), nilUL_c16)
      | consUL_c17 y_v138197 zs_v138198 ⇒
        let __v138199 = (splitL_i48 zs_v138198) in
        match __v138199 with
        | (xs_v138200, ys_v138201) ⇒
          ((consUL_c17 x_v138195 xs_v138200), (consUL_c17
                                                y_v138197 ys_v138201))
        end
      end
    end

def mergeU_i51 =
  fn xs_v138202 ⇒
    ln ys_v138203 ⇒
      match xs_v138202 with
      | nilUU_c18  ⇒ ys_v138203
      | consUU_c19 x_v138204 xs0_v138205 ⇒
        match ys_v138203 with
        | nilUU_c18  ⇒ (consUU_c19 x_v138204 xs0_v138205)
        | consUU_c19 y_v138206 ys0_v138207 ⇒
          match ((lten_i4 x_v138204) y_v138206) with
          | true_c2  ⇒
            (consUU_c19
              x_v138204
              ((mergeU_i51 xs0_v138205) (consUU_c19 y_v138206 ys0_v138207)))
          | false_c3  ⇒
            (consUU_c19
              y_v138206
              ((mergeU_i51 (consUU_c19 x_v138204 xs0_v138205)) ys0_v138207))
          end
        end
      end

def mergeL_i50 =
  fn xs_v138208 ⇒
    ln ys_v138209 ⇒
      match xs_v138208 with
      | nilUL_c16  ⇒ ys_v138209
      | consUL_c17 x_v138210 xs0_v138211 ⇒
        match ys_v138209 with
        | nilUL_c16  ⇒ (consUL_c17 x_v138210 xs0_v138211)
        | consUL_c17 y_v138212 ys0_v138213 ⇒
          match ((lten_i4 x_v138210) y_v138212) with
          | true_c2  ⇒
            (consUL_c17
              x_v138210
              ((mergeL_i50 xs0_v138211) (consUL_c17 y_v138212 ys0_v138213)))
          | false_c3  ⇒
            (consUL_c17
              y_v138212
              ((mergeL_i50 (consUL_c17 x_v138210 xs0_v138211)) ys0_v138213))
          end
        end
      end

def msortU_i53 =
  fn zs_v138214 ⇒
    match zs_v138214 with
    | nilUU_c18  ⇒ nilUU_c18
    | consUU_c19 x_v138215 zs_v138216 ⇒
      match zs_v138216 with
      | nilUU_c18  ⇒ (consUU_c19 x_v138215 nilUU_c18)
      | consUU_c19 y_v138217 zs_v138218 ⇒
        let __v138219 =
          (splitU_i49
            (consUU_c19 x_v138215 (consUU_c19 y_v138217 zs_v138218)))
        in
        match __v138219 with
        | (xs_v138220, ys_v138221) ⇒
          ((mergeU_i51 (msortU_i53 xs_v138220)) (msortU_i53 ys_v138221))
        end
      end
    end

def msortL_i52 =
  fn zs_v138222 ⇒
    match zs_v138222 with
    | nilUL_c16  ⇒ nilUL_c16
    | consUL_c17 x_v138223 zs_v138224 ⇒
      match zs_v138224 with
      | nilUL_c16  ⇒ (consUL_c17 x_v138223 nilUL_c16)
      | consUL_c17 y_v138225 zs_v138226 ⇒
        let __v138227 =
          (splitL_i48
            (consUL_c17 x_v138223 (consUL_c17 y_v138225 zs_v138226)))
        in
        match __v138227 with
        | (xs_v138228, ys_v138229) ⇒
          ((mergeL_i50 (msortL_i52 xs_v138228)) (msortL_i52 ys_v138229))
        end
      end
    end

data uniqU_d13 =
| UniqU_c21 of size(2)

data uniqL_d12 =
| UniqL_c20 of size(2)

def cmsort_workerU_i57 =
  fn zs_v138230 ⇒
    ln c_v138231 ⇒
      (match zs_v138230 with
       | nilUU_c18  ⇒
         ln c_v138232 ⇒
           let c_v138233 ⇐ (send c_v138232 (UniqU_c21 nilUU_c18 NULL)) in
           close⇑ c_v138233
       | consUU_c19 z0_v138234 zs0_v138235 ⇒
         ln c_v138236 ⇒
           (match zs0_v138235 with
            | nilUU_c18  ⇒
              ln c_v138237 ⇒
                let c_v138238 ⇐
                  (send c_v138237
                    (UniqU_c21 (consUU_c19 z0_v138234 nilUU_c18) NULL))
                in close⇑ c_v138238
            | consUU_c19 z1_v138239 zs1_v138240 ⇒
              ln c_v138241 ⇒
                (match (splitU_i49
                         (consUU_c19
                           z0_v138234 (consUU_c19 z1_v138239 zs1_v138240))) with
                 | (xs0_v138242, ys0_v138243) ⇒
                   ln e_v138244 ⇒
                     let r1_v138245 ⇐
                       fork r1_v138246 in
                         ((cmsort_workerU_i57 xs0_v138242) r1_v138246)
                     in
                     let r2_v138247 ⇐
                       fork r2_v138248 in
                         ((cmsort_workerU_i57 ys0_v138243) r2_v138248)
                     in
                     let __v138249 ⇐ recv r1_v138245 in
                     match __v138249 with
                     | (msg1_v138250, r1_v138251) ⇒
                       let __v138252 ⇐ recv r2_v138247 in
                       match __v138252 with
                       | (msg2_v138253, r2_v138254) ⇒
                         match msg1_v138250 with
                         | UniqU_c21 xs1_v138255 pf1_v138256 ⇒
                           match msg2_v138253 with
                           | UniqU_c21 xs2_v138257 pf2_v138258 ⇒
                             let zs_v138259 =
                               ((mergeU_i51 xs1_v138255) xs2_v138257)
                             in
                             let c_v138260 ⇐
                               (send c_v138241 (UniqU_c21 zs_v138259 NULL))
                             in
                             let __v138261 ⇐ close⇓ r1_v138251 in
                             let __v138262 ⇐ close⇓ r2_v138254 in
                             close⇑ c_v138260
                           end
                         end
                       end
                     end
                 end NULL)
            end c_v138236)
       end c_v138231)

def cmsort_workerL_i56 =
  fn zs_v138263 ⇒
    ln c_v138264 ⇒
      (match zs_v138263 with
       | nilUL_c16  ⇒
         ln c_v138265 ⇒
           let c_v138266 ⇐ (send c_v138265 (UniqL_c20 nilUL_c16 NULL)) in
           close⇑ c_v138266
       | consUL_c17 z0_v138267 zs0_v138268 ⇒
         ln c_v138269 ⇒
           (match zs0_v138268 with
            | nilUL_c16  ⇒
              ln c_v138270 ⇒
                let c_v138271 ⇐
                  (send c_v138270
                    (UniqL_c20 (consUL_c17 z0_v138267 nilUL_c16) NULL))
                in close⇑ c_v138271
            | consUL_c17 z1_v138272 zs1_v138273 ⇒
              ln c_v138274 ⇒
                (match (splitL_i48
                         (consUL_c17
                           z0_v138267 (consUL_c17 z1_v138272 zs1_v138273))) with
                 | (xs0_v138275, ys0_v138276) ⇒
                   ln e_v138277 ⇒
                     let r1_v138278 ⇐
                       fork r1_v138279 in
                         ((cmsort_workerL_i56 xs0_v138275) r1_v138279)
                     in
                     let r2_v138280 ⇐
                       fork r2_v138281 in
                         ((cmsort_workerL_i56 ys0_v138276) r2_v138281)
                     in
                     let __v138282 ⇐ recv r1_v138278 in
                     match __v138282 with
                     | (msg1_v138283, r1_v138284) ⇒
                       let __v138285 ⇐ recv r2_v138280 in
                       match __v138285 with
                       | (msg2_v138286, r2_v138287) ⇒
                         match msg1_v138283 with
                         | UniqL_c20 xs1_v138288 pf1_v138289 ⇒
                           match msg2_v138286 with
                           | UniqL_c20 xs2_v138290 pf2_v138291 ⇒
                             let zs_v138292 =
                               ((mergeL_i50 xs1_v138288) xs2_v138290)
                             in
                             let c_v138293 ⇐
                               (send c_v138274 (UniqL_c20 zs_v138292 NULL))
                             in
                             let __v138294 ⇐ close⇓ r1_v138284 in
                             let __v138295 ⇐ close⇓ r2_v138287 in
                             close⇑ c_v138293
                           end
                         end
                       end
                     end
                 end NULL)
            end c_v138269)
       end c_v138264)

def cmsortU_i59 =
  fn zs_v138296 ⇒
    let c_v138297 ⇐
      fork c_v138298 in ((cmsort_workerU_i57 zs_v138296) c_v138298)
    in
    let __v138299 ⇐ recv c_v138297 in
    match __v138299 with
    | (msg_v138300, c_v138301) ⇒
      let __v138302 ⇐ close⇓ c_v138301 in return msg_v138300
    end

def cmsortL_i58 =
  fn zs_v138303 ⇒
    let c_v138304 ⇐
      fork c_v138305 in ((cmsort_workerL_i56 zs_v138303) c_v138305)
    in
    let __v138306 ⇐ recv c_v138304 in
    match __v138306 with
    | (msg_v138307, c_v138308) ⇒
      let __v138309 ⇐ close⇓ c_v138308 in return msg_v138307
    end

def digits_i34 =
  (consUU_c19
    "0"
    (consUU_c19
      "1"
      (consUU_c19
        "2"
        (consUU_c19
          "3"
          (consUU_c19
            "4"
            (consUU_c19
              "5"
              (consUU_c19
                "6"
                (consUU_c19 "7" (consUU_c19 "8" (consUU_c19 "9" nilUU_c18))))))))))

def get_at_i35 =
  fn A_v138310 n_v138311 xs_v138312 a_v138313 ⇒
    match n_v138311 with
    | O_c4  ⇒
      match xs_v138312 with
      | nilUU_c18  ⇒ a_v138313
      | consUU_c19 x_v138314 __v138315 ⇒ x_v138314
      end
    | S_c5 n_v138316 ⇒
      match xs_v138312 with
      | nilUU_c18  ⇒ a_v138313
      | consUU_c19 __v138317 xs_v138318 ⇒
        ((((get_at_i35 NULL) n_v138316) xs_v138318) a_v138313)
      end
    end

def string_of_digit_i36 =
  fn n_v138319 ⇒
    ((((get_at_i35 NULL) n_v138319) digits_i34) EmptyString_c7)

def string_of_nat_i37 =
  fn n_v138320 ⇒
    let s_v138321 = (string_of_digit_i36 ((modn_i14 n_v138320) 10)) in
    let n_v138322 = ((divn_i13 n_v138320) 10) in
    match ((ltn_i6 O_c4) n_v138322) with
    | true_c2  ⇒ ((cats_i15 (string_of_nat_i37 n_v138322)) s_v138321)
    | false_c3  ⇒ s_v138321
    end

def string_of_listU_i61 =
  fn xs_v138323 ⇒
    match xs_v138323 with
    | nilUU_c18  ⇒ "nil"
    | consUU_c19 x_v138324 xs_v138325 ⇒
      ((cats_i15 ((cats_i15 (string_of_nat_i37 x_v138324)) " :: "))
        (string_of_listU_i61 xs_v138325))
    end

def string_of_listL_i60 =
  fn xs_v138326 ⇒
    match xs_v138326 with
    | nilUL_c16  ⇒ "nil"
    | consUL_c17 x_v138327 xs_v138328 ⇒
      ((cats_i15 ((cats_i15 (string_of_nat_i37 x_v138327)) " :: "))
        (string_of_listL_i60 xs_v138328))
    end

main =
  let test1_v138329 =
    (consUU_c19
      5
      (consUU_c19
        2
        (consUU_c19
          1
          (consUU_c19
            6 (consUU_c19 4 (consUU_c19 O_c4 (consUU_c19 3 nilUU_c18)))))))
  in
  let test2_v138330 =
    (consUL_c17
      3
      (consUL_c17
        O_c4
        (consUL_c17
          6
          (consUL_c17
            1 (consUL_c17 4 (consUL_c17 2 (consUL_c17 5 nilUL_c16)))))))
  in
  let msg1_v138331 ⇐ (cmsortU_i59 test1_v138329) in
  let msg2_v138332 ⇐ (cmsortL_i58 test2_v138330) in
  match msg1_v138331 with
  | UniqU_c21 sorted1_v138333 __v138334 ⇒
    match msg2_v138332 with
    | UniqL_c20 sorted2_v138335 __v138336 ⇒
      let __v138337 ⇐
        (print_i26 ((cats_i15 (string_of_listU_i61 sorted1_v138333)) "\n"))
      in (print_i26 ((cats_i15 (string_of_listL_i60 sorted2_v138335)) "\n"))
    end
  end

trans12 success--------------------------

fun andb_i1(b1_v138673, b2_v138674) =
  match b1_v138673 with
  | true_c2  ⇒ b2_v138674 | false_c3  ⇒ false_c3
  end

val andbclo_i62 =
  fn b1_v138675 b2_v138676 ⇒ andb_i1(b1_v138675, b2_v138676)

fun orb_i2(b1_v138677, b2_v138678) =
  match b1_v138677 with
  | true_c2  ⇒ true_c2 | false_c3  ⇒ b2_v138678
  end

val orbclo_i63 = fn b1_v138679 b2_v138680 ⇒ orb_i2(b1_v138679, b2_v138680)

fun notb_i3(b_v138681) =
  match b_v138681 with
  | true_c2  ⇒ false_c3 | false_c3  ⇒ true_c2
  end

val notbclo_i64 = fn b_v138682 ⇒ notb_i3(b_v138682)

fun lten_i4(x_v138683, y_v138684) =
  match x_v138683 with
  | O_c4  ⇒ true_c2
  | S_c5 x_v138685 ⇒
    match y_v138684 with
    | O_c4  ⇒ false_c3 | S_c5 y_v138686 ⇒ lten_i4(x_v138685, y_v138686)
    end
  end

val ltenclo_i65 = fn x_v138687 y_v138688 ⇒ lten_i4(x_v138687, y_v138688)

fun gten_i5(x_v138689, y_v138690) =
  match x_v138689 with
  | O_c4  ⇒
    match y_v138690 with
    | O_c4  ⇒ true_c2 | S_c5 __v138691 ⇒ false_c3
    end
  | S_c5 x_v138692 ⇒
    match y_v138690 with
    | O_c4  ⇒ true_c2 | S_c5 y_v138693 ⇒ gten_i5(x_v138692, y_v138693)
    end
  end

val gtenclo_i66 = fn x_v138694 y_v138695 ⇒ gten_i5(x_v138694, y_v138695)

fun ltn_i6(x_v138696, y_v138697) =
  match x_v138696 with
  | O_c4  ⇒
    match y_v138697 with
    | O_c4  ⇒ false_c3 | S_c5 y_v138698 ⇒ true_c2
    end
  | S_c5 x_v138699 ⇒
    match y_v138697 with
    | O_c4  ⇒ false_c3 | S_c5 y_v138700 ⇒ ltn_i6(x_v138699, y_v138700)
    end
  end

val ltnclo_i67 = fn x_v138701 y_v138702 ⇒ ltn_i6(x_v138701, y_v138702)

fun gtn_i7(x_v138703, y_v138704) =
  match x_v138703 with
  | O_c4  ⇒ false_c3
  | S_c5 x_v138705 ⇒
    match y_v138704 with
    | O_c4  ⇒ true_c2 | S_c5 y_v138706 ⇒ gtn_i7(x_v138705, y_v138706)
    end
  end

val gtnclo_i68 = fn x_v138707 y_v138708 ⇒ gtn_i7(x_v138707, y_v138708)

fun eqn_i8(x_v138709, y_v138710) =
  match x_v138709 with
  | O_c4  ⇒
    match y_v138710 with
    | O_c4  ⇒ true_c2 | S_c5 __v138711 ⇒ false_c3
    end
  | S_c5 x_v138712 ⇒
    match y_v138710 with
    | O_c4  ⇒ false_c3 | S_c5 y_v138713 ⇒ eqn_i8(x_v138712, y_v138713)
    end
  end

val eqnclo_i69 = fn x_v138714 y_v138715 ⇒ eqn_i8(x_v138714, y_v138715)

fun pred_i9(x_v138716) =
  match x_v138716 with
  | O_c4  ⇒ O_c4 | S_c5 x_v138717 ⇒ x_v138717
  end

val predclo_i70 = fn x_v138718 ⇒ pred_i9(x_v138718)

fun addn_i10(x_v138719, y_v138720) =
  match x_v138719 with
  | O_c4  ⇒ y_v138720
  | S_c5 x_v138721 ⇒ (S_c5 addn_i10(x_v138721, y_v138720))
  end

val addnclo_i71 = fn x_v138722 y_v138723 ⇒ addn_i10(x_v138722, y_v138723)

fun subn_i11(x_v138724, y_v138725) =
  match y_v138725 with
  | O_c4  ⇒ x_v138724
  | S_c5 y_v138726 ⇒ subn_i11(pred_i9(x_v138724), y_v138726)
  end

val subnclo_i72 = fn x_v138727 y_v138728 ⇒ subn_i11(x_v138727, y_v138728)

fun muln_i12(x_v138729, y_v138730) =
  match x_v138729 with
  | O_c4  ⇒ O_c4
  | S_c5 x_v138731 ⇒ addn_i10(y_v138730, muln_i12(x_v138731, y_v138730))
  end

val mulnclo_i73 = fn x_v138732 y_v138733 ⇒ muln_i12(x_v138732, y_v138733)

fun divn_i13(x_v138734, y_v138735) =
  match ltn_i6(x_v138734, y_v138735) with
  | true_c2  ⇒ O_c4
  | false_c3  ⇒ (S_c5 divn_i13(subn_i11(x_v138734, y_v138735), y_v138735))
  end

val divnclo_i74 = fn x_v138736 y_v138737 ⇒ divn_i13(x_v138736, y_v138737)

fun modn_i14(x_v138738, y_v138739) =
  subn_i11(x_v138738, muln_i12(divn_i13(x_v138738, y_v138739), y_v138739))

val modnclo_i75 = fn x_v138740 y_v138741 ⇒ modn_i14(x_v138740, y_v138741)

fun cats_i15(s1_v138742, s2_v138743) =
  match s1_v138742 with
  | EmptyString_c7  ⇒ s2_v138743
  | String_c8 c_v138744 s1_v138745 ⇒
    (String_c8 c_v138744 cats_i15(s1_v138745, s2_v138743))
  end

val catsclo_i76 =
  fn s1_v138746 s2_v138747 ⇒ cats_i15(s1_v138746, s2_v138747)

fun strlen_i16(s_v138748) =
  match s_v138748 with
  | EmptyString_c7  ⇒ O_c4
  | String_c8 __v138749 s_v138750 ⇒ (S_c5 strlen_i16(s_v138750))
  end

val strlenclo_i77 = fn s_v138751 ⇒ strlen_i16(s_v138751)

fun lenUU_i43(A_v138752, xs_v138753) =
  match xs_v138753 with
  | nilUU_c18  ⇒ (O_c4, nilUU_c18)
  | consUU_c19 x_v138754 xs_v138755 ⇒
    match lenUU_i43(NULL, xs_v138755) with
    | (n_v138756, xs_v138757) ⇒
      ((S_c5 n_v138756), (consUU_c19 x_v138754 xs_v138757))
    end
  end

val lenUUclo_i78 =
  fn A_v138758 xs_v138759 ⇒ lenUU_i43(A_v138758, xs_v138759)

fun lenUL_i42(A_v138760, xs_v138761) =
  match xs_v138761 with
  | nilUL_c16  ⇒ (O_c4, nilUL_c16)
  | consUL_c17 x_v138762 xs_v138763 ⇒
    match lenUL_i42(NULL, xs_v138763) with
    | (n_v138764, xs_v138765) ⇒
      ((S_c5 n_v138764), (consUL_c17 x_v138762 xs_v138765))
    end
  end

val lenULclo_i79 =
  fn A_v138766 xs_v138767 ⇒ lenUL_i42(A_v138766, xs_v138767)

fun lenLL_i40(A_v138768, xs_v138769) =
  match xs_v138769 with
  | nilLL_c12  ⇒ (O_c4, nilLL_c12)
  | consLL_c13 x_v138770 xs_v138771 ⇒
    match lenLL_i40(NULL, xs_v138771) with
    | (n_v138772, xs_v138773) ⇒
      ((S_c5 n_v138772), (consLL_c13 x_v138770 xs_v138773))
    end
  end

val lenLLclo_i80 =
  fn A_v138774 xs_v138775 ⇒ lenLL_i40(A_v138774, xs_v138775)

fun appendUU_i47(A_v138776, xs_v138777, ys_v138778) =
  match xs_v138777 with
  | nilUU_c18  ⇒ ys_v138778
  | consUU_c19 x_v138779 xs_v138780 ⇒
    (consUU_c19 x_v138779 appendUU_i47(NULL, xs_v138780, ys_v138778))
  end

val appendUUclo_i81 =
  fn A_v138781 xs_v138782 ⇒
    ln ys_v138783 ⇒ appendUU_i47(A_v138781, xs_v138782, ys_v138783)

fun appendUL_i46(A_v138784, xs_v138785, ys_v138786) =
  match xs_v138785 with
  | nilUL_c16  ⇒ ys_v138786
  | consUL_c17 x_v138787 xs_v138788 ⇒
    (consUL_c17 x_v138787 appendUL_i46(NULL, xs_v138788, ys_v138786))
  end

val appendULclo_i82 =
  fn A_v138789 xs_v138790 ⇒
    ln ys_v138791 ⇒ appendUL_i46(A_v138789, xs_v138790, ys_v138791)

fun appendLL_i44(A_v138792, xs_v138793, ys_v138794) =
  match xs_v138793 with
  | nilLL_c12  ⇒ ys_v138794
  | consLL_c13 x_v138795 xs_v138796 ⇒
    (consLL_c13 x_v138795 appendLL_i44(NULL, xs_v138796, ys_v138794))
  end

val appendLLclo_i83 =
  fn A_v138797 xs_v138798 ⇒
    ln ys_v138799 ⇒ appendLL_i44(A_v138797, xs_v138798, ys_v138799)

fun readline_i25(__v138800) =
  ln __v138801 ⇒
    let ch_v138802 = (ln __v138803 ⇒ open stdin) NULL in
    let ch_v138804 =
      ((fn x_v138805 ⇒ ln __v138806 ⇒ send(ch_v138802, x_v138805))
         true_c2)
        NULL
    in
    let __v138807 = (ln __v138808 ⇒ recv(ch_v138804)) NULL in
    (match __v138807 with
     | (s_v138809, ch_v138810) ⇒
       ln __v138811 ⇒
         let ch_v138812 =
           ((fn x_v138813 ⇒ ln __v138814 ⇒ send(ch_v138810, x_v138813))
              false_c3)
             NULL
         in
         let __v138815 =
           (ln __v138816 ⇒ let __v138817 = ch_v138812 in tt_c1) NULL
         in (ln __v138818 ⇒ s_v138809) NULL
     end) NULL

val readlineclo_i84 = fn __v138819 ⇒ readline_i25(__v138819)

fun print_i26(s_v138820) =
  ln __v138821 ⇒
    let ch_v138822 = (ln __v138823 ⇒ open stdout) NULL in
    let ch_v138824 =
      ((fn x_v138825 ⇒ ln __v138826 ⇒ send(ch_v138822, x_v138825))
         true_c2)
        NULL
    in
    let ch_v138827 =
      ((fn x_v138828 ⇒ ln __v138829 ⇒ send(ch_v138824, x_v138828))
         s_v138820)
        NULL
    in
    let ch_v138830 =
      ((fn x_v138831 ⇒ ln __v138832 ⇒ send(ch_v138827, x_v138831))
         false_c3)
        NULL
    in (ln __v138833 ⇒ let __v138834 = ch_v138830 in tt_c1) NULL

val printclo_i85 = fn s_v138835 ⇒ print_i26(s_v138835)

fun prerr_i27(s_v138836) =
  ln __v138837 ⇒
    let ch_v138838 = (ln __v138839 ⇒ open stderr) NULL in
    let ch_v138840 =
      ((fn x_v138841 ⇒ ln __v138842 ⇒ send(ch_v138838, x_v138841))
         true_c2)
        NULL
    in
    let ch_v138843 =
      ((fn x_v138844 ⇒ ln __v138845 ⇒ send(ch_v138840, x_v138844))
         s_v138836)
        NULL
    in
    let ch_v138846 =
      ((fn x_v138847 ⇒ ln __v138848 ⇒ send(ch_v138843, x_v138847))
         false_c3)
        NULL
    in (ln __v138849 ⇒ let __v138850 = ch_v138846 in tt_c1) NULL

val prerrclo_i86 = fn s_v138851 ⇒ prerr_i27(s_v138851)

fun splitU_i49(zs_v138852) =
  match zs_v138852 with
  | nilUU_c18  ⇒ (nilUU_c18, nilUU_c18)
  | consUU_c19 x_v138853 zs_v138854 ⇒
    match zs_v138854 with
    | nilUU_c18  ⇒ ((consUU_c19 x_v138853 nilUU_c18), nilUU_c18)
    | consUU_c19 y_v138855 zs_v138856 ⇒
      let __v138857 = splitU_i49(zs_v138856) in
      match __v138857 with
      | (xs_v138858, ys_v138859) ⇒
        ((consUU_c19 x_v138853 xs_v138858), (consUU_c19 y_v138855 ys_v138859))
      end
    end
  end

val splitUclo_i87 = fn zs_v138860 ⇒ splitU_i49(zs_v138860)

fun splitL_i48(zs_v138861) =
  match zs_v138861 with
  | nilUL_c16  ⇒ (nilUL_c16, nilUL_c16)
  | consUL_c17 x_v138862 zs_v138863 ⇒
    match zs_v138863 with
    | nilUL_c16  ⇒ ((consUL_c17 x_v138862 nilUL_c16), nilUL_c16)
    | consUL_c17 y_v138864 zs_v138865 ⇒
      let __v138866 = splitL_i48(zs_v138865) in
      match __v138866 with
      | (xs_v138867, ys_v138868) ⇒
        ((consUL_c17 x_v138862 xs_v138867), (consUL_c17 y_v138864 ys_v138868))
      end
    end
  end

val splitLclo_i88 = fn zs_v138869 ⇒ splitL_i48(zs_v138869)

fun mergeU_i51(xs_v138870, ys_v138871) =
  match xs_v138870 with
  | nilUU_c18  ⇒ ys_v138871
  | consUU_c19 x_v138872 xs0_v138873 ⇒
    match ys_v138871 with
    | nilUU_c18  ⇒ (consUU_c19 x_v138872 xs0_v138873)
    | consUU_c19 y_v138874 ys0_v138875 ⇒
      match lten_i4(x_v138872, y_v138874) with
      | true_c2  ⇒
        (consUU_c19
          x_v138872
          mergeU_i51(xs0_v138873, (consUU_c19 y_v138874 ys0_v138875)))
      | false_c3  ⇒
        (consUU_c19
          y_v138874
          mergeU_i51((consUU_c19 x_v138872 xs0_v138873), ys0_v138875))
      end
    end
  end

val mergeUclo_i89 =
  fn xs_v138876 ⇒ ln ys_v138877 ⇒ mergeU_i51(xs_v138876, ys_v138877)

fun mergeL_i50(xs_v138878, ys_v138879) =
  match xs_v138878 with
  | nilUL_c16  ⇒ ys_v138879
  | consUL_c17 x_v138880 xs0_v138881 ⇒
    match ys_v138879 with
    | nilUL_c16  ⇒ (consUL_c17 x_v138880 xs0_v138881)
    | consUL_c17 y_v138882 ys0_v138883 ⇒
      match lten_i4(x_v138880, y_v138882) with
      | true_c2  ⇒
        (consUL_c17
          x_v138880
          mergeL_i50(xs0_v138881, (consUL_c17 y_v138882 ys0_v138883)))
      | false_c3  ⇒
        (consUL_c17
          y_v138882
          mergeL_i50((consUL_c17 x_v138880 xs0_v138881), ys0_v138883))
      end
    end
  end

val mergeLclo_i90 =
  fn xs_v138884 ⇒ ln ys_v138885 ⇒ mergeL_i50(xs_v138884, ys_v138885)

fun msortU_i53(zs_v138886) =
  match zs_v138886 with
  | nilUU_c18  ⇒ nilUU_c18
  | consUU_c19 x_v138887 zs_v138888 ⇒
    match zs_v138888 with
    | nilUU_c18  ⇒ (consUU_c19 x_v138887 nilUU_c18)
    | consUU_c19 y_v138889 zs_v138890 ⇒
      let __v138891 =
        splitU_i49((consUU_c19 x_v138887 (consUU_c19 y_v138889 zs_v138890)))
      in
      match __v138891 with
      | (xs_v138892, ys_v138893) ⇒
        mergeU_i51(msortU_i53(xs_v138892), msortU_i53(ys_v138893))
      end
    end
  end

val msortUclo_i91 = fn zs_v138894 ⇒ msortU_i53(zs_v138894)

fun msortL_i52(zs_v138895) =
  match zs_v138895 with
  | nilUL_c16  ⇒ nilUL_c16
  | consUL_c17 x_v138896 zs_v138897 ⇒
    match zs_v138897 with
    | nilUL_c16  ⇒ (consUL_c17 x_v138896 nilUL_c16)
    | consUL_c17 y_v138898 zs_v138899 ⇒
      let __v138900 =
        splitL_i48((consUL_c17 x_v138896 (consUL_c17 y_v138898 zs_v138899)))
      in
      match __v138900 with
      | (xs_v138901, ys_v138902) ⇒
        mergeL_i50(msortL_i52(xs_v138901), msortL_i52(ys_v138902))
      end
    end
  end

val msortLclo_i92 = fn zs_v138903 ⇒ msortL_i52(zs_v138903)

fun cmsort_workerU_i57(zs_v138904, c_v138905) =
  (match zs_v138904 with
   | nilUU_c18  ⇒
     ln c_v138906 __v138907 ⇒
       let c_v138908 =
         ((fn x_v138909 ⇒ ln __v138910 ⇒ send(c_v138906, x_v138909))
            (UniqU_c21 nilUU_c18 NULL))
           NULL
       in (ln __v138911 ⇒ let __v138912 = c_v138908 in tt_c1) NULL
   | consUU_c19 z0_v138913 zs0_v138914 ⇒
     ln c_v138915 ⇒
       (match zs0_v138914 with
        | nilUU_c18  ⇒
          ln c_v138916 __v138917 ⇒
            let c_v138918 =
              ((fn x_v138919 ⇒ ln __v138920 ⇒ send(c_v138916, x_v138919))
                 (UniqU_c21 (consUU_c19 z0_v138913 nilUU_c18) NULL))
                NULL
            in (ln __v138921 ⇒ let __v138922 = c_v138918 in tt_c1) NULL
        | consUU_c19 z1_v138923 zs1_v138924 ⇒
          ln c_v138925 ⇒
            (match splitU_i49((consUU_c19
                                z0_v138913
                                (consUU_c19 z1_v138923 zs1_v138924))) with
             | (xs0_v138926, ys0_v138927) ⇒
               ln e_v138928 __v138929 ⇒
                 let r1_v138930 =
                   (ln __v138931 ⇒
                      fork r1_v138932 in
                        (cmsort_workerU_i57(xs0_v138926, r1_v138932)) NULL)
                     NULL
                 in
                 let r2_v138933 =
                   (ln __v138934 ⇒
                      fork r2_v138935 in
                        (cmsort_workerU_i57(ys0_v138927, r2_v138935)) NULL)
                     NULL
                 in
                 let __v138936 = (ln __v138937 ⇒ recv(r1_v138930)) NULL in
                 (match __v138936 with
                  | (msg1_v138938, r1_v138939) ⇒
                    ln __v138940 ⇒
                      let __v138941 =
                        (ln __v138942 ⇒ recv(r2_v138933)) NULL
                      in
                      (match __v138941 with
                       | (msg2_v138943, r2_v138944) ⇒
                         match msg1_v138938 with
                         | UniqU_c21 xs1_v138945 pf1_v138946 ⇒
                           match msg2_v138943 with
                           | UniqU_c21 xs2_v138947 pf2_v138948 ⇒
                             let zs_v138949 =
                               mergeU_i51(xs1_v138945, xs2_v138947)
                             in
                             ln __v138950 ⇒
                               let c_v138951 =
                                 ((fn x_v138952 ⇒
                                     ln __v138953 ⇒
                                       send(c_v138925, x_v138952))
                                    (UniqU_c21 zs_v138949 NULL))
                                   NULL
                               in
                               let __v138954 =
                                 (ln __v138955 ⇒ close(r1_v138939)) NULL
                               in
                               let __v138956 =
                                 (ln __v138957 ⇒ close(r2_v138944)) NULL
                               in
                               (ln __v138958 ⇒
                                  let __v138959 = c_v138951 in tt_c1)
                                 NULL
                           end
                         end
                       end) NULL
                  end) NULL
             end) NULL
        end) c_v138915
   end) c_v138905

val cmsort_workerUclo_i93 =
  fn zs_v138960 ⇒
    ln c_v138961 ⇒ cmsort_workerU_i57(zs_v138960, c_v138961)

fun cmsort_workerL_i56(zs_v138962, c_v138963) =
  (match zs_v138962 with
   | nilUL_c16  ⇒
     ln c_v138964 __v138965 ⇒
       let c_v138966 =
         ((ln x_v138967 __v138968 ⇒ send(c_v138964, x_v138967))
            (UniqL_c20 nilUL_c16 NULL))
           NULL
       in (ln __v138969 ⇒ let __v138970 = c_v138966 in tt_c1) NULL
   | consUL_c17 z0_v138971 zs0_v138972 ⇒
     ln c_v138973 ⇒
       (match zs0_v138972 with
        | nilUL_c16  ⇒
          ln c_v138974 __v138975 ⇒
            let c_v138976 =
              ((ln x_v138977 __v138978 ⇒ send(c_v138974, x_v138977))
                 (UniqL_c20 (consUL_c17 z0_v138971 nilUL_c16) NULL))
                NULL
            in (ln __v138979 ⇒ let __v138980 = c_v138976 in tt_c1) NULL
        | consUL_c17 z1_v138981 zs1_v138982 ⇒
          ln c_v138983 ⇒
            (match splitL_i48((consUL_c17
                                z0_v138971
                                (consUL_c17 z1_v138981 zs1_v138982))) with
             | (xs0_v138984, ys0_v138985) ⇒
               ln e_v138986 __v138987 ⇒
                 let r1_v138988 =
                   (ln __v138989 ⇒
                      fork r1_v138990 in
                        (cmsort_workerL_i56(xs0_v138984, r1_v138990)) NULL)
                     NULL
                 in
                 let r2_v138991 =
                   (ln __v138992 ⇒
                      fork r2_v138993 in
                        (cmsort_workerL_i56(ys0_v138985, r2_v138993)) NULL)
                     NULL
                 in
                 let __v138994 = (ln __v138995 ⇒ recv(r1_v138988)) NULL in
                 (match __v138994 with
                  | (msg1_v138996, r1_v138997) ⇒
                    ln __v138998 ⇒
                      let __v138999 =
                        (ln __v139000 ⇒ recv(r2_v138991)) NULL
                      in
                      (match __v138999 with
                       | (msg2_v139001, r2_v139002) ⇒
                         match msg1_v138996 with
                         | UniqL_c20 xs1_v139003 pf1_v139004 ⇒
                           match msg2_v139001 with
                           | UniqL_c20 xs2_v139005 pf2_v139006 ⇒
                             let zs_v139007 =
                               mergeL_i50(xs1_v139003, xs2_v139005)
                             in
                             ln __v139008 ⇒
                               let c_v139009 =
                                 ((ln x_v139010 __v139011 ⇒
                                     send(c_v138983, x_v139010))
                                    (UniqL_c20 zs_v139007 NULL))
                                   NULL
                               in
                               let __v139012 =
                                 (ln __v139013 ⇒ close(r1_v138997)) NULL
                               in
                               let __v139014 =
                                 (ln __v139015 ⇒ close(r2_v139002)) NULL
                               in
                               (ln __v139016 ⇒
                                  let __v139017 = c_v139009 in tt_c1)
                                 NULL
                           end
                         end
                       end) NULL
                  end) NULL
             end) NULL
        end) c_v138973
   end) c_v138963

val cmsort_workerLclo_i94 =
  fn zs_v139018 ⇒
    ln c_v139019 ⇒ cmsort_workerL_i56(zs_v139018, c_v139019)

fun cmsortU_i59(zs_v139020) =
  ln __v139021 ⇒
    let c_v139022 =
      (ln __v139023 ⇒
         fork c_v139024 in (cmsort_workerU_i57(zs_v139020, c_v139024)) NULL)
        NULL
    in
    let __v139025 = (ln __v139026 ⇒ recv(c_v139022)) NULL in
    (match __v139025 with
     | (msg_v139027, c_v139028) ⇒
       ln __v139029 ⇒
         let __v139030 = (ln __v139031 ⇒ close(c_v139028)) NULL in
         (ln __v139032 ⇒ msg_v139027) NULL
     end) NULL

val cmsortUclo_i95 = fn zs_v139033 ⇒ cmsortU_i59(zs_v139033)

fun cmsortL_i58(zs_v139034) =
  ln __v139035 ⇒
    let c_v139036 =
      (ln __v139037 ⇒
         fork c_v139038 in (cmsort_workerL_i56(zs_v139034, c_v139038)) NULL)
        NULL
    in
    let __v139039 = (ln __v139040 ⇒ recv(c_v139036)) NULL in
    (match __v139039 with
     | (msg_v139041, c_v139042) ⇒
       ln __v139043 ⇒
         let __v139044 = (ln __v139045 ⇒ close(c_v139042)) NULL in
         (ln __v139046 ⇒ msg_v139041) NULL
     end) NULL

val cmsortLclo_i96 = fn zs_v139047 ⇒ cmsortL_i58(zs_v139047)

val digits_i34 =
  (consUU_c19
    "0"
    (consUU_c19
      "1"
      (consUU_c19
        "2"
        (consUU_c19
          "3"
          (consUU_c19
            "4"
            (consUU_c19
              "5"
              (consUU_c19
                "6"
                (consUU_c19 "7" (consUU_c19 "8" (consUU_c19 "9" nilUU_c18))))))))))

fun get_at_i35(A_v139048, n_v139049, xs_v139050, a_v139051) =
  match n_v139049 with
  | O_c4  ⇒
    match xs_v139050 with
    | nilUU_c18  ⇒ a_v139051 | consUU_c19 x_v139052 __v139053 ⇒ x_v139052
    end
  | S_c5 n_v139054 ⇒
    match xs_v139050 with
    | nilUU_c18  ⇒ a_v139051
    | consUU_c19 __v139055 xs_v139056 ⇒
      get_at_i35(NULL, n_v139054, xs_v139056, a_v139051)
    end
  end

val get_atclo_i97 =
  fn A_v139057 n_v139058 xs_v139059 a_v139060 ⇒
    get_at_i35(A_v139057, n_v139058, xs_v139059, a_v139060)

fun string_of_digit_i36(n_v139061) =
  get_at_i35(NULL, n_v139061, digits_i34, EmptyString_c7)

val string_of_digitclo_i98 = fn n_v139062 ⇒ string_of_digit_i36(n_v139062)

fun string_of_nat_i37(n_v139063) =
  let s_v139064 = string_of_digit_i36(modn_i14(n_v139063, 10)) in
  let n_v139065 = divn_i13(n_v139063, 10) in
  match ltn_i6(O_c4, n_v139065) with
  | true_c2  ⇒ cats_i15(string_of_nat_i37(n_v139065), s_v139064)
  | false_c3  ⇒ s_v139064
  end

val string_of_natclo_i99 = fn n_v139066 ⇒ string_of_nat_i37(n_v139066)

fun string_of_listU_i61(xs_v139067) =
  match xs_v139067 with
  | nilUU_c18  ⇒ "nil"
  | consUU_c19 x_v139068 xs_v139069 ⇒
    cats_i15(cats_i15(string_of_nat_i37(x_v139068), " :: "),
             string_of_listU_i61(xs_v139069))
  end

val string_of_listUclo_i100 =
  fn xs_v139070 ⇒ string_of_listU_i61(xs_v139070)

fun string_of_listL_i60(xs_v139071) =
  match xs_v139071 with
  | nilUL_c16  ⇒ "nil"
  | consUL_c17 x_v139072 xs_v139073 ⇒
    cats_i15(cats_i15(string_of_nat_i37(x_v139072), " :: "),
             string_of_listL_i60(xs_v139073))
  end

val string_of_listLclo_i101 =
  fn xs_v139074 ⇒ string_of_listL_i60(xs_v139074)

main =
  (let test1_v139075 =
     (consUU_c19
       5
       (consUU_c19
         2
         (consUU_c19
           1
           (consUU_c19
             6 (consUU_c19 4 (consUU_c19 O_c4 (consUU_c19 3 nilUU_c18)))))))
   in
   let test2_v139076 =
     (consUL_c17
       3
       (consUL_c17
         O_c4
         (consUL_c17
           6
           (consUL_c17
             1 (consUL_c17 4 (consUL_c17 2 (consUL_c17 5 nilUL_c16)))))))
   in
   ln __v139077 ⇒
     let msg1_v139078 = (cmsortU_i59(test1_v139075)) NULL in
     let msg2_v139079 = (cmsortL_i58(test2_v139076)) NULL in
     (match msg1_v139078 with
      | UniqU_c21 sorted1_v139080 __v139081 ⇒
        match msg2_v139079 with
        | UniqL_c20 sorted2_v139082 __v139083 ⇒
          ln __v139084 ⇒
            let __v139085 =
              (print_i26(cats_i15(string_of_listU_i61(sorted1_v139080), "\n")))
                NULL
            in
            (print_i26(cats_i15(string_of_listL_i60(sorted2_v139082), "\n")))
              NULL
        end
      end) NULL)
    NULL

trans23 success--------------------------

fun andb_i1(b1_v140250, b2_v140251) =
  match b1_v140250 with
  | true_c2  ⇒ b2_v140251 | false_c3  ⇒ false_c3
  end

val andbclo_i62 =
  fn b1_v140252 b2_v140253 ⇒ andb_i1(b1_v140252, b2_v140253)

fun orb_i2(b1_v140254, b2_v140255) =
  match b1_v140254 with
  | true_c2  ⇒ true_c2 | false_c3  ⇒ b2_v140255
  end

val orbclo_i63 = fn b1_v140256 b2_v140257 ⇒ orb_i2(b1_v140256, b2_v140257)

fun notb_i3(b_v140258) =
  match b_v140258 with
  | true_c2  ⇒ false_c3 | false_c3  ⇒ true_c2
  end

val notbclo_i64 = fn b_v140259 ⇒ notb_i3(b_v140259)

fun lten_i4(x_v140260, y_v140261) =
  match x_v140260 with
  | O_c4  ⇒ true_c2
  | S_c5 x_v140262 ⇒
    match y_v140261 with
    | O_c4  ⇒ false_c3 | S_c5 y_v140263 ⇒ lten_i4(x_v140262, y_v140263)
    end
  end

val ltenclo_i65 = fn x_v140264 y_v140265 ⇒ lten_i4(x_v140264, y_v140265)

fun gten_i5(x_v140266, y_v140267) =
  match x_v140266 with
  | O_c4  ⇒
    match y_v140267 with
    | O_c4  ⇒ true_c2 | S_c5 __v140268 ⇒ false_c3
    end
  | S_c5 x_v140269 ⇒
    match y_v140267 with
    | O_c4  ⇒ true_c2 | S_c5 y_v140270 ⇒ gten_i5(x_v140269, y_v140270)
    end
  end

val gtenclo_i66 = fn x_v140271 y_v140272 ⇒ gten_i5(x_v140271, y_v140272)

fun ltn_i6(x_v140273, y_v140274) =
  match x_v140273 with
  | O_c4  ⇒
    match y_v140274 with
    | O_c4  ⇒ false_c3 | S_c5 y_v140275 ⇒ true_c2
    end
  | S_c5 x_v140276 ⇒
    match y_v140274 with
    | O_c4  ⇒ false_c3 | S_c5 y_v140277 ⇒ ltn_i6(x_v140276, y_v140277)
    end
  end

val ltnclo_i67 = fn x_v140278 y_v140279 ⇒ ltn_i6(x_v140278, y_v140279)

fun gtn_i7(x_v140280, y_v140281) =
  match x_v140280 with
  | O_c4  ⇒ false_c3
  | S_c5 x_v140282 ⇒
    match y_v140281 with
    | O_c4  ⇒ true_c2 | S_c5 y_v140283 ⇒ gtn_i7(x_v140282, y_v140283)
    end
  end

val gtnclo_i68 = fn x_v140284 y_v140285 ⇒ gtn_i7(x_v140284, y_v140285)

fun eqn_i8(x_v140286, y_v140287) =
  match x_v140286 with
  | O_c4  ⇒
    match y_v140287 with
    | O_c4  ⇒ true_c2 | S_c5 __v140288 ⇒ false_c3
    end
  | S_c5 x_v140289 ⇒
    match y_v140287 with
    | O_c4  ⇒ false_c3 | S_c5 y_v140290 ⇒ eqn_i8(x_v140289, y_v140290)
    end
  end

val eqnclo_i69 = fn x_v140291 y_v140292 ⇒ eqn_i8(x_v140291, y_v140292)

fun pred_i9(x_v140293) =
  match x_v140293 with
  | O_c4  ⇒ O_c4 | S_c5 x_v140294 ⇒ x_v140294
  end

val predclo_i70 = fn x_v140295 ⇒ pred_i9(x_v140295)

fun addn_i10(x_v140296, y_v140297) =
  match x_v140296 with
  | O_c4  ⇒ y_v140297
  | S_c5 x_v140298 ⇒ (S_c5 addn_i10(x_v140298, y_v140297))
  end

val addnclo_i71 = fn x_v140299 y_v140300 ⇒ addn_i10(x_v140299, y_v140300)

fun subn_i11(x_v140301, y_v140302) =
  match y_v140302 with
  | O_c4  ⇒ x_v140301
  | S_c5 y_v140303 ⇒ subn_i11(pred_i9(x_v140301), y_v140303)
  end

val subnclo_i72 = fn x_v140304 y_v140305 ⇒ subn_i11(x_v140304, y_v140305)

fun muln_i12(x_v140306, y_v140307) =
  match x_v140306 with
  | O_c4  ⇒ O_c4
  | S_c5 x_v140308 ⇒ addn_i10(y_v140307, muln_i12(x_v140308, y_v140307))
  end

val mulnclo_i73 = fn x_v140309 y_v140310 ⇒ muln_i12(x_v140309, y_v140310)

fun divn_i13(x_v140311, y_v140312) =
  match ltn_i6(x_v140311, y_v140312) with
  | true_c2  ⇒ O_c4
  | false_c3  ⇒ (S_c5 divn_i13(subn_i11(x_v140311, y_v140312), y_v140312))
  end

val divnclo_i74 = fn x_v140313 y_v140314 ⇒ divn_i13(x_v140313, y_v140314)

fun modn_i14(x_v140315, y_v140316) =
  subn_i11(x_v140315, muln_i12(divn_i13(x_v140315, y_v140316), y_v140316))

val modnclo_i75 = fn x_v140317 y_v140318 ⇒ modn_i14(x_v140317, y_v140318)

fun cats_i15(s1_v140319, s2_v140320) =
  match s1_v140319 with
  | EmptyString_c7  ⇒ s2_v140320
  | String_c8 c_v140321 s1_v140322 ⇒
    (String_c8 c_v140321 cats_i15(s1_v140322, s2_v140320))
  end

val catsclo_i76 =
  fn s1_v140323 s2_v140324 ⇒ cats_i15(s1_v140323, s2_v140324)

fun strlen_i16(s_v140325) =
  match s_v140325 with
  | EmptyString_c7  ⇒ O_c4
  | String_c8 __v140326 s_v140327 ⇒ (S_c5 strlen_i16(s_v140327))
  end

val strlenclo_i77 = fn s_v140328 ⇒ strlen_i16(s_v140328)

fun lenUU_i43(A_v140329, xs_v140330) =
  match xs_v140330 with
  | nilUU_c18  ⇒ (O_c4, nilUU_c18)
  | consUU_c19 x_v140331 xs_v140332 ⇒
    match lenUU_i43(NULL, xs_v140332) with
    | (n_v140333, xs_v140334) ⇒
      ((S_c5 n_v140333), (consUU_c19 x_v140331 xs_v140334))
    end
  end

val lenUUclo_i78 =
  fn A_v140335 xs_v140336 ⇒ lenUU_i43(A_v140335, xs_v140336)

fun lenUL_i42(A_v140337, xs_v140338) =
  match xs_v140338 with
  | nilUL_c16  ⇒ (O_c4, nilUL_c16)
  | consUL_c17 x_v140339 xs_v140340 ⇒
    match lenUL_i42(NULL, xs_v140340) with
    | (n_v140341, xs_v140342) ⇒
      ((S_c5 n_v140341), (consUL_c17 x_v140339 xs_v140342))
    end
  end

val lenULclo_i79 =
  fn A_v140343 xs_v140344 ⇒ lenUL_i42(A_v140343, xs_v140344)

fun lenLL_i40(A_v140345, xs_v140346) =
  match xs_v140346 with
  | nilLL_c12  ⇒ (O_c4, nilLL_c12)
  | consLL_c13 x_v140347 xs_v140348 ⇒
    match lenLL_i40(NULL, xs_v140348) with
    | (n_v140349, xs_v140350) ⇒
      ((S_c5 n_v140349), (consLL_c13 x_v140347 xs_v140350))
    end
  end

val lenLLclo_i80 =
  fn A_v140351 xs_v140352 ⇒ lenLL_i40(A_v140351, xs_v140352)

fun appendUU_i47(A_v140353, xs_v140354, ys_v140355) =
  match xs_v140354 with
  | nilUU_c18  ⇒ ys_v140355
  | consUU_c19 x_v140356 xs_v140357 ⇒
    (consUU_c19 x_v140356 appendUU_i47(NULL, xs_v140357, ys_v140355))
  end

val appendUUclo_i81 =
  fn A_v140358 xs_v140359 ⇒
    ln ys_v140360 ⇒ appendUU_i47(A_v140358, xs_v140359, ys_v140360)

fun appendUL_i46(A_v140361, xs_v140362, ys_v140363) =
  match xs_v140362 with
  | nilUL_c16  ⇒ ys_v140363
  | consUL_c17 x_v140364 xs_v140365 ⇒
    (consUL_c17 x_v140364 appendUL_i46(NULL, xs_v140365, ys_v140363))
  end

val appendULclo_i82 =
  fn A_v140366 xs_v140367 ⇒
    ln ys_v140368 ⇒ appendUL_i46(A_v140366, xs_v140367, ys_v140368)

fun appendLL_i44(A_v140369, xs_v140370, ys_v140371) =
  match xs_v140370 with
  | nilLL_c12  ⇒ ys_v140371
  | consLL_c13 x_v140372 xs_v140373 ⇒
    (consLL_c13 x_v140372 appendLL_i44(NULL, xs_v140373, ys_v140371))
  end

val appendLLclo_i83 =
  fn A_v140374 xs_v140375 ⇒
    ln ys_v140376 ⇒ appendLL_i44(A_v140374, xs_v140375, ys_v140376)

fun readline_i25(__v140377) =
  ln __v140378 ⇒
    let ch_v140379 = open stdin in
    let ch_v140380 = send(ch_v140379, true_c2) in
    let __v140381 = recv(ch_v140380) in
    match __v140381 with
    | (s_v140382, ch_v140383) ⇒
      let ch_v140384 = send(ch_v140383, false_c3) in
      let __v140385 = let __v140386 = ch_v140384 in tt_c1 in s_v140382
    end

val readlineclo_i84 = fn __v140387 ⇒ readline_i25(__v140387)

fun print_i26(s_v140388) =
  ln __v140389 ⇒
    let ch_v140390 = open stdout in
    let ch_v140391 = send(ch_v140390, true_c2) in
    let ch_v140392 = send(ch_v140391, s_v140388) in
    let ch_v140393 = send(ch_v140392, false_c3) in
    let __v140394 = ch_v140393 in tt_c1

val printclo_i85 = fn s_v140395 ⇒ print_i26(s_v140395)

fun prerr_i27(s_v140396) =
  ln __v140397 ⇒
    let ch_v140398 = open stderr in
    let ch_v140399 = send(ch_v140398, true_c2) in
    let ch_v140400 = send(ch_v140399, s_v140396) in
    let ch_v140401 = send(ch_v140400, false_c3) in
    let __v140402 = ch_v140401 in tt_c1

val prerrclo_i86 = fn s_v140403 ⇒ prerr_i27(s_v140403)

fun splitU_i49(zs_v140404) =
  match zs_v140404 with
  | nilUU_c18  ⇒ (nilUU_c18, nilUU_c18)
  | consUU_c19 x_v140405 zs_v140406 ⇒
    match zs_v140406 with
    | nilUU_c18  ⇒ ((consUU_c19 x_v140405 nilUU_c18), nilUU_c18)
    | consUU_c19 y_v140407 zs_v140408 ⇒
      let __v140409 = splitU_i49(zs_v140408) in
      match __v140409 with
      | (xs_v140410, ys_v140411) ⇒
        ((consUU_c19 x_v140405 xs_v140410), (consUU_c19 y_v140407 ys_v140411))
      end
    end
  end

val splitUclo_i87 = fn zs_v140412 ⇒ splitU_i49(zs_v140412)

fun splitL_i48(zs_v140413) =
  match zs_v140413 with
  | nilUL_c16  ⇒ (nilUL_c16, nilUL_c16)
  | consUL_c17 x_v140414 zs_v140415 ⇒
    match zs_v140415 with
    | nilUL_c16  ⇒ ((consUL_c17 x_v140414 nilUL_c16), nilUL_c16)
    | consUL_c17 y_v140416 zs_v140417 ⇒
      let __v140418 = splitL_i48(zs_v140417) in
      match __v140418 with
      | (xs_v140419, ys_v140420) ⇒
        ((consUL_c17 x_v140414 xs_v140419), (consUL_c17 y_v140416 ys_v140420))
      end
    end
  end

val splitLclo_i88 = fn zs_v140421 ⇒ splitL_i48(zs_v140421)

fun mergeU_i51(xs_v140422, ys_v140423) =
  match xs_v140422 with
  | nilUU_c18  ⇒ ys_v140423
  | consUU_c19 x_v140424 xs0_v140425 ⇒
    match ys_v140423 with
    | nilUU_c18  ⇒ (consUU_c19 x_v140424 xs0_v140425)
    | consUU_c19 y_v140426 ys0_v140427 ⇒
      match lten_i4(x_v140424, y_v140426) with
      | true_c2  ⇒
        (consUU_c19
          x_v140424
          mergeU_i51(xs0_v140425, (consUU_c19 y_v140426 ys0_v140427)))
      | false_c3  ⇒
        (consUU_c19
          y_v140426
          mergeU_i51((consUU_c19 x_v140424 xs0_v140425), ys0_v140427))
      end
    end
  end

val mergeUclo_i89 =
  fn xs_v140428 ⇒ ln ys_v140429 ⇒ mergeU_i51(xs_v140428, ys_v140429)

fun mergeL_i50(xs_v140430, ys_v140431) =
  match xs_v140430 with
  | nilUL_c16  ⇒ ys_v140431
  | consUL_c17 x_v140432 xs0_v140433 ⇒
    match ys_v140431 with
    | nilUL_c16  ⇒ (consUL_c17 x_v140432 xs0_v140433)
    | consUL_c17 y_v140434 ys0_v140435 ⇒
      match lten_i4(x_v140432, y_v140434) with
      | true_c2  ⇒
        (consUL_c17
          x_v140432
          mergeL_i50(xs0_v140433, (consUL_c17 y_v140434 ys0_v140435)))
      | false_c3  ⇒
        (consUL_c17
          y_v140434
          mergeL_i50((consUL_c17 x_v140432 xs0_v140433), ys0_v140435))
      end
    end
  end

val mergeLclo_i90 =
  fn xs_v140436 ⇒ ln ys_v140437 ⇒ mergeL_i50(xs_v140436, ys_v140437)

fun msortU_i53(zs_v140438) =
  match zs_v140438 with
  | nilUU_c18  ⇒ nilUU_c18
  | consUU_c19 x_v140439 zs_v140440 ⇒
    match zs_v140440 with
    | nilUU_c18  ⇒ (consUU_c19 x_v140439 nilUU_c18)
    | consUU_c19 y_v140441 zs_v140442 ⇒
      let __v140443 =
        splitU_i49((consUU_c19 x_v140439 (consUU_c19 y_v140441 zs_v140442)))
      in
      match __v140443 with
      | (xs_v140444, ys_v140445) ⇒
        mergeU_i51(msortU_i53(xs_v140444), msortU_i53(ys_v140445))
      end
    end
  end

val msortUclo_i91 = fn zs_v140446 ⇒ msortU_i53(zs_v140446)

fun msortL_i52(zs_v140447) =
  match zs_v140447 with
  | nilUL_c16  ⇒ nilUL_c16
  | consUL_c17 x_v140448 zs_v140449 ⇒
    match zs_v140449 with
    | nilUL_c16  ⇒ (consUL_c17 x_v140448 nilUL_c16)
    | consUL_c17 y_v140450 zs_v140451 ⇒
      let __v140452 =
        splitL_i48((consUL_c17 x_v140448 (consUL_c17 y_v140450 zs_v140451)))
      in
      match __v140452 with
      | (xs_v140453, ys_v140454) ⇒
        mergeL_i50(msortL_i52(xs_v140453), msortL_i52(ys_v140454))
      end
    end
  end

val msortLclo_i92 = fn zs_v140455 ⇒ msortL_i52(zs_v140455)

fun cmsort_workerU_i57(zs_v140456, c_v140457) =
  match zs_v140456 with
  | nilUU_c18  ⇒
    ln __v140458 ⇒
      let c_v140459 = send(c_v140457, (UniqU_c21 nilUU_c18 NULL)) in
      let __v140460 = c_v140459 in tt_c1
  | consUU_c19 z0_v140461 zs0_v140462 ⇒
    match zs0_v140462 with
    | nilUU_c18  ⇒
      ln __v140463 ⇒
        let c_v140464 =
          send(c_v140457, (UniqU_c21 (consUU_c19 z0_v140461 nilUU_c18) NULL))
        in let __v140465 = c_v140464 in tt_c1
    | consUU_c19 z1_v140466 zs1_v140467 ⇒
      match splitU_i49((consUU_c19
                         z0_v140461 (consUU_c19 z1_v140466 zs1_v140467))) with
      | (xs0_v140468, ys0_v140469) ⇒
        ln __v140470 ⇒
          let r1_v140471 =
            fork r1_v140472 in
              (cmsort_workerU_i57(xs0_v140468, r1_v140472)) NULL
          in
          let r2_v140473 =
            fork r2_v140474 in
              (cmsort_workerU_i57(ys0_v140469, r2_v140474)) NULL
          in
          let __v140475 = recv(r1_v140471) in
          match __v140475 with
          | (msg1_v140476, r1_v140477) ⇒
            let __v140478 = recv(r2_v140473) in
            match __v140478 with
            | (msg2_v140479, r2_v140480) ⇒
              match msg1_v140476 with
              | UniqU_c21 xs1_v140481 pf1_v140482 ⇒
                match msg2_v140479 with
                | UniqU_c21 xs2_v140483 pf2_v140484 ⇒
                  let zs_v140485 = mergeU_i51(xs1_v140481, xs2_v140483) in
                  let c_v140486 =
                    send(c_v140457, (UniqU_c21 zs_v140485 NULL))
                  in
                  let __v140487 = close(r1_v140477) in
                  let __v140488 = close(r2_v140480) in
                  let __v140489 = c_v140486 in tt_c1
                end
              end
            end
          end
      end
    end
  end

val cmsort_workerUclo_i93 =
  fn zs_v140490 ⇒
    ln c_v140491 ⇒ cmsort_workerU_i57(zs_v140490, c_v140491)

fun cmsort_workerL_i56(zs_v140492, c_v140493) =
  match zs_v140492 with
  | nilUL_c16  ⇒
    ln __v140494 ⇒
      let c_v140495 = send(c_v140493, (UniqL_c20 nilUL_c16 NULL)) in
      let __v140496 = c_v140495 in tt_c1
  | consUL_c17 z0_v140497 zs0_v140498 ⇒
    match zs0_v140498 with
    | nilUL_c16  ⇒
      ln __v140499 ⇒
        let c_v140500 =
          send(c_v140493, (UniqL_c20 (consUL_c17 z0_v140497 nilUL_c16) NULL))
        in let __v140501 = c_v140500 in tt_c1
    | consUL_c17 z1_v140502 zs1_v140503 ⇒
      match splitL_i48((consUL_c17
                         z0_v140497 (consUL_c17 z1_v140502 zs1_v140503))) with
      | (xs0_v140504, ys0_v140505) ⇒
        ln __v140506 ⇒
          let r1_v140507 =
            fork r1_v140508 in
              (cmsort_workerL_i56(xs0_v140504, r1_v140508)) NULL
          in
          let r2_v140509 =
            fork r2_v140510 in
              (cmsort_workerL_i56(ys0_v140505, r2_v140510)) NULL
          in
          let __v140511 = recv(r1_v140507) in
          match __v140511 with
          | (msg1_v140512, r1_v140513) ⇒
            let __v140514 = recv(r2_v140509) in
            match __v140514 with
            | (msg2_v140515, r2_v140516) ⇒
              match msg1_v140512 with
              | UniqL_c20 xs1_v140517 pf1_v140518 ⇒
                match msg2_v140515 with
                | UniqL_c20 xs2_v140519 pf2_v140520 ⇒
                  let zs_v140521 = mergeL_i50(xs1_v140517, xs2_v140519) in
                  let c_v140522 =
                    send(c_v140493, (UniqL_c20 zs_v140521 NULL))
                  in
                  let __v140523 = close(r1_v140513) in
                  let __v140524 = close(r2_v140516) in
                  let __v140525 = c_v140522 in tt_c1
                end
              end
            end
          end
      end
    end
  end

val cmsort_workerLclo_i94 =
  fn zs_v140526 ⇒
    ln c_v140527 ⇒ cmsort_workerL_i56(zs_v140526, c_v140527)

fun cmsortU_i59(zs_v140528) =
  ln __v140529 ⇒
    let c_v140530 =
      fork c_v140531 in (cmsort_workerU_i57(zs_v140528, c_v140531)) NULL
    in
    let __v140532 = recv(c_v140530) in
    match __v140532 with
    | (msg_v140533, c_v140534) ⇒
      let __v140535 = close(c_v140534) in msg_v140533
    end

val cmsortUclo_i95 = fn zs_v140536 ⇒ cmsortU_i59(zs_v140536)

fun cmsortL_i58(zs_v140537) =
  ln __v140538 ⇒
    let c_v140539 =
      fork c_v140540 in (cmsort_workerL_i56(zs_v140537, c_v140540)) NULL
    in
    let __v140541 = recv(c_v140539) in
    match __v140541 with
    | (msg_v140542, c_v140543) ⇒
      let __v140544 = close(c_v140543) in msg_v140542
    end

val cmsortLclo_i96 = fn zs_v140545 ⇒ cmsortL_i58(zs_v140545)

val digits_i34 =
  (consUU_c19
    "0"
    (consUU_c19
      "1"
      (consUU_c19
        "2"
        (consUU_c19
          "3"
          (consUU_c19
            "4"
            (consUU_c19
              "5"
              (consUU_c19
                "6"
                (consUU_c19 "7" (consUU_c19 "8" (consUU_c19 "9" nilUU_c18))))))))))

fun get_at_i35(A_v140546, n_v140547, xs_v140548, a_v140549) =
  match n_v140547 with
  | O_c4  ⇒
    match xs_v140548 with
    | nilUU_c18  ⇒ a_v140549 | consUU_c19 x_v140550 __v140551 ⇒ x_v140550
    end
  | S_c5 n_v140552 ⇒
    match xs_v140548 with
    | nilUU_c18  ⇒ a_v140549
    | consUU_c19 __v140553 xs_v140554 ⇒
      get_at_i35(NULL, n_v140552, xs_v140554, a_v140549)
    end
  end

val get_atclo_i97 =
  fn A_v140555 n_v140556 xs_v140557 a_v140558 ⇒
    get_at_i35(A_v140555, n_v140556, xs_v140557, a_v140558)

fun string_of_digit_i36(n_v140559) =
  get_at_i35(NULL, n_v140559, digits_i34, EmptyString_c7)

val string_of_digitclo_i98 = fn n_v140560 ⇒ string_of_digit_i36(n_v140560)

fun string_of_nat_i37(n_v140561) =
  let s_v140562 = string_of_digit_i36(modn_i14(n_v140561, 10)) in
  let n_v140563 = divn_i13(n_v140561, 10) in
  match ltn_i6(O_c4, n_v140563) with
  | true_c2  ⇒ cats_i15(string_of_nat_i37(n_v140563), s_v140562)
  | false_c3  ⇒ s_v140562
  end

val string_of_natclo_i99 = fn n_v140564 ⇒ string_of_nat_i37(n_v140564)

fun string_of_listU_i61(xs_v140565) =
  match xs_v140565 with
  | nilUU_c18  ⇒ "nil"
  | consUU_c19 x_v140566 xs_v140567 ⇒
    cats_i15(cats_i15(string_of_nat_i37(x_v140566), " :: "),
             string_of_listU_i61(xs_v140567))
  end

val string_of_listUclo_i100 =
  fn xs_v140568 ⇒ string_of_listU_i61(xs_v140568)

fun string_of_listL_i60(xs_v140569) =
  match xs_v140569 with
  | nilUL_c16  ⇒ "nil"
  | consUL_c17 x_v140570 xs_v140571 ⇒
    cats_i15(cats_i15(string_of_nat_i37(x_v140570), " :: "),
             string_of_listL_i60(xs_v140571))
  end

val string_of_listLclo_i101 =
  fn xs_v140572 ⇒ string_of_listL_i60(xs_v140572)

main =
  let test1_v140573 =
    (consUU_c19
      5
      (consUU_c19
        2
        (consUU_c19
          1
          (consUU_c19
            6 (consUU_c19 4 (consUU_c19 O_c4 (consUU_c19 3 nilUU_c18)))))))
  in
  let test2_v140574 =
    (consUL_c17
      3
      (consUL_c17
        O_c4
        (consUL_c17
          6
          (consUL_c17
            1 (consUL_c17 4 (consUL_c17 2 (consUL_c17 5 nilUL_c16)))))))
  in
  let msg1_v140575 = (cmsortU_i59(test1_v140573)) NULL in
  let msg2_v140576 = (cmsortL_i58(test2_v140574)) NULL in
  match msg1_v140575 with
  | UniqU_c21 sorted1_v140577 __v140578 ⇒
    match msg2_v140576 with
    | UniqL_c20 sorted2_v140579 __v140580 ⇒
      let __v140581 =
        (print_i26(cats_i15(string_of_listU_i61(sorted1_v140577), "\n")))
          NULL
      in
      (print_i26(cats_i15(string_of_listL_i60(sorted2_v140579), "\n"))) NULL
    end
  end

trans3e success--------------------------

trans34 success--------------------------

