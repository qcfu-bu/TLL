parsing success--------------------------

inductive unit_d1 : U =
| tt_c1 of : unit_d1

inductive bool_d2 : U =
| true_c2 of : bool_d2 | false_c3 of : bool_d2

program andb_i1 : bool_d2 → bool_d2 → bool_d2 =
  fn (b1_v285 : bool_d2) (b2_v286 : bool_d2) ⇒
    match b1_v285 as __v287 in ??1 with
    | true_c2  ⇒ b2_v286 | false_c3  ⇒ false_c3‹›
    end

program orb_i2 : bool_d2 → bool_d2 → bool_d2 =
  fn (b1_v290 : bool_d2) (b2_v291 : bool_d2) ⇒
    match b1_v290 as __v292 in ??2 with
    | true_c2  ⇒ true_c2‹› | false_c3  ⇒ b2_v291
    end

program notb_i3 : bool_d2 → bool_d2 =
  fn (b_v294 : bool_d2) ⇒
    match b_v294 as __v295 in ??3 with
    | true_c2  ⇒ false_c3‹› | false_c3  ⇒ true_c2‹›
    end

inductive nat_d3 : U =
| O_c4 of : nat_d3 | S_c5 of (n_v296 : nat_d3) : nat_d3

program lten_i4 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v299 : nat_d3) (y_v300 : nat_d3) ⇒
    match x_v299 as __v301 in ??4 with
    | O_c4  ⇒ true_c2‹›
    | S_c5 x_v302 ⇒
      match y_v300 as __v303 in ??5 with
      | O_c4  ⇒ false_c3‹› | S_c5 y_v304 ⇒ (lten_i4 x_v302 y_v304)
      end
    end

program gten_i5 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v307 : nat_d3) (y_v308 : nat_d3) ⇒
    match x_v307 as __v309 in ??6 with
    | O_c4  ⇒
      match y_v308 as __v310 in ??8 with
      | O_c4  ⇒ true_c2‹› | S_c5 __v311 ⇒ false_c3‹›
      end
    | S_c5 x_v312 ⇒
      match y_v308 as __v313 in ??7 with
      | O_c4  ⇒ true_c2‹› | S_c5 y_v314 ⇒ (gten_i5 x_v312 y_v314)
      end
    end

program ltn_i6 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v317 : nat_d3) (y_v318 : nat_d3) ⇒
    match x_v317 as __v319 in ??9 with
    | O_c4  ⇒
      match y_v318 as __v320 in ??11 with
      | O_c4  ⇒ false_c3‹› | S_c5 y_v321 ⇒ true_c2‹›
      end
    | S_c5 x_v322 ⇒
      match y_v318 as __v323 in ??10 with
      | O_c4  ⇒ false_c3‹› | S_c5 y_v324 ⇒ (ltn_i6 x_v322 y_v324)
      end
    end

program gtn_i7 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v327 : nat_d3) (y_v328 : nat_d3) ⇒
    match x_v327 as __v329 in ??12 with
    | O_c4  ⇒ false_c3‹›
    | S_c5 x_v330 ⇒
      match y_v328 as __v331 in ??13 with
      | O_c4  ⇒ true_c2‹› | S_c5 y_v332 ⇒ (gtn_i7 x_v330 y_v332)
      end
    end

program eqn_i8 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v335 : nat_d3) (y_v336 : nat_d3) ⇒
    match x_v335 as __v337 in ??14 with
    | O_c4  ⇒
      match y_v336 as __v338 in ??16 with
      | O_c4  ⇒ true_c2‹› | S_c5 __v339 ⇒ false_c3‹›
      end
    | S_c5 x_v340 ⇒
      match y_v336 as __v341 in ??15 with
      | O_c4  ⇒ false_c3‹› | S_c5 y_v342 ⇒ (eqn_i8 x_v340 y_v342)
      end
    end

program pred_i9 : nat_d3 → nat_d3 =
  fn (x_v344 : nat_d3) ⇒
    match x_v344 as __v345 in ??17 with
    | O_c4  ⇒ O_c4‹› | S_c5 x_v346 ⇒ x_v346
    end

program addn_i10 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v349 : nat_d3) (y_v350 : nat_d3) ⇒
    match x_v349 as __v351 in ??18 with
    | O_c4  ⇒ y_v350
    | S_c5 x_v352 ⇒ (S_c5‹› (addn_i10 x_v352 y_v350))
    end

program subn_i11 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v355 : nat_d3) (y_v356 : nat_d3) ⇒
    match y_v356 as __v357 in ??19 with
    | O_c4  ⇒ x_v355 | S_c5 y_v358 ⇒ (subn_i11 (pred_i9 x_v355) y_v358)
    end

program muln_i12 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v361 : nat_d3) (y_v362 : nat_d3) ⇒
    match x_v361 as __v363 in ??20 with
    | O_c4  ⇒ O_c4‹›
    | S_c5 x_v364 ⇒ (addn_i10 y_v362 (muln_i12 x_v364 y_v362))
    end

program divn_i13 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v367 : nat_d3) (y_v368 : nat_d3) ⇒
    match (ltn_i6 x_v367 y_v368) as __v369 in ??21 with
    | true_c2  ⇒ O_c4‹›
    | false_c3  ⇒ (S_c5‹› (divn_i13 (subn_i11 x_v367 y_v368) y_v368))
    end

program modn_i14 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v372 : nat_d3) (y_v373 : nat_d3) ⇒
    (subn_i11 x_v372 (muln_i12 (divn_i13 x_v372 y_v373) y_v373))

inductive ascii_d4 : U =
| Ascii_c6 of
    (b0_v374 : bool_d2) (b1_v375 : bool_d2) (b2_v376 : bool_d2)
    (b3_v377 : bool_d2) (b4_v378 : bool_d2) (b5_v379 : bool_d2)
    (b6_v380 : bool_d2) (b7_v381 : bool_d2) : ascii_d4

inductive string_d5 : U =
| EmptyString_c7 of : string_d5
| String_c8 of (c_v382 : ascii_d4) (s_v383 : string_d5) : string_d5

program cats_i15 : string_d5 → string_d5 → string_d5 =
  fn (s1_v386 : string_d5) (s2_v387 : string_d5) ⇒
    match s1_v386 as __v388 in ??22 with
    | EmptyString_c7  ⇒ s2_v387
    | String_c8 c_v389 s1_v390 ⇒
      (String_c8‹› c_v389 (cats_i15 s1_v390 s2_v387))
    end

program strlen_i16 : string_d5 → nat_d3 =
  fn (s_v392 : string_d5) ⇒
    match s_v392 as __v393 in ??23 with
    | EmptyString_c7  ⇒ O_c4‹›
    | String_c8 __v394 s_v395 ⇒ (S_c5‹› (strlen_i16 s_v395))
    end

inductive list_d6 ‹s_s396, t_s397›
  (A_v398 : Type‹s_s396›) : Type‹t_s397›
=
| nil_c9 of
    ‹s_s399, t_s400› (A_v401 : Type‹s_s399›)
    : (list_d6‹s_s399, t_s400› A_v401)
| cons_c10 of
    ‹s_s402, t_s403› (A_v404 : Type‹s_s402›) (hd_v405 : A_v404)
    (tl_v406 : (list_d6‹s_s402, t_s403› A_v404))
    : (list_d6‹s_s402, t_s403› A_v404)

program len_i17 ‹s_s407, t_s408› :
  ∀ {A_v409 : Type‹s_s407›} →
    (list_d6‹??24, t_s408› A_v409) →
      nat_d3 ⊗ (list_d6‹??25, t_s408› A_v409)
=
  fn {A_v412 : Type‹s_s407›}
     (xs_v413 : (list_d6‹??24, t_s408› A_v412)) ⇒
    match xs_v413 as __v414 in ??26 with
    | nil_c9  ⇒ ⟨O_c4‹›, nil_c9‹??36, ??35›⟩
    | cons_c10 x_v415 xs_v416 ⇒
      match (len_i17‹??29, ??28› ??27 xs_v416) as __v417 in ??30 with
      | ⟨n_v418, xs_v419⟩ ⇒
        ⟨(S_c5‹› n_v418), (cons_c10‹??33, ??32› x_v415 xs_v419)⟩
      end
    end

program append_i18 ‹s_s420, t_s421› :
  ∀ {A_v422 : Type‹s_s420›} →
    (list_d6‹??37, t_s421› A_v422) →
      (list_d6‹??38, t_s421› A_v422) ⊸ (list_d6‹??40, ??39› A_v422)
=
  fn {A_v425 : Type‹s_s420›}
     (xs_v426 : (list_d6‹??37, t_s421› A_v425)) ⇒
    ln (ys_v427 : ??41) ⇒
      match xs_v426 as __v428 in ??42 with
      | nil_c9  ⇒ ys_v427
      | cons_c10 x_v429 xs_v430 ⇒
        (cons_c10‹??48, ??47›
          x_v429 (append_i18‹??45, ??44› ??43 xs_v430 ys_v427))
      end

logical stdin_rec_i19 : unit_d1 → proto =
  fn (__v432 : unit_d1) ⇒
    ⇑(b_v433 : bool_d2) ⇒
      match b_v433 as __v434 in ??49 with
      | true_c2  ⇒ ⇓(__v435 : string_d5) ⇒ (stdin_rec_i19 tt_c1‹›)
      | false_c3  ⇒ end
      end

logical stdout_rec_i20 : unit_d1 → proto =
  fn (__v437 : unit_d1) ⇒
    ⇑(b_v438 : bool_d2) ⇒
      match b_v438 as __v439 in ??50 with
      | true_c2  ⇒ ⇑(__v440 : string_d5) ⇒ (stdout_rec_i20 tt_c1‹›)
      | false_c3  ⇒ end
      end

logical stderr_rec_i21 : unit_d1 → proto =
  fn (__v442 : unit_d1) ⇒
    ⇑(b_v443 : bool_d2) ⇒
      match b_v443 as __v444 in ??51 with
      | true_c2  ⇒ ⇑(__v445 : string_d5) ⇒ (stderr_rec_i21 tt_c1‹›)
      | false_c3  ⇒ end
      end

logical stdin_t_i22 : proto = (stdin_rec_i19 tt_c1‹›)

logical stdout_t_i23 : proto = (stdout_rec_i20 tt_c1‹›)

logical stderr_t_i24 : proto = (stderr_rec_i21 tt_c1‹›)

program readline_i25 : unit_d1 → IO string_d5 =
  fn (__v447 : unit_d1) ⇒
    let ch_v448 ⇐ open stdin in
    let ch_v449 ⇐ (send ch_v448 true_c2‹›) in
    let __v450 ⇐ recv ch_v449 in
    match __v450 as __v451 in ??52 with
    | ⟨s_v452, ch_v453⟩ ⇒
      let ch_v454 ⇐ (send ch_v453 false_c3‹›) in
      let __v455 ⇐ close ch_v454 in return s_v452
    end

program print_i26 : string_d5 → IO unit_d1 =
  fn (s_v457 : string_d5) ⇒
    let ch_v458 ⇐ open stdout in
    let ch_v459 ⇐ (send ch_v458 true_c2‹›) in
    let ch_v460 ⇐ (send ch_v459 s_v457) in
    let ch_v461 ⇐ (send ch_v460 false_c3‹›) in close ch_v461

program prerr_i27 : string_d5 → IO unit_d1 =
  fn (s_v463 : string_d5) ⇒
    let ch_v464 ⇐ open stderr in
    let ch_v465 ⇐ (send ch_v464 true_c2‹›) in
    let ch_v466 ⇐ (send ch_v465 s_v463) in
    let ch_v467 ⇐ (send ch_v466 false_c3‹›) in close ch_v467

program split_i28 ‹t_s468› :
  (list_d6‹??53, t_s468› nat_d3) →
    (list_d6‹??54, t_s468› nat_d3) ⊗ (list_d6‹??55, t_s468› nat_d3)
=
  fn (zs_v471 : (list_d6‹??53, t_s468› nat_d3)) ⇒
    match zs_v471 as __v472 in ??56 with
    | nil_c9  ⇒ ⟨nil_c9‹??77, ??76›, nil_c9‹??80, ??79›⟩
    | cons_c10 x_v473 zs_v474 ⇒
      match zs_v474 as __v475 in ??57 with
      | nil_c9  ⇒
        ⟨(cons_c10‹??71, ??70› x_v473 nil_c9‹??68, ??67›), nil_c9‹??74,
        ??73›⟩
      | cons_c10 y_v476 zs_v477 ⇒
        let __v478 = (split_i28‹??58› zs_v477) in
        match __v478 as __v479 in ??65 with
        | ⟨xs_v480, ys_v481⟩ ⇒
          ⟨(cons_c10‹??61, ??60› x_v473 xs_v480), (cons_c10‹??64,
                                                        ??63›
                                                          y_v476 ys_v481)⟩
        end
      end
    end

program merge_i29 ‹t_s482› :
  (list_d6‹??81, t_s482› nat_d3) →
    (list_d6‹??82, t_s482› nat_d3) ⊸ (list_d6‹??83, t_s482› nat_d3)
=
  fn (xs_v485 : (list_d6‹??81, t_s482› nat_d3)) ⇒
    ln (ys_v486 : ??84) ⇒
      match xs_v485 as __v487 in ??85 with
      | nil_c9  ⇒ ys_v486
      | cons_c10 x_v488 xs0_v489 ⇒
        match ys_v486 as __v490 in ??86 with
        | nil_c9  ⇒ (cons_c10‹??104, ??103› x_v488 xs0_v489)
        | cons_c10 y_v491 ys0_v492 ⇒
          match (lten_i4 x_v488 y_v491) as __v493 in ??87 with
          | true_c2  ⇒
            (cons_c10‹??101, ??100›
              x_v488
              (merge_i29‹??98›
                xs0_v489 (cons_c10‹??97, ??96› y_v491 ys0_v492)))
          | false_c3  ⇒
            (cons_c10‹??94, ??93›
              y_v491
              (merge_i29‹??91›
                (cons_c10‹??90, ??89› x_v488 xs0_v489) ys0_v492))
          end
        end
      end

program msort_i30 ‹t_s494› :
  (list_d6‹??105, t_s494› nat_d3) → (list_d6‹??106, t_s494› nat_d3)
=
  fn (zs_v496 : (list_d6‹??105, t_s494› nat_d3)) ⇒
    match zs_v496 as __v497 in ??107 with
    | nil_c9  ⇒ nil_c9‹??128, ??127›
    | cons_c10 x_v498 zs_v499 ⇒
      match zs_v499 as __v500 in ??108 with
      | nil_c9  ⇒
        (cons_c10‹??125, ??124› x_v498 nil_c9‹??122, ??121›)
      | cons_c10 y_v501 zs_v502 ⇒
        let __v503 =
          (split_i28‹??115›
            (cons_c10‹??114, ??113›
              x_v498 (cons_c10‹??111, ??110› y_v501 zs_v502)))
        in
        match __v503 as __v504 in ??119 with
        | ⟨xs_v505, ys_v506⟩ ⇒
          (merge_i29‹??118›
            (msort_i30‹??117› xs_v505) (msort_i30‹??116› ys_v506))
        end
      end
    end

inductive uniq_d7 ‹t_s507›
  (A_v508 : Type‹t_s507›) (a_v509 : A_v508) : Type‹t_s507›
=
| Uniq_c11 of
    ‹t_s510› (A_v511 : Type‹t_s510›) (a_v512 : A_v511)
    (m_v513 : A_v511) {pf_v514 : m_v513 ≡ a_v512}
    : (uniq_d7‹t_s510› A_v511 a_v512)

logical cmsort_ch_i31 ‹t_s515› :
  (list_d6‹??130, t_s515› nat_d3) → L
=
  fn (xs_v517 : (list_d6‹??130, t_s515› nat_d3)) ⇒
    ch⟨⇑(__v518 :
           (uniq_d7‹??133› ??132 (msort_i30‹??131› xs_v517))) ⇒ end⟩

program cmsort_worker_i32 ‹t_s519› :
  ∀ (zs_v520 : (list_d6‹??134, t_s519› nat_d3)) →
    (cmsort_ch_i31‹t_s519› zs_v520) ⊸ IO unit_d1
=
  fn (zs_v522 : (list_d6‹??134, t_s519› nat_d3)) ⇒
    ln (c_v523 : ??135) ⇒
      (match zs_v522 as _zs__v524 in
         (cmsort_ch_i31‹??136› _zs__v524) ⊸ IO unit_d1 with
       | nil_c9  ⇒
         ln (c_v526 : ??194) ⇒
           let c_v527 ⇐
             (send c_v526
               (Uniq_c11‹??201› nil_c9‹??198, ??197› refl ??195))
           in close c_v527
       | cons_c10 z0_v528 zs0_v529 ⇒
         ln (c_v530 : ??137) ⇒
           (match zs0_v529 as _zs0__v531 in
              (cmsort_ch_i31‹??141›
                (cons_c10‹??140, ??139› z0_v528 _zs0__v531)) ⊸
                IO unit_d1 with
            | nil_c9  ⇒
              ln (c_v533 : ??183) ⇒
                let c_v534 ⇐
                  (send c_v533
                    (Uniq_c11‹??193›
                      (cons_c10‹??190, ??189›
                        z0_v528 nil_c9‹??187, ??186›)
                      refl ??184))
                in close c_v534
            | cons_c10 z1_v535 zs1_v536 ⇒
              ln (c_v537 : ??142) ⇒
                (match (split_i28‹??149›
                         (cons_c10‹??148, ??147›
                           z0_v528
                           (cons_c10‹??145, ??144› z1_v535 zs1_v536))) as _p__v538 in
                   {_p__v538 ≡
                      (split_i28‹??156›
                        (cons_c10‹??155, ??154›
                          z0_v528
                          (cons_c10‹??152, ??151› z1_v535 zs1_v536)))} ⊸
                     IO unit_d1 with
                 | ⟨xs0_v540, ys0_v541⟩ ⇒
                   ln {e_v542 : ??158} ⇒
                     let r1_v543 ⇐
                       fork (r1_v544 : (cmsort_ch_i31‹??159› xs0_v540))
                       in (cmsort_worker_i32‹??160› xs0_v540 r1_v544)
                     in
                     let r2_v545 ⇐
                       fork (r2_v546 : (cmsort_ch_i31‹??161› ys0_v541))
                       in (cmsort_worker_i32‹??162› ys0_v541 r2_v546)
                     in
                     let __v547 ⇐ recv r1_v543 in
                     match __v547 as __v548 in ??181 with
                     | ⟨msg1_v549, r1_v550⟩ ⇒
                       let __v551 ⇐ recv r2_v545 in
                       match __v551 as __v552 in ??180 with
                       | ⟨msg2_v553, r2_v554⟩ ⇒
                         match msg1_v549 as __v555 in ??163 with
                         | Uniq_c11 xs1_v556 pf1_v557 ⇒
                           match msg2_v553 as __v558 in ??164 with
                           | Uniq_c11 xs2_v559 pf2_v560 ⇒
                             let zs_v561 =
                               (merge_i29‹??165› xs1_v556 xs2_v559)
                             in
                             let c_v562 ⇐
                               (send c_v537
                                 (Uniq_c11‹??179›
                                   zs_v561
                                   rew [p_v563, __v564 ⇒
                                     zs_v561 ≡
                                       let __v565 = p_v563 in
                                       match __v565 as __v566 in ??175 with
                                       | ⟨xs_v567, ys_v568⟩ ⇒
                                         (merge_i29‹??174›
                                           (msort_i30‹??173› xs_v567)
                                           (msort_i30‹??172› ys_v568))
                                       end]
                                     e_v542 in
                                   rew [l_v569, __v570 ⇒
                                     zs_v561 ≡
                                       (merge_i29‹??170›
                                         l_v569
                                         (msort_i30‹??169› ys0_v541))]
                                     pf1_v557 in
                                   rew [l_v571, __v572 ⇒
                                     zs_v561 ≡
                                       (merge_i29‹??167› xs1_v556 l_v571)]
                                     pf2_v560 in
                                   refl ??166))
                             in
                             let __v573 ⇐ close r1_v550 in
                             let __v574 ⇐ close r2_v554 in close c_v562
                           end
                         end
                       end
                     end
                 end refl ??182)
            end c_v530)
       end c_v523)

program cmsort_i33 ‹t_s575› :
  ∀ (zs_v576 : (list_d6‹??202, t_s575› nat_d3)) →
    IO (uniq_d7‹t_s575› ??204 (msort_i30‹??203› zs_v576))
=
  fn (zs_v577 : (list_d6‹??202, t_s575› nat_d3)) ⇒
    let c_v578 ⇐
      fork (c_v579 : (cmsort_ch_i31‹??205› zs_v577)) in
        (cmsort_worker_i32‹??206› zs_v577 c_v579)
    in
    let __v580 ⇐ recv c_v578 in
    match __v580 as __v581 in ??207 with
    | ⟨msg_v582, c_v583⟩ ⇒
      let __v584 ⇐ close c_v583 in return msg_v582
    end

program digits_i34 : (list_d6‹??208, U› ??209) =
  (cons_c10‹??242, ??241›
    "0"
    (cons_c10‹??239, ??238›
      "1"
      (cons_c10‹??236, ??235›
        "2"
        (cons_c10‹??233, ??232›
          "3"
          (cons_c10‹??230, ??229›
            "4"
            (cons_c10‹??227, ??226›
              "5"
              (cons_c10‹??224, ??223›
                "6"
                (cons_c10‹??221, ??220›
                  "7"
                  (cons_c10‹??218, ??217›
                    "8"
                    (cons_c10‹??215, ??214› "9" nil_c9‹??212, ??211›))))))))))

program get_at_i35 :
  ∀ {A_v585 : U} →
    nat_d3 → (list_d6‹??243, U› A_v585) → A_v585 → A_v585
=
  fn {A_v589 : U} (n_v590 : nat_d3)
     (xs_v591 : (list_d6‹??243, U› A_v589)) (a_v592 : A_v589) ⇒
    match n_v590 as __v593 in ??244 with
    | O_c4  ⇒
      match xs_v591 as __v594 in ??247 with
      | nil_c9  ⇒ a_v592 | cons_c10 x_v595 __v596 ⇒ x_v595
      end
    | S_c5 n_v597 ⇒
      match xs_v591 as __v598 in ??245 with
      | nil_c9  ⇒ a_v592
      | cons_c10 __v599 xs_v600 ⇒ (get_at_i35 ??246 n_v597 xs_v600 a_v592)
      end
    end

program string_of_digit_i36 : nat_d3 → string_d5 =
  fn (n_v602 : nat_d3) ⇒
    (get_at_i35 ??248 n_v602 digits_i34 EmptyString_c7‹›)

program string_of_nat_i37 : nat_d3 → string_d5 =
  fn (n_v604 : nat_d3) ⇒
    let s_v605 = (string_of_digit_i36 (modn_i14 n_v604 10)) in
    let n_v606 = (divn_i13 n_v604 10) in
    match (ltn_i6 O_c4‹› n_v606) as __v607 in ??249 with
    | true_c2  ⇒ (cats_i15 (string_of_nat_i37 n_v606) s_v605)
    | false_c3  ⇒ s_v605
    end

program string_of_list_i38 ‹t_s608› :
  (list_d6‹??250, t_s608› nat_d3) → string_d5
=
  fn (xs_v610 : (list_d6‹??250, t_s608› nat_d3)) ⇒
    match xs_v610 as __v611 in ??251 with
    | nil_c9  ⇒ "nil"
    | cons_c10 x_v612 xs_v613 ⇒
      (cats_i15
        (cats_i15 (string_of_nat_i37 x_v612) " :: ")
        (string_of_list_i38‹??252› xs_v613))
    end

program main_i39 : IO unit_d1 =
  let test1_v614 =
    ((cons_c10‹??273, ??272›
       5
       (cons_c10‹??270, ??269›
         2
         (cons_c10‹??267, ??266›
           1
           (cons_c10‹??264, ??263›
             6
             (cons_c10‹??261, ??260›
               O_c4‹›
               (cons_c10‹??258, ??257› 3 nil_c9‹??255, ??254›))))))
      : (list_d6‹??274, U› ??275))
  in
  let test2_v615 =
    ((cons_c10‹??296, ??295›
       3
       (cons_c10‹??293, ??292›
         O_c4‹›
         (cons_c10‹??290, ??289›
           6
           (cons_c10‹??287, ??286›
             1
             (cons_c10‹??284, ??283›
               2 (cons_c10‹??281, ??280› 5 nil_c9‹??278, ??277›))))))
      : (list_d6‹??297, L› ??298))
  in
  let msg1_v616 ⇐ (cmsort_i33‹??299› test1_v614) in
  let msg2_v617 ⇐ (cmsort_i33‹??300› test2_v615) in
  match msg1_v616 as __v618 in ??301 with
  | Uniq_c11 sorted1_v619 __v620 ⇒
    match msg2_v617 as __v621 in ??302 with
    | Uniq_c11 sorted2_v622 __v623 ⇒
      let __v624 ⇐
        (print_i26
          (cats_i15 (string_of_list_i38‹??303› sorted1_v619) "\n"))
      in
      (print_i26
        (cats_i15 (string_of_list_i38‹??304› sorted2_v622) "\n"))
    end
  end

trans01 success--------------------------

inductive unit_d1 : U =
| tt_c1 of : unit_d1

inductive bool_d2 : U =
| true_c2 of : bool_d2 | false_c3 of : bool_d2

program andb_i1 : bool_d2 → bool_d2 → bool_d2 =
  fn (b1_v134656 : bool_d2) (b2_v134657 : bool_d2) ⇒
    match b1_v134656 as __v134658 in bool_d2 with
    | true_c2  ⇒ b2_v134657 | false_c3  ⇒ false_c3‹›
    end

program orb_i2 : bool_d2 → bool_d2 → bool_d2 =
  fn (b1_v134661 : bool_d2) (b2_v134662 : bool_d2) ⇒
    match b1_v134661 as __v134663 in bool_d2 with
    | true_c2  ⇒ true_c2‹› | false_c3  ⇒ b2_v134662
    end

program notb_i3 : bool_d2 → bool_d2 =
  fn (b_v134665 : bool_d2) ⇒
    match b_v134665 as __v134666 in bool_d2 with
    | true_c2  ⇒ false_c3‹› | false_c3  ⇒ true_c2‹›
    end

inductive nat_d3 : U =
| O_c4 of : nat_d3 | S_c5 of (n_v134667 : nat_d3) : nat_d3

program lten_i4 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v134670 : nat_d3) (y_v134671 : nat_d3) ⇒
    match x_v134670 as __v134672 in bool_d2 with
    | O_c4  ⇒ true_c2‹›
    | S_c5 x_v134673 ⇒
      match y_v134671 as __v134674 in bool_d2 with
      | O_c4  ⇒ false_c3‹›
      | S_c5 y_v134675 ⇒ (lten_i4 x_v134673 y_v134675)
      end
    end

program gten_i5 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v134678 : nat_d3) (y_v134679 : nat_d3) ⇒
    match x_v134678 as __v134680 in bool_d2 with
    | O_c4  ⇒
      match y_v134679 as __v134681 in bool_d2 with
      | O_c4  ⇒ true_c2‹› | S_c5 __v134682 ⇒ false_c3‹›
      end
    | S_c5 x_v134683 ⇒
      match y_v134679 as __v134684 in bool_d2 with
      | O_c4  ⇒ true_c2‹›
      | S_c5 y_v134685 ⇒ (gten_i5 x_v134683 y_v134685)
      end
    end

program ltn_i6 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v134688 : nat_d3) (y_v134689 : nat_d3) ⇒
    match x_v134688 as __v134690 in bool_d2 with
    | O_c4  ⇒
      match y_v134689 as __v134691 in bool_d2 with
      | O_c4  ⇒ false_c3‹› | S_c5 y_v134692 ⇒ true_c2‹›
      end
    | S_c5 x_v134693 ⇒
      match y_v134689 as __v134694 in bool_d2 with
      | O_c4  ⇒ false_c3‹›
      | S_c5 y_v134695 ⇒ (ltn_i6 x_v134693 y_v134695)
      end
    end

program gtn_i7 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v134698 : nat_d3) (y_v134699 : nat_d3) ⇒
    match x_v134698 as __v134700 in bool_d2 with
    | O_c4  ⇒ false_c3‹›
    | S_c5 x_v134701 ⇒
      match y_v134699 as __v134702 in bool_d2 with
      | O_c4  ⇒ true_c2‹›
      | S_c5 y_v134703 ⇒ (gtn_i7 x_v134701 y_v134703)
      end
    end

program eqn_i8 : nat_d3 → nat_d3 → bool_d2 =
  fn (x_v134706 : nat_d3) (y_v134707 : nat_d3) ⇒
    match x_v134706 as __v134708 in bool_d2 with
    | O_c4  ⇒
      match y_v134707 as __v134709 in bool_d2 with
      | O_c4  ⇒ true_c2‹› | S_c5 __v134710 ⇒ false_c3‹›
      end
    | S_c5 x_v134711 ⇒
      match y_v134707 as __v134712 in bool_d2 with
      | O_c4  ⇒ false_c3‹›
      | S_c5 y_v134713 ⇒ (eqn_i8 x_v134711 y_v134713)
      end
    end

program pred_i9 : nat_d3 → nat_d3 =
  fn (x_v134715 : nat_d3) ⇒
    match x_v134715 as __v134716 in nat_d3 with
    | O_c4  ⇒ O_c4‹› | S_c5 x_v134717 ⇒ x_v134717
    end

program addn_i10 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v134720 : nat_d3) (y_v134721 : nat_d3) ⇒
    match x_v134720 as __v134722 in nat_d3 with
    | O_c4  ⇒ y_v134721
    | S_c5 x_v134723 ⇒ (S_c5‹› (addn_i10 x_v134723 y_v134721))
    end

program subn_i11 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v134726 : nat_d3) (y_v134727 : nat_d3) ⇒
    match y_v134727 as __v134728 in nat_d3 with
    | O_c4  ⇒ x_v134726
    | S_c5 y_v134729 ⇒ (subn_i11 (pred_i9 x_v134726) y_v134729)
    end

program muln_i12 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v134732 : nat_d3) (y_v134733 : nat_d3) ⇒
    match x_v134732 as __v134734 in nat_d3 with
    | O_c4  ⇒ O_c4‹›
    | S_c5 x_v134735 ⇒ (addn_i10 y_v134733 (muln_i12 x_v134735 y_v134733))
    end

program divn_i13 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v134738 : nat_d3) (y_v134739 : nat_d3) ⇒
    match (ltn_i6 x_v134738 y_v134739) as __v134740 in nat_d3 with
    | true_c2  ⇒ O_c4‹›
    | false_c3  ⇒
      (S_c5‹› (divn_i13 (subn_i11 x_v134738 y_v134739) y_v134739))
    end

program modn_i14 : nat_d3 → nat_d3 → nat_d3 =
  fn (x_v134743 : nat_d3) (y_v134744 : nat_d3) ⇒
    (subn_i11 x_v134743 (muln_i12 (divn_i13 x_v134743 y_v134744) y_v134744))

inductive ascii_d4 : U =
| Ascii_c6 of
    (b0_v134745 : bool_d2) (b1_v134746 : bool_d2) (b2_v134747 : bool_d2)
    (b3_v134748 : bool_d2) (b4_v134749 : bool_d2) (b5_v134750 : bool_d2)
    (b6_v134751 : bool_d2) (b7_v134752 : bool_d2) : ascii_d4

inductive string_d5 : U =
| EmptyString_c7 of : string_d5
| String_c8 of (c_v134753 : ascii_d4) (s_v134754 : string_d5) : string_d5

program cats_i15 : string_d5 → string_d5 → string_d5 =
  fn (s1_v134757 : string_d5) (s2_v134758 : string_d5) ⇒
    match s1_v134757 as __v134759 in string_d5 with
    | EmptyString_c7  ⇒ s2_v134758
    | String_c8 c_v134760 s1_v134761 ⇒
      (String_c8‹› c_v134760 (cats_i15 s1_v134761 s2_v134758))
    end

program strlen_i16 : string_d5 → nat_d3 =
  fn (s_v134763 : string_d5) ⇒
    match s_v134763 as __v134764 in nat_d3 with
    | EmptyString_c7  ⇒ O_c4‹›
    | String_c8 __v134765 s_v134766 ⇒ (S_c5‹› (strlen_i16 s_v134766))
    end

inductive list_d6 ‹s_s134767, t_s134768›
  (A_v134769 : Type‹s_s134767›) : Type‹t_s134768›
=
| nil_c9 of
    ‹s_s134770, t_s134771› (A_v134772 : Type‹s_s134770›)
    : (list_d6‹s_s134770, t_s134771› A_v134772)
| cons_c10 of
    ‹s_s134773, t_s134774› (A_v134775 : Type‹s_s134773›)
    (hd_v134776 : A_v134775)
    (tl_v134777 : (list_d6‹s_s134773, t_s134774› A_v134775))
    : (list_d6‹s_s134773, t_s134774› A_v134775)

program len_i17 ‹s_s134778, t_s134779› :
  ∀ {A_v134780 : Type‹s_s134778›} →
    (list_d6‹s_s134778, t_s134779› A_v134780) →
      nat_d3 ⊗ (list_d6‹s_s134778, t_s134779› A_v134780)
=
  fn {A_v134783 : Type‹s_s134778›}
     (xs_v134784 : (list_d6‹s_s134778, t_s134779› A_v134783)) ⇒
    match xs_v134784 as __v134785 in
      nat_d3 ⊗ (list_d6‹s_s134778, t_s134779› A_v134783) with
    | nil_c9  ⇒ ⟨O_c4‹›, nil_c9‹s_s134778, t_s134779›⟩
    | cons_c10 x_v134787 xs_v134788 ⇒
      match (len_i17‹s_s134778, t_s134779› A_v134783 xs_v134788) as __v134789 in
        nat_d3 ⊗ (list_d6‹s_s134778, t_s134779› A_v134783) with
      | ⟨n_v134791, xs_v134792⟩ ⇒
        ⟨(S_c5‹› n_v134791), (cons_c10‹s_s134778, t_s134779›
                                     x_v134787 xs_v134792)⟩
      end
    end

program append_i18 ‹s_s134793, t_s134794› :
  ∀ {A_v134795 : Type‹s_s134793›} →
    (list_d6‹s_s134793, t_s134794› A_v134795) →
      (list_d6‹s_s134793, t_s134794› A_v134795) ⊸
        (list_d6‹s_s134793, t_s134794› A_v134795)
=
  fn {A_v134798 : Type‹s_s134793›}
     (xs_v134799 : (list_d6‹s_s134793, t_s134794› A_v134798)) ⇒
    ln (ys_v134800 : (list_d6‹s_s134793, t_s134794› A_v134798)) ⇒
      match xs_v134799 as __v134801 in
        (list_d6‹s_s134793, t_s134794› A_v134798) with
      | nil_c9  ⇒ ys_v134800
      | cons_c10 x_v134802 xs_v134803 ⇒
        (cons_c10‹s_s134793, t_s134794›
          x_v134802
          (append_i18‹s_s134793, t_s134794›
            A_v134798 xs_v134803 ys_v134800))
      end

logical stdin_rec_i19 : unit_d1 → proto =
  fn (__v134805 : unit_d1) ⇒
    ⇑(b_v134806 : bool_d2) ⇒
      match b_v134806 as __v134807 in proto with
      | true_c2  ⇒
        ⇓(__v134808 : string_d5) ⇒ (stdin_rec_i19 tt_c1‹›)
      | false_c3  ⇒ end
      end

logical stdout_rec_i20 : unit_d1 → proto =
  fn (__v134810 : unit_d1) ⇒
    ⇑(b_v134811 : bool_d2) ⇒
      match b_v134811 as __v134812 in proto with
      | true_c2  ⇒
        ⇑(__v134813 : string_d5) ⇒ (stdout_rec_i20 tt_c1‹›)
      | false_c3  ⇒ end
      end

logical stderr_rec_i21 : unit_d1 → proto =
  fn (__v134815 : unit_d1) ⇒
    ⇑(b_v134816 : bool_d2) ⇒
      match b_v134816 as __v134817 in proto with
      | true_c2  ⇒
        ⇑(__v134818 : string_d5) ⇒ (stderr_rec_i21 tt_c1‹›)
      | false_c3  ⇒ end
      end

logical stdin_t_i22 : proto = (stdin_rec_i19 tt_c1‹›)

logical stdout_t_i23 : proto = (stdout_rec_i20 tt_c1‹›)

logical stderr_t_i24 : proto = (stderr_rec_i21 tt_c1‹›)

program readline_i25 : unit_d1 → IO string_d5 =
  fn (__v134820 : unit_d1) ⇒
    let ch_v134821 ⇐ open stdin in
    let ch_v134822 ⇐ (send ch_v134821 true_c2‹›) in
    let __v134823 ⇐ recv ch_v134822 in
    match __v134823 as __v134824 in IO string_d5 with
    | ⟨s_v134825, ch_v134826⟩ ⇒
      let ch_v134827 ⇐ (send ch_v134826 false_c3‹›) in
      let __v134828 ⇐ close ch_v134827 in return s_v134825
    end

program print_i26 : string_d5 → IO unit_d1 =
  fn (s_v134830 : string_d5) ⇒
    let ch_v134831 ⇐ open stdout in
    let ch_v134832 ⇐ (send ch_v134831 true_c2‹›) in
    let ch_v134833 ⇐ (send ch_v134832 s_v134830) in
    let ch_v134834 ⇐ (send ch_v134833 false_c3‹›) in close ch_v134834

program prerr_i27 : string_d5 → IO unit_d1 =
  fn (s_v134836 : string_d5) ⇒
    let ch_v134837 ⇐ open stderr in
    let ch_v134838 ⇐ (send ch_v134837 true_c2‹›) in
    let ch_v134839 ⇐ (send ch_v134838 s_v134836) in
    let ch_v134840 ⇐ (send ch_v134839 false_c3‹›) in close ch_v134840

program split_i28 ‹t_s134841› :
  (list_d6‹U, t_s134841› nat_d3) →
    (list_d6‹U, t_s134841› nat_d3) ⊗ (list_d6‹U, t_s134841› nat_d3)
=
  fn (zs_v134844 : (list_d6‹U, t_s134841› nat_d3)) ⇒
    match zs_v134844 as __v134845 in
      (list_d6‹U, t_s134841› nat_d3) ⊗
        (list_d6‹U, t_s134841› nat_d3) with
    | nil_c9  ⇒ ⟨nil_c9‹U, t_s134841›, nil_c9‹U, t_s134841›⟩
    | cons_c10 x_v134847 zs_v134848 ⇒
      match zs_v134848 as __v134849 in
        (list_d6‹U, t_s134841› nat_d3) ⊗
          (list_d6‹U, t_s134841› nat_d3) with
      | nil_c9  ⇒
        ⟨(cons_c10‹U, t_s134841› x_v134847 nil_c9‹U, t_s134841›), nil_c9‹U,
        t_s134841›⟩
      | cons_c10 y_v134851 zs_v134852 ⇒
        let __v134853 = (split_i28‹t_s134841› zs_v134852) in
        match __v134853 as __v134854 in
          (list_d6‹U, t_s134841› nat_d3) ⊗
            (list_d6‹U, t_s134841› nat_d3) with
        | ⟨xs_v134856, ys_v134857⟩ ⇒
          ⟨(cons_c10‹U, t_s134841› x_v134847 xs_v134856), (cons_c10‹U,
                                                                t_s134841›
                                                                  y_v134851
                                                                  ys_v134857)⟩
        end
      end
    end

program merge_i29 ‹t_s134858› :
  (list_d6‹U, t_s134858› nat_d3) →
    (list_d6‹U, t_s134858› nat_d3) ⊸ (list_d6‹U, t_s134858› nat_d3)
=
  fn (xs_v134861 : (list_d6‹U, t_s134858› nat_d3)) ⇒
    ln (ys_v134862 : (list_d6‹U, t_s134858› nat_d3)) ⇒
      match xs_v134861 as __v134863 in
        (list_d6‹U, t_s134858› nat_d3) with
      | nil_c9  ⇒ ys_v134862
      | cons_c10 x_v134864 xs0_v134865 ⇒
        match ys_v134862 as __v134866 in
          (list_d6‹U, t_s134858› nat_d3) with
        | nil_c9  ⇒ (cons_c10‹U, t_s134858› x_v134864 xs0_v134865)
        | cons_c10 y_v134867 ys0_v134868 ⇒
          match (lten_i4 x_v134864 y_v134867) as __v134869 in
            (list_d6‹U, t_s134858› nat_d3) with
          | true_c2  ⇒
            (cons_c10‹U, t_s134858›
              x_v134864
              (merge_i29‹t_s134858›
                xs0_v134865
                (cons_c10‹U, t_s134858› y_v134867 ys0_v134868)))
          | false_c3  ⇒
            (cons_c10‹U, t_s134858›
              y_v134867
              (merge_i29‹t_s134858›
                (cons_c10‹U, t_s134858› x_v134864 xs0_v134865)
                ys0_v134868))
          end
        end
      end

program msort_i30 ‹t_s134870› :
  (list_d6‹U, t_s134870› nat_d3) → (list_d6‹U, t_s134870› nat_d3)
=
  fn (zs_v134872 : (list_d6‹U, t_s134870› nat_d3)) ⇒
    match zs_v134872 as __v134873 in (list_d6‹U, t_s134870› nat_d3) with
    | nil_c9  ⇒ nil_c9‹U, t_s134870›
    | cons_c10 x_v134874 zs_v134875 ⇒
      match zs_v134875 as __v134876 in
        (list_d6‹U, t_s134870› nat_d3) with
      | nil_c9  ⇒
        (cons_c10‹U, t_s134870› x_v134874 nil_c9‹U, t_s134870›)
      | cons_c10 y_v134877 zs_v134878 ⇒
        let __v134879 =
          (split_i28‹t_s134870›
            (cons_c10‹U, t_s134870›
              x_v134874 (cons_c10‹U, t_s134870› y_v134877 zs_v134878)))
        in
        match __v134879 as __v134880 in
          (list_d6‹U, t_s134870› nat_d3) with
        | ⟨xs_v134881, ys_v134882⟩ ⇒
          (merge_i29‹t_s134870›
            (msort_i30‹t_s134870› xs_v134881)
            (msort_i30‹t_s134870› ys_v134882))
        end
      end
    end

inductive uniq_d7 ‹t_s134883›
  (A_v134884 : Type‹t_s134883›) (a_v134885 : A_v134884) : Type‹t_s134883›
=
| Uniq_c11 of
    ‹t_s134886› (A_v134887 : Type‹t_s134886›) (a_v134888 : A_v134887)
    (m_v134889 : A_v134887) {pf_v134890 : m_v134889 ≡ a_v134888}
    : (uniq_d7‹t_s134886› A_v134887 a_v134888)

logical cmsort_ch_i31 ‹t_s134891› :
  (list_d6‹U, t_s134891› nat_d3) → L
=
  fn (xs_v134893 : (list_d6‹U, t_s134891› nat_d3)) ⇒
    ch⟨⇑(__v134894 :
           (uniq_d7‹t_s134891›
             (list_d6‹U, t_s134891› nat_d3)
             (msort_i30‹t_s134891› xs_v134893))) ⇒
           end⟩

program cmsort_worker_i32 ‹t_s134895› :
  ∀ (zs_v134896 : (list_d6‹U, t_s134895› nat_d3)) →
    (cmsort_ch_i31‹t_s134895› zs_v134896) ⊸ IO unit_d1
=
  fn (zs_v134898 : (list_d6‹U, t_s134895› nat_d3)) ⇒
    ln (c_v134899 : (cmsort_ch_i31‹t_s134895› zs_v134898)) ⇒
      (match zs_v134898 as _zs__v134900 in
         (cmsort_ch_i31‹t_s134895› _zs__v134900) ⊸ IO unit_d1 with
       | nil_c9  ⇒
         ln (c_v134902 : (cmsort_ch_i31‹t_s134895›
                           nil_c9‹U, t_s134895›)) ⇒
           let c_v134903 ⇐
             (send c_v134902
               (Uniq_c11‹t_s134895›
                 nil_c9‹U, t_s134895› refl nil_c9‹U, t_s134895›))
           in close c_v134903
       | cons_c10 z0_v134904 zs0_v134905 ⇒
         ln (c_v134906 : (cmsort_ch_i31‹t_s134895›
                           (cons_c10‹U, t_s134895›
                             z0_v134904 zs0_v134905))) ⇒
           (match zs0_v134905 as _zs0__v134907 in
              (cmsort_ch_i31‹t_s134895›
                (cons_c10‹U, t_s134895› z0_v134904 _zs0__v134907)) ⊸
                IO unit_d1 with
            | nil_c9  ⇒
              ln (c_v134909 : (cmsort_ch_i31‹t_s134895›
                                (cons_c10‹U, t_s134895›
                                  z0_v134904 nil_c9‹U, t_s134895›))) ⇒
                let c_v134910 ⇐
                  (send c_v134909
                    (Uniq_c11‹t_s134895›
                      (cons_c10‹U, t_s134895›
                        z0_v134904 nil_c9‹U, t_s134895›)
                      refl (cons_c10‹U, t_s134895›
                             z0_v134904 nil_c9‹U, t_s134895›)))
                in close c_v134910
            | cons_c10 z1_v134911 zs1_v134912 ⇒
              ln (c_v134913 : (cmsort_ch_i31‹t_s134895›
                                (cons_c10‹U, t_s134895›
                                  z0_v134904
                                  (cons_c10‹U, t_s134895›
                                    z1_v134911 zs1_v134912)))) ⇒
                (match (split_i28‹t_s134895›
                         (cons_c10‹U, t_s134895›
                           z0_v134904
                           (cons_c10‹U, t_s134895›
                             z1_v134911 zs1_v134912))) as _p__v134914 in
                   {_p__v134914 ≡
                      (split_i28‹t_s134895›
                        (cons_c10‹U, t_s134895›
                          z0_v134904
                          (cons_c10‹U, t_s134895› z1_v134911 zs1_v134912)))} ⊸
                     IO unit_d1 with
                 | ⟨xs0_v134916, ys0_v134917⟩ ⇒
                   ln {e_v134918 : (⟨xs0_v134916, ys0_v134917⟩
                                     : (list_d6‹U, t_s134895› nat_d3) ⊗
                                         (list_d6‹U, t_s134895› nat_d3)) ≡
                                     (split_i28‹t_s134895›
                                       (cons_c10‹U, t_s134895›
                                         z0_v134904
                                         (cons_c10‹U, t_s134895›
                                           z1_v134911 zs1_v134912)))} ⇒
                     let r1_v134920 ⇐
                       fork (r1_v134921 :
                         (cmsort_ch_i31‹t_s134895› xs0_v134916))
                       in
                         (cmsort_worker_i32‹t_s134895›
                           xs0_v134916 r1_v134921)
                     in
                     let r2_v134922 ⇐
                       fork (r2_v134923 :
                         (cmsort_ch_i31‹t_s134895› ys0_v134917))
                       in
                         (cmsort_worker_i32‹t_s134895›
                           ys0_v134917 r2_v134923)
                     in
                     let __v134924 ⇐ recv r1_v134920 in
                     match __v134924 as __v134925 in IO unit_d1 with
                     | ⟨msg1_v134926, r1_v134927⟩ ⇒
                       let __v134928 ⇐ recv r2_v134922 in
                       match __v134928 as __v134929 in IO unit_d1 with
                       | ⟨msg2_v134930, r2_v134931⟩ ⇒
                         match msg1_v134926 as __v134932 in IO unit_d1 with
                         | Uniq_c11 xs1_v134933 pf1_v134934 ⇒
                           match msg2_v134930 as __v134935 in IO unit_d1 with
                           | Uniq_c11 xs2_v134936 pf2_v134937 ⇒
                             let zs_v134938 =
                               (merge_i29‹t_s134895›
                                 xs1_v134933 xs2_v134936)
                             in
                             let c_v134939 ⇐
                               (send c_v134913
                                 (Uniq_c11‹t_s134895›
                                   zs_v134938
                                   rew [p_v134940, __v134941 ⇒
                                     zs_v134938 ≡
                                       let __v134942 = p_v134940 in
                                       match __v134942 as __v134943 in
                                         (list_d6‹U, t_s134895› nat_d3) with
                                       | ⟨xs_v134944, ys_v134945⟩ ⇒
                                         (merge_i29‹t_s134895›
                                           (msort_i30‹t_s134895›
                                             xs_v134944)
                                           (msort_i30‹t_s134895›
                                             ys_v134945))
                                       end]
                                     e_v134918 in
                                   rew [l_v134946, __v134947 ⇒
                                     zs_v134938 ≡
                                       (merge_i29‹t_s134895›
                                         l_v134946
                                         (msort_i30‹t_s134895›
                                           ys0_v134917))]
                                     pf1_v134934 in
                                   rew [l_v134948, __v134949 ⇒
                                     zs_v134938 ≡
                                       (merge_i29‹t_s134895›
                                         xs1_v134933 l_v134948)]
                                     pf2_v134937 in
                                   refl (merge_i29‹t_s134895›
                                          xs1_v134933 xs2_v134936)))
                             in
                             let __v134950 ⇐ close r1_v134927 in
                             let __v134951 ⇐ close r2_v134931 in
                             close c_v134939
                           end
                         end
                       end
                     end
                 end
                  refl (split_i28‹t_s134895›
                         (cons_c10‹U, t_s134895›
                           z0_v134904
                           (cons_c10‹U, t_s134895›
                             z1_v134911 zs1_v134912))))
            end c_v134906)
       end c_v134899)

program cmsort_i33 ‹t_s134952› :
  ∀ (zs_v134953 : (list_d6‹U, t_s134952› nat_d3)) →
    IO (uniq_d7‹t_s134952›
         (list_d6‹U, t_s134952› nat_d3)
         (msort_i30‹t_s134952› zs_v134953))
=
  fn (zs_v134954 : (list_d6‹U, t_s134952› nat_d3)) ⇒
    let c_v134955 ⇐
      fork (c_v134956 : (cmsort_ch_i31‹t_s134952› zs_v134954)) in
        (cmsort_worker_i32‹t_s134952› zs_v134954 c_v134956)
    in
    let __v134957 ⇐ recv c_v134955 in
    match __v134957 as __v134958 in
      IO (uniq_d7‹t_s134952›
           (list_d6‹U, t_s134952› nat_d3)
           (msort_i30‹t_s134952› zs_v134954)) with
    | ⟨msg_v134959, c_v134960⟩ ⇒
      let __v134961 ⇐ close c_v134960 in return msg_v134959
    end

program digits_i34 : (list_d6‹U, U› string_d5) =
  (cons_c10‹U, U›
    "0"
    (cons_c10‹U, U›
      "1"
      (cons_c10‹U, U›
        "2"
        (cons_c10‹U, U›
          "3"
          (cons_c10‹U, U›
            "4"
            (cons_c10‹U, U›
              "5"
              (cons_c10‹U, U›
                "6"
                (cons_c10‹U, U›
                  "7"
                  (cons_c10‹U, U›
                    "8" (cons_c10‹U, U› "9" nil_c9‹U, U›))))))))))

program get_at_i35 :
  ∀ {A_v134962 : U} →
    nat_d3 → (list_d6‹U, U› A_v134962) → A_v134962 → A_v134962
=
  fn {A_v134966 : U} (n_v134967 : nat_d3)
     (xs_v134968 : (list_d6‹U, U› A_v134966)) (a_v134969 : A_v134966) ⇒
    match n_v134967 as __v134970 in A_v134966 with
    | O_c4  ⇒
      match xs_v134968 as __v134971 in A_v134966 with
      | nil_c9  ⇒ a_v134969 | cons_c10 x_v134972 __v134973 ⇒ x_v134972
      end
    | S_c5 n_v134974 ⇒
      match xs_v134968 as __v134975 in A_v134966 with
      | nil_c9  ⇒ a_v134969
      | cons_c10 __v134976 xs_v134977 ⇒
        (get_at_i35 A_v134966 n_v134974 xs_v134977 a_v134969)
      end
    end

program string_of_digit_i36 : nat_d3 → string_d5 =
  fn (n_v134979 : nat_d3) ⇒
    (get_at_i35 string_d5 n_v134979 digits_i34 EmptyString_c7‹›)

program string_of_nat_i37 : nat_d3 → string_d5 =
  fn (n_v134981 : nat_d3) ⇒
    let s_v134982 = (string_of_digit_i36 (modn_i14 n_v134981 10)) in
    let n_v134983 = (divn_i13 n_v134981 10) in
    match (ltn_i6 O_c4‹› n_v134983) as __v134984 in string_d5 with
    | true_c2  ⇒ (cats_i15 (string_of_nat_i37 n_v134983) s_v134982)
    | false_c3  ⇒ s_v134982
    end

program string_of_list_i38 ‹t_s134985› :
  (list_d6‹U, t_s134985› nat_d3) → string_d5
=
  fn (xs_v134987 : (list_d6‹U, t_s134985› nat_d3)) ⇒
    match xs_v134987 as __v134988 in string_d5 with
    | nil_c9  ⇒ "nil"
    | cons_c10 x_v134989 xs_v134990 ⇒
      (cats_i15
        (cats_i15 (string_of_nat_i37 x_v134989) " :: ")
        (string_of_list_i38‹t_s134985› xs_v134990))
    end

program main_i39 : IO unit_d1 =
  let test1_v134991 =
    ((cons_c10‹U, U›
       5
       (cons_c10‹U, U›
         2
         (cons_c10‹U, U›
           1
           (cons_c10‹U, U›
             6
             (cons_c10‹U, U›
               O_c4‹› (cons_c10‹U, U› 3 nil_c9‹U, U›))))))
      : (list_d6‹U, U› nat_d3))
  in
  let test2_v134992 =
    ((cons_c10‹U, L›
       3
       (cons_c10‹U, L›
         O_c4‹›
         (cons_c10‹U, L›
           6
           (cons_c10‹U, L›
             1 (cons_c10‹U, L› 2 (cons_c10‹U, L› 5 nil_c9‹U, L›))))))
      : (list_d6‹U, L› nat_d3))
  in
  let msg1_v134993 ⇐ (cmsort_i33‹U› test1_v134991) in
  let msg2_v134994 ⇐ (cmsort_i33‹L› test2_v134992) in
  match msg1_v134993 as __v134995 in IO unit_d1 with
  | Uniq_c11 sorted1_v134996 __v134997 ⇒
    match msg2_v134994 as __v134998 in IO unit_d1 with
    | Uniq_c11 sorted2_v134999 __v135000 ⇒
      let __v135001 ⇐
        (print_i26
          (cats_i15 (string_of_list_i38‹U› sorted1_v134996) "\n"))
      in
      (print_i26 (cats_i15 (string_of_list_i38‹L› sorted2_v134999) "\n"))
    end
  end

trans1e success--------------------------

data unit_d1 =
| tt_c1 of size(0)

data bool_d2 =
| true_c2 of size(0) | false_c3 of size(0)

def andb_i1 =
  fn b1_v135805 b2_v135806 ⇒
    match b1_v135805 with
    | true_c2  ⇒ b2_v135806 | false_c3  ⇒ false_c3
    end

def orb_i2 =
  fn b1_v135807 b2_v135808 ⇒
    match b1_v135807 with
    | true_c2  ⇒ true_c2 | false_c3  ⇒ b2_v135808
    end

def notb_i3 =
  fn b_v135809 ⇒
    match b_v135809 with
    | true_c2  ⇒ false_c3 | false_c3  ⇒ true_c2
    end

data nat_d3 =
| O_c4 of size(0) | S_c5 of size(1)

def lten_i4 =
  fn x_v135810 y_v135811 ⇒
    match x_v135810 with
    | O_c4  ⇒ true_c2
    | S_c5 x_v135812 ⇒
      match y_v135811 with
      | O_c4  ⇒ false_c3
      | S_c5 y_v135813 ⇒ ((lten_i4 x_v135812) y_v135813)
      end
    end

def gten_i5 =
  fn x_v135814 y_v135815 ⇒
    match x_v135814 with
    | O_c4  ⇒
      match y_v135815 with
      | O_c4  ⇒ true_c2 | S_c5 __v135816 ⇒ false_c3
      end
    | S_c5 x_v135817 ⇒
      match y_v135815 with
      | O_c4  ⇒ true_c2
      | S_c5 y_v135818 ⇒ ((gten_i5 x_v135817) y_v135818)
      end
    end

def ltn_i6 =
  fn x_v135819 y_v135820 ⇒
    match x_v135819 with
    | O_c4  ⇒
      match y_v135820 with
      | O_c4  ⇒ false_c3 | S_c5 y_v135821 ⇒ true_c2
      end
    | S_c5 x_v135822 ⇒
      match y_v135820 with
      | O_c4  ⇒ false_c3
      | S_c5 y_v135823 ⇒ ((ltn_i6 x_v135822) y_v135823)
      end
    end

def gtn_i7 =
  fn x_v135824 y_v135825 ⇒
    match x_v135824 with
    | O_c4  ⇒ false_c3
    | S_c5 x_v135826 ⇒
      match y_v135825 with
      | O_c4  ⇒ true_c2 | S_c5 y_v135827 ⇒ ((gtn_i7 x_v135826) y_v135827)
      end
    end

def eqn_i8 =
  fn x_v135828 y_v135829 ⇒
    match x_v135828 with
    | O_c4  ⇒
      match y_v135829 with
      | O_c4  ⇒ true_c2 | S_c5 __v135830 ⇒ false_c3
      end
    | S_c5 x_v135831 ⇒
      match y_v135829 with
      | O_c4  ⇒ false_c3
      | S_c5 y_v135832 ⇒ ((eqn_i8 x_v135831) y_v135832)
      end
    end

def pred_i9 =
  fn x_v135833 ⇒
    match x_v135833 with
    | O_c4  ⇒ O_c4 | S_c5 x_v135834 ⇒ x_v135834
    end

def addn_i10 =
  fn x_v135835 y_v135836 ⇒
    match x_v135835 with
    | O_c4  ⇒ y_v135836
    | S_c5 x_v135837 ⇒ (S_c5 ((addn_i10 x_v135837) y_v135836))
    end

def subn_i11 =
  fn x_v135838 y_v135839 ⇒
    match y_v135839 with
    | O_c4  ⇒ x_v135838
    | S_c5 y_v135840 ⇒ ((subn_i11 (pred_i9 x_v135838)) y_v135840)
    end

def muln_i12 =
  fn x_v135841 y_v135842 ⇒
    match x_v135841 with
    | O_c4  ⇒ O_c4
    | S_c5 x_v135843 ⇒
      ((addn_i10 y_v135842) ((muln_i12 x_v135843) y_v135842))
    end

def divn_i13 =
  fn x_v135844 y_v135845 ⇒
    match ((ltn_i6 x_v135844) y_v135845) with
    | true_c2  ⇒ O_c4
    | false_c3  ⇒
      (S_c5 ((divn_i13 ((subn_i11 x_v135844) y_v135845)) y_v135845))
    end

def modn_i14 =
  fn x_v135846 y_v135847 ⇒
    ((subn_i11 x_v135846)
      ((muln_i12 ((divn_i13 x_v135846) y_v135847)) y_v135847))

data ascii_d4 =
| Ascii_c6 of size(8)

data string_d5 =
| EmptyString_c7 of size(0) | String_c8 of size(2)

def cats_i15 =
  fn s1_v135848 s2_v135849 ⇒
    match s1_v135848 with
    | EmptyString_c7  ⇒ s2_v135849
    | String_c8 c_v135850 s1_v135851 ⇒
      (String_c8 c_v135850 ((cats_i15 s1_v135851) s2_v135849))
    end

def strlen_i16 =
  fn s_v135852 ⇒
    match s_v135852 with
    | EmptyString_c7  ⇒ O_c4
    | String_c8 __v135853 s_v135854 ⇒ (S_c5 (strlen_i16 s_v135854))
    end

data listUU_d11 =
| nilUU_c18 of size(0) | consUU_c19 of size(2)

data listUL_d10 =
| nilUL_c16 of size(0) | consUL_c17 of size(2)

data listLU_d9 =
| nilLU_c14 of size(0)

data listLL_d8 =
| nilLL_c12 of size(0) | consLL_c13 of size(2)

def lenUU_i43 =
  fn A_v135855 xs_v135856 ⇒
    match xs_v135856 with
    | nilUU_c18  ⇒ (O_c4, nilUU_c18)
    | consUU_c19 x_v135857 xs_v135858 ⇒
      match ((lenUU_i43 NULL) xs_v135858) with
      | (n_v135859, xs_v135860) ⇒
        ((S_c5 n_v135859), (consUU_c19 x_v135857 xs_v135860))
      end
    end

def lenUL_i42 =
  fn A_v135861 xs_v135862 ⇒
    match xs_v135862 with
    | nilUL_c16  ⇒ (O_c4, nilUL_c16)
    | consUL_c17 x_v135863 xs_v135864 ⇒
      match ((lenUL_i42 NULL) xs_v135864) with
      | (n_v135865, xs_v135866) ⇒
        ((S_c5 n_v135865), (consUL_c17 x_v135863 xs_v135866))
      end
    end

def lenLL_i40 =
  fn A_v135867 xs_v135868 ⇒
    match xs_v135868 with
    | nilLL_c12  ⇒ (O_c4, nilLL_c12)
    | consLL_c13 x_v135869 xs_v135870 ⇒
      match ((lenLL_i40 NULL) xs_v135870) with
      | (n_v135871, xs_v135872) ⇒
        ((S_c5 n_v135871), (consLL_c13 x_v135869 xs_v135872))
      end
    end

def appendUU_i47 =
  fn A_v135873 xs_v135874 ⇒
    ln ys_v135875 ⇒
      match xs_v135874 with
      | nilUU_c18  ⇒ ys_v135875
      | consUU_c19 x_v135876 xs_v135877 ⇒
        (consUU_c19 x_v135876 (((appendUU_i47 NULL) xs_v135877) ys_v135875))
      end

def appendUL_i46 =
  fn A_v135878 xs_v135879 ⇒
    ln ys_v135880 ⇒
      match xs_v135879 with
      | nilUL_c16  ⇒ ys_v135880
      | consUL_c17 x_v135881 xs_v135882 ⇒
        (consUL_c17 x_v135881 (((appendUL_i46 NULL) xs_v135882) ys_v135880))
      end

def appendLL_i44 =
  fn A_v135883 xs_v135884 ⇒
    ln ys_v135885 ⇒
      match xs_v135884 with
      | nilLL_c12  ⇒ ys_v135885
      | consLL_c13 x_v135886 xs_v135887 ⇒
        (consLL_c13 x_v135886 (((appendLL_i44 NULL) xs_v135887) ys_v135885))
      end

def readline_i25 =
  fn __v135888 ⇒
    let ch_v135889 ⇐ open stdin in
    let ch_v135890 ⇐ (send ch_v135889 true_c2) in
    let __v135891 ⇐ recv ch_v135890 in
    match __v135891 with
    | (s_v135892, ch_v135893) ⇒
      let ch_v135894 ⇐ (send ch_v135893 false_c3) in
      let __v135895 ⇐ close⇑ ch_v135894 in return s_v135892
    end

def print_i26 =
  fn s_v135896 ⇒
    let ch_v135897 ⇐ open stdout in
    let ch_v135898 ⇐ (send ch_v135897 true_c2) in
    let ch_v135899 ⇐ (send ch_v135898 s_v135896) in
    let ch_v135900 ⇐ (send ch_v135899 false_c3) in close⇑ ch_v135900

def prerr_i27 =
  fn s_v135901 ⇒
    let ch_v135902 ⇐ open stderr in
    let ch_v135903 ⇐ (send ch_v135902 true_c2) in
    let ch_v135904 ⇐ (send ch_v135903 s_v135901) in
    let ch_v135905 ⇐ (send ch_v135904 false_c3) in close⇑ ch_v135905

def splitU_i49 =
  fn zs_v135906 ⇒
    match zs_v135906 with
    | nilUU_c18  ⇒ (nilUU_c18, nilUU_c18)
    | consUU_c19 x_v135907 zs_v135908 ⇒
      match zs_v135908 with
      | nilUU_c18  ⇒ ((consUU_c19 x_v135907 nilUU_c18), nilUU_c18)
      | consUU_c19 y_v135909 zs_v135910 ⇒
        let __v135911 = (splitU_i49 zs_v135910) in
        match __v135911 with
        | (xs_v135912, ys_v135913) ⇒
          ((consUU_c19 x_v135907 xs_v135912), (consUU_c19
                                                y_v135909 ys_v135913))
        end
      end
    end

def splitL_i48 =
  fn zs_v135914 ⇒
    match zs_v135914 with
    | nilUL_c16  ⇒ (nilUL_c16, nilUL_c16)
    | consUL_c17 x_v135915 zs_v135916 ⇒
      match zs_v135916 with
      | nilUL_c16  ⇒ ((consUL_c17 x_v135915 nilUL_c16), nilUL_c16)
      | consUL_c17 y_v135917 zs_v135918 ⇒
        let __v135919 = (splitL_i48 zs_v135918) in
        match __v135919 with
        | (xs_v135920, ys_v135921) ⇒
          ((consUL_c17 x_v135915 xs_v135920), (consUL_c17
                                                y_v135917 ys_v135921))
        end
      end
    end

def mergeU_i51 =
  fn xs_v135922 ⇒
    ln ys_v135923 ⇒
      match xs_v135922 with
      | nilUU_c18  ⇒ ys_v135923
      | consUU_c19 x_v135924 xs0_v135925 ⇒
        match ys_v135923 with
        | nilUU_c18  ⇒ (consUU_c19 x_v135924 xs0_v135925)
        | consUU_c19 y_v135926 ys0_v135927 ⇒
          match ((lten_i4 x_v135924) y_v135926) with
          | true_c2  ⇒
            (consUU_c19
              x_v135924
              ((mergeU_i51 xs0_v135925) (consUU_c19 y_v135926 ys0_v135927)))
          | false_c3  ⇒
            (consUU_c19
              y_v135926
              ((mergeU_i51 (consUU_c19 x_v135924 xs0_v135925)) ys0_v135927))
          end
        end
      end

def mergeL_i50 =
  fn xs_v135928 ⇒
    ln ys_v135929 ⇒
      match xs_v135928 with
      | nilUL_c16  ⇒ ys_v135929
      | consUL_c17 x_v135930 xs0_v135931 ⇒
        match ys_v135929 with
        | nilUL_c16  ⇒ (consUL_c17 x_v135930 xs0_v135931)
        | consUL_c17 y_v135932 ys0_v135933 ⇒
          match ((lten_i4 x_v135930) y_v135932) with
          | true_c2  ⇒
            (consUL_c17
              x_v135930
              ((mergeL_i50 xs0_v135931) (consUL_c17 y_v135932 ys0_v135933)))
          | false_c3  ⇒
            (consUL_c17
              y_v135932
              ((mergeL_i50 (consUL_c17 x_v135930 xs0_v135931)) ys0_v135933))
          end
        end
      end

def msortU_i53 =
  fn zs_v135934 ⇒
    match zs_v135934 with
    | nilUU_c18  ⇒ nilUU_c18
    | consUU_c19 x_v135935 zs_v135936 ⇒
      match zs_v135936 with
      | nilUU_c18  ⇒ (consUU_c19 x_v135935 nilUU_c18)
      | consUU_c19 y_v135937 zs_v135938 ⇒
        let __v135939 =
          (splitU_i49
            (consUU_c19 x_v135935 (consUU_c19 y_v135937 zs_v135938)))
        in
        match __v135939 with
        | (xs_v135940, ys_v135941) ⇒
          ((mergeU_i51 (msortU_i53 xs_v135940)) (msortU_i53 ys_v135941))
        end
      end
    end

def msortL_i52 =
  fn zs_v135942 ⇒
    match zs_v135942 with
    | nilUL_c16  ⇒ nilUL_c16
    | consUL_c17 x_v135943 zs_v135944 ⇒
      match zs_v135944 with
      | nilUL_c16  ⇒ (consUL_c17 x_v135943 nilUL_c16)
      | consUL_c17 y_v135945 zs_v135946 ⇒
        let __v135947 =
          (splitL_i48
            (consUL_c17 x_v135943 (consUL_c17 y_v135945 zs_v135946)))
        in
        match __v135947 with
        | (xs_v135948, ys_v135949) ⇒
          ((mergeL_i50 (msortL_i52 xs_v135948)) (msortL_i52 ys_v135949))
        end
      end
    end

data uniqU_d13 =
| UniqU_c21 of size(2)

data uniqL_d12 =
| UniqL_c20 of size(2)

def cmsort_workerU_i57 =
  fn zs_v135950 ⇒
    ln c_v135951 ⇒
      (match zs_v135950 with
       | nilUU_c18  ⇒
         ln c_v135952 ⇒
           let c_v135953 ⇐ (send c_v135952 (UniqU_c21 nilUU_c18 NULL)) in
           close⇑ c_v135953
       | consUU_c19 z0_v135954 zs0_v135955 ⇒
         ln c_v135956 ⇒
           (match zs0_v135955 with
            | nilUU_c18  ⇒
              ln c_v135957 ⇒
                let c_v135958 ⇐
                  (send c_v135957
                    (UniqU_c21 (consUU_c19 z0_v135954 nilUU_c18) NULL))
                in close⇑ c_v135958
            | consUU_c19 z1_v135959 zs1_v135960 ⇒
              ln c_v135961 ⇒
                (match (splitU_i49
                         (consUU_c19
                           z0_v135954 (consUU_c19 z1_v135959 zs1_v135960))) with
                 | (xs0_v135962, ys0_v135963) ⇒
                   ln e_v135964 ⇒
                     let r1_v135965 ⇐
                       fork r1_v135966 in
                         ((cmsort_workerU_i57 xs0_v135962) r1_v135966)
                     in
                     let r2_v135967 ⇐
                       fork r2_v135968 in
                         ((cmsort_workerU_i57 ys0_v135963) r2_v135968)
                     in
                     let __v135969 ⇐ recv r1_v135965 in
                     match __v135969 with
                     | (msg1_v135970, r1_v135971) ⇒
                       let __v135972 ⇐ recv r2_v135967 in
                       match __v135972 with
                       | (msg2_v135973, r2_v135974) ⇒
                         match msg1_v135970 with
                         | UniqU_c21 xs1_v135975 pf1_v135976 ⇒
                           match msg2_v135973 with
                           | UniqU_c21 xs2_v135977 pf2_v135978 ⇒
                             let zs_v135979 =
                               ((mergeU_i51 xs1_v135975) xs2_v135977)
                             in
                             let c_v135980 ⇐
                               (send c_v135961 (UniqU_c21 zs_v135979 NULL))
                             in
                             let __v135981 ⇐ close⇓ r1_v135971 in
                             let __v135982 ⇐ close⇓ r2_v135974 in
                             close⇑ c_v135980
                           end
                         end
                       end
                     end
                 end NULL)
            end c_v135956)
       end c_v135951)

def cmsort_workerL_i56 =
  fn zs_v135983 ⇒
    ln c_v135984 ⇒
      (match zs_v135983 with
       | nilUL_c16  ⇒
         ln c_v135985 ⇒
           let c_v135986 ⇐ (send c_v135985 (UniqL_c20 nilUL_c16 NULL)) in
           close⇑ c_v135986
       | consUL_c17 z0_v135987 zs0_v135988 ⇒
         ln c_v135989 ⇒
           (match zs0_v135988 with
            | nilUL_c16  ⇒
              ln c_v135990 ⇒
                let c_v135991 ⇐
                  (send c_v135990
                    (UniqL_c20 (consUL_c17 z0_v135987 nilUL_c16) NULL))
                in close⇑ c_v135991
            | consUL_c17 z1_v135992 zs1_v135993 ⇒
              ln c_v135994 ⇒
                (match (splitL_i48
                         (consUL_c17
                           z0_v135987 (consUL_c17 z1_v135992 zs1_v135993))) with
                 | (xs0_v135995, ys0_v135996) ⇒
                   ln e_v135997 ⇒
                     let r1_v135998 ⇐
                       fork r1_v135999 in
                         ((cmsort_workerL_i56 xs0_v135995) r1_v135999)
                     in
                     let r2_v136000 ⇐
                       fork r2_v136001 in
                         ((cmsort_workerL_i56 ys0_v135996) r2_v136001)
                     in
                     let __v136002 ⇐ recv r1_v135998 in
                     match __v136002 with
                     | (msg1_v136003, r1_v136004) ⇒
                       let __v136005 ⇐ recv r2_v136000 in
                       match __v136005 with
                       | (msg2_v136006, r2_v136007) ⇒
                         match msg1_v136003 with
                         | UniqL_c20 xs1_v136008 pf1_v136009 ⇒
                           match msg2_v136006 with
                           | UniqL_c20 xs2_v136010 pf2_v136011 ⇒
                             let zs_v136012 =
                               ((mergeL_i50 xs1_v136008) xs2_v136010)
                             in
                             let c_v136013 ⇐
                               (send c_v135994 (UniqL_c20 zs_v136012 NULL))
                             in
                             let __v136014 ⇐ close⇓ r1_v136004 in
                             let __v136015 ⇐ close⇓ r2_v136007 in
                             close⇑ c_v136013
                           end
                         end
                       end
                     end
                 end NULL)
            end c_v135989)
       end c_v135984)

def cmsortU_i59 =
  fn zs_v136016 ⇒
    let c_v136017 ⇐
      fork c_v136018 in ((cmsort_workerU_i57 zs_v136016) c_v136018)
    in
    let __v136019 ⇐ recv c_v136017 in
    match __v136019 with
    | (msg_v136020, c_v136021) ⇒
      let __v136022 ⇐ close⇓ c_v136021 in return msg_v136020
    end

def cmsortL_i58 =
  fn zs_v136023 ⇒
    let c_v136024 ⇐
      fork c_v136025 in ((cmsort_workerL_i56 zs_v136023) c_v136025)
    in
    let __v136026 ⇐ recv c_v136024 in
    match __v136026 with
    | (msg_v136027, c_v136028) ⇒
      let __v136029 ⇐ close⇓ c_v136028 in return msg_v136027
    end

def digits_i34 =
  (consUU_c19
    "0"
    (consUU_c19
      "1"
      (consUU_c19
        "2"
        (consUU_c19
          "3"
          (consUU_c19
            "4"
            (consUU_c19
              "5"
              (consUU_c19
                "6"
                (consUU_c19 "7" (consUU_c19 "8" (consUU_c19 "9" nilUU_c18))))))))))

def get_at_i35 =
  fn A_v136030 n_v136031 xs_v136032 a_v136033 ⇒
    match n_v136031 with
    | O_c4  ⇒
      match xs_v136032 with
      | nilUU_c18  ⇒ a_v136033
      | consUU_c19 x_v136034 __v136035 ⇒ x_v136034
      end
    | S_c5 n_v136036 ⇒
      match xs_v136032 with
      | nilUU_c18  ⇒ a_v136033
      | consUU_c19 __v136037 xs_v136038 ⇒
        ((((get_at_i35 NULL) n_v136036) xs_v136038) a_v136033)
      end
    end

def string_of_digit_i36 =
  fn n_v136039 ⇒
    ((((get_at_i35 NULL) n_v136039) digits_i34) EmptyString_c7)

def string_of_nat_i37 =
  fn n_v136040 ⇒
    let s_v136041 = (string_of_digit_i36 ((modn_i14 n_v136040) 10)) in
    let n_v136042 = ((divn_i13 n_v136040) 10) in
    match ((ltn_i6 O_c4) n_v136042) with
    | true_c2  ⇒ ((cats_i15 (string_of_nat_i37 n_v136042)) s_v136041)
    | false_c3  ⇒ s_v136041
    end

def string_of_listU_i61 =
  fn xs_v136043 ⇒
    match xs_v136043 with
    | nilUU_c18  ⇒ "nil"
    | consUU_c19 x_v136044 xs_v136045 ⇒
      ((cats_i15 ((cats_i15 (string_of_nat_i37 x_v136044)) " :: "))
        (string_of_listU_i61 xs_v136045))
    end

def string_of_listL_i60 =
  fn xs_v136046 ⇒
    match xs_v136046 with
    | nilUL_c16  ⇒ "nil"
    | consUL_c17 x_v136047 xs_v136048 ⇒
      ((cats_i15 ((cats_i15 (string_of_nat_i37 x_v136047)) " :: "))
        (string_of_listL_i60 xs_v136048))
    end

main =
  let test1_v136049 =
    (consUU_c19
      5
      (consUU_c19
        2
        (consUU_c19
          1 (consUU_c19 6 (consUU_c19 O_c4 (consUU_c19 3 nilUU_c18))))))
  in
  let test2_v136050 =
    (consUL_c17
      3
      (consUL_c17
        O_c4
        (consUL_c17 6 (consUL_c17 1 (consUL_c17 2 (consUL_c17 5 nilUL_c16))))))
  in
  let msg1_v136051 ⇐ (cmsortU_i59 test1_v136049) in
  let msg2_v136052 ⇐ (cmsortL_i58 test2_v136050) in
  match msg1_v136051 with
  | UniqU_c21 sorted1_v136053 __v136054 ⇒
    match msg2_v136052 with
    | UniqL_c20 sorted2_v136055 __v136056 ⇒
      let __v136057 ⇐
        (print_i26 ((cats_i15 (string_of_listU_i61 sorted1_v136053)) "\n"))
      in (print_i26 ((cats_i15 (string_of_listL_i60 sorted2_v136055)) "\n"))
    end
  end

trans12 success--------------------------

fun andb_i1(b1_v136393, b2_v136394) =
  match b1_v136393 with
  | true_c2  ⇒ b2_v136394 | false_c3  ⇒ false_c3
  end

val andbclo_i62 =
  fn b1_v136395 b2_v136396 ⇒ andb_i1(b1_v136395, b2_v136396)

fun orb_i2(b1_v136397, b2_v136398) =
  match b1_v136397 with
  | true_c2  ⇒ true_c2 | false_c3  ⇒ b2_v136398
  end

val orbclo_i63 = fn b1_v136399 b2_v136400 ⇒ orb_i2(b1_v136399, b2_v136400)

fun notb_i3(b_v136401) =
  match b_v136401 with
  | true_c2  ⇒ false_c3 | false_c3  ⇒ true_c2
  end

val notbclo_i64 = fn b_v136402 ⇒ notb_i3(b_v136402)

fun lten_i4(x_v136403, y_v136404) =
  match x_v136403 with
  | O_c4  ⇒ true_c2
  | S_c5 x_v136405 ⇒
    match y_v136404 with
    | O_c4  ⇒ false_c3 | S_c5 y_v136406 ⇒ lten_i4(x_v136405, y_v136406)
    end
  end

val ltenclo_i65 = fn x_v136407 y_v136408 ⇒ lten_i4(x_v136407, y_v136408)

fun gten_i5(x_v136409, y_v136410) =
  match x_v136409 with
  | O_c4  ⇒
    match y_v136410 with
    | O_c4  ⇒ true_c2 | S_c5 __v136411 ⇒ false_c3
    end
  | S_c5 x_v136412 ⇒
    match y_v136410 with
    | O_c4  ⇒ true_c2 | S_c5 y_v136413 ⇒ gten_i5(x_v136412, y_v136413)
    end
  end

val gtenclo_i66 = fn x_v136414 y_v136415 ⇒ gten_i5(x_v136414, y_v136415)

fun ltn_i6(x_v136416, y_v136417) =
  match x_v136416 with
  | O_c4  ⇒
    match y_v136417 with
    | O_c4  ⇒ false_c3 | S_c5 y_v136418 ⇒ true_c2
    end
  | S_c5 x_v136419 ⇒
    match y_v136417 with
    | O_c4  ⇒ false_c3 | S_c5 y_v136420 ⇒ ltn_i6(x_v136419, y_v136420)
    end
  end

val ltnclo_i67 = fn x_v136421 y_v136422 ⇒ ltn_i6(x_v136421, y_v136422)

fun gtn_i7(x_v136423, y_v136424) =
  match x_v136423 with
  | O_c4  ⇒ false_c3
  | S_c5 x_v136425 ⇒
    match y_v136424 with
    | O_c4  ⇒ true_c2 | S_c5 y_v136426 ⇒ gtn_i7(x_v136425, y_v136426)
    end
  end

val gtnclo_i68 = fn x_v136427 y_v136428 ⇒ gtn_i7(x_v136427, y_v136428)

fun eqn_i8(x_v136429, y_v136430) =
  match x_v136429 with
  | O_c4  ⇒
    match y_v136430 with
    | O_c4  ⇒ true_c2 | S_c5 __v136431 ⇒ false_c3
    end
  | S_c5 x_v136432 ⇒
    match y_v136430 with
    | O_c4  ⇒ false_c3 | S_c5 y_v136433 ⇒ eqn_i8(x_v136432, y_v136433)
    end
  end

val eqnclo_i69 = fn x_v136434 y_v136435 ⇒ eqn_i8(x_v136434, y_v136435)

fun pred_i9(x_v136436) =
  match x_v136436 with
  | O_c4  ⇒ O_c4 | S_c5 x_v136437 ⇒ x_v136437
  end

val predclo_i70 = fn x_v136438 ⇒ pred_i9(x_v136438)

fun addn_i10(x_v136439, y_v136440) =
  match x_v136439 with
  | O_c4  ⇒ y_v136440
  | S_c5 x_v136441 ⇒ (S_c5 addn_i10(x_v136441, y_v136440))
  end

val addnclo_i71 = fn x_v136442 y_v136443 ⇒ addn_i10(x_v136442, y_v136443)

fun subn_i11(x_v136444, y_v136445) =
  match y_v136445 with
  | O_c4  ⇒ x_v136444
  | S_c5 y_v136446 ⇒ subn_i11(pred_i9(x_v136444), y_v136446)
  end

val subnclo_i72 = fn x_v136447 y_v136448 ⇒ subn_i11(x_v136447, y_v136448)

fun muln_i12(x_v136449, y_v136450) =
  match x_v136449 with
  | O_c4  ⇒ O_c4
  | S_c5 x_v136451 ⇒ addn_i10(y_v136450, muln_i12(x_v136451, y_v136450))
  end

val mulnclo_i73 = fn x_v136452 y_v136453 ⇒ muln_i12(x_v136452, y_v136453)

fun divn_i13(x_v136454, y_v136455) =
  match ltn_i6(x_v136454, y_v136455) with
  | true_c2  ⇒ O_c4
  | false_c3  ⇒ (S_c5 divn_i13(subn_i11(x_v136454, y_v136455), y_v136455))
  end

val divnclo_i74 = fn x_v136456 y_v136457 ⇒ divn_i13(x_v136456, y_v136457)

fun modn_i14(x_v136458, y_v136459) =
  subn_i11(x_v136458, muln_i12(divn_i13(x_v136458, y_v136459), y_v136459))

val modnclo_i75 = fn x_v136460 y_v136461 ⇒ modn_i14(x_v136460, y_v136461)

fun cats_i15(s1_v136462, s2_v136463) =
  match s1_v136462 with
  | EmptyString_c7  ⇒ s2_v136463
  | String_c8 c_v136464 s1_v136465 ⇒
    (String_c8 c_v136464 cats_i15(s1_v136465, s2_v136463))
  end

val catsclo_i76 =
  fn s1_v136466 s2_v136467 ⇒ cats_i15(s1_v136466, s2_v136467)

fun strlen_i16(s_v136468) =
  match s_v136468 with
  | EmptyString_c7  ⇒ O_c4
  | String_c8 __v136469 s_v136470 ⇒ (S_c5 strlen_i16(s_v136470))
  end

val strlenclo_i77 = fn s_v136471 ⇒ strlen_i16(s_v136471)

fun lenUU_i43(A_v136472, xs_v136473) =
  match xs_v136473 with
  | nilUU_c18  ⇒ (O_c4, nilUU_c18)
  | consUU_c19 x_v136474 xs_v136475 ⇒
    match lenUU_i43(NULL, xs_v136475) with
    | (n_v136476, xs_v136477) ⇒
      ((S_c5 n_v136476), (consUU_c19 x_v136474 xs_v136477))
    end
  end

val lenUUclo_i78 =
  fn A_v136478 xs_v136479 ⇒ lenUU_i43(A_v136478, xs_v136479)

fun lenUL_i42(A_v136480, xs_v136481) =
  match xs_v136481 with
  | nilUL_c16  ⇒ (O_c4, nilUL_c16)
  | consUL_c17 x_v136482 xs_v136483 ⇒
    match lenUL_i42(NULL, xs_v136483) with
    | (n_v136484, xs_v136485) ⇒
      ((S_c5 n_v136484), (consUL_c17 x_v136482 xs_v136485))
    end
  end

val lenULclo_i79 =
  fn A_v136486 xs_v136487 ⇒ lenUL_i42(A_v136486, xs_v136487)

fun lenLL_i40(A_v136488, xs_v136489) =
  match xs_v136489 with
  | nilLL_c12  ⇒ (O_c4, nilLL_c12)
  | consLL_c13 x_v136490 xs_v136491 ⇒
    match lenLL_i40(NULL, xs_v136491) with
    | (n_v136492, xs_v136493) ⇒
      ((S_c5 n_v136492), (consLL_c13 x_v136490 xs_v136493))
    end
  end

val lenLLclo_i80 =
  fn A_v136494 xs_v136495 ⇒ lenLL_i40(A_v136494, xs_v136495)

fun appendUU_i47(A_v136496, xs_v136497, ys_v136498) =
  match xs_v136497 with
  | nilUU_c18  ⇒ ys_v136498
  | consUU_c19 x_v136499 xs_v136500 ⇒
    (consUU_c19 x_v136499 appendUU_i47(NULL, xs_v136500, ys_v136498))
  end

val appendUUclo_i81 =
  fn A_v136501 xs_v136502 ⇒
    ln ys_v136503 ⇒ appendUU_i47(A_v136501, xs_v136502, ys_v136503)

fun appendUL_i46(A_v136504, xs_v136505, ys_v136506) =
  match xs_v136505 with
  | nilUL_c16  ⇒ ys_v136506
  | consUL_c17 x_v136507 xs_v136508 ⇒
    (consUL_c17 x_v136507 appendUL_i46(NULL, xs_v136508, ys_v136506))
  end

val appendULclo_i82 =
  fn A_v136509 xs_v136510 ⇒
    ln ys_v136511 ⇒ appendUL_i46(A_v136509, xs_v136510, ys_v136511)

fun appendLL_i44(A_v136512, xs_v136513, ys_v136514) =
  match xs_v136513 with
  | nilLL_c12  ⇒ ys_v136514
  | consLL_c13 x_v136515 xs_v136516 ⇒
    (consLL_c13 x_v136515 appendLL_i44(NULL, xs_v136516, ys_v136514))
  end

val appendLLclo_i83 =
  fn A_v136517 xs_v136518 ⇒
    ln ys_v136519 ⇒ appendLL_i44(A_v136517, xs_v136518, ys_v136519)

fun readline_i25(__v136520) =
  ln __v136521 ⇒
    let ch_v136522 = (ln __v136523 ⇒ open stdin) NULL in
    let ch_v136524 =
      ((fn x_v136525 ⇒ ln __v136526 ⇒ send(ch_v136522, x_v136525))
         true_c2)
        NULL
    in
    let __v136527 = (ln __v136528 ⇒ recv(ch_v136524)) NULL in
    (match __v136527 with
     | (s_v136529, ch_v136530) ⇒
       ln __v136531 ⇒
         let ch_v136532 =
           ((fn x_v136533 ⇒ ln __v136534 ⇒ send(ch_v136530, x_v136533))
              false_c3)
             NULL
         in
         let __v136535 =
           (ln __v136536 ⇒ let __v136537 = ch_v136532 in tt_c1) NULL
         in (ln __v136538 ⇒ s_v136529) NULL
     end) NULL

val readlineclo_i84 = fn __v136539 ⇒ readline_i25(__v136539)

fun print_i26(s_v136540) =
  ln __v136541 ⇒
    let ch_v136542 = (ln __v136543 ⇒ open stdout) NULL in
    let ch_v136544 =
      ((fn x_v136545 ⇒ ln __v136546 ⇒ send(ch_v136542, x_v136545))
         true_c2)
        NULL
    in
    let ch_v136547 =
      ((fn x_v136548 ⇒ ln __v136549 ⇒ send(ch_v136544, x_v136548))
         s_v136540)
        NULL
    in
    let ch_v136550 =
      ((fn x_v136551 ⇒ ln __v136552 ⇒ send(ch_v136547, x_v136551))
         false_c3)
        NULL
    in (ln __v136553 ⇒ let __v136554 = ch_v136550 in tt_c1) NULL

val printclo_i85 = fn s_v136555 ⇒ print_i26(s_v136555)

fun prerr_i27(s_v136556) =
  ln __v136557 ⇒
    let ch_v136558 = (ln __v136559 ⇒ open stderr) NULL in
    let ch_v136560 =
      ((fn x_v136561 ⇒ ln __v136562 ⇒ send(ch_v136558, x_v136561))
         true_c2)
        NULL
    in
    let ch_v136563 =
      ((fn x_v136564 ⇒ ln __v136565 ⇒ send(ch_v136560, x_v136564))
         s_v136556)
        NULL
    in
    let ch_v136566 =
      ((fn x_v136567 ⇒ ln __v136568 ⇒ send(ch_v136563, x_v136567))
         false_c3)
        NULL
    in (ln __v136569 ⇒ let __v136570 = ch_v136566 in tt_c1) NULL

val prerrclo_i86 = fn s_v136571 ⇒ prerr_i27(s_v136571)

fun splitU_i49(zs_v136572) =
  match zs_v136572 with
  | nilUU_c18  ⇒ (nilUU_c18, nilUU_c18)
  | consUU_c19 x_v136573 zs_v136574 ⇒
    match zs_v136574 with
    | nilUU_c18  ⇒ ((consUU_c19 x_v136573 nilUU_c18), nilUU_c18)
    | consUU_c19 y_v136575 zs_v136576 ⇒
      let __v136577 = splitU_i49(zs_v136576) in
      match __v136577 with
      | (xs_v136578, ys_v136579) ⇒
        ((consUU_c19 x_v136573 xs_v136578), (consUU_c19 y_v136575 ys_v136579))
      end
    end
  end

val splitUclo_i87 = fn zs_v136580 ⇒ splitU_i49(zs_v136580)

fun splitL_i48(zs_v136581) =
  match zs_v136581 with
  | nilUL_c16  ⇒ (nilUL_c16, nilUL_c16)
  | consUL_c17 x_v136582 zs_v136583 ⇒
    match zs_v136583 with
    | nilUL_c16  ⇒ ((consUL_c17 x_v136582 nilUL_c16), nilUL_c16)
    | consUL_c17 y_v136584 zs_v136585 ⇒
      let __v136586 = splitL_i48(zs_v136585) in
      match __v136586 with
      | (xs_v136587, ys_v136588) ⇒
        ((consUL_c17 x_v136582 xs_v136587), (consUL_c17 y_v136584 ys_v136588))
      end
    end
  end

val splitLclo_i88 = fn zs_v136589 ⇒ splitL_i48(zs_v136589)

fun mergeU_i51(xs_v136590, ys_v136591) =
  match xs_v136590 with
  | nilUU_c18  ⇒ ys_v136591
  | consUU_c19 x_v136592 xs0_v136593 ⇒
    match ys_v136591 with
    | nilUU_c18  ⇒ (consUU_c19 x_v136592 xs0_v136593)
    | consUU_c19 y_v136594 ys0_v136595 ⇒
      match lten_i4(x_v136592, y_v136594) with
      | true_c2  ⇒
        (consUU_c19
          x_v136592
          mergeU_i51(xs0_v136593, (consUU_c19 y_v136594 ys0_v136595)))
      | false_c3  ⇒
        (consUU_c19
          y_v136594
          mergeU_i51((consUU_c19 x_v136592 xs0_v136593), ys0_v136595))
      end
    end
  end

val mergeUclo_i89 =
  fn xs_v136596 ⇒ ln ys_v136597 ⇒ mergeU_i51(xs_v136596, ys_v136597)

fun mergeL_i50(xs_v136598, ys_v136599) =
  match xs_v136598 with
  | nilUL_c16  ⇒ ys_v136599
  | consUL_c17 x_v136600 xs0_v136601 ⇒
    match ys_v136599 with
    | nilUL_c16  ⇒ (consUL_c17 x_v136600 xs0_v136601)
    | consUL_c17 y_v136602 ys0_v136603 ⇒
      match lten_i4(x_v136600, y_v136602) with
      | true_c2  ⇒
        (consUL_c17
          x_v136600
          mergeL_i50(xs0_v136601, (consUL_c17 y_v136602 ys0_v136603)))
      | false_c3  ⇒
        (consUL_c17
          y_v136602
          mergeL_i50((consUL_c17 x_v136600 xs0_v136601), ys0_v136603))
      end
    end
  end

val mergeLclo_i90 =
  fn xs_v136604 ⇒ ln ys_v136605 ⇒ mergeL_i50(xs_v136604, ys_v136605)

fun msortU_i53(zs_v136606) =
  match zs_v136606 with
  | nilUU_c18  ⇒ nilUU_c18
  | consUU_c19 x_v136607 zs_v136608 ⇒
    match zs_v136608 with
    | nilUU_c18  ⇒ (consUU_c19 x_v136607 nilUU_c18)
    | consUU_c19 y_v136609 zs_v136610 ⇒
      let __v136611 =
        splitU_i49((consUU_c19 x_v136607 (consUU_c19 y_v136609 zs_v136610)))
      in
      match __v136611 with
      | (xs_v136612, ys_v136613) ⇒
        mergeU_i51(msortU_i53(xs_v136612), msortU_i53(ys_v136613))
      end
    end
  end

val msortUclo_i91 = fn zs_v136614 ⇒ msortU_i53(zs_v136614)

fun msortL_i52(zs_v136615) =
  match zs_v136615 with
  | nilUL_c16  ⇒ nilUL_c16
  | consUL_c17 x_v136616 zs_v136617 ⇒
    match zs_v136617 with
    | nilUL_c16  ⇒ (consUL_c17 x_v136616 nilUL_c16)
    | consUL_c17 y_v136618 zs_v136619 ⇒
      let __v136620 =
        splitL_i48((consUL_c17 x_v136616 (consUL_c17 y_v136618 zs_v136619)))
      in
      match __v136620 with
      | (xs_v136621, ys_v136622) ⇒
        mergeL_i50(msortL_i52(xs_v136621), msortL_i52(ys_v136622))
      end
    end
  end

val msortLclo_i92 = fn zs_v136623 ⇒ msortL_i52(zs_v136623)

fun cmsort_workerU_i57(zs_v136624, c_v136625) =
  (match zs_v136624 with
   | nilUU_c18  ⇒
     ln c_v136626 __v136627 ⇒
       let c_v136628 =
         ((fn x_v136629 ⇒ ln __v136630 ⇒ send(c_v136626, x_v136629))
            (UniqU_c21 nilUU_c18 NULL))
           NULL
       in (ln __v136631 ⇒ let __v136632 = c_v136628 in tt_c1) NULL
   | consUU_c19 z0_v136633 zs0_v136634 ⇒
     ln c_v136635 ⇒
       (match zs0_v136634 with
        | nilUU_c18  ⇒
          ln c_v136636 __v136637 ⇒
            let c_v136638 =
              ((fn x_v136639 ⇒ ln __v136640 ⇒ send(c_v136636, x_v136639))
                 (UniqU_c21 (consUU_c19 z0_v136633 nilUU_c18) NULL))
                NULL
            in (ln __v136641 ⇒ let __v136642 = c_v136638 in tt_c1) NULL
        | consUU_c19 z1_v136643 zs1_v136644 ⇒
          ln c_v136645 ⇒
            (match splitU_i49((consUU_c19
                                z0_v136633
                                (consUU_c19 z1_v136643 zs1_v136644))) with
             | (xs0_v136646, ys0_v136647) ⇒
               ln e_v136648 __v136649 ⇒
                 let r1_v136650 =
                   (ln __v136651 ⇒
                      fork r1_v136652 in
                        (cmsort_workerU_i57(xs0_v136646, r1_v136652)) NULL)
                     NULL
                 in
                 let r2_v136653 =
                   (ln __v136654 ⇒
                      fork r2_v136655 in
                        (cmsort_workerU_i57(ys0_v136647, r2_v136655)) NULL)
                     NULL
                 in
                 let __v136656 = (ln __v136657 ⇒ recv(r1_v136650)) NULL in
                 (match __v136656 with
                  | (msg1_v136658, r1_v136659) ⇒
                    ln __v136660 ⇒
                      let __v136661 =
                        (ln __v136662 ⇒ recv(r2_v136653)) NULL
                      in
                      (match __v136661 with
                       | (msg2_v136663, r2_v136664) ⇒
                         match msg1_v136658 with
                         | UniqU_c21 xs1_v136665 pf1_v136666 ⇒
                           match msg2_v136663 with
                           | UniqU_c21 xs2_v136667 pf2_v136668 ⇒
                             let zs_v136669 =
                               mergeU_i51(xs1_v136665, xs2_v136667)
                             in
                             ln __v136670 ⇒
                               let c_v136671 =
                                 ((fn x_v136672 ⇒
                                     ln __v136673 ⇒
                                       send(c_v136645, x_v136672))
                                    (UniqU_c21 zs_v136669 NULL))
                                   NULL
                               in
                               let __v136674 =
                                 (ln __v136675 ⇒ close(r1_v136659)) NULL
                               in
                               let __v136676 =
                                 (ln __v136677 ⇒ close(r2_v136664)) NULL
                               in
                               (ln __v136678 ⇒
                                  let __v136679 = c_v136671 in tt_c1)
                                 NULL
                           end
                         end
                       end) NULL
                  end) NULL
             end) NULL
        end) c_v136635
   end) c_v136625

val cmsort_workerUclo_i93 =
  fn zs_v136680 ⇒
    ln c_v136681 ⇒ cmsort_workerU_i57(zs_v136680, c_v136681)

fun cmsort_workerL_i56(zs_v136682, c_v136683) =
  (match zs_v136682 with
   | nilUL_c16  ⇒
     ln c_v136684 __v136685 ⇒
       let c_v136686 =
         ((ln x_v136687 __v136688 ⇒ send(c_v136684, x_v136687))
            (UniqL_c20 nilUL_c16 NULL))
           NULL
       in (ln __v136689 ⇒ let __v136690 = c_v136686 in tt_c1) NULL
   | consUL_c17 z0_v136691 zs0_v136692 ⇒
     ln c_v136693 ⇒
       (match zs0_v136692 with
        | nilUL_c16  ⇒
          ln c_v136694 __v136695 ⇒
            let c_v136696 =
              ((ln x_v136697 __v136698 ⇒ send(c_v136694, x_v136697))
                 (UniqL_c20 (consUL_c17 z0_v136691 nilUL_c16) NULL))
                NULL
            in (ln __v136699 ⇒ let __v136700 = c_v136696 in tt_c1) NULL
        | consUL_c17 z1_v136701 zs1_v136702 ⇒
          ln c_v136703 ⇒
            (match splitL_i48((consUL_c17
                                z0_v136691
                                (consUL_c17 z1_v136701 zs1_v136702))) with
             | (xs0_v136704, ys0_v136705) ⇒
               ln e_v136706 __v136707 ⇒
                 let r1_v136708 =
                   (ln __v136709 ⇒
                      fork r1_v136710 in
                        (cmsort_workerL_i56(xs0_v136704, r1_v136710)) NULL)
                     NULL
                 in
                 let r2_v136711 =
                   (ln __v136712 ⇒
                      fork r2_v136713 in
                        (cmsort_workerL_i56(ys0_v136705, r2_v136713)) NULL)
                     NULL
                 in
                 let __v136714 = (ln __v136715 ⇒ recv(r1_v136708)) NULL in
                 (match __v136714 with
                  | (msg1_v136716, r1_v136717) ⇒
                    ln __v136718 ⇒
                      let __v136719 =
                        (ln __v136720 ⇒ recv(r2_v136711)) NULL
                      in
                      (match __v136719 with
                       | (msg2_v136721, r2_v136722) ⇒
                         match msg1_v136716 with
                         | UniqL_c20 xs1_v136723 pf1_v136724 ⇒
                           match msg2_v136721 with
                           | UniqL_c20 xs2_v136725 pf2_v136726 ⇒
                             let zs_v136727 =
                               mergeL_i50(xs1_v136723, xs2_v136725)
                             in
                             ln __v136728 ⇒
                               let c_v136729 =
                                 ((ln x_v136730 __v136731 ⇒
                                     send(c_v136703, x_v136730))
                                    (UniqL_c20 zs_v136727 NULL))
                                   NULL
                               in
                               let __v136732 =
                                 (ln __v136733 ⇒ close(r1_v136717)) NULL
                               in
                               let __v136734 =
                                 (ln __v136735 ⇒ close(r2_v136722)) NULL
                               in
                               (ln __v136736 ⇒
                                  let __v136737 = c_v136729 in tt_c1)
                                 NULL
                           end
                         end
                       end) NULL
                  end) NULL
             end) NULL
        end) c_v136693
   end) c_v136683

val cmsort_workerLclo_i94 =
  fn zs_v136738 ⇒
    ln c_v136739 ⇒ cmsort_workerL_i56(zs_v136738, c_v136739)

fun cmsortU_i59(zs_v136740) =
  ln __v136741 ⇒
    let c_v136742 =
      (ln __v136743 ⇒
         fork c_v136744 in (cmsort_workerU_i57(zs_v136740, c_v136744)) NULL)
        NULL
    in
    let __v136745 = (ln __v136746 ⇒ recv(c_v136742)) NULL in
    (match __v136745 with
     | (msg_v136747, c_v136748) ⇒
       ln __v136749 ⇒
         let __v136750 = (ln __v136751 ⇒ close(c_v136748)) NULL in
         (ln __v136752 ⇒ msg_v136747) NULL
     end) NULL

val cmsortUclo_i95 = fn zs_v136753 ⇒ cmsortU_i59(zs_v136753)

fun cmsortL_i58(zs_v136754) =
  ln __v136755 ⇒
    let c_v136756 =
      (ln __v136757 ⇒
         fork c_v136758 in (cmsort_workerL_i56(zs_v136754, c_v136758)) NULL)
        NULL
    in
    let __v136759 = (ln __v136760 ⇒ recv(c_v136756)) NULL in
    (match __v136759 with
     | (msg_v136761, c_v136762) ⇒
       ln __v136763 ⇒
         let __v136764 = (ln __v136765 ⇒ close(c_v136762)) NULL in
         (ln __v136766 ⇒ msg_v136761) NULL
     end) NULL

val cmsortLclo_i96 = fn zs_v136767 ⇒ cmsortL_i58(zs_v136767)

val digits_i34 =
  (consUU_c19
    "0"
    (consUU_c19
      "1"
      (consUU_c19
        "2"
        (consUU_c19
          "3"
          (consUU_c19
            "4"
            (consUU_c19
              "5"
              (consUU_c19
                "6"
                (consUU_c19 "7" (consUU_c19 "8" (consUU_c19 "9" nilUU_c18))))))))))

fun get_at_i35(A_v136768, n_v136769, xs_v136770, a_v136771) =
  match n_v136769 with
  | O_c4  ⇒
    match xs_v136770 with
    | nilUU_c18  ⇒ a_v136771 | consUU_c19 x_v136772 __v136773 ⇒ x_v136772
    end
  | S_c5 n_v136774 ⇒
    match xs_v136770 with
    | nilUU_c18  ⇒ a_v136771
    | consUU_c19 __v136775 xs_v136776 ⇒
      get_at_i35(NULL, n_v136774, xs_v136776, a_v136771)
    end
  end

val get_atclo_i97 =
  fn A_v136777 n_v136778 xs_v136779 a_v136780 ⇒
    get_at_i35(A_v136777, n_v136778, xs_v136779, a_v136780)

fun string_of_digit_i36(n_v136781) =
  get_at_i35(NULL, n_v136781, digits_i34, EmptyString_c7)

val string_of_digitclo_i98 = fn n_v136782 ⇒ string_of_digit_i36(n_v136782)

fun string_of_nat_i37(n_v136783) =
  let s_v136784 = string_of_digit_i36(modn_i14(n_v136783, 10)) in
  let n_v136785 = divn_i13(n_v136783, 10) in
  match ltn_i6(O_c4, n_v136785) with
  | true_c2  ⇒ cats_i15(string_of_nat_i37(n_v136785), s_v136784)
  | false_c3  ⇒ s_v136784
  end

val string_of_natclo_i99 = fn n_v136786 ⇒ string_of_nat_i37(n_v136786)

fun string_of_listU_i61(xs_v136787) =
  match xs_v136787 with
  | nilUU_c18  ⇒ "nil"
  | consUU_c19 x_v136788 xs_v136789 ⇒
    cats_i15(cats_i15(string_of_nat_i37(x_v136788), " :: "),
             string_of_listU_i61(xs_v136789))
  end

val string_of_listUclo_i100 =
  fn xs_v136790 ⇒ string_of_listU_i61(xs_v136790)

fun string_of_listL_i60(xs_v136791) =
  match xs_v136791 with
  | nilUL_c16  ⇒ "nil"
  | consUL_c17 x_v136792 xs_v136793 ⇒
    cats_i15(cats_i15(string_of_nat_i37(x_v136792), " :: "),
             string_of_listL_i60(xs_v136793))
  end

val string_of_listLclo_i101 =
  fn xs_v136794 ⇒ string_of_listL_i60(xs_v136794)

main =
  (let test1_v136795 =
     (consUU_c19
       5
       (consUU_c19
         2
         (consUU_c19
           1 (consUU_c19 6 (consUU_c19 O_c4 (consUU_c19 3 nilUU_c18))))))
   in
   let test2_v136796 =
     (consUL_c17
       3
       (consUL_c17
         O_c4
         (consUL_c17
           6 (consUL_c17 1 (consUL_c17 2 (consUL_c17 5 nilUL_c16))))))
   in
   ln __v136797 ⇒
     let msg1_v136798 = (cmsortU_i59(test1_v136795)) NULL in
     let msg2_v136799 = (cmsortL_i58(test2_v136796)) NULL in
     (match msg1_v136798 with
      | UniqU_c21 sorted1_v136800 __v136801 ⇒
        match msg2_v136799 with
        | UniqL_c20 sorted2_v136802 __v136803 ⇒
          ln __v136804 ⇒
            let __v136805 =
              (print_i26(cats_i15(string_of_listU_i61(sorted1_v136800), "\n")))
                NULL
            in
            (print_i26(cats_i15(string_of_listL_i60(sorted2_v136802), "\n")))
              NULL
        end
      end) NULL)
    NULL

trans23 success--------------------------

fun andb_i1(b1_v137403, b2_v137404) =
  match b1_v137403 with
  | true_c2  ⇒ b2_v137404 | false_c3  ⇒ false_c3
  end

val andbclo_i62 =
  fn b1_v137405 b2_v137406 ⇒ andb_i1(b1_v137405, b2_v137406)

fun orb_i2(b1_v137407, b2_v137408) =
  match b1_v137407 with
  | true_c2  ⇒ true_c2 | false_c3  ⇒ b2_v137408
  end

val orbclo_i63 = fn b1_v137409 b2_v137410 ⇒ orb_i2(b1_v137409, b2_v137410)

fun notb_i3(b_v137411) =
  match b_v137411 with
  | true_c2  ⇒ false_c3 | false_c3  ⇒ true_c2
  end

val notbclo_i64 = fn b_v137412 ⇒ notb_i3(b_v137412)

fun lten_i4(x_v137413, y_v137414) =
  match x_v137413 with
  | O_c4  ⇒ true_c2
  | S_c5 x_v137415 ⇒
    match y_v137414 with
    | O_c4  ⇒ false_c3 | S_c5 y_v137416 ⇒ lten_i4(x_v137415, y_v137416)
    end
  end

val ltenclo_i65 = fn x_v137417 y_v137418 ⇒ lten_i4(x_v137417, y_v137418)

fun gten_i5(x_v137419, y_v137420) =
  match x_v137419 with
  | O_c4  ⇒
    match y_v137420 with
    | O_c4  ⇒ true_c2 | S_c5 __v137421 ⇒ false_c3
    end
  | S_c5 x_v137422 ⇒
    match y_v137420 with
    | O_c4  ⇒ true_c2 | S_c5 y_v137423 ⇒ gten_i5(x_v137422, y_v137423)
    end
  end

val gtenclo_i66 = fn x_v137424 y_v137425 ⇒ gten_i5(x_v137424, y_v137425)

fun ltn_i6(x_v137426, y_v137427) =
  match x_v137426 with
  | O_c4  ⇒
    match y_v137427 with
    | O_c4  ⇒ false_c3 | S_c5 y_v137428 ⇒ true_c2
    end
  | S_c5 x_v137429 ⇒
    match y_v137427 with
    | O_c4  ⇒ false_c3 | S_c5 y_v137430 ⇒ ltn_i6(x_v137429, y_v137430)
    end
  end

val ltnclo_i67 = fn x_v137431 y_v137432 ⇒ ltn_i6(x_v137431, y_v137432)

fun gtn_i7(x_v137433, y_v137434) =
  match x_v137433 with
  | O_c4  ⇒ false_c3
  | S_c5 x_v137435 ⇒
    match y_v137434 with
    | O_c4  ⇒ true_c2 | S_c5 y_v137436 ⇒ gtn_i7(x_v137435, y_v137436)
    end
  end

val gtnclo_i68 = fn x_v137437 y_v137438 ⇒ gtn_i7(x_v137437, y_v137438)

fun eqn_i8(x_v137439, y_v137440) =
  match x_v137439 with
  | O_c4  ⇒
    match y_v137440 with
    | O_c4  ⇒ true_c2 | S_c5 __v137441 ⇒ false_c3
    end
  | S_c5 x_v137442 ⇒
    match y_v137440 with
    | O_c4  ⇒ false_c3 | S_c5 y_v137443 ⇒ eqn_i8(x_v137442, y_v137443)
    end
  end

val eqnclo_i69 = fn x_v137444 y_v137445 ⇒ eqn_i8(x_v137444, y_v137445)

fun pred_i9(x_v137446) =
  match x_v137446 with
  | O_c4  ⇒ O_c4 | S_c5 x_v137447 ⇒ x_v137447
  end

val predclo_i70 = fn x_v137448 ⇒ pred_i9(x_v137448)

fun addn_i10(x_v137449, y_v137450) =
  match x_v137449 with
  | O_c4  ⇒ y_v137450
  | S_c5 x_v137451 ⇒ (S_c5 addn_i10(x_v137451, y_v137450))
  end

val addnclo_i71 = fn x_v137452 y_v137453 ⇒ addn_i10(x_v137452, y_v137453)

fun subn_i11(x_v137454, y_v137455) =
  match y_v137455 with
  | O_c4  ⇒ x_v137454
  | S_c5 y_v137456 ⇒ subn_i11(pred_i9(x_v137454), y_v137456)
  end

val subnclo_i72 = fn x_v137457 y_v137458 ⇒ subn_i11(x_v137457, y_v137458)

fun muln_i12(x_v137459, y_v137460) =
  match x_v137459 with
  | O_c4  ⇒ O_c4
  | S_c5 x_v137461 ⇒ addn_i10(y_v137460, muln_i12(x_v137461, y_v137460))
  end

val mulnclo_i73 = fn x_v137462 y_v137463 ⇒ muln_i12(x_v137462, y_v137463)

fun divn_i13(x_v137464, y_v137465) =
  match ltn_i6(x_v137464, y_v137465) with
  | true_c2  ⇒ O_c4
  | false_c3  ⇒ (S_c5 divn_i13(subn_i11(x_v137464, y_v137465), y_v137465))
  end

val divnclo_i74 = fn x_v137466 y_v137467 ⇒ divn_i13(x_v137466, y_v137467)

fun modn_i14(x_v137468, y_v137469) =
  subn_i11(x_v137468, muln_i12(divn_i13(x_v137468, y_v137469), y_v137469))

val modnclo_i75 = fn x_v137470 y_v137471 ⇒ modn_i14(x_v137470, y_v137471)

fun cats_i15(s1_v137472, s2_v137473) =
  match s1_v137472 with
  | EmptyString_c7  ⇒ s2_v137473
  | String_c8 c_v137474 s1_v137475 ⇒
    (String_c8 c_v137474 cats_i15(s1_v137475, s2_v137473))
  end

val catsclo_i76 =
  fn s1_v137476 s2_v137477 ⇒ cats_i15(s1_v137476, s2_v137477)

fun strlen_i16(s_v137478) =
  match s_v137478 with
  | EmptyString_c7  ⇒ O_c4
  | String_c8 __v137479 s_v137480 ⇒ (S_c5 strlen_i16(s_v137480))
  end

val strlenclo_i77 = fn s_v137481 ⇒ strlen_i16(s_v137481)

fun lenUU_i43(A_v137482, xs_v137483) =
  match xs_v137483 with
  | nilUU_c18  ⇒ (O_c4, nilUU_c18)
  | consUU_c19 x_v137484 xs_v137485 ⇒
    match lenUU_i43(NULL, xs_v137485) with
    | (n_v137486, xs_v137487) ⇒
      ((S_c5 n_v137486), (consUU_c19 x_v137484 xs_v137487))
    end
  end

val lenUUclo_i78 =
  fn A_v137488 xs_v137489 ⇒ lenUU_i43(A_v137488, xs_v137489)

fun lenUL_i42(A_v137490, xs_v137491) =
  match xs_v137491 with
  | nilUL_c16  ⇒ (O_c4, nilUL_c16)
  | consUL_c17 x_v137492 xs_v137493 ⇒
    match lenUL_i42(NULL, xs_v137493) with
    | (n_v137494, xs_v137495) ⇒
      ((S_c5 n_v137494), (consUL_c17 x_v137492 xs_v137495))
    end
  end

val lenULclo_i79 =
  fn A_v137496 xs_v137497 ⇒ lenUL_i42(A_v137496, xs_v137497)

fun lenLL_i40(A_v137498, xs_v137499) =
  match xs_v137499 with
  | nilLL_c12  ⇒ (O_c4, nilLL_c12)
  | consLL_c13 x_v137500 xs_v137501 ⇒
    match lenLL_i40(NULL, xs_v137501) with
    | (n_v137502, xs_v137503) ⇒
      ((S_c5 n_v137502), (consLL_c13 x_v137500 xs_v137503))
    end
  end

val lenLLclo_i80 =
  fn A_v137504 xs_v137505 ⇒ lenLL_i40(A_v137504, xs_v137505)

fun appendUU_i47(A_v137506, xs_v137507, ys_v137508) =
  match xs_v137507 with
  | nilUU_c18  ⇒ ys_v137508
  | consUU_c19 x_v137509 xs_v137510 ⇒
    (consUU_c19 x_v137509 appendUU_i47(NULL, xs_v137510, ys_v137508))
  end

val appendUUclo_i81 =
  fn A_v137511 xs_v137512 ⇒
    ln ys_v137513 ⇒ appendUU_i47(A_v137511, xs_v137512, ys_v137513)

fun appendUL_i46(A_v137514, xs_v137515, ys_v137516) =
  match xs_v137515 with
  | nilUL_c16  ⇒ ys_v137516
  | consUL_c17 x_v137517 xs_v137518 ⇒
    (consUL_c17 x_v137517 appendUL_i46(NULL, xs_v137518, ys_v137516))
  end

val appendULclo_i82 =
  fn A_v137519 xs_v137520 ⇒
    ln ys_v137521 ⇒ appendUL_i46(A_v137519, xs_v137520, ys_v137521)

fun appendLL_i44(A_v137522, xs_v137523, ys_v137524) =
  match xs_v137523 with
  | nilLL_c12  ⇒ ys_v137524
  | consLL_c13 x_v137525 xs_v137526 ⇒
    (consLL_c13 x_v137525 appendLL_i44(NULL, xs_v137526, ys_v137524))
  end

val appendLLclo_i83 =
  fn A_v137527 xs_v137528 ⇒
    ln ys_v137529 ⇒ appendLL_i44(A_v137527, xs_v137528, ys_v137529)

fun readline_i25(__v137530) =
  ln __v137531 ⇒
    let ch_v137532 = open stdin in
    let ch_v137533 = send(ch_v137532, true_c2) in
    let __v137534 = recv(ch_v137533) in
    (match __v137534 with
     | (s_v137535, ch_v137536) ⇒
       ln __v137537 ⇒
         let ch_v137538 = send(ch_v137536, false_c3) in
         let __v137539 = let __v137540 = ch_v137538 in tt_c1 in s_v137535
     end) NULL

val readlineclo_i84 = fn __v137541 ⇒ readline_i25(__v137541)

fun print_i26(s_v137542) =
  ln __v137543 ⇒
    let ch_v137544 = open stdout in
    let ch_v137545 = send(ch_v137544, true_c2) in
    let ch_v137546 = send(ch_v137545, s_v137542) in
    let ch_v137547 = send(ch_v137546, false_c3) in
    let __v137548 = ch_v137547 in tt_c1

val printclo_i85 = fn s_v137549 ⇒ print_i26(s_v137549)

fun prerr_i27(s_v137550) =
  ln __v137551 ⇒
    let ch_v137552 = open stderr in
    let ch_v137553 = send(ch_v137552, true_c2) in
    let ch_v137554 = send(ch_v137553, s_v137550) in
    let ch_v137555 = send(ch_v137554, false_c3) in
    let __v137556 = ch_v137555 in tt_c1

val prerrclo_i86 = fn s_v137557 ⇒ prerr_i27(s_v137557)

fun splitU_i49(zs_v137558) =
  match zs_v137558 with
  | nilUU_c18  ⇒ (nilUU_c18, nilUU_c18)
  | consUU_c19 x_v137559 zs_v137560 ⇒
    match zs_v137560 with
    | nilUU_c18  ⇒ ((consUU_c19 x_v137559 nilUU_c18), nilUU_c18)
    | consUU_c19 y_v137561 zs_v137562 ⇒
      let __v137563 = splitU_i49(zs_v137562) in
      match __v137563 with
      | (xs_v137564, ys_v137565) ⇒
        ((consUU_c19 x_v137559 xs_v137564), (consUU_c19 y_v137561 ys_v137565))
      end
    end
  end

val splitUclo_i87 = fn zs_v137566 ⇒ splitU_i49(zs_v137566)

fun splitL_i48(zs_v137567) =
  match zs_v137567 with
  | nilUL_c16  ⇒ (nilUL_c16, nilUL_c16)
  | consUL_c17 x_v137568 zs_v137569 ⇒
    match zs_v137569 with
    | nilUL_c16  ⇒ ((consUL_c17 x_v137568 nilUL_c16), nilUL_c16)
    | consUL_c17 y_v137570 zs_v137571 ⇒
      let __v137572 = splitL_i48(zs_v137571) in
      match __v137572 with
      | (xs_v137573, ys_v137574) ⇒
        ((consUL_c17 x_v137568 xs_v137573), (consUL_c17 y_v137570 ys_v137574))
      end
    end
  end

val splitLclo_i88 = fn zs_v137575 ⇒ splitL_i48(zs_v137575)

fun mergeU_i51(xs_v137576, ys_v137577) =
  match xs_v137576 with
  | nilUU_c18  ⇒ ys_v137577
  | consUU_c19 x_v137578 xs0_v137579 ⇒
    match ys_v137577 with
    | nilUU_c18  ⇒ (consUU_c19 x_v137578 xs0_v137579)
    | consUU_c19 y_v137580 ys0_v137581 ⇒
      match lten_i4(x_v137578, y_v137580) with
      | true_c2  ⇒
        (consUU_c19
          x_v137578
          mergeU_i51(xs0_v137579, (consUU_c19 y_v137580 ys0_v137581)))
      | false_c3  ⇒
        (consUU_c19
          y_v137580
          mergeU_i51((consUU_c19 x_v137578 xs0_v137579), ys0_v137581))
      end
    end
  end

val mergeUclo_i89 =
  fn xs_v137582 ⇒ ln ys_v137583 ⇒ mergeU_i51(xs_v137582, ys_v137583)

fun mergeL_i50(xs_v137584, ys_v137585) =
  match xs_v137584 with
  | nilUL_c16  ⇒ ys_v137585
  | consUL_c17 x_v137586 xs0_v137587 ⇒
    match ys_v137585 with
    | nilUL_c16  ⇒ (consUL_c17 x_v137586 xs0_v137587)
    | consUL_c17 y_v137588 ys0_v137589 ⇒
      match lten_i4(x_v137586, y_v137588) with
      | true_c2  ⇒
        (consUL_c17
          x_v137586
          mergeL_i50(xs0_v137587, (consUL_c17 y_v137588 ys0_v137589)))
      | false_c3  ⇒
        (consUL_c17
          y_v137588
          mergeL_i50((consUL_c17 x_v137586 xs0_v137587), ys0_v137589))
      end
    end
  end

val mergeLclo_i90 =
  fn xs_v137590 ⇒ ln ys_v137591 ⇒ mergeL_i50(xs_v137590, ys_v137591)

fun msortU_i53(zs_v137592) =
  match zs_v137592 with
  | nilUU_c18  ⇒ nilUU_c18
  | consUU_c19 x_v137593 zs_v137594 ⇒
    match zs_v137594 with
    | nilUU_c18  ⇒ (consUU_c19 x_v137593 nilUU_c18)
    | consUU_c19 y_v137595 zs_v137596 ⇒
      let __v137597 =
        splitU_i49((consUU_c19 x_v137593 (consUU_c19 y_v137595 zs_v137596)))
      in
      match __v137597 with
      | (xs_v137598, ys_v137599) ⇒
        mergeU_i51(msortU_i53(xs_v137598), msortU_i53(ys_v137599))
      end
    end
  end

val msortUclo_i91 = fn zs_v137600 ⇒ msortU_i53(zs_v137600)

fun msortL_i52(zs_v137601) =
  match zs_v137601 with
  | nilUL_c16  ⇒ nilUL_c16
  | consUL_c17 x_v137602 zs_v137603 ⇒
    match zs_v137603 with
    | nilUL_c16  ⇒ (consUL_c17 x_v137602 nilUL_c16)
    | consUL_c17 y_v137604 zs_v137605 ⇒
      let __v137606 =
        splitL_i48((consUL_c17 x_v137602 (consUL_c17 y_v137604 zs_v137605)))
      in
      match __v137606 with
      | (xs_v137607, ys_v137608) ⇒
        mergeL_i50(msortL_i52(xs_v137607), msortL_i52(ys_v137608))
      end
    end
  end

val msortLclo_i92 = fn zs_v137609 ⇒ msortL_i52(zs_v137609)

fun cmsort_workerU_i57(zs_v137610, c_v137611) =
  (match zs_v137610 with
   | nilUU_c18  ⇒
     ln c_v137612 __v137613 ⇒
       let c_v137614 = send(c_v137612, (UniqU_c21 nilUU_c18 NULL)) in
       let __v137615 = c_v137614 in tt_c1
   | consUU_c19 z0_v137616 zs0_v137617 ⇒
     ln c_v137618 ⇒
       (match zs0_v137617 with
        | nilUU_c18  ⇒
          ln c_v137619 __v137620 ⇒
            let c_v137621 =
              send(c_v137619, (UniqU_c21
                                (consUU_c19 z0_v137616 nilUU_c18) NULL))
            in let __v137622 = c_v137621 in tt_c1
        | consUU_c19 z1_v137623 zs1_v137624 ⇒
          ln c_v137625 ⇒
            (match splitU_i49((consUU_c19
                                z0_v137616
                                (consUU_c19 z1_v137623 zs1_v137624))) with
             | (xs0_v137626, ys0_v137627) ⇒
               ln e_v137628 __v137629 ⇒
                 let r1_v137630 =
                   fork r1_v137631 in
                     (cmsort_workerU_i57(xs0_v137626, r1_v137631)) NULL
                 in
                 let r2_v137632 =
                   fork r2_v137633 in
                     (cmsort_workerU_i57(ys0_v137627, r2_v137633)) NULL
                 in
                 let __v137634 = recv(r1_v137630) in
                 (match __v137634 with
                  | (msg1_v137635, r1_v137636) ⇒
                    ln __v137637 ⇒
                      let __v137638 = recv(r2_v137632) in
                      (match __v137638 with
                       | (msg2_v137639, r2_v137640) ⇒
                         match msg1_v137635 with
                         | UniqU_c21 xs1_v137641 pf1_v137642 ⇒
                           match msg2_v137639 with
                           | UniqU_c21 xs2_v137643 pf2_v137644 ⇒
                             let zs_v137645 =
                               mergeU_i51(xs1_v137641, xs2_v137643)
                             in
                             ln __v137646 ⇒
                               let c_v137647 =
                                 send(c_v137625, (UniqU_c21 zs_v137645 NULL))
                               in
                               let __v137648 = close(r1_v137636) in
                               let __v137649 = close(r2_v137640) in
                               let __v137650 = c_v137647 in tt_c1
                           end
                         end
                       end) NULL
                  end) NULL
             end) NULL
        end) c_v137618
   end) c_v137611

val cmsort_workerUclo_i93 =
  fn zs_v137651 ⇒
    ln c_v137652 ⇒ cmsort_workerU_i57(zs_v137651, c_v137652)

fun cmsort_workerL_i56(zs_v137653, c_v137654) =
  (match zs_v137653 with
   | nilUL_c16  ⇒
     ln c_v137655 __v137656 ⇒
       let c_v137657 = send(c_v137655, (UniqL_c20 nilUL_c16 NULL)) in
       let __v137658 = c_v137657 in tt_c1
   | consUL_c17 z0_v137659 zs0_v137660 ⇒
     ln c_v137661 ⇒
       (match zs0_v137660 with
        | nilUL_c16  ⇒
          ln c_v137662 __v137663 ⇒
            let c_v137664 =
              send(c_v137662, (UniqL_c20
                                (consUL_c17 z0_v137659 nilUL_c16) NULL))
            in let __v137665 = c_v137664 in tt_c1
        | consUL_c17 z1_v137666 zs1_v137667 ⇒
          ln c_v137668 ⇒
            (match splitL_i48((consUL_c17
                                z0_v137659
                                (consUL_c17 z1_v137666 zs1_v137667))) with
             | (xs0_v137669, ys0_v137670) ⇒
               ln e_v137671 __v137672 ⇒
                 let r1_v137673 =
                   fork r1_v137674 in
                     (cmsort_workerL_i56(xs0_v137669, r1_v137674)) NULL
                 in
                 let r2_v137675 =
                   fork r2_v137676 in
                     (cmsort_workerL_i56(ys0_v137670, r2_v137676)) NULL
                 in
                 let __v137677 = recv(r1_v137673) in
                 (match __v137677 with
                  | (msg1_v137678, r1_v137679) ⇒
                    ln __v137680 ⇒
                      let __v137681 = recv(r2_v137675) in
                      (match __v137681 with
                       | (msg2_v137682, r2_v137683) ⇒
                         match msg1_v137678 with
                         | UniqL_c20 xs1_v137684 pf1_v137685 ⇒
                           match msg2_v137682 with
                           | UniqL_c20 xs2_v137686 pf2_v137687 ⇒
                             let zs_v137688 =
                               mergeL_i50(xs1_v137684, xs2_v137686)
                             in
                             ln __v137689 ⇒
                               let c_v137690 =
                                 send(c_v137668, (UniqL_c20 zs_v137688 NULL))
                               in
                               let __v137691 = close(r1_v137679) in
                               let __v137692 = close(r2_v137683) in
                               let __v137693 = c_v137690 in tt_c1
                           end
                         end
                       end) NULL
                  end) NULL
             end) NULL
        end) c_v137661
   end) c_v137654

val cmsort_workerLclo_i94 =
  fn zs_v137694 ⇒
    ln c_v137695 ⇒ cmsort_workerL_i56(zs_v137694, c_v137695)

fun cmsortU_i59(zs_v137696) =
  ln __v137697 ⇒
    let c_v137698 =
      fork c_v137699 in (cmsort_workerU_i57(zs_v137696, c_v137699)) NULL
    in
    let __v137700 = recv(c_v137698) in
    (match __v137700 with
     | (msg_v137701, c_v137702) ⇒
       ln __v137703 ⇒ let __v137704 = close(c_v137702) in msg_v137701
     end) NULL

val cmsortUclo_i95 = fn zs_v137705 ⇒ cmsortU_i59(zs_v137705)

fun cmsortL_i58(zs_v137706) =
  ln __v137707 ⇒
    let c_v137708 =
      fork c_v137709 in (cmsort_workerL_i56(zs_v137706, c_v137709)) NULL
    in
    let __v137710 = recv(c_v137708) in
    (match __v137710 with
     | (msg_v137711, c_v137712) ⇒
       ln __v137713 ⇒ let __v137714 = close(c_v137712) in msg_v137711
     end) NULL

val cmsortLclo_i96 = fn zs_v137715 ⇒ cmsortL_i58(zs_v137715)

val digits_i34 =
  (consUU_c19
    "0"
    (consUU_c19
      "1"
      (consUU_c19
        "2"
        (consUU_c19
          "3"
          (consUU_c19
            "4"
            (consUU_c19
              "5"
              (consUU_c19
                "6"
                (consUU_c19 "7" (consUU_c19 "8" (consUU_c19 "9" nilUU_c18))))))))))

fun get_at_i35(A_v137716, n_v137717, xs_v137718, a_v137719) =
  match n_v137717 with
  | O_c4  ⇒
    match xs_v137718 with
    | nilUU_c18  ⇒ a_v137719 | consUU_c19 x_v137720 __v137721 ⇒ x_v137720
    end
  | S_c5 n_v137722 ⇒
    match xs_v137718 with
    | nilUU_c18  ⇒ a_v137719
    | consUU_c19 __v137723 xs_v137724 ⇒
      get_at_i35(NULL, n_v137722, xs_v137724, a_v137719)
    end
  end

val get_atclo_i97 =
  fn A_v137725 n_v137726 xs_v137727 a_v137728 ⇒
    get_at_i35(A_v137725, n_v137726, xs_v137727, a_v137728)

fun string_of_digit_i36(n_v137729) =
  get_at_i35(NULL, n_v137729, digits_i34, EmptyString_c7)

val string_of_digitclo_i98 = fn n_v137730 ⇒ string_of_digit_i36(n_v137730)

fun string_of_nat_i37(n_v137731) =
  let s_v137732 = string_of_digit_i36(modn_i14(n_v137731, 10)) in
  let n_v137733 = divn_i13(n_v137731, 10) in
  match ltn_i6(O_c4, n_v137733) with
  | true_c2  ⇒ cats_i15(string_of_nat_i37(n_v137733), s_v137732)
  | false_c3  ⇒ s_v137732
  end

val string_of_natclo_i99 = fn n_v137734 ⇒ string_of_nat_i37(n_v137734)

fun string_of_listU_i61(xs_v137735) =
  match xs_v137735 with
  | nilUU_c18  ⇒ "nil"
  | consUU_c19 x_v137736 xs_v137737 ⇒
    cats_i15(cats_i15(string_of_nat_i37(x_v137736), " :: "),
             string_of_listU_i61(xs_v137737))
  end

val string_of_listUclo_i100 =
  fn xs_v137738 ⇒ string_of_listU_i61(xs_v137738)

fun string_of_listL_i60(xs_v137739) =
  match xs_v137739 with
  | nilUL_c16  ⇒ "nil"
  | consUL_c17 x_v137740 xs_v137741 ⇒
    cats_i15(cats_i15(string_of_nat_i37(x_v137740), " :: "),
             string_of_listL_i60(xs_v137741))
  end

val string_of_listLclo_i101 =
  fn xs_v137742 ⇒ string_of_listL_i60(xs_v137742)

main =
  (let test1_v137743 =
     (consUU_c19
       5
       (consUU_c19
         2
         (consUU_c19
           1 (consUU_c19 6 (consUU_c19 O_c4 (consUU_c19 3 nilUU_c18))))))
   in
   let test2_v137744 =
     (consUL_c17
       3
       (consUL_c17
         O_c4
         (consUL_c17
           6 (consUL_c17 1 (consUL_c17 2 (consUL_c17 5 nilUL_c16))))))
   in
   ln __v137745 ⇒
     let msg1_v137746 = (cmsortU_i59(test1_v137743)) NULL in
     let msg2_v137747 = (cmsortL_i58(test2_v137744)) NULL in
     (match msg1_v137746 with
      | UniqU_c21 sorted1_v137748 __v137749 ⇒
        match msg2_v137747 with
        | UniqL_c20 sorted2_v137750 __v137751 ⇒
          ln __v137752 ⇒
            let __v137753 =
              (print_i26(cats_i15(string_of_listU_i61(sorted1_v137748), "\n")))
                NULL
            in
            (print_i26(cats_i15(string_of_listL_i60(sorted2_v137750), "\n")))
              NULL
        end
      end) NULL)
    NULL

trans3e success--------------------------

trans34 success--------------------------

