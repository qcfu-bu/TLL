[Definition {name = "DH"; relv = N;
   body =
   (Binder ([],
      ((Fun (
          (Pi (R, U, Int_t,
             (Binder ("p", (Pi (R, U, Int_t, (Binder ("g", Proto)))))))),
          (Binder ((Some "DH"),
             [([(PId "p"); (PId "g")],
               (Some (Act (N, true, Int_t,
                        (Binder ("a",
                           (Act (R, true, Int_t,
                              (Binder ("A",
                                 (Act (N, true,
                                    (BOpr ("=", (Id ("A", I)),
                                       (App
                                          [(Id ("powm", I)); (Id ("g", I));
                                            (Id ("a", I)); (Id ("p", I))])
                                       )),
                                    (Binder ("_",
                                       (Act (N, false, Int_t,
                                          (Binder ("b",
                                             (Act (R, false, Int_t,
                                                (Binder ("B",
                                                   (Act (N, false,
                                                      (BOpr ("=",
                                                         (Id ("B", I)),
                                                         (App
                                                            [(Id ("powm", I));
                                                              (Id ("g", I));
                                                              (Id ("b", I));
                                                              (Id ("p", I))])
                                                         )),
                                                      (Binder ("_", End))))
                                                   ))
                                                ))
                                             ))
                                          ))
                                       ))
                                    ))
                                 ))
                              ))
                           ))
                        ))))
               ]
             )),
          [E; E])),
       (Pi (R, U, Int_t,
          (Binder ("p", (Pi (R, U, Int_t, (Binder ("g", Proto)))))))))
      ));
   view = [E; E]};
  Definition {name = "DH_ch"; relv = N;
    body =
    (Binder ([],
       ((Fun (
           (Pi (R, U, Int_t,
              (Binder ("p", (Pi (R, U, Int_t, (Binder ("g", IMeta)))))))),
           (Binder ((Some "DH_ch"),
              [([(PId "p"); (PId "g")],
                (Some (Ch (true,
                         (App [(Id ("DH", I)); (Id ("p", I)); (Id ("g", I))])
                         ))))
                ]
              )),
           [E; E])),
        (Pi (R, U, Int_t,
           (Binder ("p", (Pi (R, U, Int_t, (Binder ("g", IMeta)))))))))
       ));
    view = [E; E]};
  Definition {name = "DH_hc"; relv = N;
    body =
    (Binder ([],
       ((Fun (
           (Pi (R, U, Int_t,
              (Binder ("p", (Pi (R, U, Int_t, (Binder ("g", IMeta)))))))),
           (Binder ((Some "DH_hc"),
              [([(PId "p"); (PId "g")],
                (Some (Ch (false,
                         (App [(Id ("DH", I)); (Id ("p", I)); (Id ("g", I))])
                         ))))
                ]
              )),
           [E; E])),
        (Pi (R, U, Int_t,
           (Binder ("p", (Pi (R, U, Int_t, (Binder ("g", IMeta)))))))))
       ));
    view = [E; E]};
  Definition {name = "alice"; relv = R;
    body =
    (Binder ([],
       ((Fun (
           (Pi (R, U, Int_t,
              (Binder ("a",
                 (Pi (R, U, Int_t,
                    (Binder ("p",
                       (Pi (R, U, Int_t,
                          (Binder ("g",
                             (Pi (R, U,
                                (App
                                   [(Id ("DH_ch", I)); (Id ("p", I));
                                     (Id ("g", I))]),
                                (Binder ("c", (IO (Id ("unit", I)))))))
                             ))
                          ))
                       ))
                    ))
                 ))
              )),
           (Binder ((Some "alice"),
              [([(PId "a"); (PId "p"); (PId "g"); (PId "c")],
                (Some (MLet ((App [(Send (Id ("c", I))); (Id ("a", I))]),
                         (Binder ((PId "c"),
                            (MLet (
                               (App
                                  [(Send (Id ("c", I)));
                                    (App
                                       [(Id ("powm", I)); (Id ("g", I));
                                         (Id ("a", I)); (Id ("p", I))])
                                    ]),
                               (Binder ((PId "c"),
                                  (MLet (
                                     (App
                                        [(Send (Id ("c", I)));
                                          (Id ("refl", I))]),
                                     (Binder ((PId "c"),
                                        (MLet ((Recv (Id ("c", I))),
                                           (Binder (
                                              (PBOpr (
                                                 "\226\159\168{},\226\159\169",
                                                 (PId "b"), (PId "c"))),
                                              (MLet ((Recv (Id ("c", I))),
                                                 (Binder (
                                                    (PBOpr (
                                                       "\226\159\168,\226\159\169",
                                                       (PId "B"), (PId "c"))),
                                                    (MLet (
                                                       (Recv (Id ("c", I))),
                                                       (Binder (
                                                          (PBOpr (
                                                             "\226\159\168{},\226\159\169",
                                                             (PId "pf"),
                                                             (PId "c"))),
                                                          (Close
                                                             (Id ("c", I)))
                                                          ))
                                                       ))
                                                    ))
                                                 ))
                                              ))
                                           ))
                                        ))
                                     ))
                                  ))
                               ))
                            ))
                         ))))
                ]
              )),
           [E; E; E; E])),
        (Pi (R, U, Int_t,
           (Binder ("a",
              (Pi (R, U, Int_t,
                 (Binder ("p",
                    (Pi (R, U, Int_t,
                       (Binder ("g",
                          (Pi (R, U,
                             (App
                                [(Id ("DH_ch", I)); (Id ("p", I));
                                  (Id ("g", I))]),
                             (Binder ("c", (IO (Id ("unit", I)))))))
                          ))
                       ))
                    ))
                 ))
              ))
           )))
       ));
    view = [E; E; E; E]};
  Definition {name = "bob"; relv = R;
    body =
    (Binder ([],
       ((Fun (
           (Pi (R, U, Int_t,
              (Binder ("b",
                 (Pi (R, U, Int_t,
                    (Binder ("p",
                       (Pi (R, U, Int_t,
                          (Binder ("g",
                             (Pi (R, U,
                                (App
                                   [(Id ("DH_hc", I)); (Id ("p", I));
                                     (Id ("g", I))]),
                                (Binder ("c", (IO (Id ("unit", I)))))))
                             ))
                          ))
                       ))
                    ))
                 ))
              )),
           (Binder ((Some "bob"),
              [([(PId "b"); (PId "p"); (PId "g"); (PId "c")],
                (Some (MLet ((Recv (Id ("c", I))),
                         (Binder (
                            (PBOpr ("\226\159\168{},\226\159\169", (PId "a"),
                               (PId "c"))),
                            (MLet ((Recv (Id ("c", I))),
                               (Binder (
                                  (PBOpr ("\226\159\168,\226\159\169",
                                     (PId "A"), (PId "c"))),
                                  (MLet ((Recv (Id ("c", I))),
                                     (Binder (
                                        (PBOpr (
                                           "\226\159\168{},\226\159\169",
                                           (PId "pf"), (PId "c"))),
                                        (MLet (
                                           (App
                                              [(Send (Id ("c", I)));
                                                (Id ("b", I))]),
                                           (Binder ((PId "c"),
                                              (MLet (
                                                 (App
                                                    [(Send (Id ("c", I)));
                                                      (App
                                                         [(Id ("powm", I));
                                                           (Id ("g", I));
                                                           (Id ("b", I));
                                                           (Id ("p", I))])
                                                      ]),
                                                 (Binder ((PId "c"),
                                                    (MLet (
                                                       (App
                                                          [(Send
                                                              (Id ("c", I)));
                                                            (Id ("refl", I))]),
                                                       (Binder ((PId "c"),
                                                          (Close
                                                             (Id ("c", I)))
                                                          ))
                                                       ))
                                                    ))
                                                 ))
                                              ))
                                           ))
                                        ))
                                     ))
                                  ))
                               ))
                            ))
                         ))))
                ]
              )),
           [E; E; E; E])),
        (Pi (R, U, Int_t,
           (Binder ("b",
              (Pi (R, U, Int_t,
                 (Binder ("p",
                    (Pi (R, U, Int_t,
                       (Binder ("g",
                          (Pi (R, U,
                             (App
                                [(Id ("DH_hc", I)); (Id ("p", I));
                                  (Id ("g", I))]),
                             (Binder ("c", (IO (Id ("unit", I)))))))
                          ))
                       ))
                    ))
                 ))
              ))
           )))
       ));
    view = [E; E; E; E]};
  Definition {name = "key_exchange"; relv = R;
    body =
    (Binder ([],
       ((Fun (
           (Pi (R, U, (Id ("unit", I)), (Binder ("_", (IO (Id ("unit", I)))))
              )),
           (Binder ((Some "key_exchange"),
              [([(PId "_")],
                (Some (Let (R, (Int 23),
                         (Binder ((PId "p"),
                            (Let (R, (Int 5),
                               (Binder ((PId "g"),
                                  (MLet (
                                     (Fork
                                        (Fun (
                                           (Pi (R, L,
                                              (App
                                                 [(Id ("DH_ch", I));
                                                   (Id ("p", I));
                                                   (Id ("g", I))]),
                                              (Binder ("",
                                                 (IO (Id ("unit", I)))))
                                              )),
                                           (Binder (None,
                                              [([(PId "c")],
                                                (Some (App
                                                         [(Id ("alice", I));
                                                           (Int 4);
                                                           (Id ("p", I));
                                                           (Id ("g", I));
                                                           (Id ("c", I))])))
                                                ]
                                              )),
                                           []))),
                                     (Binder ((PId "c"),
                                        (MLet (
                                           (Fork
                                              (Fun (
                                                 (Pi (R, L,
                                                    (Ch (true,
                                                       (Act (R, false,
                                                          (App
                                                             [(Id ("DH_hc", I
                                                                 ));
                                                               (Id ("p", I));
                                                               (Id ("g", I))]),
                                                          (Binder ("_", End))
                                                          ))
                                                       )),
                                                    (Binder ("",
                                                       (IO (Id ("unit", I)))
                                                       ))
                                                    )),
                                                 (Binder (None,
                                                    [([(PId "c0")],
                                                      (Some (MLet (
                                                               (Recv
                                                                  (Id ("c0",
                                                                    I))),
                                                               (Binder (
                                                                  (PBOpr (
                                                                    "\226\159\168,\226\159\169",
                                                                    (PId "c"),
                                                                    (PId "c0")
                                                                    )),
                                                                  (BOpr (";",
                                                                    (Close
                                                                    (Id (
                                                                    "c0", I))),
                                                                    (App
                                                                    [(Id (
                                                                    "bob", I
                                                                    ));
                                                                    (Int 3);
                                                                    (Id ("p",
                                                                    I));
                                                                    (Id ("g",
                                                                    I));
                                                                    (Id ("c",
                                                                    I))])))
                                                                  ))
                                                               ))))
                                                      ]
                                                    )),
                                                 []))),
                                           (Binder ((PId "c0"),
                                              (MLet (
                                                 (App
                                                    [(Send (Id ("c0", I)));
                                                      (Id ("c", I))]),
                                                 (Binder ((PId "c0"),
                                                    (Close (Id ("c0", I)))))
                                                 ))
                                              ))
                                           ))
                                        ))
                                     ))
                                  ))
                               ))
                            ))
                         ))))
                ]
              )),
           [E])),
        (Pi (R, U, (Id ("unit", I)), (Binder ("_", (IO (Id ("unit", I))))))))
       ));
    view = [E]}
  ]

-----------------------------------------

#[logical]
inductive eq_1‹s_296› (A_297 : Type‹s_296›) (m_298 : A_297):
  A_297 -> U
where
| refl_1 : (eq_1‹??_1› ?_1[0;0] m_298 m_298)

#[program]
def rwl_1‹s_300,r_301› :
  ∀ {A_302 : Type‹s_300›} ->
    ∀ {m_303 : A_302} ->
      ∀ {n_304 : A_302} ->
        ∀ {B_305 : A_302 -> Type‹r_301›} ->
          {(eq_1‹??_3› ?_3[0;0] m_303 n_304)} ->
            ((B_305) m_303) -> ((B_305) n_304)
:=
  fun rwl_309 :
    ∀ {A_310 : Type‹s_300›} ->
      ∀ {m_311 : A_310} ->
        ∀ {n_312 : A_310} ->
          ∀ {B_313 : A_310 -> Type‹r_301›} ->
            {(eq_1‹??_2› ?_2[0;0] m_311 n_312)} ->
              ((B_313) m_311) -> ((B_313) n_312)
  | A_317 m_318 n_319 B_320 refl_1 x_321 => x_321

#[program]
def rwr_2‹s_322,r_323› :
  ∀ {A_324 : Type‹s_322›} ->
    ∀ {m_325 : A_324} ->
      ∀ {n_326 : A_324} ->
        ∀ {B_327 : A_324 -> Type‹r_323›} ->
          {(eq_1‹??_5› ?_5[0;0] m_325 n_326)} ->
            ((B_327) n_326) -> ((B_327) m_325)
:=
  fun rwr_331 :
    ∀ {A_332 : Type‹s_322›} ->
      ∀ {m_333 : A_332} ->
        ∀ {n_334 : A_332} ->
          ∀ {B_335 : A_332 -> Type‹r_323›} ->
            {(eq_1‹??_4› ?_4[0;0] m_333 n_334)} ->
              ((B_335) n_334) -> ((B_335) m_333)
  | A_339 m_340 n_341 B_342 refl_1 x_343 => x_343

#[program]
inductive sing_2‹s_344› (A_345 : Type‹s_344›):
  A_345 -> Type‹s_344›
where
| just_2 (m_347 : A_345) : (sing_2‹??_6› ?_6[0;0] m_347)

#[program]
inductive unit_3‹› : U where
| tt_3 : unit_3

#[program]
inductive bool_4‹› : U where
| true_4 : bool_4
| false_5 : bool_4

#[program]
inductive list_5‹s_348,t_349› (A_350 : Type‹s_348›): Type‹t_349›
where
| nil_6 : (list_5‹??_7,??_8› A_350)
| cons_7
    (hd_351 : A_350) (tl_352 : (list_5‹??_9,t_349› A_350))
    : (list_5‹??_10,??_11› A_350)

#[program]
inductive exists0_6‹s_353,r_354› (A_355 : Type‹s_353›) (B_356 : 
A_355 -> Type‹r_354›): L where
| ex0_8
    {m_358 : A_355} (n_359 : ((B_356) m_358))
    : (exists0_6‹??_12,??_13› A_355 B_356)

#[program]
inductive exists1_7‹s_360,r_361› (A_362 : Type‹s_360›) (B_363 : 
A_362 -> Type‹r_361›): L where
| ex1_9
    (m_365 : A_362) (n_366 : ((B_363) m_365))
    : (exists1_7‹??_14,??_15› A_362 B_363)

#[logical]
def prod0_3‹s_367,r_368› :
  Type‹s_367› -> Type‹r_368› -> ?_10[0;0]
:=
  fun prod0_371 : Type‹s_367› -> Type‹r_368› -> ?_7[0;0]
  | A_374 B_375 =>
    (exists0_6‹??_16,??_17›
      A_374 fun _376 : ?_8[0;0] -> ?_9[0;0]
            | _378 => B_375)

#[logical]
def prod1_4‹s_379,r_380› :
  Type‹s_379› -> Type‹r_380› -> ?_14[0;0]
:=
  fun prod1_383 : Type‹s_379› -> Type‹r_380› -> ?_11[0;0]
  | A_386 B_387 =>
    (exists1_7‹??_18,??_19›
      A_386 fun _388 : ?_12[0;0] -> ?_13[0;0]
            | _390 => B_387)

#[program]
def not_5‹› : bool_4 -> bool_4 :=
  fun not_392 : bool_4 -> bool_4
  | true_4 => false_5
  | false_5 => true_4

#[program]
def and_6‹› : bool_4 -> bool_4 -> bool_4 :=
  fun and_396 : bool_4 -> bool_4 -> bool_4
  | true_4 true_4 => true_4
  | _399 _400 => false_5

#[program]
def or_7‹› : bool_4 -> bool_4 -> bool_4 :=
  fun or_403 : bool_4 -> bool_4 -> bool_4
  | false_5 false_5 => false_5
  | _406 _407 => true_4

#[program]
def xor_8‹› : bool_4 -> bool_4 -o bool_4 :=
  fun xor_410 : bool_4 -> bool_4 -o bool_4
  | true_4 true_4 => false_5
  | false_5 false_5 => false_5
  | _413 _414 => true_4

#[program]
def pow_9‹› : int -> int -> int :=
  fun pow_417 : int -> int -> int
  | x_420 y_421 =>
    let loop_422 :=
      fun loop_423 : int -> int -> int
      | acc_426 y_427 =>
        match (__lte__ y_427 0) in ?_15[0;0] -o ?_16[0;0] with
        | true_4 => acc_426
        | false_5 => ((loop_423) (__mul__ x_420 acc_426) (__sub__ y_427 1))
    in ((loop_422) 1 y_421)

#[program]
def powm_10‹› : int -> int -> int -> int :=
  fun powm_432 : int -> int -> int -> int
  | x_436 y_437 m_438 =>
    let loop_439 :=
      fun loop_440 : int -> int -> int
      | acc_443 y_444 =>
        match (__lte__ y_444 0) in ?_17[0;0] -o ?_18[0;0] with
        | true_4 => acc_443
        | false_5 =>
          ((loop_440)
            (__rem__ (__mul__ x_436 acc_443) m_438) (__sub__ y_444 1))
    in ((loop_439) 1 y_437)

#[logical]
def DH_11‹› : int -> int -> proto :=
  fun DH_448 : int -> int -> proto
  | p_451 g_452 =>
    ⇑{a_453 : int} ⇒
      ⇑(A_454 : int) ⇒
        ⇑{__455 :
          (eq_1‹??_20› ?_19[0;0] A_454 ((powm_10) g_452 a_453 p_451))} ⇒
          ⇓{b_456 : int} ⇒
            ⇓(B_457 : int) ⇒
              ⇓{__458 :
                (eq_1‹??_21›
                  ?_20[0;0] B_457 ((powm_10) g_452 b_456 p_451))} ⇒
                •

#[logical]
def DH_ch_12‹› : int -> int -> ?_22[0;0] :=
  fun DH_ch_461 : int -> int -> ?_21[0;0]
  | p_464 g_465 => ch⟨((DH_11) p_464 g_465)⟩

#[logical]
def DH_hc_13‹› : int -> int -> ?_24[0;0] :=
  fun DH_hc_468 : int -> int -> ?_23[0;0]
  | p_471 g_472 => hc⟨((DH_11) p_471 g_472)⟩

#[program]
def alice_14‹› :
  int ->
    ∀ (p_474 : int) ->
      ∀ (g_475 : int) -> ((DH_ch_12) p_474 g_475) -> IO unit_3
:=
  fun alice_477 :
    int ->
      ∀ (p_479 : int) ->
        ∀ (g_480 : int) -> ((DH_ch_12) p_479 g_480) -> IO unit_3
  | a_482 p_483 g_484 c_485 =>
    let* c_486 := ((send c_485) a_482) in
    let* c_487 := ((send c_486) ((powm_10) g_484 a_482 p_483)) in
    let* c_488 := ((send c_487) (refl_1‹??_22› ?_25[0;0] ?_26[0;0])) in
    let* _489 := recv c_488 in
    match _489 in ?_32[0;0] -o ?_31[0;0] with
    | (ex0_8 b_491 c_492) =>
      let* _493 := recv c_492 in
      match _493 in ?_30[0;0] -o ?_29[0;0] with
      | (ex1_9 B_495 c_496) =>
        let* _497 := recv c_496 in
        match _497 in ?_28[0;0] -o ?_27[0;0] with
        | (ex0_8 pf_499 c_500) => close c_500

#[program]
def bob_15‹› :
  int ->
    ∀ (p_502 : int) ->
      ∀ (g_503 : int) -> ((DH_hc_13) p_502 g_503) -> IO unit_3
:=
  fun bob_505 :
    int ->
      ∀ (p_507 : int) ->
        ∀ (g_508 : int) -> ((DH_hc_13) p_507 g_508) -> IO unit_3
  | b_510 p_511 g_512 c_513 =>
    let* _514 := recv c_513 in
    match _514 in ?_40[0;0] -o ?_39[0;0] with
    | (ex0_8 a_516 c_517) =>
      let* _518 := recv c_517 in
      match _518 in ?_38[0;0] -o ?_37[0;0] with
      | (ex1_9 A_520 c_521) =>
        let* _522 := recv c_521 in
        match _522 in ?_36[0;0] -o ?_35[0;0] with
        | (ex0_8 pf_524 c_525) =>
          let* c_526 := ((send c_525) b_510) in
          let* c_527 := ((send c_526) ((powm_10) g_512 b_510 p_511)) in
          let* c_528 :=
            ((send c_527) (refl_1‹??_23› ?_33[0;0] ?_34[0;0]))
          in close c_528

#[program]
def key_exchange_16‹› : unit_3 -> IO unit_3 :=
  fun key_exchange_530 : unit_3 -> IO unit_3
  | _532 =>
    let p_533 := 23 in
    let g_534 := 5 in
    let* c_535 :=
      fork
        fun _536 : ((DH_ch_12) p_533 g_534) -o IO unit_3
        | c_538 => ((alice_14) 4 p_533 g_534 c_538)
    in
    let* c0_539 :=
      fork
        fun _540 :
          ch⟨⇓(__542 : ((DH_hc_13) p_533 g_534)) ⇒ •⟩ -o IO unit_3
        | c0_543 =>
          let* _544 := recv c0_543 in
          match _544 in ?_42[0;0] -o ?_41[0;0] with
          | (ex1_9 c_546 c0_547) =>
            let* __548 := close c0_547 in ((bob_15) 3 p_533 g_534 c_546)
    in let* c0_549 := ((send c0_539) c_535) in close c0_549

-----------------------------------------

#[logical]
inductive eq_1‹s_5823› (A_5824 : Type‹s_5823›) (m_5825 : A_5824):
  A_5824 -> U
where
| refl_1 : (eq_1‹s_5823› A_5824 m_5825 m_5825)

#[program]
def rwl_1‹s_5827,r_5828› :
  ∀ {A_5829 : Type‹s_5827›} ->
    ∀ {m_5830 : A_5829} ->
      ∀ {n_5831 : A_5829} ->
        ∀ {B_5832 : A_5829 -> Type‹r_5828›} ->
          {(eq_1‹s_5827› A_5829 m_5830 n_5831)} ->
            ((B_5832) m_5830) -> ((B_5832) n_5831)
:=
  fun rwl_5836 :
    ∀ {A_5837 : Type‹s_5827›} ->
      ∀ {m_5838 : A_5837} ->
        ∀ {n_5839 : A_5837} ->
          ∀ {B_5840 : A_5837 -> Type‹r_5828›} ->
            {(eq_1‹s_5827› A_5837 m_5838 n_5839)} ->
              ((B_5840) m_5838) -> ((B_5840) n_5839)
  | A_5844 m_5845 n_5846 B_5847 refl_1 __5848 => __5848

#[program]
def rwr_2‹s_5849,r_5850› :
  ∀ {A_5851 : Type‹s_5849›} ->
    ∀ {m_5852 : A_5851} ->
      ∀ {n_5853 : A_5851} ->
        ∀ {B_5854 : A_5851 -> Type‹r_5850›} ->
          {(eq_1‹s_5849› A_5851 m_5852 n_5853)} ->
            ((B_5854) n_5853) -> ((B_5854) m_5852)
:=
  fun rwr_5858 :
    ∀ {A_5859 : Type‹s_5849›} ->
      ∀ {m_5860 : A_5859} ->
        ∀ {n_5861 : A_5859} ->
          ∀ {B_5862 : A_5859 -> Type‹r_5850›} ->
            {(eq_1‹s_5849› A_5859 m_5860 n_5861)} ->
              ((B_5862) n_5861) -> ((B_5862) m_5860)
  | A_5866 m_5867 n_5868 B_5869 refl_1 __5870 => __5870

#[program]
inductive sing_2‹s_5871› (A_5872 : Type‹s_5871›):
  A_5872 -> Type‹s_5871›
where
| just_2 (m_5874 : A_5872) : (sing_2‹s_5871› A_5872 m_5874)

#[program]
inductive unit_3‹› : U where
| tt_3 : unit_3

#[program]
inductive bool_4‹› : U where
| true_4 : bool_4
| false_5 : bool_4

#[program]
inductive list_5‹s_5875,t_5876› (A_5877 : Type‹s_5875›):
  Type‹t_5876›
where
| nil_6 : (list_5‹s_5875,t_5876› A_5877)
| cons_7
    (hd_5878 : A_5877) (tl_5879 : (list_5‹s_5875,t_5876› A_5877))
    : (list_5‹s_5875,t_5876› A_5877)

#[program]
inductive exists0_6‹s_5880,r_5881› (A_5882 : Type‹s_5880›) (B_5883 : 
A_5882 -> Type‹r_5881›): L where
| ex0_8
    {m_5885 : A_5882} (n_5886 : ((B_5883) m_5885))
    : (exists0_6‹s_5880,r_5881› A_5882 B_5883)

#[program]
inductive exists1_7‹s_5887,r_5888› (A_5889 : Type‹s_5887›) (B_5890 : 
A_5889 -> Type‹r_5888›): L where
| ex1_9
    (m_5892 : A_5889) (n_5893 : ((B_5890) m_5892))
    : (exists1_7‹s_5887,r_5888› A_5889 B_5890)

#[logical]
def prod0_3‹s_5894,r_5895› : Type‹s_5894› -> Type‹r_5895› -> L :=
  fun prod0_5898 : Type‹s_5894› -> Type‹r_5895› -> L
  | A_5901 B_5902 =>
    (exists0_6‹s_5894,r_5895›
      A_5901 fun _5903 : A_5901 -> Type‹r_5895›
             | __5905 => B_5902)

#[logical]
def prod1_4‹s_5906,r_5907› : Type‹s_5906› -> Type‹r_5907› -> L :=
  fun prod1_5910 : Type‹s_5906› -> Type‹r_5907› -> L
  | A_5913 B_5914 =>
    (exists1_7‹s_5906,r_5907›
      A_5913 fun _5915 : A_5913 -> Type‹r_5907›
             | __5917 => B_5914)

#[program]
def not_5‹› : bool_4 -> bool_4 :=
  fun not_5919 : bool_4 -> bool_4
  | true_4 => false_5
  | false_5 => true_4

#[program]
def and_6‹› : bool_4 -> bool_4 -> bool_4 :=
  fun and_5923 : bool_4 -> bool_4 -> bool_4
  | true_4 true_4 => true_4
  | true_4 false_5 => false_5
  | false_5 __5926 => false_5

#[program]
def or_7‹› : bool_4 -> bool_4 -> bool_4 :=
  fun or_5929 : bool_4 -> bool_4 -> bool_4
  | true_4 __5932 => true_4
  | false_5 true_4 => true_4
  | false_5 false_5 => false_5

#[program]
def xor_8‹› : bool_4 -> bool_4 -o bool_4 :=
  fun xor_5935 : bool_4 -> bool_4 -o bool_4
  | true_4 true_4 => false_5
  | true_4 false_5 => true_4
  | false_5 true_4 => true_4
  | false_5 false_5 => false_5

#[program]
def pow_9‹› : int -> int -> int :=
  fun pow_5940 : int -> int -> int
  | x_5943 y_5944 =>
    let loop_5945 :=
      fun loop_5946 : int -> int -> int
      | acc_5949 y_5950 =>
        match (__lte__ y_5950 0) in bool_4 -o int with
        | true_4 => acc_5949
        | false_5 =>
          ((loop_5946) (__mul__ x_5943 acc_5949) (__sub__ y_5950 1))
    in ((loop_5945) 1 y_5944)

#[program]
def powm_10‹› : int -> int -> int -> int :=
  fun powm_5955 : int -> int -> int -> int
  | x_5959 y_5960 m_5961 =>
    let loop_5962 :=
      fun loop_5963 : int -> int -> int
      | acc_5966 y_5967 =>
        match (__lte__ y_5967 0) in bool_4 -o int with
        | true_4 => acc_5966
        | false_5 =>
          ((loop_5963)
            (__rem__ (__mul__ x_5959 acc_5966) m_5961) (__sub__ y_5967 1))
    in ((loop_5962) 1 y_5960)

#[logical]
def DH_11‹› : int -> int -> proto :=
  fun DH_5971 : int -> int -> proto
  | p_5974 g_5975 =>
    ⇑{a_5976 : int} ⇒
      ⇑(A_5977 : int) ⇒
        ⇑{__5978 :
          (eq_1‹U› int A_5977 ((powm_10) g_5975 a_5976 p_5974))} ⇒
          ⇓{b_5979 : int} ⇒
            ⇓(B_5980 : int) ⇒
              ⇓{__5981 :
                (eq_1‹U› int B_5980 ((powm_10) g_5975 b_5979 p_5974))} ⇒
                •

#[logical]
def DH_ch_12‹› : int -> int -> L :=
  fun DH_ch_5984 : int -> int -> L
  | p_5987 g_5988 => ch⟨((DH_11) p_5987 g_5988)⟩

#[logical]
def DH_hc_13‹› : int -> int -> L :=
  fun DH_hc_5991 : int -> int -> L
  | p_5994 g_5995 => hc⟨((DH_11) p_5994 g_5995)⟩

#[program]
def alice_14‹› :
  int ->
    ∀ (p_5997 : int) ->
      ∀ (g_5998 : int) -> ((DH_ch_12) p_5997 g_5998) -> IO unit_3
:=
  fun alice_6000 :
    int ->
      ∀ (p_6002 : int) ->
        ∀ (g_6003 : int) -> ((DH_ch_12) p_6002 g_6003) -> IO unit_3
  | a_6005 p_6006 g_6007 c_6008 =>
    let* c_6009 := ((send c_6008) a_6005) in
    let* c_6010 := ((send c_6009) ((powm_10) g_6007 a_6005 p_6006)) in
    let* c_6011 :=
      ((send c_6010) (refl_1‹U› int ((powm_10) g_6007 a_6005 p_6006)))
    in
    let* _6012 := recv c_6011 in
    match _6012 in
      (exists0_6‹U,L›
        int
        fun _6014 : int -> L
        | b_6016 =>
          ch⟨⇓(B_6017 : int) ⇒
                 ⇓{__6018 :
                   (eq_1‹U› int B_6017 ((powm_10) g_6007 b_6016 p_6006))} ⇒
                   •⟩) -o
        IO unit_3
    with
    | (ex0_8 m_6019 n_6020) =>
      let* _6021 := recv n_6020 in
      match _6021 in
        (exists1_7‹U,L›
          int
          fun _6023 : int -> L
          | B_6025 =>
            ch⟨⇓{__6026 :
                   (eq_1‹U› int B_6025 ((powm_10) g_6007 m_6019 p_6006))} ⇒
                   •⟩) -o
          IO unit_3
      with
      | (ex1_9 m_6027 n_6028) =>
        let* _6029 := recv n_6028 in
        match _6029 in
          (exists0_6‹U,L›
            (eq_1‹U› int m_6027 ((powm_10) g_6007 m_6019 p_6006))
            fun _6031 :
              (eq_1‹U› int m_6027 ((powm_10) g_6007 m_6019 p_6006)) -> L
            | __6033 => ch⟨•⟩) -o IO unit_3
        with
        | (ex0_8 m_6034 n_6035) => close n_6035

#[program]
def bob_15‹› :
  int ->
    ∀ (p_6037 : int) ->
      ∀ (g_6038 : int) -> ((DH_hc_13) p_6037 g_6038) -> IO unit_3
:=
  fun bob_6040 :
    int ->
      ∀ (p_6042 : int) ->
        ∀ (g_6043 : int) -> ((DH_hc_13) p_6042 g_6043) -> IO unit_3
  | b_6045 p_6046 g_6047 c_6048 =>
    let* _6049 := recv c_6048 in
    match _6049 in
      (exists0_6‹U,L›
        int
        fun _6051 : int -> L
        | a_6053 =>
          hc⟨⇑(A_6054 : int) ⇒
                 ⇑{__6055 :
                   (eq_1‹U› int A_6054 ((powm_10) g_6047 a_6053 p_6046))} ⇒
                   ⇓{b_6056 : int} ⇒
                     ⇓(B_6057 : int) ⇒
                       ⇓{__6058 :
                         (eq_1‹U›
                           int B_6057 ((powm_10) g_6047 b_6056 p_6046))} ⇒
                         •⟩) -o
        IO unit_3
    with
    | (ex0_8 m_6059 n_6060) =>
      let* _6061 := recv n_6060 in
      match _6061 in
        (exists1_7‹U,L›
          int
          fun _6063 : int -> L
          | A_6065 =>
            hc⟨⇑{__6066 :
                   (eq_1‹U› int A_6065 ((powm_10) g_6047 m_6059 p_6046))} ⇒
                   ⇓{b_6067 : int} ⇒
                     ⇓(B_6068 : int) ⇒
                       ⇓{__6069 :
                         (eq_1‹U›
                           int B_6068 ((powm_10) g_6047 b_6067 p_6046))} ⇒
                         •⟩) -o
          IO unit_3
      with
      | (ex1_9 m_6070 n_6071) =>
        let* _6072 := recv n_6071 in
        match _6072 in
          (exists0_6‹U,L›
            (eq_1‹U› int m_6070 ((powm_10) g_6047 m_6059 p_6046))
            fun _6074 :
              (eq_1‹U› int m_6070 ((powm_10) g_6047 m_6059 p_6046)) -> L
            | __6076 =>
              hc⟨⇓{b_6077 : int} ⇒
                     ⇓(B_6078 : int) ⇒
                       ⇓{__6079 :
                         (eq_1‹U›
                           int B_6078 ((powm_10) g_6047 b_6077 p_6046))} ⇒
                         •⟩) -o
            IO unit_3
        with
        | (ex0_8 m_6080 n_6081) =>
          let* c_6082 := ((send n_6081) b_6045) in
          let* c_6083 := ((send c_6082) ((powm_10) g_6047 b_6045 p_6046)) in
          let* c_6084 :=
            ((send c_6083)
              (refl_1‹U› int ((powm_10) g_6047 b_6045 p_6046)))
          in close c_6084

#[program]
def key_exchange_16‹› : unit_3 -> IO unit_3 :=
  fun key_exchange_6086 : unit_3 -> IO unit_3
  | __6088 =>
    let p_6089 := 23 in
    let g_6090 := 5 in
    let* c_6091 :=
      fork
        fun _6092 : ((DH_ch_12) p_6089 g_6090) -o IO unit_3
        | _6094 => ((alice_14) 4 p_6089 g_6090 _6094)
    in
    let* c0_6095 :=
      fork
        fun _6096 :
          ch⟨⇓(__6098 : ((DH_hc_13) p_6089 g_6090)) ⇒ •⟩ -o
            IO unit_3
        | _6099 =>
          let* _6100 := recv _6099 in
          match _6100 in
            (exists1_7‹L,L›
              ((DH_hc_13) p_6089 g_6090)
              fun _6102 : ((DH_hc_13) p_6089 g_6090) -> L
              | __6104 => ch⟨•⟩) -o IO unit_3
          with
          | (ex1_9 m_6105 n_6106) =>
            let* __6107 := close n_6106 in ((bob_15) 3 p_6089 g_6090 m_6105)
    in let* c0_6108 := ((send c0_6095) c_6091) in close c0_6108

-----------------------------------------

